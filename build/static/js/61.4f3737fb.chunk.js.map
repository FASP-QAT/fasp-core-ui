{"version":3,"sources":["../node_modules/jexcel/dist/jexcel.js","../node_modules/jsuites/dist/jsuites.js"],"names":["jSuites","require","factory","jexcel","el","options","obj","Element","HTMLDocument","console","error","defaults","url","data","copyCompatibility","rows","columns","colHeaders","colWidths","colAlignments","nestedHeaders","defaultColWidth","defaultColAlign","minSpareRows","minSpareCols","minDimensions","allowExport","includeHeadersOnDownload","columnSorting","columnDrag","columnResize","rowResize","rowDrag","editable","allowInsertRow","allowManualInsertRow","allowInsertColumn","allowManualInsertColumn","allowDeleteRow","allowDeletingAllRows","allowDeleteColumn","allowRenameColumn","allowComments","wordWrap","imageOptions","csv","csvFileName","csvHeaders","csvDelimiter","selectionCopy","mergeCells","toolbar","search","pagination","paginationOptions","fullscreen","lazyLoading","loadingSpin","tableOverflow","tableHeight","tableWidth","meta","style","parseFormulas","autoIncrement","autoCasting","onundo","onredo","onload","onchange","onbeforechange","onafterchanges","onbeforeinsertrow","oninsertrow","onbeforeinsertcolumn","oninsertcolumn","onbeforedeleterow","ondeleterow","onbeforedeletecolumn","ondeletecolumn","onmoverow","onmovecolumn","onresizerow","onresizecolumn","onsort","onselection","onpaste","onbeforepaste","onmerge","onfocus","onblur","onchangeheader","oneditionstart","oneditionend","onchangestyle","onchangemeta","onchangepage","updateTable","detachForUpdates","text","noRecordsFound","showingPage","show","entries","columnName","insertANewColumnBefore","insertANewColumnAfter","deleteSelectedColumns","renameThisColumn","orderAscending","orderDescending","insertANewRowBefore","insertANewRowAfter","deleteSelectedRows","editComments","addComments","comments","clearComments","copy","paste","saveAs","about","areYouSureToDeleteTheSelectedRows","areYouSureToDeleteTheSelectedColumns","thisActionWillDestroyAnyExistingMergedCellsAreYouSure","thisActionWillClearYourSearchResultsAreYouSure","thereIsAConflictWithAnotherMergedCell","invalidMergeProperties","cellAlreadyMerged","noCellsSelected","property","hasOwnProperty","textKey","corner","contextMenu","textarea","ads","content","table","thead","tbody","results","searchInput","pageNumber","headerContainer","colgroupContainer","headers","records","history","formula","colgroup","selection","highlighted","selectedCell","selectedContainer","cursor","historyIndex","ignoreEvents","ignoreHistory","edition","hashString","resizing","dragging","activate","classList","add","remove","prepareTable","size","length","keys","Object","multiple","i","type","name","source","editor","allowEmpty","title","width","align","push","ajax","index","method","dataType","success","this","complete","createTable","format","document","createElement","searchContainer","searchText","createTextNode","appendChild","resetSelection","tempCol","paginationUpdateContainer","paginationDropdown","parseInt","value","page","temp","innerHTML","filter","setAttribute","j","createNestedHeader","createCellHeader","className","display","id","tabIndex","contextmenu","onclick","close","sessionStorage","getItem","setItem","img","src","span","paginationInfo","paginationPages","createToolbar","maxHeight","setData","setStyle","refresh","loading","result","hide","JSON","parse","row","size_i","size_j","min_i","min_j","max_i","max_j","undefined","startNumber","finalNumber","tr","createRow","updatePagination","num","setMerge","getData","dataOnly","dataset","px","py","x","y","contains","getJson","getRowData","rowNumber","setRowData","getColumnNameFromId","setValue","getColumnData","columnNumber","setColumnData","colNumber","height","td","createCell","element","checked","readOnly","formatted","calendar","extractDateFromString","getDateString","getDropDownValue","render","color","backgroundColor","substr","executeFormula","mask","decimal","run","colAlign","textAlign","whiteSpace","overflow","colWidth","getColumnName","nestedInformation","headerIndex","colspan","numberOfColumns","column","join","toolbarItem","k","v","tooltip","getAttribute","toolbarDropdownOption","open","o","cellName","rowspan","ignoreHistoryAndEvents","test","alert","x1","y1","x2","y2","cell","getIdFromColumnName","updateCell","updateSelection","setHistory","action","getMerge","removeMerge","keepOptions","removeAttribute","info","destroyMerged","isColMerged","insertBefore","cols","isRowMerged","openEditor","empty","e","createEditor","getBoundingClientRect","minHeight","children","autocomplete","opened","split","position","onclose","closeEditor","dropdown","focus","div","image","rect","rectContent","window","innerHeight","bottom","top","save","tagName","getCell","getCellFromCoords","getLabel","getLabelFromCoords","getValue","processedValue","getValueFromCoords","force","columnId","updateFormulaChain","setValueFromCoords","setCheckRadioValue","val","record","col","newValue","oldValue","copyData","d","h","breakControl","posx","posy","tokens","match","affectedTokens","token","updateFormula","Number","date","Date","setDate","getDate","getFullYear","doubleDigitFormat","getMonth","refreshSelection","updateSelectionFromCoords","conditionalSelectionUpdate","blur","previousStatus","ux","uy","left","el1","el2","origin","previousState","borderLeft","borderRight","borderTop","borderBottom","updateCornerPosition","removeCopySelection","updateCopySelection","x3","y3","last","contentRect","lastRect","w2","h2","scrollLeft","scrollTop","updateScroll","direction","w1","h1","referenceRect","getWidth","$","setWidth","oldWidth","setHeight","oldHeight","getHeight","getHeader","innerText","setHeader","prompt","getHeaders","asArray","getMeta","key","setMeta","prop","updateMeta","affectedCells","newMeta","getStyle","resetStyle","applyStyle","cellId","currentValue","oneApplication","trim","getComments","withAuthor","setComments","author","getConfig","orderBy","order","confirm","Array","prototype","p","slice","sort","a","b","valueA","toLowerCase","valueB","updateOrderArrow","updateOrder","updateTableReferences","loadPage","moveRow","ignoreDom","resetSearch","indexOf","call","nextSibling","removeChild","splice","insertRow","mixed","numOfRows","lastRow","log","rowIndex","currentRecords","currentData","currentRows","rowRecords","rowData","rowNode","apply","deleteRow","number","getSelectedRows","mergeExists","parentNode","moveColumn","insertColumn","properties","numOfColumns","lastColumn","columnIndex","injectArray","currentHeaders","currentColgroup","historyHeaders","historyColgroup","historyRecords","historyData","currentRecord","deleteColumn","getSelectedColumns","asIds","getHighlighted","mergeCellUpdates","updatePosition","columnIdFrom","columnIdTo","totalX","totalY","updateFormulas","numBlankRows","numBlankCols","setTimeout","showColumn","hideColumn","showIndex","hideIndex","chainLoopProtection","referencesToUpdate","newFormula","letter","testLetter","testNumber","exec","expression","formulaResults","formulaLoopProtection","execute","parentId","tokensUpdate","f","e1","e2","replace","evalstring","eval","parseNumber","res","up","shiftKey","ctrlKey","visible","loadValidation","item","firstChild","loadUp","whichPage","group","get","down","lastChild","loadDown","right","first","selectAll","Math","ceil","startRow","finalRow","currentPage","selectedPage","totalPages","query","addToResult","total","oldPage","quantityPerPage","quantyOfPages","paginationItem","args","arguments","download","includeHeaders","blob","Blob","navigator","msSaveOrOpenBlob","pom","URL","createObjectURL","href","body","click","changes","delimiter","returnData","colLabel","rowLabel","tmp","RegExp","label","str","strLabel","select","execCommand","hash","parseCSV","newStyle","oldStyle","styleIndex","colIndex","historyProcessRow","historyRecord","historyProcessColumn","undo","redo","combo","charCodeAt","arr","quote","c","cc","nc","destroy","init","current","build","newData","shift","items","comment","shortcut","clipboard","readText","then","scrollControls","timeControlLoading","clientHeight","scrollHeight","target","addEventListener","timeControl","destroyEventHandlers","removeEventListener","keyDownControls","mouseUpControls","mouseDownControls","mouseMoveControls","mouseOverControls","doubleClickControls","pasteControls","contextMenuControls","touchStartControls","touchEndControls","which","preventDefault","altKey","editorTextarea","editorValue","editorIndexOf","selectionStart","selectionEnd","selectedRow","selectedHeader","metaKey","rowId","keyCode","String","fromCharCode","validLetter","cutControls","copyControls","clearTimeout","isMouseAction","event","buttons","mouseButton","button","jexcelTable","getElement","selectedCorner","offsetX","mousePosition","pageX","offsetY","destination","c1","c2","pageY","clientWidth","getCellCoords","newWidth","newHeight","tempWidth","tempHeight","clientX","clientY","enabled","clipboardData","tmpElement","createTabs","tabs","spreadsheet","link","sheetName","fromSpreadsheet","file","__callback","oReq","convert","workbook","spreadsheets","SheetNames","forEach","Sheets","wpx","hpx","s","r","max_x","max_y","w","fgColor","rgb","numColumns","XMLHttpRequest","Uint8Array","responseType","arraybuffer","response","wb","XLSX","read","cellFormula","cellStyles","setRequestHeader","onreadystatechange","readyState","status","ff","convertResponseBodyToText","responseBody","send","idx","concat","t","code","pow","isArray","jexcelSection","jexcelElement","path","jQuery","fn","spreadsheetContainer","exports","nil","Error","div0","ref","na","utils","array","reduce","aIsArray","bIsArray","argsToArray","isFlat","flattenShallow","arrayEach","possibleNumbers","flatten","round","bool","toUpperCase","isNaN","string","parseFloat","len","parsed","matrix","pnarr","parseNumberArray","d1900","UTC","parseDate","getTime","parseDateArray","anyIsError","n","arrayValuesToNumbers","rest","initial","iteratee","transpose","map","methods","datetime","WEEK_TYPES","serial","DATE","year","month","day","DATEVALUE","date_text","DAY","serial_number","DAYS","end_date","start_date","DAYS360","EDATE","months","setMonth","EOMONTH","HOUR","getHours","INTERVAL","second","floor","hour","min","sec","ISOWEEKNUM","setHours","getDay","yearStart","MINUTE","getMinutes","MONTH","NETWORKDAYS","holidays","INTL","weekend","NOW","SECOND","getSeconds","TIME","minute","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","WORKDAY","days","YEAR","YEARFRAC","basis","database","compact","findResultIndex","criterias","matches","maxCriteriaLength","l","currentCriteriaResult","hasMatchingCriteria","criteria","criteriaField","FINDFIELD","DAVERAGE","field","resultIndexes","targetFields","sum","DCOUNT","DCOUNTA","DGET","DMAX","maxValue","DMIN","minValue","DPRODUCT","targetValues","DSTDEV","DSTDEVP","DSUM","DVAR","DVARP","MATCH","lookupValue","lookupArray","matchType","indexValue","engineering","isValidBinaryNumber","BESSELI","BESSELJ","BESSELK","BESSELY","BIN2DEC","stringified","toString","substring","BIN2HEX","places","REPT","BIN2OCT","BITAND","number1","number2","BITLSHIFT","abs","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki","unit_prefixes","Y","Z","E","P","T","G","M","m","u","z","from","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","ERF","lower_bound","upper_bound","PRECISE","ERFC","GESTEP","step","HEX2BIN","negative","HEX2DEC","HEX2OCT","IMABS","inumber","IMREAL","IMAGINARY","sqrt","plus","minus","unit","IMARGUMENT","PI","atan","IMCONJUGATE","IMCOS","cos","exp","sin","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","den","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","financial","validDate","ensureDate","ACCRINT","issue","settlement","rate","par","frequency","ACCRINTM","AMORDEGRC","AMORLINC","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPNCD","COUPNUM","COUPPCD","CUMIPMT","periods","start","end","payment","PMT","interest","FV","CUMPRINC","principal","DB","cost","salvage","life","period","toFixed","ceiling","DDB","factor","DISC","DOLLARDE","dollar","fraction","LN10","power","LN2","DOLLARFR","DURATION","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","IPMT","present","IRR","values","guess","irrResult","dates","irrResultDeriv","frac","positive","newRate","epsRate","resultValue","resultRate","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","PRICEDISC","PRICEMAT","PV","RATE","iter","t1","t2","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","maturity","discount","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","information","ERROR","TYPE","error_val","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISERROR","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISNUMBER","ISODD","ISREF","ISTEXT","N","NA","SHEET","SHEETS","logical","then_value","otherwise_value","valueIfError","value_if_na","targetValue","argc","switchCount","switchSatisfied","defaultClause","math","acos","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","asin","number_x","number_y","atan2","radix","min_length","max","significance","mode","CEILING","MATH","COMBIN","number_chosen","FACT","COMBINA","COS","COSH","COT","tan","COTH","CSC","CSCH","DECIMAL","DEGREES","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","FLOOR","GCD","INT","LCM","pop","LN","LOG","base","LOG10","MDETERM","MINVERSE","MMULT","MOD","dividend","divisor","modulus","MROUND","MULTINOMIAL","MUNIT","ODD","POWER","PRODUCT","QUOTIENT","numerator","denominator","RADIANS","RAND","random","RANDBETWEEN","ROMAN","ROUND","digits","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","ADD","num1","num2","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","EQ","value1","value2","NE","POW","exponent","SUM","argsKeys","elt","SUMIF","range","SUMIFS","n_range_elements","n_criterias","condition","SUMPRODUCT","SUMSQ","numbers","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","misc","hasElement","FLATTEN","ARGS2ARRAY","REFERENCE","context","reference","opening","JOIN","separator","NUMBERS","NUMERAL","trueFound","falseFound","text1","text2","find_text","within_text","line","begin","txt","charAt","regular_expression","full","replacement","new_text","foundAt","old_text","occurrence","UNICHAR","CHAR","UNICODE","CODE","UPPER","VALUE","stats","SQRT2PI","AVEDEV","AVERAGE","count","AVERAGEA","AVERAGEIF","average_range","average_count","AVERAGEIFS","COUNT","COUNTA","COUNTBLANK","COUNTIN","blanks","COUNTIF","COUNTIFS","COUNTUNIQUE","UNIQUE","FISHER","FISHERINV","e2y","FREQUENCY","bins","LARGE","MAX","MAXA","MIN","MINA","MODE","MULT","currentItem","maxItems","SNGL","PERCENTILE","EXC","fl","cleanFloat","INC","PERCENTRANK","uniques","PERMUT","PERMUTATIONA","PHI","PROB","probability","lower","upper","sorted","QUARTILE","quart","RANK","AVG","RSQ","data_x","data_y","PEARSON","SMALL","STANDARDIZE","mean","sd","STDEV","VAR","S","STDEVA","VARA","STDEVPA","VARPA","sigma","WEIBULL","DIST","alpha","beta","cumulative","TEST","NORM","module","app","querySelector","guid","documentElement","g","getElementsByTagName","innerWidth","changedTouches","Event","evt","MouseEvent","bubbles","cancelable","view","dispatchEvent","foundElement","targetElement","formObject","ret","elements","querySelectorAll","http","files","extension","lastIndexOf","cover","encodeURIComponent","httpRequest","responseText","err","requests","slideLeft","done","slideRight","slideTop","slideBottom","fadeIn","fadeOut","nodes","slider","dialog","onconfirm","actionUpControl","getLinkElement","back","panel","pages","scrollTo","behavior","prev","next","onpopstate","state","route","readonly","today","time","resetButton","placeholder","weekdays","weekdays_short","two","calendarReset","calendarConfirm","calendarControls","calendarContainer","calendarContent","calendarHeaderPrev","calendarLabelYear","calendarLabelMonth","calendarHeaderTitle","calendarHeaderNext","calendarHeaderRow","calendarHeader","calendarBody","calendarFooter","calendarTable","calendarSelectHour","calendarSelectMin","calendarControlsTime","maxWidth","calendarControlsUpdate","flexGrow","calendarBackdrop","getDays","getWindowWidth","update","getYears","setLabel","reset","today_d","nd","fd","fontWeight","getMonths","html","fromFormatted","stopPropagation","prettify","texts","justNow","xMinutesAgo","xHoursAgo","xDaysAgo","xWeeksAgo","xMonthsAgo","xYearsAgo","d1","d2","prettifyAll","now","v1","v2","weekday","isOpen","palette","colors","shade","container","backdrop","closeButton","selected","create","itemContainer","itemText","disabled","itemShortCut","foundId","dialogHeader","dialogTitle","dialogMessage","dialogFooter","dialogContainer","dialogConfirm","dialogConfirmButton","confirmLabel","dialogCancel","dialogCancelButton","cancelLabel","oncancel","message","opacity","extractFromDom","onopen","groups","minWidth","containerHeader","header","keyTimer","find","getUrl","setUrl","createItem","textLowerCase","node","groupNames","groupName","groupArrow","groupContent","getText","updateLabel","selectIndex","oldLabel","currentIndex","indexToRemove","resetSelected","newLabel","selectItem","updateCursor","rectContainer","resetCursor","offsetTop","clientTop","firstVisible","newIndex","hasEvents","mouseup","onkeydown","offsetWidth","snippet","remoteParser","youtubeKey","userSearch","parseURL","dropZone","dropAsAttachment","acceptImages","acceptFiles","maxFileSize","border","padding","onenter","onkeyup","editorTimer","editorAction","overflowY","extractImageFromHtml","addImage","insertNodeAtCaret","newNode","sel","getSelection","rangeCount","getRangeAt","deleteContents","insertNode","setStartAfter","setEndAfter","removeAllRanges","addRange","appendElement","description","host","verifyEditor","thumbsContainer","detectUrl","getDomain","location","hostname","importImage","youtubeParser","getYoutube","getWebsite","parseContent","thumbnails","medium","encodeURI","json","tagged","users","userId","stringify","addPdf","canvas","Image","getContext","drawImage","toBlob","newImage","toDataURL","addFile","reader","FileReader","lastModified","readAsDataURL","editorMouseUp","editorMouseDown","editorMouseMove","editorKeyUp","editorKeyDown","editorDragStart","editorDragEnter","editorDragOver","editorDrop","editorPaste","editorBlur","editorFocus","removeRange","originalEvent","nodeName","caretRangeFromPoint","rangeParent","createRange","setStart","rangeOffset","anchorNode","dataTransfer","getDefaultToolbar","icon","userSelect","itemIcon","setCursor","startContainer","endContainer","setEnd","links","queryCommandState","singleFile","extensionNotAllowed","imageTooSmall","lastmodified","small","addImages","addFromFile","imageFile","srcElement","extentionNotAllowed","addFromUrl","attachmentInput","login","prepareRequest","accessToken","deviceToken","facebookUrl","onerror","logo","newProfile","newProfileUrl","newProfileLogin","messageElement","divLogo","labelCode","inputCode","divCode","inputHash","divHash","inputRecovery","divRecovery","labelLogin","inputLogin","divLogin","labelName","inputName","divName","labelUsername","inputUsername","divUsername","labelPassword","inputPassword","divPassword","labelRepeatPassword","inputRepeatPassword","divRepeatPassword","labelRemember","inputRemember","divRememberButton","actionButton","divActionButton","cancelButton","requestAccess","divCancelButton","labelCaptcha","inputCaptcha","imageCaptcha","divCaptcha","facebookButton","divFacebookButton","requestLoginViaFacebook","inputRequest","divRequestButton","requestNewPassword","inputNewProfile","divNewProfileButton","showMessage","captcha","codeConfirmation","changeMyPassword","localStorage","deviceNotificationToken","FB","getLoginStatus","authResponse","scope","jDestroy","fbLogin","jStart","jError","jExit","pattern","getFormElements","password","sha512","onsuccess","int64","msint_32","lsint_32","highOrder","lowOrder","T1","T2","H","K","W","safe_add_2","lsw","msw","safe_add_4","safe_add_5","maj","rotr","sigma0","rotr28","rotr34","rotr39","sigma1","rotr14","rotr18","rotr41","gamma0","rotr1","rotr8","shr7","shr","gamma1","rotr19","rotr61","shr6","strlen","unescape","utf8_encode","bin","str2binb","binarray","srcByte","binb2hex","pieces","valueDecimal","prepare","process","fromKeyCode","input","reverse","_to_ascii","shiftUps","mobile","createPage","callback","onpush","script","setTitle","closed","showPage","onleave","pushState","routePath","getContainer","toolbarContent","setBadge","toolbarIcon","toolbarBadge","toolbarBadgeContent","badge","toolbarTitle","actionsheet","actionContent","actionGroup","actionItem","actionInput","modal","resetPosition","notification","timeout","autoHide","closeable","notificationContainer","notificationHeader","notificationImage","notificationIcon","notificationName","notificationClose","notificationDate","notificationContent","notificationTitle","notificationMessage","rating","previousSibling","currentImage","addFiles","getFiles","allowAttachment","attachmentIcon","longTouchTimer","mouseDown","mouseUp","sorting","headersItem","contentItem","setBorder","tags","limit","validation","searchTerms","searchIndex","searchTimer","getSelectionStart","caret","extractTags","isValid","terms","nodeValue","tagsMouseUp","tagsKeyDown","tagsKeyUp","tagsPaste","tagsFocus","tagsBlur","collapse","nodeType","word","anchorOffset","tracker","ignore","currentHash","submitButton","onbeforesave","onsave","load","validate","getElements","validateElement","emailChecker","addError","delError","getError","setHash","getHash","isChanged","resetTracker","setIgnore","ignoreFlag","confirmationMessage","returnValue"],"mappings":"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M,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,WAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,WACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,UAAY,WACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,WAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA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","file":"static/js/61.4f3737fb.chunk.js","sourcesContent":["\r\n/**\r\n * jExcel v3.9.1\r\n *\r\n * Author: Paul Hodel <paul.hodel@gmail.com>\r\n * Website: https://bossanova.uk/jexcel/\r\n * Description: Create amazing web based spreadsheets.\r\n *\r\n * This software is distribute under MIT License\r\n */\r\n\r\n if (! jSuites && typeof(require) === 'function') {\r\n    var jSuites = require('jsuites');\r\n    require('jsuites/dist/jsuites.css');\r\n}\r\n\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jexcel = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\n// Jexcel core object\n\nvar jexcel = (function(el, options) {\n    // Create jexcel object\n    var obj = {};\n    obj.options = {};\n\n    if (! (el instanceof Element || el instanceof HTMLDocument)) {\r\n        console.error('JEXCEL: el is not a valid DOM element');\r\n        return false;\r\n    }\r\n\n    // Loading default configuration\n    var defaults = {\n        // External data\n        url:null,\n        // Data\n        data:null,\n        // Copy behavior\n        copyCompatibility:false,\n        // Rows and columns definitions\n        rows:[],\n        columns:[],\n        // Deprected legacy options\n        colHeaders:[],\n        colWidths:[],\n        colAlignments:[],\n        nestedHeaders:null,\n        // Column width that is used by default\n        defaultColWidth:50,\n        defaultColAlign:'center',\n        // Spare rows and columns\n        minSpareRows:0,\n        minSpareCols:0,\n        // Minimal table dimensions\n        minDimensions:[0,0],\n        // Allow Export\n        allowExport:true,\r\n        // @type {boolean} - Include the header titles on download\n        includeHeadersOnDownload:false,\n        // Allow column sorting\n        columnSorting:true,\n        // Allow column dragging\n        columnDrag:false,\n        // Allow column resizing\n        columnResize:true,\n        // Allow row resizing\n        rowResize:false,\n        // Allow row dragging\n        rowDrag:true,\n        // Allow table edition\n        editable:true,\n        // Allow new rows\n        allowInsertRow:true,\n        // Allow new rows\n        allowManualInsertRow:true,\n        // Allow new columns\n        allowInsertColumn:true,\n        // Allow new rows\n        allowManualInsertColumn:true,\n        // Allow row delete\n        allowDeleteRow:true,\n        // Allow deleting of all rows\n        allowDeletingAllRows:false,\n        // Allow column delete\n        allowDeleteColumn:true,\n        // Allow rename column\n        allowRenameColumn:true,\n        // Allow comments\n        allowComments:false,\n        // Global wrap\n        wordWrap:false,\n        // Image options\n        imageOptions: null,\n        // CSV source\n        csv:null,\n        // Filename\n        csvFileName:'jexcel',\n        // Consider first line as header\n        csvHeaders:true,\n        // Delimiters\n        csvDelimiter:',',\n        // Disable corner selection\n        selectionCopy:true,\n        // Merged cells\n        mergeCells:{},\n        // Create toolbar\n        toolbar:null,\n        // Allow search\n        search:false,\n        // Create pagination\n        pagination:false,\n        paginationOptions:null,\n        // Full screen\n        fullscreen:false,\n        // Lazy loading\n        lazyLoading:false,\n        loadingSpin:false,\n        // Table overflow\n        tableOverflow:false,\n        tableHeight:'300px',\n        tableWidth:null,\n        // Meta\n        meta: null,\n        // Style\n        style:null,\n        // Execute formulas\n        parseFormulas:true,\n        autoIncrement:true,\n        autoCasting:true,\n        // Event handles\n        onundo:null,\n        onredo:null,\n        onload:null,\n        onchange:null,\n        onbeforechange:null,\n        onafterchanges:null,\n        onbeforeinsertrow: null,\n        oninsertrow:null,\n        onbeforeinsertcolumn: null,\n        oninsertcolumn:null,\n        onbeforedeleterow:null,\n        ondeleterow:null,\n        onbeforedeletecolumn:null,\n        ondeletecolumn:null,\n        onmoverow:null,\n        onmovecolumn:null,\n        onresizerow:null,\n        onresizecolumn:null,\n        onsort:null,\n        onselection:null,\n        onpaste:null,\n        onbeforepaste:null,\n        onmerge:null,\n        onfocus:null,\n        onblur:null,\n        onchangeheader:null,\n        oneditionstart:null,\n        oneditionend:null,\n        onchangestyle:null,\n        onchangemeta:null,\n        onchangepage:null,\n        // Customize any cell behavior\n        updateTable:null,\n        // Detach the HTML table when calling updateTable\r\n        detachForUpdates: false,\n        // Texts\n        text:{\n            noRecordsFound: 'No records found',\n            showingPage: 'Showing page {0} of {1} entries',\n            show: 'Show ',\n            search: 'Search',\n            entries: ' entries',\n            columnName: 'Column name',\n            insertANewColumnBefore: 'Insert a new column before',\n            insertANewColumnAfter: 'Insert a new column after',\n            deleteSelectedColumns: 'Delete selected columns',\n            renameThisColumn: 'Rename this column',\n            orderAscending: 'Order ascending',\n            orderDescending: 'Order descending',\n            insertANewRowBefore: 'Insert a new row before',\n            insertANewRowAfter: 'Insert a new row after',\n            deleteSelectedRows: 'Delete selected rows',\n            editComments: 'Edit comments',\n            addComments: 'Add comments',\n            comments: 'Comments',\n            clearComments: 'Clear comments',\n            copy: 'Copy...',\n            paste: 'Paste...',\n            saveAs: 'Save as...',\n            about: 'About',\n            areYouSureToDeleteTheSelectedRows: 'Are you sure to delete the selected rows?',\n            areYouSureToDeleteTheSelectedColumns: 'Are you sure to delete the selected columns?',\n            thisActionWillDestroyAnyExistingMergedCellsAreYouSure: 'This action will destroy any existing merged cells. Are you sure?',\n            thisActionWillClearYourSearchResultsAreYouSure: 'This action will clear your search results. Are you sure?',\n            thereIsAConflictWithAnotherMergedCell: 'There is a conflict with another merged cell',\n            invalidMergeProperties: 'Invalid merged properties',\n            cellAlreadyMerged: 'Cell already merged',\n            noCellsSelected: 'No cells selected',\n        },\n        // About message\n        about:\"jExcel CE Spreadsheet\\nVersion 3.9.1\\nAuthor: Paul Hodel <paul.hodel@gmail.com>\\nWebsite: https://bossanova.uk/jexcel/v3\",\n    };\n\n    // Loading initial configuration from user\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            if (property === 'text') {\r\n                obj.options[property] = defaults[property];\r\n                for (var textKey in options[property]) {\r\n                    if (options[property].hasOwnProperty(textKey)){\r\n                        obj.options[property][textKey] = options[property][textKey];\r\n                    }\r\n                }\r\n            } else {\r\n                obj.options[property] = options[property];\n            }\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Global elements\n    obj.el = el;\n    obj.corner = null;\n    obj.contextMenu = null;\n    obj.textarea = null;\n    obj.ads = null;\n    obj.content = null;\n    obj.table = null;\n    obj.thead = null;\n    obj.tbody = null;\n    obj.rows = [];\n    obj.results = null;\n    obj.searchInput = null;\n    obj.toolbar = null;\n    obj.pagination = null;\n    obj.pageNumber = null;\n    obj.headerContainer = null;\n    obj.colgroupContainer = null;\n\n    // Containers\n    obj.headers = [];\n    obj.records = [];\n    obj.history = [];\n    obj.formula = [];\n    obj.colgroup = [];\n    obj.selection = [];\n    obj.highlighted  = [];\n    obj.selectedCell = null;\n    obj.selectedContainer = null;\n    obj.style = [];\n    obj.data = null;\n\n    // Internal controllers\n    obj.cursor = null;\n    obj.historyIndex = -1;\n    obj.ignoreEvents = false;\n    obj.ignoreHistory = false;\n    obj.edition = null;\n    obj.hashString = null;\n    obj.resizing = null;\n    obj.dragging = null;\n\n    // Lazy loading\n    if (obj.options.lazyLoading == true && (obj.options.tableOverflow == false && obj.options.fullscreen == false)) {\n        console.error('JEXCEL: The lazyloading only works when tableOverflow = yes or fullscreen = yes');\n        obj.options.lazyLoading = false;\n    }\n    \n    /**\n     * Activate/Disable fullscreen \n     * use programmatically : table.fullscreen(); or table.fullscreen(true); or table.fullscreen(false);\n     * @Param {boolean} activate\n     */\n    obj.fullscreen = function(activate) {\n        // If activate not defined, get reverse options.fullscreen\n        if (activate == null) {\n            activate = ! obj.options.fullscreen;\n        }\n\n        // If change\n        if (obj.options.fullscreen != activate) {\n            obj.options.fullscreen = activate;\n\n            // Test LazyLoading conflict\n            if (activate == true) {\n                el.classList.add('fullscreen');\n            } else {\n                el.classList.remove('fullscreen');\n            }\n        } \n    }\n\n    /**\n     * Prepare the jexcel table\n     * \n     * @Param config\n     */\n    obj.prepareTable = function() {\n        // Loading initial data from remote sources\n        var results = [];\n\n        // Number of columns\n        var size = obj.options.columns.length;\n\n        if (obj.options.data && typeof(obj.options.data[0]) !== 'undefined') {\n            // Data keys\n            var keys = Object.keys(obj.options.data[0]);\n\n            if (keys.length > size) {\n                size = keys.length;\n            }\n        }\n\n        // Minimal dimensions\n        if (obj.options.minDimensions[0] > size) {\n            size = obj.options.minDimensions[0];\n        }\n\n        // Requests\n        var multiple = [];\n\n        // Preparations\n        for (var i = 0; i < size; i++) {\n            // Deprected options. You should use only columns\n            if (! obj.options.colHeaders[i]) {\n                obj.options.colHeaders[i] = '';\n            }\n            if (! obj.options.colWidths[i]) {\n                obj.options.colWidths[i] = obj.options.defaultColWidth;\n            }\n            if (! obj.options.colAlignments[i]) {\n                obj.options.colAlignments[i] = obj.options.defaultColAlign;\n            }\n\n            // Default column description\n            if (! obj.options.columns[i]) {\n                obj.options.columns[i] = { type:'text' };\n            } else if (! obj.options.columns[i].type) {\n                obj.options.columns[i].type = 'text';\n            }\n            if (! obj.options.columns[i].name) {\n                obj.options.columns[i].name = keys && keys[i] ? keys[i] : i;\n            }\n            if (! obj.options.columns[i].source) {\n                obj.options.columns[i].source = [];\n            }\n            if (! obj.options.columns[i].options) {\n                obj.options.columns[i].options = [];\n            }\n            if (! obj.options.columns[i].editor) {\n                obj.options.columns[i].editor = null;\n            }\n            if (! obj.options.columns[i].allowEmpty) {\n                obj.options.columns[i].allowEmpty = false;\n            }\n            if (! obj.options.columns[i].title) {\n                obj.options.columns[i].title = obj.options.colHeaders[i] ? obj.options.colHeaders[i] : '';\n            }\n            if (! obj.options.columns[i].width) {\n                obj.options.columns[i].width = obj.options.colWidths[i] ? obj.options.colWidths[i] : obj.options.defaultColWidth;\n            }\n            if (! obj.options.columns[i].align) {\n                obj.options.columns[i].align = obj.options.colAlignments[i] ? obj.options.colAlignments[i] : 'center';\n            }\n\n            // Pre-load initial source for json autocomplete\n            if (obj.options.columns[i].type == 'autocomplete' || obj.options.columns[i].type == 'dropdown') {\n                // if remote content\n                if (obj.options.columns[i].url) {\n                    multiple.push(jSuites.ajax({\n                        url: obj.options.columns[i].url,\n                        index: i,\n                        method: 'GET',\n                        dataType: 'json',\n                        multiple: multiple,\n                        success: function(data) {\n                            var source = [];\n                            for (var i = 0; i < data.length; i++) {\n                                obj.options.columns[this.index].source.push(data[i]);\n                            }\n                        },\n                        complete: function() {\n                            obj.createTable();\n                        }\n                    }));\n                }\n            } else if (obj.options.columns[i].type == 'calendar') {\n                // Default format for date columns\n                if (! obj.options.columns[i].options.format) {\n                    obj.options.columns[i].options.format = 'DD/MM/YYYY';\n                }\n            }\n        }\n\n        // On complete\n        if (! multiple.length) {\n            obj.createTable();\n        }\n    }\n\n    obj.createTable = function() {\n        // Elements\n        obj.table = document.createElement('table');\n        obj.thead = document.createElement('thead');\n        obj.tbody = document.createElement('tbody');\n\n        // Create headers controllers\n        obj.headers = [];\n        obj.colgroup = [];\n\n        // Create table container\n        obj.content = document.createElement('div');\n        obj.content.classList.add('jexcel_content');\n\n        // Create toolbar object\n        obj.toolbar = document.createElement('div');\n        obj.toolbar.classList.add('jexcel_toolbar');\n\n        // Search\n        var searchContainer = document.createElement('div');\n        var searchText = document.createTextNode((obj.options.text.search) + ': ');\n        obj.searchInput = document.createElement('input');\n        obj.searchInput.classList.add('jexcel_search');\n        searchContainer.appendChild(searchText);\n        searchContainer.appendChild(obj.searchInput);\n        obj.searchInput.onfocus = function() {\n            obj.resetSelection();\n        }\n\n        // Pagination select option\n        var paginationUpdateContainer = document.createElement('div');\n\n        if (obj.options.pagination > 0 && obj.options.paginationOptions && obj.options.paginationOptions.length > 0) {\n            obj.paginationDropdown = document.createElement('select');\n            obj.paginationDropdown.classList.add('jexcel_pagination_dropdown');\n            obj.paginationDropdown.onchange = function() {\n                obj.options.pagination = parseInt(this.value);\n                obj.page(0);\n            }\n\n            for (var i = 0; i < obj.options.paginationOptions.length; i++) {\n                var temp = document.createElement('option');\n                temp.value = obj.options.paginationOptions[i];\n                temp.innerHTML = obj.options.paginationOptions[i];\n                obj.paginationDropdown.appendChild(temp);\n            }\n\n            paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.show));\n            paginationUpdateContainer.appendChild(obj.paginationDropdown);\n            paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.entries));\n        }\n\n        // Filter and pagination container\n        obj.filter = document.createElement('div');\n        obj.filter.classList.add('jexcel_filter');\n        obj.filter.appendChild(paginationUpdateContainer);\n        obj.filter.appendChild(searchContainer);\n\n        // Colsgroup\n        obj.colgroupContainer = document.createElement('colgroup');\n        var tempCol = document.createElement('col');\n        tempCol.setAttribute('width', '50');\n        obj.colgroupContainer.appendChild(tempCol);\n\n        // Nested\n        if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n            // Flexible way to handle nestedheaders\n            if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                    obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[j]));\n                }\n            } else {\n                obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));\n            }\n        }\n\n        // Row\n        obj.headerContainer = document.createElement('tr');\n        var tempCol = document.createElement('td');\n        tempCol.classList.add('jexcel_selectall');\n        obj.headerContainer.appendChild(tempCol);\n\n        for (var i = 0; i < obj.options.columns.length; i++) {\n            // Create header\n            obj.createCellHeader(i);\n            // Append cell to the container\n            obj.headerContainer.appendChild(obj.headers[i]);\n            obj.colgroupContainer.appendChild(obj.colgroup[i]);\n        }\n\n        obj.thead.appendChild(obj.headerContainer);\n\n        // Content table\n        obj.table = document.createElement('table');\n        obj.table.classList.add('jexcel');\n        obj.table.setAttribute('cellpadding', '0');\n        obj.table.setAttribute('cellspacing', '0');\n        obj.table.setAttribute('unselectable', 'yes');\n        obj.table.setAttribute('onselectstart', 'return false');\n        obj.table.appendChild(obj.colgroupContainer);\n        obj.table.appendChild(obj.thead);\n        obj.table.appendChild(obj.tbody);\n\n        // Spreadsheet corner\n        obj.corner = document.createElement('div');\n        obj.corner.className = 'jexcel_corner';\n        obj.corner.setAttribute('unselectable', 'on');\n        obj.corner.setAttribute('onselectstart', 'return false');\n\n        if (obj.options.selectionCopy == false) {\n            obj.corner.style.display = 'none';\n        }\n\n        // Textarea helper\n        obj.textarea = document.createElement('textarea');\n        obj.textarea.className = 'jexcel_textarea';\n        obj.textarea.id = 'jexcel_textarea';\n        obj.textarea.tabIndex = '-1';\r\n\n        // Contextmenu container\n        obj.contextMenu = document.createElement('div');\n        obj.contextMenu.className = 'jexcel_contextmenu';\n\n        // Create element\n        jSuites.contextmenu(obj.contextMenu, {\n            onclick:function() {\n                obj.contextMenu.contextmenu.close(false);\n            }\n        });\n\n        // Powered by jExcel\r\n        var ads = document.createElement('a');\r\n        ads.setAttribute('href', 'https://bossanova.uk/jexcel/');\r\n        obj.ads = document.createElement('div');\r\n        obj.ads.className = 'jexcel_about';\r\n        if (typeof(sessionStorage) !== \"undefined\" && ! sessionStorage.getItem('jexcel')) {\r\n            sessionStorage.setItem('jexcel', true);\r\n            var img = document.createElement('img');\r\n            img.src = '//bossanova.uk/jexcel/logo.png';\r\n            ads.appendChild(img);\r\n        }\r\n        var span = document.createElement('span');\r\n        span.innerHTML = 'Jexcel spreadsheet';\r\n        ads.appendChild(span);\r\n        obj.ads.appendChild(ads);\n\n        // Create table container TODO: frozen columns\n        var container = document.createElement('div');\n        container.classList.add('jexcel_table');\n\n        // Pagination\n        obj.pagination = document.createElement('div');\n        obj.pagination.classList.add('jexcel_pagination');\n        var paginationInfo = document.createElement('div');\n        var paginationPages = document.createElement('div');\n        obj.pagination.appendChild(paginationInfo);\n        obj.pagination.appendChild(paginationPages);\n\n        // Hide pagination if not in use\r\n        if (! obj.options.pagination) {\r\n            obj.pagination.style.display = 'none';\r\n        }\r\n\n        // Append containers to the table\n        if (obj.options.search == true) {\n            el.appendChild(obj.filter);\n        }\n\n        // Elements\n        obj.content.appendChild(obj.table);\n        obj.content.appendChild(obj.corner);\n        obj.content.appendChild(obj.textarea);\n\n        el.appendChild(obj.toolbar);\n        el.appendChild(obj.content);\n        el.appendChild(obj.pagination);\n        el.appendChild(obj.contextMenu);\n        el.appendChild(obj.ads);\n        el.classList.add('jexcel_container');\n\n        // Create toolbar\n        if (obj.options.toolbar && obj.options.toolbar.length) {\n            obj.createToolbar();\n        }\n\n        // Fullscreen\n        if (obj.options.fullscreen == true) {\n            el.classList.add('fullscreen');\n        } else {\n            // Overflow\n            if (obj.options.tableOverflow == true) {\n                if (obj.options.tableHeight) {\n                    obj.content.style['overflow-y'] = 'auto';\n                    obj.content.style.maxHeight = obj.options.tableHeight;\n                }\n                if (obj.options.tableWidth) {\n                    obj.content.style['overflow-x'] = 'auto';\n                    obj.content.style.width = obj.options.tableWidth;\n                }\n            }\n        }\n\n        // With toolbars\n        if (obj.options.tableOverflow != true && obj.options.toolbar) {\n            el.classList.add('with-toolbar');\n        }\n\n        // Actions\n        if (obj.options.columnDrag == true) {\n            obj.thead.classList.add('draggable');\n        }\n        if (obj.options.columnResize == true) {\n            obj.thead.classList.add('resizable');\n        }\n        if (obj.options.rowDrag == true) {\n            obj.tbody.classList.add('draggable');\n        }\n        if (obj.options.rowResize == true) {\n            obj.tbody.classList.add('resizable');\n        }\n\n        // Load data\n        obj.setData();\n\n        // Style\n        if (obj.options.style) {\n            obj.setStyle(obj.options.style, null, null, 1, 1);\n        }\n    }\n\r\n    /**\r\n     * Refresh the data\r\n     * \r\n     * @return void\r\n     */\r\n    obj.refresh = function() {\r\n        if (obj.options.url) {\r\n            // Loading\r\n            if (obj.options.loadingSpin == true) {\r\n                jSuites.loading.show();\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Data\r\n                    obj.options.data = (result.data) ? result.data : result;\r\n                    // Prepare table\r\n                    obj.setData();\r\n                    // Hide spin\r\n                    if (obj.options.loadingSpin == true) {\r\n                        jSuites.loading.hide();\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            obj.setData();\r\n        }\r\n    }\r\n\n    /**\n     * Set data\n     * \n     * @param array data In case no data is sent, default is reloaded\n     * @return void\n     */\n    obj.setData = function(data) {\n        // Update data\n        if (data) {\n            if (typeof(data) == 'string') {\n                data = JSON.parse(data);\n            }\n\n            obj.options.data = data;\n        }\n\n        // Data\n        if (! obj.options.data) {\n            obj.options.data = [];\n        }\n\n        // Prepare data\n        if (obj.options.data) {\n            var data = [];\n            for (var j = 0; j < obj.options.data.length; j++) {\n                var row = [];\n                for (var i = 0; i < obj.options.columns.length; i++) {\n                    row[i] = obj.options.data[j][obj.options.columns[i].name];\n                }\n                data.push(row);\n            }\n\n            obj.options.data = data;\n        }\n\n        // Adjust minimal dimensions\n        var j = 0;\n        var i = 0;\n        var size_i = obj.options.columns.length;\n        var size_j = obj.options.data.length;\n        var min_i = obj.options.minDimensions[0];\n        var min_j = obj.options.minDimensions[1];\n        var max_i = min_i > size_i ? min_i : size_i;\n        var max_j = min_j > size_j ? min_j : size_j;\n\n        for (j = 0; j < max_j; j++) {\n            for (i = 0; i < max_i; i++) {\n                if (obj.options.data[j] == undefined) {\n                    obj.options.data[j] = [];\n                }\n\n                if (obj.options.data[j][i] == undefined) {\n                    obj.options.data[j][i] = '';\n                }\n            }\n        }\n\n        // Reset containers\n        obj.rows = [];\n        obj.results = null;\n        obj.records = [];\n        obj.history = [];\n\n        // Reset internal controllers\n        obj.historyIndex = -1;\n\n        // Reset data\n        obj.tbody.innerHTML = '';\n\n        // Lazy loading\n        if (obj.options.lazyLoading == true) {\n            // Load only 100 records\n            var startNumber = 0\n            var finalNumber = obj.options.data.length < 100 ? obj.options.data.length : 100;\n\n            if (obj.options.pagination) {\n                obj.options.pagination = false;\n                console.error('JEXCEL: Pagination will be disable due the lazyLoading');\n            }\n        } else if (obj.options.pagination) {\n            // Pagination\n            if (! obj.pageNumber) {\n                obj.pageNumber = 0;\n            }\n            var quantityPerPage = obj.options.pagination;\n            startNumber = (obj.options.pagination * obj.pageNumber);\n            finalNumber = (obj.options.pagination * obj.pageNumber) + obj.options.pagination;\n\n            if (obj.options.data.length < finalNumber) {\n                finalNumber = obj.options.data.length;\n            }\n        } else {\n            var startNumber = 0;\n            var finalNumber = obj.options.data.length;\n        }\n\n        // Append nodes to the HTML\n        for (j = 0; j < obj.options.data.length; j++) {\n            // Create row\n            var tr = obj.createRow(j, obj.options.data[j]);\n            // Append line to the table\n            if (j >= startNumber && j < finalNumber) {\n                obj.tbody.appendChild(tr);\n            }\n        }\n\n        if (obj.options.lazyLoading == true) {\n            // Do not create pagination with lazyloading activated\n        } else if (obj.options.pagination) {\n            obj.updatePagination();\n        }\n\n        // Merge cells\n        if (obj.options.mergeCells) {\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                var num = obj.options.mergeCells[keys[i]];\n                obj.setMerge(keys[i], num[0], num[1], 1);\n            }\n        }\n\n        // Updata table with custom configurations if applicable\n        obj.updateTable();\n\n        // Onload\n        if (! obj.ignoreEvents) {\n            if (typeof(obj.options.onload) == 'function') {\n                obj.options.onload(el, obj);\n            }\n        }\n    }\n\n    /**\n     * Get the whole table data\n     * \n     * @param bool get highlighted cells only\n     * @return array data\n     */\n        obj.getData = function(highlighted, dataOnly) {\n        // Control vars\n        var dataset = [];\n        var px = 0;\n        var py = 0;\n\n        // Data type\r\n        var dataType = dataOnly == true || obj.options.copyCompatibility == false ? true : false;\r\n\n        // Column and row length\n        var x = obj.options.columns.length\n        var y = obj.options.data.length\n\n        // Go through the columns to get the data\n        for (var j = 0; j < y; j++) {\n            px = 0;\n            for (var i = 0; i < x; i++) {\n                // Cell selected or fullset\n                if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                    // Get value\n                    if (! dataset[py]) {\n                        dataset[py] = [];\n                    }\n                    if (! dataType) {\n                        dataset[py][px] = obj.records[j][i].innerHTML;\n                    } else {\n                        dataset[py][px] = obj.options.data[j][i];\n                    }\n                    px++;\n                }\n            }\n            if (px > 0) {\n                py++;\n            }\n       }\n\n       return dataset;\n    }\n\n    /**\n     * Get the whole table data\n     * \n     * @param integer row number\n     * @return string value\n     */\n    obj.getJson = function(highlighted) {\n        // Control vars\n        var data = [];\n\n        // Column and row length\n        var x = obj.options.columns.length\n        var y = obj.options.data.length\n\n        // Go through the columns to get the data\n        for (var j = 0; j < y; j++) {\n            var row = null;\n            for (var i = 0; i < x; i++) {\n                if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                    if (row == null) {\n                        row = {};\n                    }\n                    row[obj.options.columns[i].name] = obj.options.data[j][i];\n                }\n            }\n\n            if (row != null) {\n                data.push(row);\n            }\n       }\n\n       return data;\n    }\n\n    /**\n     * Get a row data by rowNumber\n     */\n    obj.getRowData = function(rowNumber) {\n        return obj.options.data[rowNumber];\n    }\n\n    /**\n     * Set a row data by rowNumber\n     */\n    obj.setRowData = function(rowNumber, data) {\n        for (var i = 0; i < obj.headers.length; i++) {\n            // Update cell\n            var columnName = jexcel.getColumnNameFromId([ i, rowNumber ]);\n            // Set value\n            if (data[i] != null) {\n                obj.setValue(columnName, data[i]);\n            }\n        }\n    }\n\n    /**\n     * Get a column data by columnNumber\n     */\n    obj.getColumnData = function(columnNumber) {\n        var dataset = [];\n        // Go through the rows to get the data\n        for (var j = 0; j < obj.options.data.length; j++) {\n            dataset.push(obj.options.data[j][columnNumber]);\n        }\n        return dataset;\n    }\n\n    /**\n     * Set a column data by colNumber\n     */\n    obj.setColumnData = function(colNumber, data) {\n        for (var j = 0; j < obj.rows.length; j++) {\n            // Update cell\n            var columnName = jexcel.getColumnNameFromId([ colNumber, j ]);\n            // Set value\n            if (data[j] != null) {\n                obj.setValue(columnName, data[j]);\n            }\n        }\n    }\n\n    /**\n     * Create row\n     */\n    obj.createRow = function(j, data) {\n        // Create container\n        if (! obj.records[j]) {\n            obj.records[j] = [];\n        }\n        // Default data\n        if (! data) {\n            var data = obj.options.data[j];\n        }\n        // New line of data to be append in the table\n        obj.rows[j] = document.createElement('tr');\n        obj.rows[j].setAttribute('data-y', j);\n        // Definitions\n        if (obj.options.rows[j]) {\n            if (obj.options.rows[j].height) {\n                obj.rows[j].style.height = obj.options.rows[j].height;\n            }\n        }\n        // Row number label\n        var td = document.createElement('td');\n        td.innerHTML = parseInt(j + 1);\n        td.setAttribute('data-y', j);\n        td.className = 'jexcel_row';\n        obj.rows[j].appendChild(td);\n\n        // Data columns\n        for (i = 0; i < obj.options.columns.length; i++) {\n            // New column of data to be append in the line\n            obj.records[j][i] = obj.createCell(i, j, data[i]);\n            // Add column to the row\n            obj.rows[j].appendChild(obj.records[j][i]);\n        }\n\n        // Add row to the table body\n        return obj.rows[j];\n    }\n\n    /**\n     * Create cell\n     */\n    obj.createCell = function(i, j, value) {\n        // Create cell and properties\n        var td = document.createElement('td');\n        td.setAttribute('data-x', i);\n        td.setAttribute('data-y', j);\n        // Hidden column\n        if (obj.options.columns[i].type == 'hidden') {\n            td.style.display = 'none';\n            td.innerHTML = value;\n        } else if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\n            // Create input\n            var element = document.createElement('input');\n            element.type = obj.options.columns[i].type;\n            element.name = 'c' + i;\n            element.checked = (value == 1 || value == true || value == 'true') ? true : false;\n            element.onclick = function() {\n                obj.setValue(td, this.checked);\n            }\n\n            if (obj.options.columns[i].readOnly == true) {\n                element.setAttribute('disabled', 'disabled');\n            }\n\n            // Append to the table\n            td.appendChild(element);\n            // Make sure the values are correct\n            obj.options.data[j][i] = element.checked;\n        } else if (obj.options.columns[i].type == 'calendar') {\n            // Try formatted date\n            var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[i].options.format);\n            // Create calendar cell\n            td.innerHTML = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[i].options.format);\n        } else if (obj.options.columns[i].type == 'dropdown' || obj.options.columns[i].type == 'autocomplete') {\n            // Create dropdown cell\n            td.classList.add('jexcel_dropdown');\n            td.innerHTML = obj.getDropDownValue(i, value);\n        } else if (obj.options.columns[i].type == 'color') {\n            if (obj.options.columns[i].render == 'square') {\n                var color = document.createElement('div');\n                color.className = 'color';\n                color.style.backgroundColor = value;\n                td.appendChild(color);\n            } else {\n                td.style.color = value;\n                td.innerHTML = value;\n            }\n        } else if (obj.options.columns[i].type == 'image') {\n            if (value && value.substr(0, 10) == 'data:image') {\n                var img = document.createElement('img');\n                img.src = value;\n                td.appendChild(img);\n            }\n        } else {\n            if ((''+value).substr(0,1) == '=' && obj.options.parseFormulas == true) {\n                value = obj.executeFormula(value, i, j)\n            }\n            if (obj.options.columns[i].mask) {\n                var decimal = obj.options.columns[i].decimal || '.';\n                value = '' + jSuites.mask.run(value, obj.options.columns[i].mask, decimal);\n            }\n\n            td.innerHTML = value;\n        }\n\n        // Readonly\n        if (obj.options.columns[i].readOnly == true) {\n            td.className = 'readonly';\n        }\n\n        // Text align\n        var colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\n        td.style.textAlign = colAlign;\n\n        // Wrap option\n        if (obj.options.columns[i].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[i].wordWrap == true || td.innerHTML.length > 200)) {\n            td.style.whiteSpace = 'pre-wrap';\n        }\n\n        // Overflow\n        if (i > 0) {\n            if (value || td.innerHTML) {\n                obj.records[j][i-1].style.overflow = 'hidden';\n            } else {\n                if (i == obj.options.columns.length - 1) {\n                    td.style.overflow = 'hidden';\n                }\n            }\n        }\n\n        return td;\n    }\n\n    obj.createCellHeader = function(colNumber) {\n        // Create col global control\n        var colWidth = obj.options.columns[colNumber].width ? obj.options.columns[colNumber].width : obj.options.defaultColWidth;\n        var colAlign = obj.options.columns[colNumber].align ? obj.options.columns[colNumber].align : obj.options.defaultColAlign;\n\n        // Create header cell\n        obj.headers[colNumber] = document.createElement('td');\n        obj.headers[colNumber].innerHTML = obj.options.columns[colNumber].title ? obj.options.columns[colNumber].title : jexcel.getColumnName(colNumber);\n        obj.headers[colNumber].setAttribute('data-x', colNumber);\n        obj.headers[colNumber].style.textAlign = colAlign;\n        if (obj.options.columns[colNumber].title) {\n            obj.headers[colNumber].setAttribute('title', obj.options.columns[colNumber].title);\n        }\n\n        // Width control\n        obj.colgroup[colNumber] = document.createElement('col');\n        obj.colgroup[colNumber].setAttribute('width', colWidth);\n\n        // Hidden column\n        if (obj.options.columns[colNumber].type == 'hidden') {\n            obj.headers[colNumber].style.display = 'none';\n            obj.colgroup[colNumber].style.display = 'none';\n        }\n    }\n\n    obj.createNestedHeader = function(nestedInformation) {\n        var tr = document.createElement('tr');\n        tr.classList.add('jexcel_nested');\n        var td = document.createElement('td');\n        tr.appendChild(td);\n\n        var headerIndex = 0;\n        for (var i = 0; i < nestedInformation.length; i++) {\n            // Default values\n            if (! nestedInformation[i].colspan) {\n                nestedInformation[i].colspan = 1;\n            }\n            if (! nestedInformation[i].align) {\n                nestedInformation[i].align = 'center';\n            }\n            if (! nestedInformation[i].title) {\n                nestedInformation[i].title = '';\n            }\n\n            // Number of columns\n            var numberOfColumns = nestedInformation[i].colspan;\n\n            // Classes container\n            var column = [];\n            // Header classes for this cell\n            for (var x = 0; x < numberOfColumns; x++) {\n                if (obj.options.columns[headerIndex] && obj.options.columns[headerIndex].type == 'hidden') {\n                    numberOfColumns++;\n                }\n                column.push(headerIndex);\n                headerIndex++;\n            }\n\n            // Created the nested cell\n            var td = document.createElement('td');\n            td.setAttribute('data-column', column.join(','));\n            td.setAttribute('colspan', nestedInformation[i].colspan);\n            td.setAttribute('align', nestedInformation[i].align);\n            td.innerHTML = nestedInformation[i].title;\n            tr.appendChild(td);\n        }\n\n        return tr;\n    }\n\n    /**\n     * Create toolbar\n     */\n    obj.createToolbar = function(toolbar) {\n        if (toolbar) {\n            obj.options.toolbar = toolbar;\n        } else {\n            var toolbar = obj.options.toolbar;\n        }\n\n        for (var i = 0; i < toolbar.length; i++) {\n            if (toolbar[i].type == 'i') {\n                var toolbarItem = document.createElement('i');\n                toolbarItem.classList.add('jexcel_toolbar_item');\n                toolbarItem.classList.add('material-icons');\n                toolbarItem.setAttribute('data-k', toolbar[i].k);\n                toolbarItem.setAttribute('data-v', toolbar[i].v);\n                // Tooltip\n                if (toolbar[i].tooltip) {\n                    toolbarItem.setAttribute('title', toolbar[i].tooltip);\n                }\n                // Handle click\n                if (toolbar[i].onclick && typeof(toolbar[i].onclick)) {\n                    toolbarItem.onclick = toolbar[i].onclick;\n                } else {\n                    toolbarItem.onclick = function() {\n                        var k = this.getAttribute('data-k');\n                        var v = this.getAttribute('data-v');\n                        obj.setStyle(obj.highlighted, k, v);\n                    }\n                }\n                // Append element\n                toolbarItem.innerHTML = toolbar[i].content;\n                obj.toolbar.appendChild(toolbarItem);\n            } else if (toolbar[i].type == 'select') {\n               var toolbarItem = document.createElement('select');\n               toolbarItem.classList.add('jexcel_toolbar_item');\n               toolbarItem.setAttribute('data-k', toolbar[i].k);\n               // Tooltip\n               if (toolbar[i].tooltip) {\n                   toolbarItem.setAttribute('title', toolbar[i].tooltip);\n               }\n               // Handle onchange\n               if (toolbar[i].onchange && typeof(toolbar[i].onchange)) {\n                   toolbarItem.onchange = toolbar[i].onchange;\n               } else {\n                   toolbarItem.onchange = function() {\n                       var k = this.getAttribute('data-k');\n                       obj.setStyle(obj.highlighted, k, this.value);\n                   }\n               }\n               // Add options to the dropdown\n               for(var j = 0; j < toolbar[i].v.length; j++) {\n                    var toolbarDropdownOption = document.createElement('option');\n                    toolbarDropdownOption.value = toolbar[i].v[j];\n                    toolbarDropdownOption.innerHTML = toolbar[i].v[j];\n                    toolbarItem.appendChild(toolbarDropdownOption);\n               }\n               obj.toolbar.appendChild(toolbarItem);\n            } else if (toolbar[i].type == 'color') {\n                 var toolbarItem = document.createElement('i');\n                 toolbarItem.classList.add('jexcel_toolbar_item');\n                 toolbarItem.classList.add('material-icons');\n                 toolbarItem.setAttribute('data-k', toolbar[i].k);\n                 toolbarItem.setAttribute('data-v', '');\n                 // Tooltip\n                 if (toolbar[i].tooltip) {\n                     toolbarItem.setAttribute('title', toolbar[i].tooltip);\n                 }\n                 obj.toolbar.appendChild(toolbarItem);\n                 toolbarItem.onclick = function() {\n                     this.color.open();\n                 }\n                 toolbarItem.innerHTML = toolbar[i].content;\n                 jSuites.color(toolbarItem, {\n                     onchange:function(o, v) {\n                         var k = o.getAttribute('data-k');\n                         obj.setStyle(obj.highlighted, k, v);\n                     }\n                 });\n            }\n        }\n    }\n\n    /**\n     * Merge cells\n     * @param cellName\n     * @param colspan\n     * @param rowspan\n     * @param ignoreHistoryAndEvents\n     */\n    obj.setMerge = function(cellName, colspan, rowspan, ignoreHistoryAndEvents) {\n        var test = false;\n\n        if (! cellName) {\n            if (! obj.highlighted.length) {\n                alert(obj.options.text.noCellsSelected);\n                return null;\n            } else {\n                var x1 = parseInt(obj.highlighted[0].getAttribute('data-x'));\n                var y1 = parseInt(obj.highlighted[0].getAttribute('data-y'));\n                var x2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-x'));\n                var y2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-y'));\n                var cellName = jexcel.getColumnNameFromId([ x1, y1 ]);\n                var colspan = (x2 - x1) + 1;\n                var rowspan = (y2 - y1) + 1;\n            }\n        }\n\n        var cell = jexcel.getIdFromColumnName(cellName, true);\n\n        if (obj.options.mergeCells[cellName]) {\n            if (obj.records[cell[1]][cell[0]].getAttribute('data-merged')) {\n                test = obj.options.text.cellAlreadyMerged;\n            }\n        } else if ((! colspan || colspan < 2) && (! rowspan || rowspan < 2)) {\n            test = obj.options.text.invalidMergeProperties;\n        } else {\n            var cells = [];\n            for (var j = cell[1]; j < cell[1] + rowspan; j++) {\n                for (var i = cell[0]; i < cell[0] + colspan; i++) {\n                    var columnName = jexcel.getColumnNameFromId([i, j]);\n                    if (obj.records[j][i].getAttribute('data-merged')) {\n                        test = obj.options.text.thereIsAConflictWithAnotherMergedCell;\n                    }\n                }\n            }\n        }\n\n        if (test) {\n            alert(test);\n        } else {\n            // Add property\n            if (colspan > 1) {\n                obj.records[cell[1]][cell[0]].setAttribute('colspan', colspan);\n            } else {\n                colspan = 1;\n            }\n            if (rowspan > 1) {\n                obj.records[cell[1]][cell[0]].setAttribute('rowspan', rowspan);\n            } else {\n                rowspan = 1;\n            }\n            // Keep links to the existing nodes\n            obj.options.mergeCells[cellName] = [ colspan, rowspan, [] ];\n            // Mark cell as merged\n            obj.records[cell[1]][cell[0]].setAttribute('data-merged', 'true');\n            // Overflow\n            obj.records[cell[1]][cell[0]].style.overflow = 'hidden';\n            // History data\n            var data = [];\n            // Adjust the nodes\n            for (var y = cell[1]; y < cell[1] + rowspan; y++) {\n                for (var x = cell[0]; x < cell[0] + colspan; x++) {\n                    if (! (cell[0] == x && cell[1] == y)) {\n                        data.push(obj.options.data[y][x]);\n                        obj.updateCell(x, y, '', true);\n                        obj.options.mergeCells[cellName][2].push(obj.records[y][x]);\n                        obj.records[y][x].style.display = 'none';\n                        obj.records[y][x] = obj.records[cell[1]][cell[0]];\n                    }\n                }\n            }\n            // In the initialization is not necessary keep the history\n            obj.updateSelection(obj.records[cell[1]][cell[0]]);\n\n            if (! ignoreHistoryAndEvents) {\n                obj.setHistory({\n                    action:'setMerge',\n                    column:cellName,\n                    colspan:colspan,\n                    rowspan:rowspan,\n                    data:data,\n                });\n\n                if (typeof(obj.options.onmerge) == 'function') {\n                    obj.options.onmerge(el, cellName, colspan, rowspan);\n                }\n            }\n        }\n    }\n\n    /**\n     * Merge cells\n     * @param cellName\n     * @param colspan\n     * @param rowspan\n     * @param ignoreHistoryAndEvents\n     */\n    obj.getMerge = function(cellName) {\n        var data = {};\n        if (cellName) {\n            if (obj.options.mergeCells[cellName]) {\n                data = [ obj.options.mergeCells[cellName][0], obj.options.mergeCells[cellName][1] ];\n            } else {\n                data = null;\n            }\n        } else {\n            if (obj.options.mergeCells) {\n                var mergedCells = obj.options.mergeCells;\n                var keys = Object.keys(obj.options.mergeCells);\n                for (var i = 0; i < keys.length; i++) {\n                    data[keys[i]] = [ obj.options.mergeCells[keys[i]][0], obj.options.mergeCells[keys[i]][1] ];\n                }\n            }\n        }\n\n        return data;\n    }\n\n    /**\n     * Remove merge by cellname\n     * @param cellName\n     */\n    obj.removeMerge = function(cellName, data, keepOptions) {\n        if (obj.options.mergeCells[cellName]) {\n            var cell = jexcel.getIdFromColumnName(cellName, true);\n            obj.records[cell[1]][cell[0]].removeAttribute('colspan');\n            obj.records[cell[1]][cell[0]].removeAttribute('rowspan');\n            obj.records[cell[1]][cell[0]].removeAttribute('data-merged');\n            var info = obj.options.mergeCells[cellName];\n\n            var index = 0;\n            for (var j = 0; j < info[1]; j++) {\n                for (var i = 0; i < info[0]; i++) {\n                    if (j > 0 || i > 0) {\n                        obj.records[cell[1]+j][cell[0]+i] = info[2][index];\n                        obj.records[cell[1]+j][cell[0]+i].style.display = '';\n                        // Recover data\n                        if (data && data[index]) {\n                            obj.updateCell(cell[0]+i, cell[1]+j, data[index]);\n                        }\n                        index++;\n                    }\n                }\n            }\n\n            // Update selection\n            obj.updateSelection(obj.records[cell[1]][cell[0]], obj.records[cell[1]+j-1][cell[0]+i-1]);\n\n            if (! keepOptions) {\n                delete(obj.options.mergeCells[cellName]);\n            }\n        }\n    }\n\n    /**\n     * Remove all merged cells\n     */\n    obj.destroyMerged = function(keepOptions) {\n        // Remove any merged cells\n        if (obj.options.mergeCells) {\n            var mergedCells = obj.options.mergeCells;\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                obj.removeMerge(keys[i], null, keepOptions);\n            }\n        }\n    }\n\n    /**\n     * Is column merged\n     */\n    obj.isColMerged = function(x, insertBefore) {\n        var cols = [];\n        // Remove any merged cells\n        if (obj.options.mergeCells) {\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                var info = jexcel.getIdFromColumnName(keys[i], true);\n                var colspan = obj.options.mergeCells[keys[i]][0];\n                var x1 = info[0];\n                var x2 = info[0] + (colspan > 1 ? colspan - 1 : 0);\n\n                if (insertBefore == null) {\n                    if ((x1 <= x && x2 >= x)) {\n                        cols.push(keys[i]);\n                    }\n                } else {\n                    if (insertBefore) {\n                        if ((x1 < x && x2 >= x)) {\n                            cols.push(keys[i]);\n                        }\n                    } else {\n                        if ((x1 <= x && x2 > x)) {\n                            cols.push(keys[i]);\n                        }\n                    }\n                }\n            }\n        }\n\n        return cols;\n    }\n\n    /**\n     * Is rows merged\n     */\n    obj.isRowMerged = function(y, insertBefore) {\n        var rows = [];\n        // Remove any merged cells\n        if (obj.options.mergeCells) {\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                var info = jexcel.getIdFromColumnName(keys[i], true);\n                var rowspan = obj.options.mergeCells[keys[i]][1];\n                var y1 = info[1];\n                var y2 = info[1] + (rowspan > 1 ? rowspan - 1 : 0);\n\n                if (insertBefore == null) {\n                    if ((y1 <= y && y2 >= y)) {\n                        rows.push(keys[i]);\n                    }\n                } else {\n                    if (insertBefore) {\n                        if ((y1 < y && y2 >= y)) {\n                            rows.push(keys[i]);\n                        }\n                    } else {\n                        if ((y1 <= y && y2 > y)) {\n                            rows.push(keys[i]);\n                        }\n                    }\n                }\n            }\n        }\n\n        return rows;\n    }\n\n    /**\n     * Open the editor\n     * \n     * @param object cell\n     * @return void\n     */\n    obj.openEditor = function(cell, empty, e) {\n        // Get cell position\n        var y = cell.getAttribute('data-y');\n        var x = cell.getAttribute('data-x');\n\n        // On edition start\n        if (! obj.ignoreEvents) {\n            if (typeof(obj.options.oneditionstart) == 'function') {\n                obj.options.oneditionstart(el, cell, x, y);\n            }\n        }\n\n        // Overflow\n        if (x > 0) {\n            obj.records[y][x-1].style.overflow = 'hidden';\n        }\n\n        // Create editor\n        var createEditor = function(type) {\n            // Cell information\n            var info = cell.getBoundingClientRect();\n\n            // Create dropdown\n            var editor = document.createElement(type);\n            editor.style.width = (info.width) + 'px';\n            editor.style.height = (info.height - 2) + 'px';\n            editor.style.minHeight = (info.height - 2) + 'px';\n\n            // Edit cell\n            cell.classList.add('editor');\n            cell.innerHTML = '';\n            cell.appendChild(editor);\n\n            return editor;\n        }\n\n        // Readonly\n        if (cell.classList.contains('readonly') == true) {\n            // Do nothing\n        } else {\n            // Holder\n            obj.edition = [ obj.records[y][x], obj.records[y][x].innerHTML, x, y ];\n\n            // If there is a custom editor for it\n            if (obj.options.columns[x].editor) {\n                // Custom editors\n                obj.options.columns[x].editor.openEditor(cell, el, empty, e);\n            } else {\n                // Native functions\n                if (obj.options.columns[x].type == 'hidden') {\n                    // Do nothing\n                } else if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                    // Get value\n                    var value = cell.children[0].checked ? false : true;\n                    // Toogle value\n                    obj.setValue(cell, value);\n                    // Do not keep edition open\n                    obj.edition = null;\n                } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    // Get current value\n                    var value = obj.options.data[y][x];\n\n                    // Create dropdown\n                    if (typeof(obj.options.columns[x].filter) == 'function') {\n                        var source = obj.options.columns[x].filter(el, cell, x, y, obj.options.columns[x].source);\n                    } else {\n                        var source = obj.options.columns[x].source;\n                    }\n\n                    // Create editor\n                    var editor = createEditor('div');\n                    var options = {\n                        data: source,\n                        multiple: obj.options.columns[x].multiple ? true : false,\n                        autocomplete: obj.options.columns[x].autocomplete || obj.options.columns[x].type == 'autocomplete' ? true : false,\n                        opened:true,\n                        value: obj.options.columns[x].multiple ? value.split(';') : value,\n                        width:'100%',\n                        height:editor.style.minHeight,\n                        position: (obj.options.tableOverflow == true || obj.options.fullscreen == true) ? true : false,\n                        onclose:function() {\n                            obj.closeEditor(cell, true);\n                        }\n                    };\n                    if (obj.options.columns[x].options && obj.options.columns[x].options.type) {\n                        options.type = obj.options.columns[x].options.type;\n                    }\n                    jSuites.dropdown(editor, options);\n                } else if (obj.options.columns[x].type == 'calendar' || obj.options.columns[x].type == 'color') {\n                    // Value\n                    var value = obj.options.data[y][x];\n                    // Create editor\n                    var editor = createEditor('input');\n                    editor.value = value;\n\n                    if (obj.options.tableOverflow == true || obj.options.fullscreen == true) {\n                        obj.options.columns[x].options.position = true;\n                    }\n                    obj.options.columns[x].options.value = obj.options.data[y][x];\n                    obj.options.columns[x].options.opened = true;\n                    obj.options.columns[x].options.onclose = function(el, value) {\n                        obj.closeEditor(cell, true);\n                    }\n                    // Current value\n                    if (obj.options.columns[x].type == 'color') {\n                        jSuites.color(editor, obj.options.columns[x].options);\n                    } else {\n                        var calendar = jSuites.calendar(editor, obj.options.columns[x].options);\n                        calendar.setValue(value);\n                    }\n                    // Focus on editor\n                    editor.focus();\n                } else if (obj.options.columns[x].type == 'image') {\n                    // Value\n                    var img = cell.children[0];\n                    // Create editor\n                    var editor = createEditor('div');\n                    editor.style.position = 'relative';\n                    var div = document.createElement('div');\n                    div.classList.add('jclose');\n                    if (img && img.src) {\n                        div.appendChild(img);\n                    }\n                    editor.appendChild(div);\n                    jSuites.image(div, obj.options.imageOptions);\n                    const rect = cell.getBoundingClientRect();\n                    const rectContent = div.getBoundingClientRect();\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\n                        div.style.top = (rect.top - (rectContent.height + 2)) + 'px';\n                    } else {\n                        div.style.top = (rect.top) + 'px';\n                    }\n                } else {\n                    // Value\n                    var value = empty == true ? '' : obj.options.data[y][x];\n\n                    // Basic editor\n                    if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true)) {\n                        var editor = createEditor('textarea');\n                    } else {\n                        var editor = createEditor('input');\n                        // Mask\n                        if (obj.options.columns[x].mask) {\n                            editor.setAttribute('data-mask', obj.options.columns[x].mask);\n                        }\n                    }\n\n                    editor.value = value;\n                    editor.onblur = function() {\n                        obj.closeEditor(cell, true);\n                    };\n                    editor.focus();\n                }\n            }\n        }\n    }\n\n    /**\n     * Close the editor and save the information\n     * \n     * @param object cell\n     * @param boolean save\n     * @return void\n     */\n    obj.closeEditor = function(cell, save) {\n        var x = parseInt(cell.getAttribute('data-x'));\n        var y = parseInt(cell.getAttribute('data-y'));\n\n        // Get cell properties\n        if (save == true) {\n            // If custom editor\n            if (obj.options.columns[x].editor) {\n                // Custom editor\n                var value = obj.options.columns[x].editor.closeEditor(cell, save);\n            } else {\n                // Native functions\n                if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio' || obj.options.columns[x].type == 'hidden') {\n                    // Do nothing\n                } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    var value = cell.children[0].dropdown.close(true);\n                } else if (obj.options.columns[x].type == 'calendar') {\n                    var value = cell.children[0].calendar.close(true);\n                } else if (obj.options.columns[x].type == 'color') {\n                    var value = cell.children[1].color.close(true);\n                } else if (obj.options.columns[x].type == 'image') {\n                    var img = cell.children[0].children[0].children[0];\n                    var value = img && img.tagName == 'IMG' ? img.src : '';\n                } else if (obj.options.columns[x].type == 'numeric') {\n                    var value = cell.children[0].value;\n                    if (value.substr(0,1) != '=') {\n                        if (value == '') {\n                            value = obj.options.columns[x].allowEmpty ? '' : 0;\n                        }\n                    }\n                    cell.children[0].onblur = null;\n                } else {\n                    var value = cell.children[0].value;\n                    cell.children[0].onblur = null;\n                }\n            }\n\n            // Ignore changes if the value is the same\n            if (obj.options.data[y][x] == value) {\n                cell.innerHTML = obj.edition[1];\n            } else {\n                obj.setValue(cell, value);\n            }\n        } else {\n            if (obj.options.columns[x].editor) {\n                // Custom editor\n                obj.options.columns[x].editor.closeEditor(cell, save);\n            } else {\n                if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    cell.children[0].dropdown.close(true);\n                } else if (obj.options.columns[x].type == 'calendar') {\n                    cell.children[0].calendar.close(true);\n                } else if (obj.options.columns[x].type == 'color') {\n                    cell.children[1].color.close(true);\n                } else {\n                    cell.children[0].onblur = null;\n                }\n            }\n\n            // Restore value\n            cell.innerHTML = obj.edition && obj.edition[1] ? obj.edition[1] : '';\n        }\n\n        // On edition end\n        if (! obj.ignoreEvents) {\n            if (typeof(obj.options.oneditionend) == 'function') {\n                obj.options.oneditionend(el, cell, x, y, value, save);\n            }\n        }\n\n        // Remove editor class\n        cell.classList.remove('editor');\n\n        // Finish edition\n        obj.edition = null;\n    }\n\n    /**\n     * Get the cell object\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getCell = function(cell) {\n        // Convert in case name is excel liked ex. A10, BB92\n        cell = jexcel.getIdFromColumnName(cell, true);\n        var x = cell[0];\n        var y = cell[1];\n\n        return obj.records[y][x];\n    }\n\n    /**\n     * Get the cell object from coords\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getCellFromCoords = function(x, y) {\n        return obj.records[y][x];\n    }\n\n    /**\n     * Get label\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getLabel = function(cell) {\n        // Convert in case name is excel liked ex. A10, BB92\n        cell = jexcel.getIdFromColumnName(cell, true);\n        var x = cell[0];\n        var y = cell[1];\n\n        return obj.records[y][x].innerHTML;\n    }\n\n    /**\n     * Get labelfrom coords\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getLabelFromCoords = function(x, y) {\n        return obj.records[y][x].innerHTML;\n    }\n\n    /**\n     * Get the value from a cell\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getValue = function(cell, processedValue) {\n        if (typeof(cell) == 'object') {\n            var x = cell.getAttribute('data-x');\n            var y = cell.getAttribute('data-y');\n        } else {\n            cell = jexcel.getIdFromColumnName(cell, true);\n            var x = cell[0];\n            var y = cell[1];\n        }\n\n        var value = null;\n\n        if (x != null && y != null) {\n            if (obj.records[y] && obj.records[y][x] && (processedValue || obj.options.copyCompatibility == true)) {\n                value = obj.records[y][x].innerHTML;\n            } else {\n                if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n                    value = obj.options.data[y][x];\n                }\n            }\n        }\n\n        return value;\n    }\n\n    /**\n     * Get the value from a coords\n     * \n     * @param int x\n     * @param int y\n     * @return string value\n     */\n    obj.getValueFromCoords = function(x, y, processedValue) {\n        var value = null;\n\n        if (x != null && y != null) {\n            if ((obj.records[y] && obj.records[y][x]) && processedValue || obj.options.copyCompatibility == true) {\n                value = obj.records[y][x].innerHTML;\n            } else {\n                if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n                    value = obj.options.data[y][x];\n                }\n            }\n        }\n\n        return value;\n    }\n\n    /**\n     * Set a cell value\n     * \n     * @param mixed cell destination cell\n     * @param string value value\n     * @return void\n     */\n    obj.setValue = function(cell, value, force) {\n        var records = [];\n\n        if (typeof(cell) == 'string') {\n            var columnId = jexcel.getIdFromColumnName(cell, true);\n            var x = columnId[0];\n            var y = columnId[1];\n\n            // Update cell\n            records.push(obj.updateCell(x, y, value, force));\n\n            // Update all formulas in the chain\n            obj.updateFormulaChain(x, y, records);\n        } else {\n            var x = null;\n            var y = null;\n            if (cell && cell.getAttribute) {\n                var x = cell.getAttribute('data-x');\n                var y = cell.getAttribute('data-y');\n            }\n\n            // Update cell\n            if (x != null && y != null) {\n                records.push(obj.updateCell(x, y, value, force));\n\n                // Update all formulas in the chain\n                obj.updateFormulaChain(x, y, records);\n            } else {\n                var keys = Object.keys(cell);\n                if (keys.length > 0) {\n                    for (var i = 0; i < keys.length; i++) {\n                        if (typeof(cell[i]) == 'string') {\n                            var columnId = jexcel.getIdFromColumnName(cell[i], true);\n                            var x = columnId[0];\n                            var y = columnId[1];\n                        } else {\n                            var x = cell[i].getAttribute('data-x');\n                            var y = cell[i].getAttribute('data-y');\n                        }\n\n                         // Update cell\n                        if (x != null && y != null) {\n                            records.push(obj.updateCell(x, y, value, force));\n\n                            // Update all formulas in the chain\n                            obj.updateFormulaChain(x, y, records);\n                        }\n                    }\n                }\n            }\n        }\n\n        // Update history\n        obj.setHistory({\n            action:'setValue',\n            records:records,\n            selection:obj.selectedCell,\n        });\n\n        // Update table with custom configurations if applicable\n        obj.updateTable();\n\n        // On after changes\n        obj.onafterchanges(el, records);\n    }\n\n    /**\n     * Set a cell value based on coordinates\n     * \n     * @param int x destination cell\n     * @param int y destination cell\n     * @param string value\n     * @return void\n     */\n    obj.setValueFromCoords = function(x, y, value, force) {\n        var records = [];\n        records.push(obj.updateCell(x, y, value, force));\n\n        // Update all formulas in the chain\n        obj.updateFormulaChain(x, y, records);\n\n        // Update history\n        obj.setHistory({\n            action:'setValue',\n            records:records,\n            selection:obj.selectedCell,\n        });\n\n        // Update table with custom configurations if applicable\n        obj.updateTable();\n\n        // On after changes\n        obj.onafterchanges(el, records);\n    }\n\n    /**\n     * Toogle\n     */\n    obj.setCheckRadioValue = function() {\n        var records = [];\n        var keys = Object.keys(obj.highlighted);\n        for (var i = 0; i < keys.length; i++) {\n            var x = obj.highlighted[i].getAttribute('data-x');\n            var y = obj.highlighted[i].getAttribute('data-y');\n\n            if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                // Update cell\n                records.push(obj.updateCell(x, y, ! obj.options.data[y][x]));\n            }\n        }\n\n        if (records.length) {\n            // Update history\n            obj.setHistory({\n                action:'setValue',\n                records:records,\n                selection:obj.selectedCell,\n            });\n\n            // On after changes\n            obj.onafterchanges(el, records);\n        }\n    }\n\n    /**\n     * Update cell content\n     * \n     * @param object cell\n     * @return void\n     */\n    obj.updateCell = function(x, y, value, force) {\n        // Changing value depending on the column type\n        if (obj.records[y][x].classList.contains('readonly') == true && ! force) {\n            // Do nothing\r\n            var record = {\r\n                x: x,\r\n                y: y,\r\n                col: x,\r\n                row: y\r\n            }\n        } else {\n            // On change\n            if (! obj.ignoreEvents) {\n                if (typeof(obj.options.onbeforechange) == 'function') {\n                    // Overwrite a value\n                    var val = obj.options.onbeforechange(el, obj.records[y][x], x, y, value);\n\n                    // If you return something this will overwrite the value\n                    if (val != undefined) {\n                        value = val;\n                    }\n                }\n            }\n\n            // History format\n            var record = {\n                x: x,\r\n                y: y,\n                col: x,\n                row: y,\n                newValue: value,\n                oldValue: obj.options.data[y][x],\n            }\n\n            if (obj.options.columns[x].editor) {\n                // Update data and cell\n                obj.options.data[y][x] = value;\n                obj.options.columns[x].editor.setValue(obj.records[y][x], value, force);\n            } else {\n                // Native functions\n                if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                    // Unchecked all options\n                    if (obj.options.columns[x].type == 'radio') {\n                        for (var j = 0; j < obj.options.data.length; j++) {\n                            obj.options.data[j][x] = false;\n                        }\n                    }\n\n                    // Update data and cell\n                    obj.records[y][x].children[0].checked = (value == 1 || value == true || value == 'true' || value == 'TRUE') ? true : false;\n                    obj.options.data[y][x] = obj.records[y][x].children[0].checked;\n                } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                    obj.records[y][x].innerHTML = obj.getDropDownValue(x, value);\n                } else if (obj.options.columns[x].type == 'calendar') {\n                    // Update calendar\n                    var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[x].options.format);\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                    obj.records[y][x].innerHTML = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[x].options.format);\n                } else if (obj.options.columns[x].type == 'color') {\n                    // Update color\n                    obj.options.data[y][x] = value;\n                    // Render\n                    if (obj.options.columns[x].render == 'square') {\n                        var color = document.createElement('div');\n                        color.className = 'color';\n                        color.style.backgroundColor = value;\n                        obj.records[y][x].innerHTML = '';\n                        obj.records[y][x].appendChild(color);\n                    } else {\n                    obj.records[y][x].style.color = value;\n                        obj.records[y][x].innerHTML = value;\n                    }\n                } else if (obj.options.columns[x].type == 'image') {\n                    value = ''+value;\n                    obj.options.data[y][x] = value;\n                    obj.records[y][x].innerHTML = '';\n                    if (value && value.substr(0, 10) == 'data:image') {\n                        var img = document.createElement('img');\n                        img.src = value;\n                        obj.records[y][x].appendChild(img);\n                    }\n                } else {\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                    // Label\n                    if (('' + value).substr(0,1) == '='  && obj.options.parseFormulas == true) {\n                        value = obj.executeFormula(value, x, y);\n                    }\n                    if (obj.options.columns[x].mask) {\n                        var decimal = obj.options.columns[x].decimal || '.';\n                        value = '' + jSuites.mask.run(value, obj.options.columns[x].mask, decimal);\n                    }\n                    obj.records[y][x].innerHTML = value;\n\n                    // Handle big text inside a cell\n                    if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true || obj.records[y][x].innerHTML.length > 200)) {\n                        obj.records[y][x].style.whiteSpace = 'pre-wrap';\n                    } else {\n                        obj.records[y][x].style.whiteSpace = '';\n                    }\n                }\n            }\n\n            // Overflow\n            if (x > 0) {\n                if (value) {\n                    obj.records[y][x-1].style.overflow = 'hidden';\n                } else {\n                    obj.records[y][x-1].style.overflow = '';\n                }\n            }\n\n            // On change\n            if (! obj.ignoreEvents) {\n                if (typeof(obj.options.onchange) == 'function') {\n                    obj.options.onchange(el, (obj.records[y] && obj.records[y][x] ? obj.records[y][x] : null), x, y, value, record.oldValue);\n                }\n            }\n        }\n\n        return record;\n    }\n\n    /**\n     * Helper function to copy data using the corner icon\n     */\n    obj.copyData = function(o, d) {\n        // Get data from all selected cells\n        var data = obj.getData(true, true);\n\n        // Selected cells\r\n        var h = obj.selectedContainer;\n\n        // Cells\n        var x1 = parseInt(o.getAttribute('data-x'));\n        var y1 = parseInt(o.getAttribute('data-y'));\n        var x2 = parseInt(d.getAttribute('data-x'));\n        var y2 = parseInt(d.getAttribute('data-y'));\n\n        // Records\n        var records = [];\n        var breakControl = false;\n\n        if (h[0] == x1) {\r\n            // Vertical copy\r\n            if (y1 < h[1]) {\r\n                var rowNumber = y1 - h[1];\r\n            } else {\r\n                var rowNumber = 1;\r\n            }\r\n            var colNumber = 0;\r\n        } else {\r\n            if (x1 < h[0]) {\r\n                var colNumber = x1 - h[0];\r\n            } else {\r\n                var colNumber = 1;\r\n            }\r\n            var rowNumber = 0;\r\n        }\r\n\n        // Copy data procedure\n        var posx = 0;\n        var posy = 0;\n\n        for (var j = y1; j <= y2; j++) {\n            // Skip hidden rows\n            if (obj.rows[j] && obj.rows[j].style.display == 'none') {\n                continue;\n            }\n\n            // Controls\n            if (data[posy] == undefined) {\n                posy = 0;\n            }\n            posx = 0;\n\n            // Data columns\n            if (h[0] != x1) {\r\n                if (x1 < h[0]) {\r\n                    var colNumber = x1 - h[0];\r\n                } else {\r\n                    var colNumber = 1;\r\n                }\r\n            }\n            // Data columns\n            for (var i = x1; i <= x2; i++) {\n                // Update non-readonly\n                if (obj.records[j][i] && ! obj.records[j][i].classList.contains('readonly') && obj.records[j][i].style.display != 'none' && breakControl == false) {\n                    // Stop if contains value\n                    if (! obj.selection.length) {\n                        if (obj.options.data[j][i] != '') {\n                            breakControl = true;\n                            continue;\n                        }\n                    }\n\n                    // Column\n                    if (data[posy] == undefined) {\n                        posx = 0;\n                    } else if (data[posy][posx] == undefined) {\n                        posx = 0;\n                    }\r\n\r\n                    // Value\r\n                    var value = data[posy][posx];\n\n                        if (value && ! data[1] && obj.options.autoIncrement == true) {\n                        if (obj.options.columns[i].type == 'text' || obj.options.columns[i].type == 'number') {\n                            if ((''+value).substr(0,1) == '=') {\n                                var tokens = value.match(/([A-Z]+[0-9]+)/g);\n\n                                if (tokens) {\n                                    var affectedTokens = [];\n                                    for (var index = 0; index < tokens.length; index++) {\n                                        var position = jexcel.getIdFromColumnName(tokens[index], 1);\n                                        position[0] += colNumber;\r\n                                        position[1] += rowNumber;\r\n                                        if (position[1] < 0) {\r\n                                            position[1] = 0;\r\n                                        }\n                                        var token = jexcel.getColumnNameFromId([position[0], position[1]]);\n\n                                        if (token != tokens[index]) {\n                                            affectedTokens[tokens[index]] = token;\n                                        }\n                                    }\n                                    // Update formula\n                                    if (affectedTokens) {\n                                        value = obj.updateFormula(value, affectedTokens)\n                                    }\n                                }\n                            } else {\n                                if (value == Number(value)) {\n                                    value = Number(value) + rowNumber;\n                                }\n                            }\n                        } else if (obj.options.columns[i].type == 'calendar') {\n                            var date = new Date(value);\n                            date.setDate(date.getDate() + rowNumber);\n                            value = date.getFullYear() + '-' + jexcel.doubleDigitFormat(parseInt(date.getMonth() + 1)) + '-' + jexcel.doubleDigitFormat(date.getDate()) + ' ' + '00:00:00';\n                        }\n                    }\n\n                    records.push(obj.updateCell(i, j, value));\n\n                    // Update all formulas in the chain\n                    obj.updateFormulaChain(i, j, records);\n                }\n                posx++;\n                if (h[0] != x1) {\r\n                    colNumber++;\r\n                }\n            }\n            posy++;\n            rowNumber++;\n        }\n\n        // Update history\n        obj.setHistory({\n            action:'setValue',\n            records:records,\n            selection:obj.selectedCell,\n        });\n\n        // Update table with custom configuration if applicable\n        obj.updateTable();\n\n        // On after changes\n        obj.onafterchanges(el, records);\n    }\n\n    /**\n     * Refresh current selection\n     */\n    obj.refreshSelection = function() {\n        if (obj.selectedCell) {\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        }\n    }\n\n    /**\n     * Move coords to A1 in case ovelaps with an excluded cell\n     */\n    obj.conditionalSelectionUpdate = function(type, o, d) {\n        if (type == 1) {\n            if (obj.selectedCell && ((o >= obj.selectedCell[1] && o <= obj.selectedCell[3]) || (d >= obj.selectedCell[1] && d <= obj.selectedCell[3]))) {\n                obj.resetSelection();\n                return;\n            }\n        } else {\n            if (obj.selectedCell && ((o >= obj.selectedCell[0] && o <= obj.selectedCell[2]) || (d >= obj.selectedCell[0] && d <= obj.selectedCell[2]))) {\n                obj.resetSelection();\n                return;\n            }\n        }\n    }\n\n    /**\n     * Clear table selection\n     */\n    obj.resetSelection = function(blur) {\n        // Remove style\n        if (! obj.highlighted.length) {\n            var previousStatus = 0;\n        } else {\n            var previousStatus = 1;\n\n            for (var i = 0; i < obj.highlighted.length; i++) {\n                obj.highlighted[i].classList.remove('highlight');\n                obj.highlighted[i].classList.remove('highlight-left');\n                obj.highlighted[i].classList.remove('highlight-right');\n                obj.highlighted[i].classList.remove('highlight-top');\n                obj.highlighted[i].classList.remove('highlight-bottom');\n                obj.highlighted[i].classList.remove('highlight-selected');\n\n                var px = parseInt(obj.highlighted[i].getAttribute('data-x'));\n                var py = parseInt(obj.highlighted[i].getAttribute('data-y'));\n\n                // Check for merged cells\n                if (obj.highlighted[i].getAttribute('data-merged')) {\n                    var colspan = parseInt(obj.highlighted[i].getAttribute('colspan'));\n                    var rowspan = parseInt(obj.highlighted[i].getAttribute('rowspan'));\n                    var ux = colspan > 0 ? px + (colspan - 1) : px;\n                    var uy = rowspan > 0 ? py + (rowspan - 1): py;\n                } else {\n                    var ux = px;\n                    var uy = py;\n                }\n\n                // Remove selected from headers\n                for (var j = px; j <= ux; j++) {\n                    if (obj.headers[j]) {\n                        obj.headers[j].classList.remove('selected');\n                    }\n                }\n\n                // Remove selected from rows\n                for (var j = py; j <= uy; j++) {\n                    if (obj.rows[j]) {\n                        obj.rows[j].classList.remove('selected');\n                    }\n                }\n            }\n        }\n\n        // Reset highlighed cells\n        obj.highlighted = [];\n\n        // Reset\n        obj.selectedCell = null;\n\n        // Hide corner\n        obj.corner.style.top = '-2000px';\n        obj.corner.style.left = '-2000px';\n\n        if (obj.ignoreEvents != true && blur == true) {\n            if (obj.options.onblur) {\n                if (typeof(obj.options.onblur) == 'function') {\n                    if (previousStatus == 1) {\n                        obj.options.onblur(el);\n                    }\n                }\n            }\n        }\n\n        return previousStatus;\n    }\n\n    /**\n     * Update selection based on two cells\n     */\n    obj.updateSelection = function(el1, el2, origin) {\n        var x1 = el1.getAttribute('data-x');\n        var y1 = el1.getAttribute('data-y');\n        if (el2) {\n            var x2 = el2.getAttribute('data-x');\n            var y2 = el2.getAttribute('data-y');\n        } else {\n            var x2 = x1;\n            var y2 = y1;\n        }\n\n        obj.updateSelectionFromCoords(x1, y1, x2, y2, origin);\n    }\n\n    /**\n     * Update selection from coords\n     */\n    obj.updateSelectionFromCoords = function(x1, y1, x2, y2, origin) {\n        // Reset Selection\n        var updated = null;\n        var previousState = obj.resetSelection();\n\n        // Same element\n        if (x2 == null) {\n            x2 = x1;\n        }\n        if (y2 == null) {\n            y2 = y1;\n        }\n\n        // Selection must be within the existing data\n        if (x1 >= obj.headers.length) {\n            x1 = obj.headers.length - 1;\n        }\n        if (y1 >= obj.rows.length) {\n            y1 = obj.rows.length - 1;\n        }\n        if (x2 >= obj.headers.length) {\n            x2 = obj.headers.length - 1;\n        }\n        if (y2 >= obj.rows.length) {\n            y2 = obj.rows.length - 1;\n        }\n\n        // Keep selected cell\n        obj.selectedCell = [x1, y1, x2, y2];\n\n        // Select cells\n        if (x1 != null) {\n            // Add selected cell\n            if (obj.records[y1][x1]) {\n                obj.records[y1][x1].classList.add('highlight-selected');\n            }\n\n            // Origin & Destination\n            if (parseInt(x1) < parseInt(x2)) {\n                var px = parseInt(x1);\n                var ux = parseInt(x2);\n            } else {\n                var px = parseInt(x2);\n                var ux = parseInt(x1);\n            }\n\n            if (parseInt(y1) < parseInt(y2)) {\n                var py = parseInt(y1);\n                var uy = parseInt(y2);\n            } else {\n                var py = parseInt(y2);\n                var uy = parseInt(y1);\n            }\n\n            // Verify merged columns\n            for (var i = px; i <= ux; i++) {\n                for (var j = py; j <= uy; j++) {\n                    if (obj.records[j][i] && obj.records[j][i].getAttribute('data-merged')) {\n                        var x = parseInt(obj.records[j][i].getAttribute('data-x'));\n                        var y = parseInt(obj.records[j][i].getAttribute('data-y'));\n                        var colspan = parseInt(obj.records[j][i].getAttribute('colspan'));\n                        var rowspan = parseInt(obj.records[j][i].getAttribute('rowspan'));\n\n                        if (colspan > 1) {\n                            if (x < px) {\n                                px = x;\n                            }\n                            if (x + colspan > ux) {\n                                ux = x + colspan - 1;\n                            }\n                        }\n\n                        if (rowspan) {\n                            if (y < py) {\n                                py = y;\n\n                            }\n                            if (y + rowspan > uy) {\n                                uy = y + rowspan - 1;\n                            }\n                        }\n                    }\n                }\n            }\n\n            // Limits\n            var borderLeft = null;\n            var borderRight = null;\n            var borderTop = null;\n            var borderBottom = null;\n\n            // Vertical limits\n            for (var j = py; j <= uy; j++) {\n                if (obj.rows[j].style.display != 'none') {\n                    if (borderTop == null) {\n                        borderTop = j;\n                    }\n                    borderBottom = j;\n                }\n            }\n\n            // Redefining styles\n            for (var i = px; i <= ux; i++) {\n                for (var j = py; j <= uy; j++) {\n                    if (obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n                        obj.records[j][i].classList.add('highlight');\n                        obj.highlighted.push(obj.records[j][i]);\n                    }\n                }\n\n                // Horizontal limits\n                if (obj.options.columns[i].type != 'hidden') {\n                    if (borderLeft == null) {\n                        borderLeft = i;\n                    }\n                    borderRight = i;\n                }\n            }\n\n            // Create borders\n            if (! borderLeft) {\n                borderLeft = 0;\n            }\n            if (! borderRight) {\n                borderRight = 0;\n            }\n            for (var i = borderLeft; i <= borderRight; i++) {\n                if (obj.options.columns[i].type != 'hidden') {\n                    // Top border\n                    if (obj.records[borderTop][i]) {\n                        obj.records[borderTop][i].classList.add('highlight-top');\n                    }\n                    // Bottom border\n                    if (obj.records[borderBottom][i]) {\n                        obj.records[borderBottom][i].classList.add('highlight-bottom');\n                    }\n                    // Add selected from headers\n                    obj.headers[i].classList.add('selected');\n                }\n            }\n\n            for (var j = borderTop; j <= borderBottom; j++) {\n                if (obj.rows[j].style.display != 'none') {\n                    // Left border\n                    obj.records[j][borderLeft].classList.add('highlight-left');\n                    // Right border\n                    obj.records[j][borderRight].classList.add('highlight-right');\n                    // Add selected from rows\n                    obj.rows[j].classList.add('selected');\n                }\n            }\n\n            obj.selectedContainer = [ borderLeft, borderTop, borderRight, borderBottom ];\n        }\n\n        // Handle events\n        if (obj.ignoreEvents != true) {\n            if (obj.options.onfocus) {\n                if (typeof(obj.options.onfocus) == 'function') {\n                    if (previousState == 0) {\n                        obj.options.onfocus(el);\n                    }\n                }\n            }\n\n            if (typeof(obj.options.onselection) == 'function') {\n                obj.options.onselection(el, borderLeft, borderTop, borderRight, borderBottom, origin);\n            }\n        }\n\n        // Find corner cell\n        obj.updateCornerPosition();\n    }\n\n    /**\n     * Remove copy selection\n     * \n     * @return void\n     */\n    obj.removeCopySelection = function() {\n        // Remove current selection\n        for (var i = 0; i < obj.selection.length; i++) {\n            obj.selection[i].classList.remove('selection');\n            obj.selection[i].classList.remove('selection-left');\n            obj.selection[i].classList.remove('selection-right');\n            obj.selection[i].classList.remove('selection-top');\n            obj.selection[i].classList.remove('selection-bottom');\n        }\n\n        obj.selection = [];\n    }\n\n    /**\n     * Update copy selection\n     * \n     * @param int x, y\n     * @return void\n     */\n    obj.updateCopySelection = function(x3, y3) {\n        // Remove selection\n        obj.removeCopySelection();\n\n        // Get elements first and last\n        var x1 = obj.selectedContainer[0];\n        var y1 = obj.selectedContainer[1];\n        var x2 = obj.selectedContainer[2];\n        var y2 = obj.selectedContainer[3];\n\n        if (x3 != null && y3 != null) {\n            if (x3 - x2 > 0) {\n                var px = parseInt(x2) + 1;\n                var ux = parseInt(x3);\n            } else {\n                var px = parseInt(x3);\n                var ux = parseInt(x1) - 1;\n            }\n\n            if (y3 - y2 > 0) {\n                var py = parseInt(y2) + 1;\n                var uy = parseInt(y3);\n            } else {\n                var py = parseInt(y3);\n                var uy = parseInt(y1) - 1;\n            }\n\n            if (ux - px < uy - py) {\n                var px = parseInt(x1);\n                var ux = parseInt(x2);\n            } else {\n                var py = parseInt(y1);\n                var uy = parseInt(y2);\n            }\n\n            for (var j = py; j <= uy; j++) {\n                for (var i = px; i <= ux; i++) {\n                    if (obj.records[j][i] && obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n                        obj.records[j][i].classList.add('selection');\n                        obj.records[py][i].classList.add('selection-top');\n                        obj.records[uy][i].classList.add('selection-bottom');\n                        obj.records[j][px].classList.add('selection-left');\n                        obj.records[j][ux].classList.add('selection-right');\n\n                        // Persist selected elements\n                        obj.selection.push(obj.records[j][i]);\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Update corner position\n     * \n     * @return void\n     */\n    obj.updateCornerPosition = function() {\n        // If any selected cells\n        if (! obj.highlighted.length) {\n            obj.corner.style.top = '-2000px';\n            obj.corner.style.left = '-2000px';\n        } else {\n            // Get last cell\n            var last = obj.highlighted[obj.highlighted.length-1];\n\r\n            const contentRect = obj.content.getBoundingClientRect();\r\n            var x1 = contentRect.left;\r\n            var y1 = contentRect.top;\r\n\r\n            const lastRect = last.getBoundingClientRect();\r\n            var x2 = lastRect.left;\r\n            var y2 = lastRect.top;\r\n            var w2 = lastRect.width;\r\n            var h2 = lastRect.height;\r\n\n            var x = (x2 - x1) + obj.content.scrollLeft + w2 - 4;\n            var y = (y2 - y1) + obj.content.scrollTop + h2 - 4;\n\n            // Place the corner in the correct place\n            obj.corner.style.top = y + 'px';\n            obj.corner.style.left = x + 'px';\n        }\n    }\n\n    /**\n     * Update scroll position based on the selection\n     */\n    obj.updateScroll = function(direction) {\n        // jExcel Container information\n        const contentRect = obj.content.getBoundingClientRect();\r\n        var x1 = contentRect.left;\r\n        var y1 = contentRect.top;\r\n        var w1 = contentRect.width;\r\n        var h1 = contentRect.height;\r\n\n        // Direction Left or Up\n        var reference = obj.records[obj.selectedCell[3]][obj.selectedCell[2]];\n\n            // Reference\r\n        const referenceRect = reference.getBoundingClientRect();\r\n        var x2 = referenceRect.left;\r\n        var y2 = referenceRect.top;\r\n        var w2 = referenceRect.width;\r\n        var h2 = referenceRect.height;\n\n        // Direction\n        if (direction == 0 || direction == 1) {\n            var x = (x2 - x1) + obj.content.scrollLeft;\n            var y = (y2 - y1) + obj.content.scrollTop - 2;\n        } else {\n            var x = (x2 - x1) + obj.content.scrollLeft + w2;\n            var y = (y2 - y1) + obj.content.scrollTop + h2;\n        }\n\n        // Top position check\n        if (y > (obj.content.scrollTop + 30) && y < (obj.content.scrollTop + h1)) {\n            // In the viewport\n        } else {\n            // Out of viewport\n            if (y < obj.content.scrollTop + 30) {\n                obj.content.scrollTop = y - h2;\n            } else {\n                obj.content.scrollTop = y - (h1 - 2);\n            }\n        }\n\n        // Left position check - TODO: change that to the bottom border of the element\n        if (x > (obj.content.scrollLeft) && x < (obj.content.scrollLeft + w1)) {\n            // In the viewport\n        } else {\n            // Out of viewport\n            if (x < obj.content.scrollLeft + 30) {\n                obj.content.scrollLeft = x;\n                if (obj.content.scrollLeft < 50) {\n                    obj.content.scrollLeft = 0;\n                }\n            } else {\n                obj.content.scrollLeft = x - (w1 - 20);\n            }\n        }\n    }\n\n    /**\n     * Get the column width\n     * \n     * @param int column column number (first column is: 0)\n     * @return int current width\n     */\n    obj.getWidth = function(column) {\n        if (! column) {\n            // Get all headers\n            var data = [];\n            for (var i = 0; i < obj.headers.length; i++) {\n                data.push(obj.options.columns[i].width);\n            }\n        } else {\n            // In case the column is an object\n            if (typeof(column) == 'object') {\n                column = $(column).getAttribute('data-x');\n            }\n\n            data = obj.colgroup[column].getAttribute('width')\n        }\n\n        return data;\n    }\n\n    /**\n     * Set the column width\n     * \n     * @param int column number (first column is: 0)\n     * @param int new column width\n     * @param int old column width\n     */\n    obj.setWidth = function (column, width, oldWidth) {\n        if (width > 0) {\n            // In case the column is an object\n            if (typeof(column) == 'object') {\n                column = column.getAttribute('data-x');\n            }\n\n            // Oldwidth\n            if (! oldWidth) {\n                oldWidth = obj.colgroup[column].getAttribute('width');\n            }\n\n            // Set width\n            obj.colgroup[column].setAttribute('width', width);\n            obj.options.columns[column].width = width;\n\n            // Keeping history of changes\n            obj.setHistory({\n                action:'setWidth',\n                column:column,\n                oldValue:oldWidth,\n                newValue:width,\n            });\n\n            // On resize column\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.onresizecolumn) == 'function') {\n                    obj.options.onresizecolumn(el, column, width, oldWidth);\n                }\n            }\n\n            // Update corner position\n            obj.updateCornerPosition();\n        }\n    }\n\n    /**\n     * Set the row height\n     * \n     * @param row - row number (first row is: 0)\n     * @param height - new row height\n     * @param oldHeight - old row height\n     */\n    obj.setHeight = function (row, height, oldHeight) {\n        if (height > 0) {\n            // In case the column is an object\n            if (typeof(row) == 'object') {\n                row = row.getAttribute('data-y');\n            }\n\n            // Oldwidth\n            if (! oldHeight) {\n                oldHeight = obj.rows[row].getAttribute('height');\r\n\r\n                if (! oldHeight) {\r\n                    var rect = obj.rows[row].getBoundingClientRect();\r\n                    oldHeight = rect.height;\r\n                }\n            }\n\n            // Integer\r\n            height = parseInt(height);\r\n\n            // Set width\n            obj.rows[row].style.height = height + 'px';\n\n            // Keep options updated\n            if (! obj.options.rows[row]) {\n                obj.options.rows[row] = {};\n            }\n            obj.options.rows[row].height = height;\n\n            // Keeping history of changes\n            obj.setHistory({\n                action:'setHeight',\n                row:row,\n                oldValue:oldHeight,\n                newValue:height,\n            });\n\n            // On resize column\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.onresizerow) == 'function') {\n                    obj.options.onresizerow(el, row, height, oldHeight);\n                }\n            }\n\n            // Update corner position\n            obj.updateCornerPosition();\n        }\n    }\n\n    /**\n     * Get the row height\n     * \n     * @param row - row number (first row is: 0)\n     * @return height - current row height\n     */\n    obj.getHeight = function(row) {\n        if (! row) {\n            // Get height of all rows\n            var data = [];\n            for (var j = 0; j < obj.rows.length; j++) {\n                var h = obj.rows[j].style.height;\n                if (h) {\n                    data[j] = h;\n                }\n            }\n        } else {\n            // In case the row is an object\n            if (typeof(row) == 'object') {\n                row = $(row).getAttribute('data-y');\n            }\n\n            var data = obj.rows[row].style.height;\n        }\n\n        return data;\n    }\n\n    /**\n     * Get the column title\n     * \n     * @param column - column number (first column is: 0)\n     * @param title - new column title\n     */\n    obj.getHeader = function(column) {\n        return obj.headers[column].innerText;\n    }\n\n    /**\n     * Set the column title\n     * \n     * @param column - column number (first column is: 0)\n     * @param title - new column title\n     */\n    obj.setHeader = function(column, newValue) {\n        if (obj.headers[column]) {\n            var oldValue = obj.headers[column].innerText;\n\n            if (! newValue) {\n                newValue = prompt(obj.options.text.columnName, oldValue)\n            }\n\n            if (newValue) {\n                obj.headers[column].innerHTML = newValue;\n                // Keep the title property\r\n                obj.headers[column].setAttribute('title', newValue);\n            }\n\n            obj.setHistory({\n                action: 'setHeader',\n                column: column,\n                oldValue: oldValue,\n                newValue: newValue\n            });\n\n            // On change\n            if (! obj.ignoreEvents) {\n                if (typeof(obj.options.onchangeheader) == 'function') {\n                    obj.options.onchangeheader(el, column, oldValue, newValue);\n                }\n            }\n        }\n    }\n\n    /**\n     * Get the headers\n     * \n     * @param asArray\n     * @return mixed\n     */\n    obj.getHeaders = function (asArray) {\n        var title = [];\n\n        for (var i = 0; i < obj.headers.length; i++) {\n            title.push(obj.getHeader(i));\n        }\n\n        return asArray ? title : title.join(obj.options.csvDelimiter);\n    }\n\n    /**\n     * Get meta information from cell(s)\n     * \n     * @return integer\n     */\n    obj.getMeta = function(cell, key) {\n        if (! cell) {\n            return obj.options.meta;\n        } else {\n            if (key) {\n                return obj.options.meta[cell] && obj.options.meta[cell][key] ? obj.options.meta[cell][key] : null;\n            } else {\n                return obj.options.meta[cell] ? obj.options.meta[cell] : null;\n            }\n        }\n    }\n\n    /**\n     * Set meta information to cell(s)\n     * \n     * @return integer\n     */\n    obj.setMeta = function(o, k, v) {\n        if (! obj.options.meta) {\n            obj.options.meta = {}\n        }\n\n        if (k && v) {\n            // Set data value\n            if (! obj.options.meta[o]) {\n                obj.options.meta[o] = {};\n            }\n            obj.options.meta[o][k] = v;\n        } else {\n            // Apply that for all cells\n            var keys = Object.keys(o);\n            for (var i = 0; i < keys.length; i++) {\n                if (! obj.options.meta[keys[i]]) {\n                    obj.options.meta[keys[i]] = {};\n                }\n\n                var prop = Object.keys(o[keys[i]]);\n                for (var j = 0; j < prop.length; j++) {\n                    obj.options.meta[keys[i]][prop[j]] = o[keys[i]][prop[j]];\n                }\n            }\n        }\n\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onchangemeta) == 'function') {\n                obj.options.onchangemeta(el, o, k, v);\n            }\n        }\n    }\n\n    /**\n     * Update meta information\n     * \n     * @return integer\n     */\n    obj.updateMeta = function(affectedCells) {\n        if (obj.options.meta) {\n            var newMeta = {};\n            var keys = Object.keys(obj.options.meta);\n            for (var i = 0; i < keys.length; i++) {\n                if (affectedCells[keys[i]]) {\n                    newMeta[affectedCells[keys[i]]] = obj.options.meta[keys[i]];\n                } else {\n                    newMeta[keys[i]] = obj.options.meta[keys[i]];\n                }\n            }\n            // Update meta information\n            obj.options.meta = newMeta;\n        }\n    }\n\n    /**\n     * Get style information from cell(s)\n     * \n     * @return integer\n     */\n    obj.getStyle = function(cell, key) {\n        // Cell\n        if (! cell) {\n            // Control vars\n            var data = {};\n\n            // Column and row length\n            var x = obj.options.data[0].length;\n            var y = obj.options.data.length;\n\n            // Go through the columns to get the data\n            for (var j = 0; j < y; j++) {\n                for (var i = 0; i < x; i++) {\n                    // Value\n                    var v = key ? obj.records[j][i].style[key] : obj.records[j][i].getAttribute('style');\n\n                    // Any meta data for this column?\n                    if (v) {\n                        // Column name\n                        var k = jexcel.getColumnNameFromId([i, j]);\n                        // Value\n                        data[k] = v;\n                    }\n                }\n            }\n\n           return data;\n        } else {\n            cell = jexcel.getIdFromColumnName(cell, true);\n\n            return key ? obj.records[cell[1]][cell[0]].style[key] : obj.records[cell[1]][cell[0]].getAttribute('style');\n        }\n    },\n\n    obj.resetStyle = function(o, ignoreHistoryAndEvents) {\n        var keys = Object.keys(o);\n        for (var i = 0; i < keys.length; i++) {\n            // Position\n            var cell = jexcel.getIdFromColumnName(keys[i], true);\n            if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n                obj.records[cell[1]][cell[0]].setAttribute('style', '');\n            }\n        }\n        obj.setStyle(o, null, null, null, ignoreHistoryAndEvents);\n    }\n\n    /**\n     * Set meta information to cell(s)\n     * \n     * @return integer\n     */\n    obj.setStyle = function(o, k, v, force, ignoreHistoryAndEvents) {\n        var newValue = {};\n        var oldValue = {};\n\n        // Apply style\n        var applyStyle = function(cellId, key, value) {\n            // Position\n            var cell = jexcel.getIdFromColumnName(cellId, true);\n\n            if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n                // Current value\n                var currentValue = obj.records[cell[1]][cell[0]].style[key];\n\n                // Change layout\n                if (currentValue == value && ! force) {\n                    value = '';\n                    obj.records[cell[1]][cell[0]].style[key] = '';\n                } else {\n                    obj.records[cell[1]][cell[0]].style[key] = value;\n                }\n\n                // History\n                if (! oldValue[cellId]) {\n                    oldValue[cellId] = [];\n                }\n                if (! newValue[cellId]) {\n                    newValue[cellId] = [];\n                }\n\n                oldValue[cellId].push([key + ':' + currentValue]);\n                newValue[cellId].push([key + ':' + value]);\n            }\n        }\n\n        if (k && v) {\n            // Get object from string\n            if (typeof(o) == 'string') {\n                applyStyle(o, k, v);\n            } else {\n                // Avoid duplications\n                var oneApplication = [];\n                // Apply that for all cells\n                for (var i = 0; i < o.length; i++) {\n                    var x = o[i].getAttribute('data-x');\n                    var y = o[i].getAttribute('data-y');\n                    var cellName = jexcel.getColumnNameFromId([x, y]);\n                    // This happens when is a merged cell\n                    if (! oneApplication[cellName]) {\n                        applyStyle(cellName, k, v);\n                        oneApplication[cellName] = true;\n                    }\n                }\n            }\n        } else {\n            var keys = Object.keys(o);\n            for (var i = 0; i < keys.length; i++) {\n                var style = o[keys[i]];\n                if (typeof(style) == 'string') {\n                    style = style.split(';');\n                }\n                for (var j = 0; j < style.length; j++) {\n                    if (typeof(style[j]) == 'string') {\n                        style[j] = style[j].split(':');\n                    }\n                    // Apply value\n                    if (style[j][0].trim()) {\n                        applyStyle(keys[i], style[j][0].trim(), style[j][1]);\n                    }\n                }\n            }\n        }\n\n        var keys = Object.keys(oldValue);\n        for (var i = 0; i < keys.length; i++) {\n            oldValue[keys[i]] = oldValue[keys[i]].join(';');\n        }\n        var keys = Object.keys(newValue);\n        for (var i = 0; i < keys.length; i++) {\n            newValue[keys[i]] = newValue[keys[i]].join(';');\n        }\n\n        if (! ignoreHistoryAndEvents) {\n            // Keeping history of changes\n            obj.setHistory({\n                action: 'setStyle',\n                oldValue: oldValue,\n                newValue: newValue,\n            });\n        }\n\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onchangestyle) == 'function') {\n                obj.options.onchangestyle(el, o, k, v);\n            }\n        }\n    }\n\n    /**\n     * Get cell comments, null cell for all\n     */\n    obj.getComments = function(cell, withAuthor) {\n        if (cell) {\r\n            if (typeof(cell) == 'string') {\r\n              var cell = jexcel.getIdFromColumnName(cell, true);\r\n            }\r\n\r\n            if (withAuthor) {\r\n                return [obj.records[cell[1]][cell[0]].getAttribute('title'), obj.records[cell[1]][cell[0]].getAttribute('author')];\r\n            } else {\r\n                return obj.records[cell[1]][cell[0]].getAttribute('title') || '';\r\n            }\r\n        } else {\r\n            var data = {};\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                for (var i = 0; i < obj.options.columns.length; i++) {\r\n                    var comments = obj.records[j][i].getAttribute('title');\r\n                    if (comments) {\r\n                        var cell = jexcel.getColumnNameFromId([i, j]);\r\n                        data[cell] = comments;\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        }\n    }\n\n    /**\n     * Set cell comments\n     */\n    obj.setComments = function(cellId, comments, author) {\n        if (typeof(cellId) == 'string') {\n            var cell = jexcel.getIdFromColumnName(cellId, true);\n        } else {\n            var cell = cellId;\n        }\n\n        // Keep old value\n        var title = obj.records[cell[1]][cell[0]].getAttribute('title');\n        var author = obj.records[cell[1]][cell[0]].getAttribute('data-author');\n        var oldValue = [ title, author ];\n\n        // Set new values\n        obj.records[cell[1]][cell[0]].setAttribute('title', comments ? comments : '');\n        obj.records[cell[1]][cell[0]].setAttribute('data-author', author ? author : '');\n\n        // Remove class if there is no comment\n        if (comments) {\n            obj.records[cell[1]][cell[0]].classList.add('jexcel_comments');\n        } else {\n            obj.records[cell[1]][cell[0]].classList.remove('jexcel_comments');\n        }\n\n        // Save history\n        obj.setHistory({\n            action:'setComments',\n            column: cellId,\n            newValue: [ comments, author ],\n            oldValue: oldValue,\n        });\n    }\n\n    /**\n     * Get table config information\n     */\n    obj.getConfig = function() {\n        var options = obj.options;\n        options.style = obj.getStyle();\n        options.mergeCells = obj.getMerge();\r\n        options.comments = obj.getComments();\n\n        return options;\n    }\n\n    /**\n     * Sort data and reload table\n     */\n    obj.orderBy = function(column, order) {\n        if (column >= 0) {\n            // Merged cells\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n                if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                    return false;\n                } else {\n                    // Remove merged cells\n                    obj.destroyMerged();\n                }\n            }\n\n            // Direction\n            if (order == null) {\n                order = obj.headers[column].classList.contains('arrow-down') ? 1 : 0;\n            } else {\n                order = order ? 1 : 0;\n            }\n\n            // Filter\n            Array.prototype.orderBy = function(p, o) {\n                return this.slice(0).sort(function(a, b) {\n                    var valueA = a[p] == '' ? '' : Number(a[p]) == a[p] ? Number(a[p]) : a[p].toLowerCase();\n                    var valueB = b[p] == '' ? '' : Number(b[p]) == b[p] ? Number(b[p]) : b[p].toLowerCase();\n\n                    if (! o) {\n                        return (valueA == '' && valueB != '') ? 1 : (valueA != '' && valueB == '') ? -1 : (valueA > valueB) ? 1 : (valueA < valueB) ? -1 :  0;\n                    } else {\n                        return (valueA == '' && valueB != '') ? 1 : (valueA != '' && valueB == '') ? -1 : (valueA > valueB) ? -1 : (valueA < valueB) ? 1 :  0;\n                    }\n                });\n            }\n\n            // Test order\n            var temp = [];\n            if (obj.options.columns[column].type == 'calendar' ||\n                obj.options.columns[column].type == 'checkbox' ||\n                obj.options.columns[column].type == 'radio') {\n                for (var j = 0; j < obj.options.data.length; j++) {\n                    temp[j] = [ j, obj.options.data[j][column] ];\n                }\n            } else {\n                for (var j = 0; j < obj.options.data.length; j++) {\n                    temp[j] = [ j, obj.records[j][column].innerHTML ];\n                }\n            }\n            temp = temp.orderBy(1, order);\n\n            // Save history\n            var newValue = [];\n            for (var j = 0; j < temp.length; j++) {\n                newValue[j] = temp[j][0];\n            }\n\n            // Save history\n            obj.setHistory({\n                action: 'orderBy',\n                rows: newValue,\n                column: column,\n                order: order,\n            });\n\n            // Update order\n            obj.updateOrderArrow(column, order);\n            obj.updateOrder(newValue);\n\n            // On sort event\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.onsort) == 'function') {\n                    obj.options.onsort(el, column, order);\n                }\n            }\n\n            return true;\n        }\n    }\n\n    /**\n     * Update order arrow\n     */\n    obj.updateOrderArrow = function(column, order) {\n        // Remove order\n        for (var i = 0; i < obj.headers.length; i++) {\n            obj.headers[i].classList.remove('arrow-up');\n            obj.headers[i].classList.remove('arrow-down');\n        }\n\n        // No order specified then toggle order\n        if (order) {\n            obj.headers[column].classList.add('arrow-up');\n        } else {\n            obj.headers[column].classList.add('arrow-down');\n        }\n    }\n\n    /**\n     * Update rows position\n     */\n    obj.updateOrder = function(rows) {\n        // History\n        var data = []\n        for (var j = 0; j < rows.length; j++) {\n            data[j] = obj.options.data[rows[j]];\n        }\n        obj.options.data = data;\n\n        var data = []\n        for (var j = 0; j < rows.length; j++) {\n            data[j] = obj.records[rows[j]];\n        }\n        obj.records = data;\n\n        var data = []\n        for (var j = 0; j < rows.length; j++) {\n            data[j] = obj.rows[rows[j]];\n        }\n        obj.rows = data;\n\n        // Update references\n        obj.updateTableReferences();\n\n        // Redo search\n        if (obj.searchInput.value) {\n            obj.search(obj.searchInput.value);\n        } else {\n            // Create page\n            obj.results = null;\n            obj.pageNumber = 0;\n\n            if (obj.options.pagination > 0) {\n                obj.page(0);\n            } else if (obj.options.lazyLoading == true) {\n                obj.loadPage(0);\n            } else {\n                for (var j = 0; j < obj.rows.length; j++) {\n                    obj.tbody.appendChild(obj.rows[j]);\n                }\n            }\n        }\n    }\n\n    /**\n     * Move row\n     * \n     * @return void\n     */\n    obj.moveRow = function(o, d, ignoreDom) {\n        if (Object.keys(obj.options.mergeCells).length > 0) {\n           if (o > d) {\r\n               var insertBefore = 1;\r\n           } else {\r\n               var insertBefore = 0;\r\n           }\r\n\r\n           if (obj.isRowMerged(o).length || obj.isRowMerged(d, insertBefore).length) {\n                if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                    return false;\n                } else {\n                    obj.destroyMerged();\n                }\n            }\n        }\n\n        if (obj.options.search == true) {\n            if (obj.results && obj.results.length != obj.rows.length) {\n                if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                    obj.resetSearch();\n                } else {\n                    return false;\n                }\n            }\n\n            obj.results = null;\n        }\n\n        if (! ignoreDom) {\n            if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[d]) >= 0) {\n                if (o > d) {\n                    obj.tbody.insertBefore(obj.rows[o], obj.rows[d]);\n                } else {\n                    obj.tbody.insertBefore(obj.rows[o], obj.rows[d].nextSibling);\n                }\n            } else {\n                obj.tbody.removeChild(obj.rows[o]);\n            }\n        }\n\n        // Place references in the correct position\n        obj.rows.splice(d, 0, obj.rows.splice(o, 1)[0]);\n        obj.records.splice(d, 0, obj.records.splice(o, 1)[0]);\n        obj.options.data.splice(d, 0, obj.options.data.splice(o, 1)[0]);\n\n        // Respect pagination\n        if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n            obj.page(obj.pageNumber);\n        }\n\n        // Keeping history of changes\n        obj.setHistory({\n            action:'moveRow',\n            oldValue: o,\n            newValue: d,\n        });\n\n        // Update table references\n        obj.updateTableReferences();\n\n        // Events\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onmoverow) == 'function') {\n                obj.options.onmoverow(el, o, d);\n            }\n        }\n    }\n\n    /**\n     * Insert a new row\n     * \n     * @param mixed - number of blank lines to be insert or a single array with the data of the new row\n     * @param rowNumber\n     * @param insertBefore\n     * @return void\n     */\n    obj.insertRow = function(mixed, rowNumber, insertBefore) {\n        // Configuration\n        if (obj.options.allowInsertRow == true) {\n            // Records\n            var records = [];\n\n            // Data to be insert\n            var data = [];\n\n            // The insert could be lead by number of rows or the array of data\n            if (mixed > 0) {\n                var numOfRows = mixed;\n            } else {\n                var numOfRows = 1;\n\n                if (mixed) {\n                    data = mixed;\n                }\n            }\n\n            // Direction\n            var insertBefore = insertBefore ? true : false;\n\n            // Current column number\n            var lastRow = obj.options.data.length - 1;\n\n            if (rowNumber == undefined || rowNumber >= parseInt(lastRow) || rowNumber < 0) {\n                rowNumber = lastRow;\n            }\n\n            // Onbeforeinsertrow\n            if (typeof(obj.options.onbeforeinsertrow) == 'function') {\n                if (! obj.options.onbeforeinsertrow(el, rowNumber, numOfRows, insertBefore)) {\n                    console.log('onbeforeinsertrow returned false');\n\n                    return false;\n                }\n            }\n\n            // Merged cells\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n                if (obj.isRowMerged(rowNumber, insertBefore).length) {\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                        return false;\n                    } else {\n                        obj.destroyMerged();\n                    }\n                }\n            }\n\n            // Clear any search\n            if (obj.options.search == true) {\n                if (obj.results && obj.results.length != obj.rows.length) {\n                    if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                        obj.resetSearch();\n                    } else {\n                        return false;\n                    }\n                }\n\n                obj.results = null;\n            }\n\n            // Insertbefore\n            var rowIndex = (! insertBefore) ? rowNumber + 1 : rowNumber;\n\n            // Keep the current data\n            var currentRecords = obj.records.splice(rowIndex);\n            var currentData = obj.options.data.splice(rowIndex);\n            var currentRows = obj.rows.splice(rowIndex);\n\n            // Adding lines\n            var rowRecords = [];\n            var rowData = [];\n            var rowNode = [];\n\n            for (var row = rowIndex; row < (numOfRows + rowIndex); row++) {\n                // Push data to the data container\n                obj.options.data[row] = [];\n                for (var col = 0; col < obj.options.columns.length; col++) {\n                    obj.options.data[row][col]  = data[col] ? data[col] : '';\n                }\n                // Create row\n                var tr = obj.createRow(row, obj.options.data[row]);\n                // Append node\n                if (currentRows[0]) {\r\n                    if (Array.prototype.indexOf.call(obj.tbody.children, currentRows[0]) >= 0) {\r\n                        obj.tbody.insertBefore(tr, currentRows[0]);\n                    }\n                } else {\r\n                    if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[rowNumber]) >= 0) {\r\n                        obj.tbody.appendChild(tr);\r\n                    }\r\n                }\n                // Record History\n                rowRecords.push(obj.records[row]);\n                rowData.push(obj.options.data[row]);\n                rowNode.push(tr);\n            }\n\n            // Copy the data back to the main data\n            Array.prototype.push.apply(obj.records, currentRecords);\n            Array.prototype.push.apply(obj.options.data, currentData);\n            Array.prototype.push.apply(obj.rows, currentRows);\n\n            // Respect pagination\n            if (obj.options.pagination > 0) {\n                obj.page(obj.pageNumber);\n            }\n\n            // Keep history\n            obj.setHistory({\n                action: 'insertRow',\n                rowNumber: rowNumber,\n                numOfRows: numOfRows,\n                insertBefore: insertBefore,\n                rowRecords: rowRecords,\n                rowData: rowData,\n                rowNode: rowNode,\n            });\n\n            // Remove table references\n            obj.updateTableReferences();\n\n            // Events\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.oninsertrow) == 'function') {\n                    obj.options.oninsertrow(el, rowNumber, numOfRows, rowRecords, insertBefore);\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete a row by number\n     * \n     * @param integer rowNumber - row number to be excluded\n     * @param integer numOfRows - number of lines\n     * @return void\n     */\n    obj.deleteRow = function(rowNumber, numOfRows) {\n        // Global Configuration\n        if (obj.options.allowDeleteRow == true) {\n            if (obj.options.allowDeletingAllRows == true || obj.options.data.length > 1) {\n                // Delete row definitions\n                if (rowNumber == undefined) {\n                    var number = obj.getSelectedRows();\n\n                    if (! number[0]) {\n                        rowNumber = obj.options.data.length - 1;\n                        numOfRows = 1;\n                    } else {\n                        rowNumber = parseInt(number[0].getAttribute('data-y'));\n                        numOfRows = number.length;\n                    }\n                }\n\n                // Last column\n                var lastRow = obj.options.data.length - 1;\n\n                if (rowNumber == undefined || rowNumber > lastRow || rowNumber < 0) {\n                    rowNumber = lastRow;\n                }\n\n                if (! numOfRows) {\n                    numOfRows = 1;\n                }\n\n                // Do not delete more than the number of recoreds\n                if (rowNumber + numOfRows >= obj.options.data.length) {\n                    numOfRows = obj.options.data.length - rowNumber;\n                }\n\n                // Onbeforedeleterow\n                if (typeof(obj.options.onbeforedeleterow) == 'function') {\n                    if (! obj.options.onbeforedeleterow(el, rowNumber, numOfRows)) {\n                        console.log('onbeforedeleterow returned false');\n                        return false;\n                    }\n                }\n\n                if (parseInt(rowNumber) > -1) {\n                    // Merged cells\n                    var mergeExists = false;\n                    if (Object.keys(obj.options.mergeCells).length > 0) {\n                        for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n                            if (obj.isRowMerged(row, false).length) {\n                                mergeExists = true;\n                            }\n                        }\n                    }\n                    if (mergeExists) {\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                            return false;\n                        } else {\n                            obj.destroyMerged();\n                        }\n                    }\n\n                    // Clear any search\n                    if (obj.options.search == true) {\n                        if (obj.results && obj.results.length != obj.rows.length) {\n                            if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                                obj.resetSearch();\n                            } else {\n                                return false;\n                            }\n                        }\n\n                        obj.results = null;\n                    }\n\n                    // Remove node\n                    for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n                        if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[row]) >= 0) {\n                            obj.rows[row].className = '';\n                            obj.rows[row].parentNode.removeChild(obj.rows[row]);\n                        }\n                    }\n\n                    // Remove data\n                    var rowRecords = obj.records.splice(rowNumber, numOfRows);\n                    var rowData = obj.options.data.splice(rowNumber, numOfRows);\n                    var rowNode = obj.rows.splice(rowNumber, numOfRows);\n\n                    // Respect pagination\n                    if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n                        obj.page(obj.pageNumber);\n                    }\n\n                    // Remove selection\n                    obj.conditionalSelectionUpdate(1, rowNumber, (rowNumber + numOfRows) - 1);\n\n                    // Keep history\n                    obj.setHistory({\n                        action: 'deleteRow',\n                        rowNumber: rowNumber,\n                        numOfRows: numOfRows,\n                        insertBefore: 1,\n                        rowRecords: rowRecords,\n                        rowData: rowData,\n                        rowNode: rowNode\n                    });\n\n                    // Remove table references\n                    obj.updateTableReferences();\n\n                    // Events\n                    if (obj.ignoreEvents != true) {\n                        if (typeof(obj.options.ondeleterow) == 'function') {\n                            obj.options.ondeleterow(el, rowNumber, numOfRows, rowRecords);\n                        }\n                    }\n                }\n            } else {\n                console.error('JEXCEL. It is not possible to delete the last row');\n            }\n        }\n    }\n\n\n    /**\n     * Move column\n     * \n     * @return void\n     */\n    obj.moveColumn = function(o, d) {\n        if (Object.keys(obj.options.mergeCells).length > 0) {\n            if (o > d) {\r\n                var insertBefore = 1;\r\n            } else {\r\n                var insertBefore = 0;\r\n            }\r\n\r\n            if (obj.isColMerged(o).length || obj.isColMerged(d, insertBefore).length) {\r\n                if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                    return false;\n                } else {\n                    obj.destroyMerged();\n                }\n            }\n        }\n\n        var o = parseInt(o);\n        var d = parseInt(d);\n\n        if (o > d) {\n            obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d]);\n            obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d]);\n\n            for (var j = 0; j < obj.rows.length; j++) {\n                obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d]);\n            }\n        } else {\n            obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d].nextSibling);\n            obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d].nextSibling);\n\n            for (var j = 0; j < obj.rows.length; j++) {\n                obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d].nextSibling);\n            }\n        }\n\n        obj.options.columns.splice(d, 0, obj.options.columns.splice(o, 1)[0]);\n        obj.headers.splice(d, 0, obj.headers.splice(o, 1)[0]);\n        obj.colgroup.splice(d, 0, obj.colgroup.splice(o, 1)[0]);\n\n        for (var j = 0; j < obj.rows.length; j++) {\n            obj.options.data[j].splice(d, 0, obj.options.data[j].splice(o, 1)[0]);\n            obj.records[j].splice(d, 0, obj.records[j].splice(o, 1)[0]);\n        }\n\n        // Keeping history of changes\n        obj.setHistory({\n            action:'moveColumn',\n            oldValue: o,\n            newValue: d,\n        });\n\n        // Update table references\n        obj.updateTableReferences();\n\n        // Events\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onmovecolumn) == 'function') {\n                obj.options.onmovecolumn(el, o, d);\n            }\n        }\n    }\n\n\n    /**\n     * Insert a new column\n     * \n     * @param mixed - num of columns to be added or data to be added in one single column\n     * @param int columnNumber - number of columns to be created\n     * @param bool insertBefore\n     * @param object properties - column properties\n     * @return void\n     */\n    obj.insertColumn = function(mixed, columnNumber, insertBefore, properties) {\n        // Configuration\n        if (obj.options.allowInsertColumn == true) {\n            // Records\n            var records = [];\n\n            // Data to be insert\n            var data = [];\n\n            // The insert could be lead by number of rows or the array of data\n            if (mixed > 0) {\n                var numOfColumns = mixed;\n            } else {\n                var numOfColumns = 1;\n\n                if (mixed) {\n                    data = mixed;\n                }\n            }\n\n            // Direction\n            var insertBefore = insertBefore ? true : false;\n\n            // Current column number\n            var lastColumn = obj.options.columns.length - 1;\n\n            // Confirm position\n            if (columnNumber == undefined || columnNumber >= parseInt(lastColumn) || columnNumber < 0) {\n                columnNumber = lastColumn;\n            }\n\n            // Onbeforeinsertcolumn\n            if (typeof(obj.options.onbeforeinsertcolumn) == 'function') {\n                if (! obj.options.onbeforeinsertcolumn(el, columnNumber, numOfColumns, insertBefore)) {\n                    console.log('onbeforeinsertcolumn returned false');\n\n                    return false;\n                }\n            }\n\n            // Merged cells\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n                if (obj.isColMerged(columnNumber, insertBefore).length) {\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                        return false;\n                    } else {\n                        obj.destroyMerged();\n                    }\n                }\n            }\n\n            // Create default properties\n            if (! properties) {\n                properties = [];\n            }\n\n            for (var i = 0; i < numOfColumns; i++) {\n                if (! properties[i]) {\n                    properties[i] = { type:'text', source:[], options:[], width:obj.options.defaultColWidth, align:obj.options.defaultColAlign };\n                }\n            }\n\n            // Insert before\n            var columnIndex = (! insertBefore) ? columnNumber + 1 : columnNumber;\n            obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, properties);\n\n            // Open space in the containers\n            var currentHeaders = obj.headers.splice(columnIndex);\n            var currentColgroup = obj.colgroup.splice(columnIndex);\n\n            // History\n            var historyHeaders = [];\n            var historyColgroup = [];\n            var historyRecords = [];\n            var historyData = [];\n\n            // Add new headers\n            for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\n                obj.createCellHeader(col);\n                obj.headerContainer.insertBefore(obj.headers[col], obj.headerContainer.children[col+1]);\n                obj.colgroupContainer.insertBefore(obj.colgroup[col], obj.colgroupContainer.children[col+1]);\n\n                historyHeaders.push(obj.headers[col]);\n                historyColgroup.push(obj.colgroup[col]);\n            }\n\n            // Adding visual columns\n            for (var row = 0; row < obj.options.data.length; row++) {\n                // Keep the current data\n                var currentData = obj.options.data[row].splice(columnIndex);\n                var currentRecord = obj.records[row].splice(columnIndex);\n\n                // History\n                historyData[row] = [];\n                historyRecords[row] = [];\n\n                for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\n                    // New value\n                    var value = data[row] ? data[row] : '';\n                    obj.options.data[row][col] = value;\n                    // New cell\n                    var td = obj.createCell(col, row, obj.options.data[row][col]);\n                    obj.records[row][col] = td;\n                    // Add cell to the row\n                    if (obj.rows[row]) {\n                        obj.rows[row].insertBefore(td, obj.rows[row].children[col+1]);\n                    }\n\n                    // Record History\n                    historyData[row].push(value);\n                    historyRecords[row].push(td);\n                }\n\n                // Copy the data back to the main data\n                Array.prototype.push.apply(obj.options.data[row], currentData);\n                Array.prototype.push.apply(obj.records[row], currentRecord);\n            }\n\n            Array.prototype.push.apply(obj.headers, currentHeaders);\n            Array.prototype.push.apply(obj.colgroup, currentColgroup);\n\n            // Adjust nested headers\n            if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                // Flexible way to handle nestedheaders\n                if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                    for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                        var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + numOfColumns;\n                        obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                        obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                    }\n                } else {\n                    var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + numOfColumns;\n                    obj.options.nestedHeaders[0].colspan = colspan;\n                    obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n                }\n            }\n\n            // Keep history\n            obj.setHistory({\n                action: 'insertColumn',\n                columnNumber:columnNumber,\n                numOfColumns:numOfColumns,\n                insertBefore:insertBefore,\n                columns:properties,\n                headers:historyHeaders,\n                colgroup:historyColgroup,\n                records:historyRecords,\n                data:historyData,\n            });\n\n            // Remove table references\n            obj.updateTableReferences();\n\n            // Events\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.oninsertcolumn) == 'function') {\n                    obj.options.oninsertcolumn(el, columnNumber, numOfColumns, historyRecords, insertBefore);\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete a column by number\n     * \n     * @param integer columnNumber - reference column to be excluded\n     * @param integer numOfColumns - number of columns to be excluded from the reference column\n     * @return void\n     */\n    obj.deleteColumn = function(columnNumber, numOfColumns) {\n        // Global Configuration\n        if (obj.options.allowDeleteColumn == true) {\n            if (obj.headers.length > 1) {\n                // Delete column definitions\n                if (columnNumber == undefined) {\n                    var number = obj.getSelectedColumns(true);\n\n                    if (! number.length) {\n                        // Remove last column\n                        columnNumber = obj.headers.length - 1;\n                        numOfColumns = 1;\n                    } else {\n                        // Remove selected\n                        columnNumber = parseInt(number[0]);\n                        numOfColumns = parseInt(number.length);\n                    }\n                }\n\n                // Lasat column\n                var lastColumn = obj.options.data[0].length - 1;\n\n                if (columnNumber == undefined || columnNumber > lastColumn || columnNumber < 0) {\n                    columnNumber = lastColumn;\n                }\n\n                // Minimum of columns to be delete is 1\n                if (! numOfColumns) {\n                    numOfColumns = 1;\n                }\n\n\n\n                // Can't delete more than the limit of the table\n                if (numOfColumns > obj.options.data[0].length - columnNumber) {\n                    numOfColumns = obj.options.data[0].length - columnNumber;\n                }\n\n                // onbeforedeletecolumn\n                if (typeof(obj.options.onbeforedeletecolumn) == 'function') {\n                   if (! obj.options.onbeforedeletecolumn(el, columnNumber, numOfColumns)) {\n                      console.log('onbeforedeletecolumn returned false');\n                      return false;\n                   }\n                }\n\n                // Can't remove the last column\n                if (parseInt(columnNumber) > -1) {\n                    // Merged cells\n                    var mergeExists = false;\n                    if (Object.keys(obj.options.mergeCells).length > 0) {\n                        for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                            if (obj.isColMerged(col, false).length) {\n                                mergeExists = true;\n                            }\n                        }\n                    }\n                    if (mergeExists) {\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                            return false;\n                        } else {\n                            obj.destroyMerged();\n                        }\n                    }\n\n                    // Delete the column properties\n                    var columns = obj.options.columns.splice(columnNumber, numOfColumns);\n\n                    for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                        obj.colgroup[col].className = '';\n                        obj.headers[col].className = '';\n                        obj.colgroup[col].parentNode.removeChild(obj.colgroup[col]);\n                        obj.headers[col].parentNode.removeChild(obj.headers[col]);\n                    }\n\n                    var historyHeaders = obj.headers.splice(columnNumber, numOfColumns);\n                    var historyColgroup = obj.colgroup.splice(columnNumber, numOfColumns);\n                    var historyRecords = [];\n                    var historyData = [];\n\n                    for (var row = 0; row < obj.options.data.length; row++) {\n                        for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                            obj.records[row][col].className = '';\n                            obj.records[row][col].parentNode.removeChild(obj.records[row][col]);\n                        }\n                    }\n\n                    // Delete headers\n                    for (var row = 0; row < obj.options.data.length; row++) {\n                        // History\n                        historyData[row] = obj.options.data[row].splice(columnNumber, numOfColumns);\n                        historyRecords[row] = obj.records[row].splice(columnNumber, numOfColumns);\n                    }\n\n                    // Remove selection\n                    obj.conditionalSelectionUpdate(0, columnNumber, (columnNumber + numOfColumns) - 1);\n\n                    // Adjust nested headers\n                    if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                        // Flexible way to handle nestedheaders\n                        if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                            for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                                var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - numOfColumns;\n                                obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                                obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                            }\n                        } else {\n                            var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - numOfColumns;\n                            obj.options.nestedHeaders[0].colspan = colspan;\n                            obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n                        }\n                    }\n\n                    // Keeping history of changes\n                    obj.setHistory({\n                        action:'deleteColumn',\n                        columnNumber:columnNumber,\n                        numOfColumns:numOfColumns,\n                        insertBefore: 1,\n                        columns:columns,\n                        headers:historyHeaders,\n                        colgroup:historyColgroup,\n                        records:historyRecords,\n                        data:historyData,\n                    });\n\n                    // Update table references\n                    obj.updateTableReferences();\n\n                    // Delete\n                    if (obj.ignoreEvents != true) {\n                        if (typeof(obj.options.ondeletecolumn) == 'function') {\n                            obj.options.ondeletecolumn(el, columnNumber, numOfColumns, historyRecords);\n                        }\n                    }\n                }\n            } else {\n                console.error('JEXCEL. It is not possible to delete the last column');\n            }\n        }\n    }\n\n    /**\n     * Get seleted rows numbers\n     * \n     * @return array\n     */\n    obj.getSelectedRows = function(asIds) {\n        var rows = [];\n        // Get all selected rows\n        for (var j = 0; j < obj.rows.length; j++) {\n            if (obj.rows[j].classList.contains('selected')) {\n                if (asIds) {\n                    rows.push(j);\n                } else {\n                    rows.push(obj.rows[j]);\n                }\n            }\n        }\n\n        return rows;\n    },\n\n    /**\n     * Get seleted column numbers\n     * \n     * @return array\n     */\n    obj.getSelectedColumns = function() {\n        var cols = [];\n        // Get all selected cols\n        for (var i = 0; i < obj.headers.length; i++) {\n            if (obj.headers[i].classList.contains('selected')) {\n                cols.push(i);\n            }\n        }\n\n        return cols;\n    }\n\n    /**\n     * Get highlighted\n     * \n     * @return array\n     */\n    obj.getHighlighted = function() {\n        return obj.highlighted;\n    }\n\n    /**\n     * Update cell references\n     * \n     * @return void\n     */\n    obj.updateTableReferences = function() {\n        // Update headers\n        for (var i = 0; i < obj.headers.length; i++) {\n            var x = obj.headers[i].getAttribute('data-x');\n\n            if (x != i) {\n                // Update coords\n                obj.headers[i].setAttribute('data-x', i);\n                // Title\n                if (! obj.headers[i].getAttribute('title')) {\n                    obj.headers[i].innerHTML = jexcel.getColumnName(i);\n                }\n            }\n        }\n\n        // Update all rows\n        for (var j = 0; j < obj.rows.length; j++) {\n            if (obj.rows[j]) {\n                var y = obj.rows[j].getAttribute('data-y');\n\n                if (y != j) {\n                    // Update coords\n                    obj.rows[j].setAttribute('data-y', j);\n                    obj.rows[j].children[0].setAttribute('data-y', j);\n                    // Row number\n                    obj.rows[j].children[0].innerHTML = j + 1;\n                }\n            }\n        }\n\n        // Regular cells affected by this change\n        var affectedTokens = [];\n        var mergeCellUpdates = [];\n\n        // Update cell\n        var updatePosition = function(x,y,i,j) {\n            if (x != i) {\n                obj.records[j][i].setAttribute('data-x', i);\n            }\n            if (y != j) {\n                obj.records[j][i].setAttribute('data-y', j);\n            }\n\n            // Other updates\n            if (x != i || y != j) {\n                var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\n                var columnIdTo = jexcel.getColumnNameFromId([i, j]);\n                affectedTokens[columnIdFrom] = columnIdTo;\n            }\n        }\n\n        for (var j = 0; j < obj.records.length; j++) {\n            for (var i = 0; i < obj.records[0].length; i++) {\n                if (obj.records[j][i]) {\n                    // Current values\n                    var x = obj.records[j][i].getAttribute('data-x');\n                    var y = obj.records[j][i].getAttribute('data-y');\n\n                    // Update column\n                    if (obj.records[j][i].getAttribute('data-merged')) {\n                        var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\n                        var columnIdTo = jexcel.getColumnNameFromId([i, j]);\n                        if (mergeCellUpdates[columnIdFrom] == null) {\n                            if (columnIdFrom == columnIdTo) {\n                                mergeCellUpdates[columnIdFrom] = false;\n                            } else {\n                                var totalX = parseInt(i - x);\n                                var totalY = parseInt(j - y);\n                                mergeCellUpdates[columnIdFrom] = [ columnIdTo, totalX, totalY ];\n                            }\n                        }\n                    } else {\n                        updatePosition(x,y,i,j);\n                    }\n                }\n            }\n        }\n\n        // Update merged if applicable\n        var keys = Object.keys(mergeCellUpdates);\n        if (keys.length) {\n            for (var i = 0; i < keys.length; i++) {\n                if (mergeCellUpdates[keys[i]]) {\n                    var info = jexcel.getIdFromColumnName(keys[i], true)\n                    var x = info[0];\n                    var y = info[1];\n                    updatePosition(x,y,x + mergeCellUpdates[keys[i]][1],y + mergeCellUpdates[keys[i]][2]);\n\n                    var columnIdFrom = keys[i];\n                    var columnIdTo = mergeCellUpdates[keys[i]][0];\n                    for (var j = 0; j < obj.options.mergeCells[columnIdFrom][2].length; j++) {\n                        var x = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-x'));\n                        var y = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-y'));\n                        obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-x', x + mergeCellUpdates[keys[i]][1]);\n                        obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-y', y + mergeCellUpdates[keys[i]][2]);\n                    }\n\n                    obj.options.mergeCells[columnIdTo] = obj.options.mergeCells[columnIdFrom];\n                    delete(obj.options.mergeCells[columnIdFrom]);\n                }\n            }\n        }\n\n        // Update formulas\n        obj.updateFormulas(affectedTokens);\n\n        // Update meta data\n        obj.updateMeta(affectedTokens);\n\n        // Refresh selection\n        obj.refreshSelection();\n\n        // Update table with custom configuration if applicable\n        obj.updateTable();\n    }\n\n    /**\n     * Custom settings for the cells\n     */\n    obj.updateTable = function() {\n        // Check for spare\n        if (obj.options.minSpareRows > 0) {\n            var numBlankRows = 0;\n            for (var j = obj.rows.length - 1; j >= 0; j--) {\n                var test = false;\n                for (var i = 0; i < obj.headers.length; i++) {\n                    if (obj.options.data[j][i]) {\n                        test = true;\n                    }\n                }\n                if (test) {\n                    break;\n                } else {\n                    numBlankRows++;\n                }\n            }\n\n            if (obj.options.minSpareRows - numBlankRows > 0) {\n                obj.insertRow(obj.options.minSpareRows - numBlankRows)\n            }\n        }\n\n        if (obj.options.minSpareCols > 0) {\n            var numBlankCols = 0;\n            for (var i = obj.headers.length - 1; i >= 0 ; i--) {\n                var test = false;\n                for (var j = 0; j < obj.rows.length; j++) {\n                    if (obj.options.data[j][i]) {\n                        test = true;\n                    }\n                }\n                if (test) {\n                    break;\n                } else {\n                    numBlankCols++;\n                }\n            }\n\n            if (obj.options.minSpareCols - numBlankCols > 0) {\n                obj.insertColumn(obj.options.minSpareCols - numBlankCols)\n            }\n        }\n\n        // Customizations by the developer\n        if (typeof(obj.options.updateTable) == 'function') {\n            if (obj.options.detachForUpdates) {\r\n                el.removeChild(obj.content);\r\n            }\r\n\n            for (var j = 0; j < obj.rows.length; j++) {\n                for (var i = 0; i < obj.headers.length; i++) {\n                    obj.options.updateTable(el, obj.records[j][i], i, j, obj.options.data[j][i], obj.records[j][i].innerText, jexcel.getColumnNameFromId([i, j]));\n                }\n            }\n\r\n            if (obj.options.detachForUpdates) {\r\n                el.insertBefore(obj.content, obj.pagination);\r\n            }\n        }\n\n        // Update corner position\n        setTimeout(function() {\n            obj.updateCornerPosition();\n        },0);\n    }\n\r\n    /**\r\n     * Show column\r\n     */\r\n    obj.showColumn = function(colNumber) {\r\n        obj.headers[colNumber].style.display = '';\r\n        obj.colgroup[colNumber].style.display = '';\r\n        for (var j = 0; j < obj.options.data.length; j++) {\r\n            obj.records[j][colNumber].style.display = '';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Hide column\r\n     */\r\n    obj.hideColumn = function(colNumber) {\r\n        obj.headers[colNumber].style.display = 'none';\r\n        obj.colgroup[colNumber].style.display = 'none';\r\n        for (var j = 0; j < obj.options.data.length; j++) {\r\n            obj.records[j][colNumber].style.display = 'none';\r\n        }\r\n    }\r\n\n    /**\n     * Show index column\n     */\n    obj.showIndex = function() {\n        obj.table.classList.remove('jexcel_hidden_index');\n    }\n\n    /**\n     * Hide index column\n     */\n    obj.hideIndex = function() {\n        obj.table.classList.add('jexcel_hidden_index');\n    }\n\n    /**\n     * Update all related cells in the chain\n     */\n    var chainLoopProtection = [];\n\n    obj.updateFormulaChain = function(x, y, records) {\n        var cellId = jexcel.getColumnNameFromId([x, y]);\n        if (obj.formula[cellId] && obj.formula[cellId].length > 0) {\n            if (chainLoopProtection[cellId]) {\n                obj.records[y][x].innerHTML = '#ERROR';\n                obj.formula[cellId] = '';\n            } else {\n                // Protection\n                chainLoopProtection[cellId] = true;\n\n                for (var i = 0; i < obj.formula[cellId].length; i++) {\n                    var cell = jexcel.getIdFromColumnName(obj.formula[cellId][i], true);\n                    // Update cell\n                    var value = ''+obj.options.data[cell[1]][cell[0]];\n                    if (value.substr(0,1) == '=') {\n                        records.push(obj.updateCell(cell[0], cell[1], value, true));\n                    } else {\n                        // No longer a formula, remove from the chain\n                        Object.keys(obj.formula)[i] = null;\n                    }\n                    obj.updateFormulaChain(cell[0], cell[1], records);\n                }\n            }\n        }\n\n        chainLoopProtection = [];\n    }\n\n    /**\n     * Update formulas\n     */\n    obj.updateFormulas = function(referencesToUpdate) {\n        // Update formulas\n        for (var j = 0; j < obj.options.data.length; j++) {\n            for (var i = 0; i < obj.options.data[0].length; i++) {\n                var value = '' + obj.options.data[j][i];\n                // Is formula\n                if (value.substr(0,1) == '=') {\n                    // Replace tokens\n                    var newFormula = obj.updateFormula(value, referencesToUpdate);\n                    if (newFormula != value) {\n                        obj.options.data[j][i] = newFormula;\n                    }\n                }\n            }\n        }\n\n        // Update formula chain\n        var formula = [];\n        var keys = Object.keys(obj.formula);\n        for (var j = 0; j < keys.length; j++) {\n            // Current key and values\n            var key = keys[j];\n            var value = obj.formula[key];\n            // Update key\n            if (referencesToUpdate[key]) {\n                key = referencesToUpdate[key];\n            }\n            // Update values\n            formula[key] = [];\n            for (var i = 0; i < value.length; i++) {\n                var letter = value[i];\n                if (referencesToUpdate[letter]) {\n                    letter = referencesToUpdate[letter];\n                }\n                formula[key].push(letter);\n            }\n        }\n        obj.formula = formula;\n    }\n\n    /**\n     * Update formula\n     */\n    obj.updateFormula = function(formula, referencesToUpdate) {\n        var testLetter = /[A-Z]/;\n        var testNumber = /[0-9]/;\n\n        var newFormula = '';\n        var letter = null;\n        var number = null;\n        var token = '';\n\n        for (var index = 0; index < formula.length; index++) {\n            if (testLetter.exec(formula[index])) {\n                letter = 1;\n                number = 0;\n                token += formula[index];\n            } else if (testNumber.exec(formula[index])) {\n                number = letter ? 1 : 0;\n                token += formula[index];\n            } else {\n                if (letter && number) {\n                    token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n                }\n                newFormula += token;\n                newFormula += formula[index];\n                letter = 0;\n                number = 0;\n                token = '';\n            }\n        }\n\n        if (token) {\n            if (letter && number) {\n                token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n            }\n            newFormula += token;\n        }\n\n        return newFormula;\n    }\n\n    /**\n     * Parse formulas\n     */\n    obj.executeFormula = function(expression, x, y) {\n\n        var formulaResults = [];\n        var formulaLoopProtection = [];\n\n        // Execute formula with loop protection\n        var execute = function(expression, x, y) {\n         // Parent column identification\n            var parentId = jexcel.getColumnNameFromId([x, y]);\n\n            // Code protection\n            if (formulaLoopProtection[parentId]) {\n                console.error('Reference loop detected');\n                return '#ERROR';\n            }\n\n            formulaLoopProtection[parentId] = true;\n\n            // Convert range tokens\n            var tokensUpdate = function(tokens) {\n                for (var index = 0; index < tokens.length; index++) {\n                    var f = [];\n                    var token = tokens[index].split(':');\n                    var e1 = jexcel.getIdFromColumnName(token[0], true);\n                    var e2 = jexcel.getIdFromColumnName(token[1], true);\n\n                    if (e1[0] <= e2[0]) {\n                        var x1 = e1[0];\n                        var x2 = e2[0];\n                    } else {\n                        var x1 = e2[0];\n                        var x2 = e1[0];\n                    }\n\n                    if (e1[1] <= e2[1]) {\n                        var y1 = e1[1];\n                        var y2 = e2[1];\n                    } else {\n                        var y1 = e2[1];\n                        var y2 = e1[1];\n                    }\n\n                    for (var j = y1; j <= y2; j++) {\n                        for (var i = x1; i <= x2; i++) {\n                            f.push(jexcel.getColumnNameFromId([i, j]));\n                        }\n                    }\n\n                    expression = expression.replace(tokens[index], f.join(','));\n                }\n            }\n\n            var tokens = expression.match(/([A-Z]+[0-9]+)\\:([A-Z]+[0-9]+)/g);\n            if (tokens && tokens.length) {\n                tokensUpdate(tokens);\n            }\n\n            // String\n            var evalstring = '';\n\n            // Get tokens\n            var tokens = expression.match(/([A-Z]+[0-9]+)/g);\n\n            // Direct self-reference protection\n            if (tokens && tokens.indexOf(parentId) > -1) {\n                console.error('Self Reference detected');\n                return '#ERROR';\n            } else {\n                if (tokens) {\n                    for (var i = 0; i < tokens.length; i++) {\n                        // Keep chain\n                        if (! obj.formula[tokens[i]]) {\n                            obj.formula[tokens[i]] = [];\n                        }\n                        // Is already in the register\n                        if (obj.formula[tokens[i]].indexOf(parentId) < 0) {\n                            obj.formula[tokens[i]].push(parentId);\n                        }\n\n                        // Do not calculate again\n                        if (eval('typeof(' + tokens[i] + ') == \"undefined\"')) {\n                            // Coords\n                            var position = jexcel.getIdFromColumnName(tokens[i], 1);\n                            // Get value\n                            if (typeof(obj.options.data[position[1]]) != 'undefined' && typeof(obj.options.data[position[1]][position[0]]) != 'undefined') {\n                                var value = obj.options.data[position[1]][position[0]];\n                            } else {\n                                var value = '';\n                            }\n                            // Get column data\n                            if ((''+value).substr(0,1) == '=') {\n                                if (formulaResults[tokens[i]]) {\n                                    value = formulaResults[tokens[i]];\n                                } else {\n                                    value = execute(value, position[0], position[1]);\n                                    formulaResults[tokens[i]] = value;\n                                }\n                            }\n                            // Type!\n                            if ((''+value).trim() == '') {\n                                // Null\n                                evalstring += \"var \" + tokens[i] + \" = null;\";\n                            } else {\n                                if (value == Number(value) && obj.options.autoCasting == true) {\n                                    // Number\n                                    evalstring += \"var \" + tokens[i] + \" = \" + Number(value) + \";\";\n                                } else {\n                                    // Trying any formatted number\n                                    var number = obj.parseNumber(value, position[0])\n                                    if (obj.options.autoCasting == true && number) {\n                                        // Render as number\n                                        evalstring += \"var \" + tokens[i] + \" = \" + number + \";\";\n                                    } else {\n                                        // Render as string\n                                        evalstring += \"var \" + tokens[i] + \" = '\" + value + \"';\";\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n\n                // Convert formula to javascript\n                try {\n                    evalstring += \"function COLUMN() { return parseInt(x) + 1; }; function ROW() { return parseInt(y) + 1; }; function CELL() { return parentId; };\";\n\n                    var res = eval(evalstring + expression.substr(1));\n                } catch (e) {\n                    var res = '#ERROR';\n                }\n\n                return res;\n            }\n        }\n\n        return execute(expression, x, y);\n    }\n\n    /**\n     * Trying to extract a number from a string\n     */\n    obj.parseNumber = function(value, columnNumber) {\n        // Decimal point\n        var decimal = columnNumber && obj.options.columns[columnNumber].decimal ? obj.options.columns[columnNumber].decimal : '.';\n\n        // Parse both parts of the number\n        var number = ('' + value);\n        number = number.split(decimal);\n        number[0] = number[0].match(/[+-]?[0-9]/g);\n        if (number[0]) {\n            number[0] = number[0].join('');\n        }\n        if (number[1]) {\n            number[1] = number[1].match(/[0-9]*/g).join('');\n        }\n\n        // Is a valid number\n        if (number[0] && Number(number[0]) >= 0) {\n            if (! number[1]) {\n                var value = Number(number[0] + '.00');\n            } else {\n                var value = Number(number[0] + '.' + number[1]);\n            }\n        } else {\n            var value = null;\n        }\n\n        return value;\n    }\n\n    /**\n     * Get row number\n     */\n    obj.row = function(cell) {\n    }\n\n    /**\n     * Get col number\n     */\n    obj.col = function(cell) {\n    }\n\n    obj.up = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[3] > 0) {\n                obj.up.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[1] > 0) {\n                obj.up.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        // Update selection\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n\n        // Change page\n        if (obj.options.lazyLoading == true) {\n            if (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0) {\n                obj.loadPage(0);\n                obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            } else {\n                if (obj.loadValidation()) {\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                } else {\n                    var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n                    if (obj.selectedCell[1] - item < 30) {\n                        obj.loadUp();\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                    }\n                }\n            }\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateScroll(1);\n    }\n\n    obj.up.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var j = 0; j < y; j++) {\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                    y = j;\n                    break;\n                }\n            }\n        } else {\n            y = obj.up.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.up.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n        for (var j = (y - 1); j >= 0; j--) {\n            if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                if (obj.records[j][x].getAttribute('data-merged')) {\n                    if (obj.records[j][x] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                y = j;\n                break;\n            }\n        }\n\n        return y;\n    }\n\n    obj.down = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[3] < obj.records.length - 1) {\n                obj.down.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[1] < obj.records.length - 1) {\n                obj.down.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n\n        // Change page\n        if (obj.options.lazyLoading == true) {\n            if ((obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\n                obj.loadPage(-1);\n                obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            } else {\n                if (obj.loadValidation()) {\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                } else {\n                    var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n                    if (item - obj.selectedCell[3] < 30) {\n                        obj.loadDown();\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                    }\n                }\n            }\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateScroll(3);\n    }\n\n    obj.down.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var j = obj.rows.length - 1; j > y; j--) {\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                    y = j;\n                    break;\n                }\n            }\n        } else {\n            y = obj.down.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.down.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n        for (var j = (y + 1); j < obj.rows.length; j++) {\n            if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                if (obj.records[j][x].getAttribute('data-merged')) {\n                    if (obj.records[j][x] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                y = j;\n                break;\n            }\n        }\n\n        return y;\n    }\n\n    obj.right = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[2] < obj.headers.length - 1) {\n                obj.right.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[0] < obj.headers.length - 1) {\n                obj.right.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(2);\n    }\n\n    obj.right.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var i = obj.headers.length - 1; i > x; i--) {\n                if (obj.records[y][i].style.display != 'none') {\n                    x = i;\n                    break;\n                }\n            }\n        } else {\n            x = obj.right.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.right.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n\n        for (var i = (x + 1); i < obj.headers.length; i++) {\n            if (obj.records[y][i].style.display != 'none') {\n                if (obj.records[y][i].getAttribute('data-merged')) {\n                    if (obj.records[y][i] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                x = i;\n                break;\n            }\n        }\n\n        return x;\n    }\n\n    obj.left = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[2] > 0) {\n                obj.left.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[0] > 0) {\n                obj.left.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(0);\n    }\n\n    obj.left.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var i = 0; i < x; i++) {\n                if (obj.records[y][i].style.display != 'none') {\n                    x = i;\n                    break;\n                }\n            }\n        } else {\n            x = obj.left.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.left.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n        for (var i = (x - 1); i >= 0; i--) {\n            if (obj.records[y][i].style.display != 'none') {\n                if (obj.records[y][i].getAttribute('data-merged')) {\n                    if (obj.records[y][i] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                x = i;\n                break;\n            }\n        }\n\n        return x;\n    }\n\n    obj.first = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (ctrlKey) {\n                obj.selectedCell[3] = 0;\n            } else {\n                obj.left.visible(1, 0);\n            }\n        } else {\n            if (ctrlKey) {\n                obj.selectedCell[1] = 0;\n            } else {\n                obj.left.visible(0, 0);\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        // Change page\n        if (obj.options.lazyLoading == true && (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0)) {\n            obj.loadPage(0);\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(1);\n    }\n\n    obj.last = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (ctrlKey) {\n                obj.selectedCell[3] = obj.records.length - 1;\n            } else {\n                obj.right.visible(1, 0);\n            }\n        } else {\n            if (ctrlKey) {\n                obj.selectedCell[1] = obj.records.length - 1;\n            } else {\n                obj.right.visible(0, 0);\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        // Change page\n        if (obj.options.lazyLoading == true && (obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\n            obj.loadPage(-1);\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(3);\n    }\n\n    obj.selectAll = function() {\n        if (! obj.selectedCell) {\n            obj.selectedCell = [];\n        }\n\n        obj.selectedCell[0] = 0;\n        obj.selectedCell[1] = 0;\n        obj.selectedCell[2] = obj.headers.length - 1;\n        obj.selectedCell[3] = obj.records.length - 1;\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n    }\n\n    /**\n     * Go to a page in a lazyLoading\n     */\n    obj.loadPage = function(pageNumber) {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n\n        // Per page\n        var quantityPerPage = 100;\n\n        // pageNumber\n        if (pageNumber == null || pageNumber == -1) {\n            // Last page\n            pageNumber = Math.ceil(results.length / quantityPerPage); \n        }\n\n        var startRow = (pageNumber * quantityPerPage);\n        var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\n        if (finalRow > results.length) {\n            finalRow = results.length;\n        }\n        startRow = finalRow - 100;\n        if (startRow < 0) {\n            startRow = 0;\n        }\n\n        // Appeding items\n        for (var j = startRow; j < finalRow; j++) {\n            if (obj.options.search == true && obj.results) {\n                obj.tbody.appendChild(obj.rows[results[j]]);\n            } else {\n                obj.tbody.appendChild(obj.rows[j]);\n            }\n\n            if (obj.tbody.children.length > quantityPerPage) {\n                obj.tbody.removeChild(obj.tbody.firstChild);\n            }\n        }\n    }\n\n    obj.loadUp = function() {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n        var test = 0;\n        if (results.length > 100) {\n            // Get the first element in the page\n            var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n            if (obj.options.search == true && obj.results) {\n                item = results.indexOf(item);\n            }\n            if (item > 0) {\n                for (var j = 0; j < 30; j++) {\n                    item = item - 1;\n                    if (item > -1) {\n                        if (obj.options.search == true && obj.results) {\n                            obj.tbody.insertBefore(obj.rows[results[item]], obj.tbody.firstChild);\n                        } else {\n                            obj.tbody.insertBefore(obj.rows[item], obj.tbody.firstChild);\n                        }\n                        if (obj.tbody.children.length > 100) {\n                            obj.tbody.removeChild(obj.tbody.lastChild);\n                            test = 1;\n                        }\n                    }\n                }\n            }\n        }\n        return test;\n    }\n\n    obj.loadDown = function() {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n        var test = 0;\n        if (results.length > 100) {\n            // Get the last element in the page\n            var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n            if (obj.options.search == true && obj.results) {\n                item = results.indexOf(item);\n            }\n            if (item < obj.rows.length - 1) {\n                for (var j = 0; j <= 30; j++) {\n                    if (item < results.length) {\n                        if (obj.options.search == true && obj.results) {\n                            obj.tbody.appendChild(obj.rows[results[item]]);\n                        } else {\n                            obj.tbody.appendChild(obj.rows[item]);\n                        }\n                        if (obj.tbody.children.length > 100) {\n                            obj.tbody.removeChild(obj.tbody.firstChild);\n                            test = 1;\n                        }\n                    }\n                    item = item + 1;\n                }\n            }\n        }\n\n        return test;\n    }\n\n    obj.loadValidation = function() {\n        if (obj.selectedCell) {\n            var currentPage = parseInt(obj.tbody.firstChild.getAttribute('data-y')) / 100;\n            var selectedPage = parseInt(obj.selectedCell[3] / 100);\n            var totalPages = parseInt(obj.rows.length / 100);\n\n            if (currentPage != selectedPage && selectedPage <= totalPages) {\n                if (! Array.prototype.indexOf.call(obj.tbody.children, obj.rows[obj.selectedCell[3]])) {\n                    obj.loadPage(selectedPage);\n                    return true;\n                }\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * Reset search\n     */\n    obj.resetSearch = function() {\n        obj.searchInput.value = '';\n        obj.search('');\n        obj.results = null;\n    }\n\n    /**\n     * Search\n     */\n    obj.search = function(query) {\n        // Query\n        if (query) {\n            var query = query.toLowerCase();\n        }\n\n        // Reset selection\n        obj.resetSelection();\n\n        // Total of results\n        obj.pageNumber = 0;\n        obj.results = [];\n\n        if (query) {\n            // Search filter\n            var search = function(item, query, index) {\n                for (var i = 0; i < item.length; i++) {\n                    if ((''+item[i]).toLowerCase().search(query) >= 0 ||\n                        (''+obj.records[index][i].innerHTML).toLowerCase().search(query) >= 0) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n\n            // Result\n            var addToResult = function(k) {\n                if (obj.results.indexOf(k) == -1) {\n                    obj.results.push(k);\n                }\n            }\n\n            // Filter\n            var data = obj.options.data.filter(function(v, k) {\n                if (search(v, query, k)) {\n                    // Merged rows found\n                    var rows = obj.isRowMerged(k);\n                    if (rows.length) {\n                        for (var i = 0; i < rows.length; i++) {\n                            var row = jexcel.getIdFromColumnName(rows[i], true);\n                            for (var j = 0; j < obj.options.mergeCells[rows[i]][1]; j++) {\n                                addToResult(row[1]+j);\n                            }\n                        }\n                    } else {\n                        // Normal row found\n                        addToResult(k);\n                    }\n                    return true;\n                } else {\n                    return false;\n                }\n            });\n        } else {\n            obj.results = null;\n        }\n\n        var total = 0;\n        var index = 0;\n\n        // Page 1\n        if (obj.options.lazyLoading == true) {\n            total = 100;\n        } else if (obj.options.pagination > 0) {\n            total = obj.options.pagination;\n        } else {\n            if (obj.results) {\n                total = obj.results.length;\n            } else {\n                total = obj.rows.length;\n            }\n        }\n\n        // Reset current nodes\n        while (obj.tbody.firstChild) {\n            obj.tbody.removeChild(obj.tbody.firstChild);\n        }\n\n        // Hide all records from the table\n        for (var j = 0; j < obj.rows.length; j++) {\n            if (! obj.results || obj.results.indexOf(j) > -1) {\n                if (index < total) {\n                    obj.tbody.appendChild(obj.rows[j]);\n                    index++;\n                }\n                obj.rows[j].style.display = '';\n            } else {\n                obj.rows[j].style.display = 'none';\n            }\n        }\n\n        // Update pagination\n        if (obj.options.pagination > 0) {\n            obj.updatePagination();\n        }\n\n        return total;\n    }\n\n    /**\n     * Which page the cell is\n     */\n    obj.whichPage = function(cell) {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            cell = obj.results.indexOf(cell);\n        }\n\n        return (Math.ceil((parseInt(cell) + 1) / parseInt(obj.options.pagination))) - 1;\n    }\n\n    /**\n     * Go to page\n     */\n    obj.page = function(pageNumber) {\n        var oldPage = obj.pageNumber;\r\n\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n\n        // Per page\n        var quantityPerPage = parseInt(obj.options.pagination);\n\n        // pageNumber\n        if (pageNumber == null || pageNumber == -1) {\n            // Last page\n            pageNumber = Math.ceil(results.length / quantityPerPage); \n        }\n\n        // Page number\n        obj.pageNumber = pageNumber;\n\n        var startRow = (pageNumber * quantityPerPage);\n        var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\n        if (finalRow > results.length) {\n            finalRow = results.length;\n        }\n        if (startRow < 0) {\n            startRow = 0;\n        }\n\n        // Reset container\n        while (obj.tbody.firstChild) {\n            obj.tbody.removeChild(obj.tbody.firstChild);\n        }\n\n        // Appeding items\n        for (var j = startRow; j < finalRow; j++) {\n            if (obj.options.search == true && obj.results) {\n                obj.tbody.appendChild(obj.rows[results[j]]);\n            } else {\n                obj.tbody.appendChild(obj.rows[j]);\n            }\n        }\n\n        if (obj.options.pagination > 0) {\n            obj.updatePagination();\n        }\n\n        // Update corner position\n        obj.updateCornerPosition();\n\r\n        if (typeof(obj.options.onchangepage) == 'function') {\r\n            obj.options.onchangepage(el, pageNumber, oldPage);\r\n        }\n    }\n\n    /**\n     * Update the pagination\n     */\n    obj.updatePagination = function() {\n        // Reset container\n        obj.pagination.children[0].innerHTML = '';\n        obj.pagination.children[1].innerHTML = '';\n\n        // Start pagination\n        if (obj.options.pagination) {\n            // Searchable\n            if (obj.options.search == true && obj.results) {\n                var results = obj.results.length;\n            } else {\n                var results = obj.rows.length;\n            }\n\n            if (! results) {\n                // No records found\n                obj.pagination.children[0].innerHTML = obj.options.text.noRecordsFound;\n            } else {\n                // Pagination container\n                var quantyOfPages = Math.ceil(results / obj.options.pagination);\n\n                if (obj.pageNumber < 6) {\n                    var startNumber = 1;\n                    var finalNumber = quantyOfPages < 10 ? quantyOfPages : 10;\n                } else if (quantyOfPages - obj.pageNumber < 5) {\n                    var startNumber = quantyOfPages - 9;\n                    var finalNumber = quantyOfPages;\n                    if (startNumber < 1) {\n                        startNumber = 1;\n                    }\n                } else {\n                    var startNumber = obj.pageNumber - 4;\n                    var finalNumber = obj.pageNumber + 5;\n                }\n\n                // First\n                if (startNumber > 1) {\n                    var paginationItem = document.createElement('div');\n                    paginationItem.className = 'jexcel_page';\n                    paginationItem.innerHTML = '<';\n                    paginationItem.title = 1;\n                    obj.pagination.children[1].appendChild(paginationItem);\n                }\n\n                // Get page links\n                for (var i = startNumber; i <= finalNumber; i++) {\n                    var paginationItem = document.createElement('div');\n                    paginationItem.className = 'jexcel_page';\n                    paginationItem.innerHTML = i;\n                    obj.pagination.children[1].appendChild(paginationItem);\n\n                    if (obj.pageNumber == (i-1)) {\n                        paginationItem.classList.add('jexcel_page_selected');\n                    }\n                }\n\n                // Last\n                if (finalNumber < quantyOfPages) {\n                    var paginationItem = document.createElement('div');\n                    paginationItem.className = 'jexcel_page';\n                    paginationItem.innerHTML = '>';\n                    paginationItem.title = quantyOfPages;\n                    obj.pagination.children[1].appendChild(paginationItem);\n                }\n\n                // Text\n                var format = function(format) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    return format.replace(/{(\\d+)}/g, function(match, number) {\n                      return typeof args[number] != 'undefined'\n                        ? args[number]\n                        : match\n                      ;\n                    });\n                };\n\n                obj.pagination.children[0].innerHTML = format(obj.options.text.showingPage, obj.pageNumber + 1, quantyOfPages)\n            }\n        }\n    }\n\n    /**\n     * Download CSV table\n     * \n     * @return null\n     */\n    obj.download = function(includeHeaders) {\n        if (obj.options.allowExport == false) {\n            console.error('Export not allowed');\n        } else {\n            // Data\n            var data = '';\n            if (includeHeaders == true || obj.options.includeHeadersOnDownload == true) {\n                data += obj.getHeaders();\n                data += \"\\r\\n\";\n            }\n\r\n            // Get data\n            data += obj.copy(false, obj.options.csvDelimiter, true);\r\n\n            // Download element\n            var blob = new Blob([\"\\uFEFF\"+data], {type: 'text/csv;charset=utf-8;'});\n\r\n            // IE Compatibility\r\n            if (window.navigator && window.navigator.msSaveOrOpenBlob) {\r\n                window.navigator.msSaveOrOpenBlob(blob, options.csvFileName + '.csv');\r\n            } else {\n                // Download element\n                var pom = document.createElement('a');\n                var url = URL.createObjectURL(blob);\n                pom.href = url;\n                pom.setAttribute('download', obj.options.csvFileName + '.csv');\n                document.body.appendChild(pom);\n                pom.click();\n                pom.parentNode.removeChild(pom);\n            }\n        }\n    }\n\n    /**\n     * Initializes a new history record for undo/redo\n     * \n     * @return null\n     */\n    obj.setHistory = function(changes) {\n        if (obj.ignoreHistory != true) {\n            // Increment and get the current history index\n            var index = ++obj.historyIndex;\n\n            // Slice the array to discard undone changes\n            obj.history = (obj.history = obj.history.slice(0, index + 1));\n\n            // Keep history\n            obj.history[index] = changes;\n        }\n    }\n\n    /**\n     * Copy method\n     * \n     * @param bool highlighted - Get only highlighted cells\n     * @param delimiter - \\t default to keep compatibility with excel\n     * @return string value\n     */\n    obj.copy = function(highlighted, delimiter, returnData) {\n        if (! delimiter) {\n            delimiter = \"\\t\";\n        }\n\n        // Controls\n        var col = [];\n        var colLabel = [];\n        var row = [];\n        var rowLabel = [];\n        var x = obj.options.data[0].length\n        var y = obj.options.data.length\n        var tmp = '';\n\n        // Reset container\n        obj.style = [];\n\n        // Go through the columns to get the data\n        for (var j = 0; j < y; j++) {\n            col = [];\n            colLabel = [];\n\n            for (var i = 0; i < x; i++) {\n                // If cell is highlighted\n                if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                    // Values\n                    var value = obj.options.data[j][i];\n                    if (value.match && (value.match(/,/g) || value.match(/\\n/) || value.match(/\\\"/))) {\n                        value = value.replace(new RegExp('\"', 'g'), '\"\"');\n                        value = '\"' + value + '\"';\n                    }\n                    col.push(value);\n\n                    // Labels\n                    if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\r\n                        var label = value;\n                    } else {\r\n                        var label = obj.records[j][i].innerHTML;\n                        if (label.match && (label.match(/,/g) || label.match(/\\n/) || label.match(/\\\"/))) {\n                            // Scape double quotes\n                            label = label.replace(new RegExp('\"', 'g'), '\"\"');\n                            label = '\"' + label + '\"';\n                        }\r\n                    }\n                    colLabel.push(label);\n\n                    // Get style\n                    tmp = obj.records[j][i].getAttribute('style');\n                    obj.style.push(tmp ? tmp : '');\n                }\n            }\n\n            if (col.length) {\n                row.push(col.join(delimiter));\n            }\n            if (colLabel.length) {\n                rowLabel.push(colLabel.join(delimiter));\n            }\n        }\n\n        // Final string\n        var str = row.join(\"\\r\\n\");\n        var strLabel = rowLabel.join(\"\\r\\n\");\n\n        // Create a hidden textarea to copy the values\n        if (! returnData) {\n            if (obj.options.copyCompatibility == true) {\n                obj.textarea.value = strLabel;\n            } else {\n                obj.textarea.value = str;\n            }\n            obj.textarea.select();\n            document.execCommand(\"copy\");\n        }\n\n        // Keep data\n        if (obj.options.copyCompatibility == true) {\n            obj.data = strLabel;\n        } else {\n        obj.data = str;\n        }\n        // Keep non visible information\n        obj.hashString = obj.hash(obj.data);\n\n        return obj.data;\n    }\n\n    /**\n     * jExcel paste method\n     * \n     * @param integer row number\n     * @return string value\n     */\n    obj.paste = function(x, y, data) {\n        // Paste filter\n        if (typeof(obj.options.onbeforepaste) == 'function') {\n            var data = obj.options.onbeforepaste(el, data);\n        }\n\n        // Controls\n        var hash = obj.hash(data);\n        var style = (hash == obj.hashString) ? obj.style : null;\n\n        // Depending on the behavior\n        if (obj.options.copyCompatibility == true && hash == obj.hashString) {\n            var data = obj.data;\n        }\n\n        // Split new line\n        var data = obj.parseCSV(data, \"\\t\");\n\n        if (x != null && y != null && data) {\n            // Records\n            var i = 0;\n            var j = 0;\n            var records = [];\n            var newStyle = {};\n            var oldStyle = {};\n            var styleIndex = 0;\n\n            // Index\n            var colIndex = parseInt(x);\n            var rowIndex = parseInt(y);\n            var row = null;\n\n            // Go through the columns to get the data\n            while (row = data[j]) {\n                i = 0;\n                colIndex = parseInt(x);\n\n                while (row[i] != null) {\n                    // Update and keep history\n                    var record = obj.updateCell(colIndex, rowIndex, row[i]);\n                    // Keep history\n                    records.push(record);\n                    // Update all formulas in the chain\n                    obj.updateFormulaChain(colIndex, rowIndex, records);\n                    // Style\n                    if (style && style[styleIndex]) {\n                        var columnName = jexcel.getColumnNameFromId([colIndex, rowIndex]);\n                        newStyle[columnName] = style[styleIndex];\n                        oldStyle[columnName] = obj.getStyle(columnName);\n                        obj.records[rowIndex][colIndex].setAttribute('style', style[styleIndex]);\n                        styleIndex++\n                    }\n                    i++;\n                    if (row[i] != null) {\n                        if (colIndex >= obj.headers.length - 1) {\n                            obj.insertColumn();\n                        }\n                        colIndex = obj.right.get(colIndex, rowIndex);\n                    }\n                }\n\n                j++;\n                if (data[j]) {\n                    if (rowIndex >= obj.rows.length-1) {\n                        obj.insertRow();\n                    }\n                    rowIndex = obj.down.get(x, rowIndex);\n                }\n            }\n\n            // Select the new cells\n            obj.updateSelectionFromCoords(x, y, colIndex, rowIndex);\n\n            // Update history\n            obj.setHistory({\n                action:'setValue',\n                records:records,\n                selection:obj.selectedCell,\n                newStyle:newStyle,\n                oldStyle:oldStyle,\n            });\n\n            // Update table\n            obj.updateTable();\n\n            // Paste event\n            if (typeof(obj.options.onpaste) == 'function') {\n                obj.options.onpaste(el, records);\n            }\n\n            // On after changes\n            obj.onafterchanges(el, records);\n        }\n    }\n\n    /**\n     * Process row\n     */\n    obj.historyProcessRow = function(type, historyRecord) {\n        var rowIndex = (! historyRecord.insertBefore) ? historyRecord.rowNumber + 1 : historyRecord.rowNumber;\n\n        if (obj.options.search == true) {\n            if (obj.results && obj.results.length != obj.rows.length) {\n                obj.resetSearch();\n            }\n        }\n\n        // Remove row\n        if (type == 1) {\n            var numOfRows = historyRecord.numOfRows;\n            // Remove nodes\n            for (var j = rowIndex; j < (numOfRows + rowIndex); j++) {\n                obj.rows[j].parentNode.removeChild(obj.rows[j]);\n            }\n            // Remove references\n            obj.records.splice(rowIndex, numOfRows);\n            obj.options.data.splice(rowIndex, numOfRows);\n            obj.rows.splice(rowIndex, numOfRows);\n\n            obj.conditionalSelectionUpdate(1, rowIndex, (numOfRows + rowIndex) - 1);\n        } else {\n            // Insert data\n            obj.records = jexcel.injectArray(obj.records, rowIndex, historyRecord.rowRecords);\n            obj.options.data = jexcel.injectArray(obj.options.data, rowIndex, historyRecord.rowData);\n            obj.rows = jexcel.injectArray(obj.rows, rowIndex, historyRecord.rowNode);\n            // Insert nodes\n            var index = 0\n            for (var j = rowIndex; j < (historyRecord.numOfRows + rowIndex); j++) {\n                obj.tbody.insertBefore(historyRecord.rowNode[index], obj.tbody.children[j]);\n                index++;\n            }\n        }\n\n        // Respect pagination\n        if (obj.options.pagination > 0) {\n            obj.page(obj.pageNumber);\n        }\n\n        obj.updateTableReferences();\n    }\n\n    /**\n     * Process column\n     */\n    obj.historyProcessColumn = function(type, historyRecord) {\n        var columnIndex = (! historyRecord.insertBefore) ? historyRecord.columnNumber + 1 : historyRecord.columnNumber;\n\n        // Remove column\n        if (type == 1) {\n            var numOfColumns = historyRecord.numOfColumns;\n\n            obj.options.columns.splice(columnIndex, numOfColumns);\n            for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\n                obj.headers[i].parentNode.removeChild(obj.headers[i]);\n                obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]);\n            }\n            obj.headers.splice(columnIndex, numOfColumns);\n            obj.colgroup.splice(columnIndex, numOfColumns);\n            for (var j = 0; j < historyRecord.data.length; j++) {\n                for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\n                    obj.records[j][i].parentNode.removeChild(obj.records[j][i]);\n                }\n                obj.records[j].splice(columnIndex, numOfColumns);\n                obj.options.data[j].splice(columnIndex, numOfColumns);\n            }\n\n            obj.conditionalSelectionUpdate(0, columnIndex, (numOfColumns + columnIndex) - 1);\n        } else {\n            // Insert data\n            obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, historyRecord.columns);\n            obj.headers = jexcel.injectArray(obj.headers, columnIndex, historyRecord.headers);\n            obj.colgroup = jexcel.injectArray(obj.colgroup, columnIndex, historyRecord.colgroup);\n\n            var index = 0\n            for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\n                obj.headerContainer.insertBefore(historyRecord.headers[index], obj.headerContainer.children[i+1]);\n                obj.colgroupContainer.insertBefore(historyRecord.colgroup[index], obj.colgroupContainer.children[i+1]);\n                index++;\n            }\n\n            for (var j = 0; j < historyRecord.data.length; j++) {\n                obj.options.data[j] = jexcel.injectArray(obj.options.data[j], columnIndex, historyRecord.data[j]);\n                obj.records[j] = jexcel.injectArray(obj.records[j], columnIndex, historyRecord.records[j]);\n                var index = 0\n                for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\n                    obj.rows[j].insertBefore(historyRecord.records[j][index], obj.rows[j].children[i+1]);\n                    index++;\n                }\n            }\n        }\n\n        // Adjust nested headers\n        if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n            // Flexible way to handle nestedheaders\n            if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                    if (type == 1) {\n                        var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - historyRecord.numOfColumns;\n                    } else {\n                        var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + historyRecord.numOfColumns;\n                    }\n                    obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                    obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                }\n            } else {\n                if (type == 1) {\n                    var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - historyRecord.numOfColumns;\n                } else {\n                    var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + historyRecord.numOfColumns;\n                }\n                obj.options.nestedHeaders[0].colspan = colspan;\n                obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n            }\n        }\n\n        obj.updateTableReferences();\n    }\n\n    /**\n     * Undo last action\n     */\n    obj.undo = function() {\n        // Ignore events and history\n        var ignoreEvents = obj.ignoreEvents ? true : false;\n        var ignoreHistory = obj.ignoreHistory ? true : false;\n\n        obj.ignoreEvents = true;\n        obj.ignoreHistory = true;\n\n        // Records\n        var records = [];\n\n        // Update cells\n        if (obj.historyIndex >= 0) {\n            // History\n            var historyRecord = obj.history[obj.historyIndex--];\n\n            if (historyRecord.action == 'insertRow') {\n                obj.historyProcessRow(1, historyRecord);\n            } else if (historyRecord.action == 'deleteRow') {\n                obj.historyProcessRow(0, historyRecord);\n            } else if (historyRecord.action == 'insertColumn') {\n                obj.historyProcessColumn(1, historyRecord);\n            } else if (historyRecord.action == 'deleteColumn') {\n                obj.historyProcessColumn(0, historyRecord);\n            } else if (historyRecord.action == 'moveRow') {\n                obj.moveRow(historyRecord.newValue, historyRecord.oldValue);\n            } else if (historyRecord.action == 'moveColumn') {\n                obj.moveColumn(historyRecord.newValue, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setMerge') {\n                obj.removeMerge(historyRecord.column, historyRecord.data);\n            } else if (historyRecord.action == 'setStyle') {\n                obj.setStyle(historyRecord.oldValue, null, null, 1);\n            } else if (historyRecord.action == 'setWidth') {\n                obj.setWidth(historyRecord.column, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setHeight') {\n                obj.setHeight(historyRecord.row, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setHeader') {\n                obj.setHeader(historyRecord.column, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setComments') {\n                obj.setComments(historyRecord.column, historyRecord.oldValue[0], historyRecord.oldValue[1]);\n            } else if (historyRecord.action == 'orderBy') {\n                var rows = [];\n                for (var j = 0; j < historyRecord.rows.length; j++) {\n                    rows[historyRecord.rows[j]] = j;\n                }\n                obj.updateOrderArrow(historyRecord.column, historyRecord.order ? 0 : 1);\n                obj.updateOrder(rows);\n            } else if (historyRecord.action == 'setValue') {\n                // Redo for changes in cells\n                for (var i = 0; i < historyRecord.records.length; i++) {\n                    obj.updateCell(historyRecord.records[i].col, historyRecord.records[i].row, historyRecord.records[i].oldValue);\n                    obj.updateFormulaChain(historyRecord.records[i].col, historyRecord.records[i].row, records);\n                    if (historyRecord.oldStyle) {\n                        obj.resetStyle(historyRecord.oldStyle, true);\n                    }\n                }\n                // Update selection\n                if (! historyRecord.selection) {\n                    historyRecord.selection = [historyRecord.records[0].col, historyRecord.records[0].row];\n                }\n                obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\n                // Update table\n                obj.updateTable();\n            }\n        }\n        obj.ignoreEvents = ignoreEvents;\n        obj.ignoreHistory = ignoreHistory;\n\n        if (typeof(obj.options.onundo) == 'function') {\n            obj.options.onundo(el, historyRecord);\n        }\n    }\n\n    /**\n     * Redo previously undone action\n     */\n    obj.redo = function() {\n        // Ignore events and history\n        var ignoreEvents = obj.ignoreEvents ? true : false;\n        var ignoreHistory = obj.ignoreHistory ? true : false;\n\n        obj.ignoreEvents = true;\n        obj.ignoreHistory = true;\n\n        // Records\n        var records = [];\n\n        // Update cells\n        if (obj.historyIndex < obj.history.length - 1) {\n            // History\n            var historyRecord = obj.history[++obj.historyIndex];\n\n            if (historyRecord.action == 'insertRow') {\n                obj.historyProcessRow(0, historyRecord);\n            } else if (historyRecord.action == 'deleteRow') {\n                obj.historyProcessRow(1, historyRecord);\n            } else if (historyRecord.action == 'insertColumn') {\n                obj.historyProcessColumn(0, historyRecord);\n            } else if (historyRecord.action == 'deleteColumn') {\n                obj.historyProcessColumn(1, historyRecord);\n            } else if (historyRecord.action == 'moveRow') {\n                obj.moveRow(historyRecord.oldValue, historyRecord.newValue);\n            } else if (historyRecord.action == 'moveColumn') {\n                obj.moveColumn(historyRecord.oldValue, historyRecord.newValue);\n            } else if (historyRecord.action == 'setMerge') {\n                obj.setMerge(historyRecord.column, historyRecord.colspan, historyRecord.rowspan, 1);\n            } else if (historyRecord.action == 'setStyle') {\n                obj.setStyle(historyRecord.newValue, null, null, 1);\n            } else if (historyRecord.action == 'setWidth') {\n                obj.setWidth(historyRecord.column, historyRecord.newValue);\n            } else if (historyRecord.action == 'setHeight') {\n                obj.setHeight(historyRecord.row, historyRecord.newValue);\n            } else if (historyRecord.action == 'setHeader') {\n                obj.setHeader(historyRecord.column, historyRecord.newValue);\n            } else if (historyRecord.action == 'setComments') {\n                obj.setComments(historyRecord.column, historyRecord.newValue[0], historyRecord.newValue[1]);\n            } else if (historyRecord.action == 'orderBy') {\n                obj.updateOrderArrow(historyRecord.column, historyRecord.order);\n                obj.updateOrder(historyRecord.rows);\n            } else if (historyRecord.action == 'setValue') {\n                // Redo for changes in cells\n                for (var i = 0; i < historyRecord.records.length; i++) {\n                    obj.updateCell(historyRecord.records[i].col, historyRecord.records[i].row, historyRecord.records[i].newValue);\n                    obj.updateFormulaChain(historyRecord.records[i].col, historyRecord.records[i].row, records);\n                    if (historyRecord.newStyle) {\n                        obj.resetStyle(historyRecord.newStyle, true);\n                    }\n                }\n\n                // Update selection\n                if (! historyRecord.selection) {\n                    historyRecord.selection = [historyRecord.records[0].col, historyRecord.records[0].row];\n                }\n                obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\n                // Update table\n                obj.updateTable();\n            }\n        }\n        obj.ignoreEvents = ignoreEvents;\n        obj.ignoreHistory = ignoreHistory;\n\n        if (typeof(obj.options.onredo) == 'function') {\n            obj.options.onredo(el, historyRecord);\n        }\n    }\n\n    /**\n     * Get dropdown value from key\n     */\n    obj.getDropDownValue = function(column, key) {\n        var value = [];\n\n        if (obj.options.columns[column] && obj.options.columns[column].source) {\n            // Create array from source\n            var combo = [];\n            var source = obj.options.columns[column].source;\n\n            for (var i = 0; i < source.length; i++) {\n                if (typeof(source[i]) == 'object') {\n                    combo[source[i].id] = source[i].name;\n                } else {\n                    combo[source[i]] = source[i];\n                }\n            }\n\n            // Garante single multiple compatibily\n            var keys = ('' + key).split(';')\n\n            for (var i = 0; i < keys.length; i++) {\n                if (combo[keys[i]]) {\n                    value.push(combo[keys[i]]);\n                }\n            }\n        } else {\n            console.error('Invalid column');\n        }\n\n        return (value.length > 0) ? value.join('; ') : '';\n    }\n\n    /**\n     * From starckoverflow contributions\n     */\n    obj.parseCSV = function(str, delimiter) {\n        // Remove last line break\n        str = str.replace(/\\r?\\n$|\\r$|\\n$/g, \"\");\n        // Last caracter is the delimiter\n        if (str.charCodeAt(str.length-1) == 9) {\n            str += \"\\0\";\n        }\n        // user-supplied delimeter or default comma\n        delimiter = (delimiter || \",\");\n\n        var arr = [];\n        var quote = false;  // true means we're inside a quoted field\n        // iterate over each character, keep track of current row and column (of the returned array)\n        for (var row = 0, col = 0, c = 0; c < str.length; c++) {\n            var cc = str[c], nc = str[c+1];\n            arr[row] = arr[row] || [];\n            arr[row][col] = arr[row][col] || '';\n\n            // If the current character is a quotation mark, and we're inside a quoted field, and the next character is also a quotation mark, add a quotation mark to the current column and skip the next character\n            if (cc == '\"' && quote && nc == '\"') { arr[row][col] += cc; ++c; continue; }  \n\n            // If it's just one quotation mark, begin/end quoted field\n            if (cc == '\"') { quote = !quote; continue; }\n\n            // If it's a comma and we're not in a quoted field, move on to the next column\n            if (cc == delimiter && !quote) { ++col; continue; }\n\n            // If it's a newline (CRLF) and we're not in a quoted field, skip the next character and move on to the next row and move to column 0 of that new row\n            if (cc == '\\r' && nc == '\\n' && !quote) { ++row; col = 0; ++c; continue; }\n\n            // If it's a newline (LF or CR) and we're not in a quoted field, move on to the next row and move to column 0 of that new row\n            if (cc == '\\n' && !quote) { ++row; col = 0; continue; }\n            if (cc == '\\r' && !quote) { ++row; col = 0; continue; }\n\n            // Otherwise, append the current character to the current column\n            arr[row][col] += cc;\n        }\n        return arr;\n    }\n\n    obj.hash = function(str) {\n        var hash = 0, i, chr;\n\n        if (str.length === 0) {\n            return hash;\n        } else {\n            for (i = 0; i < str.length; i++) {\n              chr = str.charCodeAt(i);\n              hash = ((hash << 5) - hash) + chr;\n              hash |= 0;\n            }\n        }\n        return hash;\n    }\n\n    obj.onafterchanges = function(el, records) {\n        if (! obj.ignoreEvents) {\n            // On after changes\n            if (typeof(obj.options.onafterchanges) == 'function') {\n                obj.options.onafterchanges(el, records);\n            }\n        }\n    }\r\n\n    obj.destroy = function() {\r\n        jexcel.destroy(el);\r\n    }\r\n\n    /**\n     * Initialization method\n     */\n    obj.init = function() {\n        jexcel.current = obj;\n\n        // Build handlers\n        if (typeof(jexcel.build) == 'function') {\n            jexcel.build();\n            jexcel.build = null;\n        }\n\n        // Load the table data based on an CSV file\n        if (obj.options.csv) {\n            // Loading\n            if (obj.options.loadingSpin == true) {\n                jSuites.loading.show();\n            }\n\n            // Load CSV file\n            jSuites.ajax({\n                url: obj.options.csv,\n                method: 'GET',\n                dataType: 'text',\n                success: function(result) {\n                    // Convert data\n                    var newData = obj.parseCSV(result, obj.options.csvDelimiter)\n\n                    // Headers\n                    if (obj.options.csvHeaders == true && newData.length > 0) {\n                        var headers = newData.shift();\n                        for(var i = 0; i < headers.length; i++) {\n                            if (! obj.options.columns[i]) {\n                                obj.options.columns[i] = { type:'text', align:obj.options.defaultColAlign, width:obj.options.defaultColWidth };\n                            }\n                            // Precedence over pre-configurated titles\n                            if (typeof obj.options.columns[i].title === 'undefined') {\n                              obj.options.columns[i].title = headers[i];\n                            }\n                        }\n                    }\n                    // Data\n                    obj.options.data = newData;\n                    // Prepare table\n                    obj.prepareTable();\n                    // Hide spin\n                    if (obj.options.loadingSpin == true) {\n                        jSuites.loading.hide();\n                    }\n                }\n            });\n        } else if (obj.options.url) {\n            // Loading\n            if (obj.options.loadingSpin == true) {\n                jSuites.loading.show();\n            }\n\n            jSuites.ajax({\n                url: obj.options.url,\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    // Data\n                    obj.options.data = (result.data) ? result.data : result;\n                    // Prepare table\n                    obj.prepareTable();\n                    // Hide spin\n                    if (obj.options.loadingSpin == true) {\n                        jSuites.loading.hide();\n                    }\n                }\n            });\n        } else {\n            // Prepare table\n            obj.prepareTable();\n        }\n    }\n\n    // Context menu\n    if (options && options.contextMenu != null) {\n        obj.options.contextMenu = options.contextMenu;\n    } else {\n        obj.options.contextMenu = function(el, x, y, e) {\n            var items = [];\n\n            if (y == null) {\n                // Insert a new column\n                if (obj.options.allowInsertColumn == true) {\n                    items.push({\n                        title:obj.options.text.insertANewColumnBefore,\n                        onclick:function() {\n                            obj.insertColumn(1, parseInt(x), 1);\n                        }\n                    });\n                }\n\n                if (obj.options.allowInsertColumn == true) {\n                    items.push({\n                        title:obj.options.text.insertANewColumnAfter,\n                        onclick:function() {\n                            obj.insertColumn(1, parseInt(x), 0);\n                        }\n                    });\n                }\n\n                // Delete a column\n                if (obj.options.allowDeleteColumn == true) {\n                    items.push({\n                        title:obj.options.text.deleteSelectedColumns,\n                        onclick:function() {\n                            obj.deleteColumn(obj.getSelectedColumns().length ? undefined : parseInt(x));\n                        }\n                    });\n                }\n\n                // Rename column\n                if (obj.options.allowRenameColumn == true) {\n                    items.push({\n                        title:obj.options.text.renameThisColumn,\n                        onclick:function() {\n                            obj.setHeader(x);\n                        }\n                    });\n                }\n\n                // Sorting\n                if (obj.options.columnSorting == true) {\n                    // Line\n                    items.push({ type:'line' });\n\n                    items.push({\n                        title:obj.options.text.orderAscending,\n                        onclick:function() {\n                            obj.orderBy(x, 0);\n                        }\n                    });\n                    items.push({\n                        title:obj.options.text.orderDescending,\n                        onclick:function() {\n                            obj.orderBy(x, 1);\n                        }\n                    });\n                }\n            } else {\n                // Insert new row\n                if (obj.options.allowInsertRow == true) {\n                    items.push({\n                        title:obj.options.text.insertANewRowBefore,\n                        onclick:function() {\n                            obj.insertRow(1, parseInt(y), 1);\n                        }\n                    });\n\n                    items.push({\n                        title:obj.options.text.insertANewRowAfter,\n                        onclick:function() {\n                            obj.insertRow(1, parseInt(y));\n                        }\n                    });\n                }\n\n                if (obj.options.allowDeleteRow == true) {\n                    items.push({\n                        title:obj.options.text.deleteSelectedRows,\n                        onclick:function() {\n                            obj.deleteRow(obj.getSelectedRows().length ? undefined : parseInt(y));\n                        }\n                    });\n                }\n\n                if (x) {\n                    if (obj.options.allowComments == true) {\n                        items.push({ type:'line' });\n\n                        var title = obj.records[y][x].getAttribute('title') || '';\n\n                        items.push({\n                            title: title ? obj.options.text.editComments : obj.options.text.addComments,\n                            onclick:function() {\n                                var comment = prompt(obj.options.text.comments, title);\r\n                                if (comment) {\r\n                                    obj.setComments([ x, y ], comment);\r\n                                }\n                            }\n                        });\n\n                        if (title) {\n                            items.push({\n                                title:obj.options.text.clearComments,\n                                onclick:function() {\n                                    obj.setComments([ x, y ], '');\n                                }\n                            });\n                        }\n                    }\n                }\n            }\n\n            // Line\n            items.push({ type:'line' });\n\n            // Copy\n            items.push({\n                title:obj.options.text.copy,\n                shortcut:'Ctrl + C',\n                onclick:function() {\n                    obj.copy(true);\n                }\n            });\n\n            // Paste\n            if (navigator && navigator.clipboard) {\n                items.push({\n                    title:obj.options.text.paste,\n                    shortcut:'Ctrl + V',\n                    onclick:function() {\n                        if (obj.selectedCell) {\n                            navigator.clipboard.readText().then(function(text) {\n                                if (text) {\n                                    jexcel.current.paste(obj.selectedCell[0], obj.selectedCell[1], text);\n                                }\n                            });\n                        }\n                    }\n                });\n            }\n\n            // Save\n            if (obj.options.allowExport) {\n                items.push({\n                    title: obj.options.text.saveAs,\n                    shortcut: 'Ctrl + S',\n                    onclick: function () {\n                        obj.download();\n                    }\n                });\n            }\n\n            // About\n            if (obj.options.about) {\n                items.push({\n                    title:obj.options.text.about,\n                    onclick:function() {\n                        alert(obj.options.about);\n                    }\n                });\n            }\n\n            return items;\n        }\n    }\n\n    obj.scrollControls = function(e) {\n        if (obj.options.lazyLoading == true) {\n            if (jexcel.timeControlLoading == null) {\n                jexcel.timeControlLoading = setTimeout(function() {\n                    if (obj.content.scrollTop + obj.content.clientHeight >= obj.content.scrollHeight) {\n                        if (obj.loadDown()) {\n                            if (obj.content.scrollTop + obj.content.clientHeight > obj.content.scrollHeight - 10) {\n                                obj.content.scrollTop = obj.content.scrollTop - obj.content.clientHeight;\n                            }\n                            obj.updateCornerPosition();\n                        }\n                    } else if (obj.content.scrollTop <= obj.content.clientHeight) {\n                        if (obj.loadUp()) {\n                            if (obj.content.scrollTop < 10) {\n                                obj.content.scrollTop = obj.content.scrollTop + obj.content.clientHeight;\n                            }\n                            obj.updateCornerPosition();\n                        }\n                    }\n\n                    jexcel.timeControlLoading = null;\n                }, 100);\n            }\n        }\n\n        // Close editor\n        if (obj.options.lazyLoading == true || obj.options.tableOverflow == true) {\n            if (obj.edition && e.target.className.substr(0,9) != 'jdropdown') {\n                obj.closeEditor(obj.edition[0], true);\n            }\n        }\n    }\n\n    el.addEventListener(\"DOMMouseScroll\", obj.scrollControls);\n    el.addEventListener(\"mousewheel\", obj.scrollControls);\n\n    el.jexcel = obj;\n\n    obj.init();\n\n    return obj;\n});\n\njexcel.current = null;\njexcel.timeControl = null;\njexcel.timeControlLoading = null;\n\njexcel.destroy = function(element, destroyEventHandlers) {\n    if (element.jexcel) {\n        element.removeEventListener(\"DOMMouseScroll\", element.jexcel.scrollControls);\n        element.removeEventListener(\"mousewheel\", element.jexcel.scrollControls);\n        element.jexcel = null;\n        element.innerHTML = '';\n\n        if (destroyEventHandlers) {\n            document.removeEventListener(\"keydown\", jexcel.keyDownControls);\n            document.removeEventListener(\"mouseup\", jexcel.mouseUpControls);\n            document.removeEventListener(\"mousedown\", jexcel.mouseDownControls);\n            document.removeEventListener(\"mousemove\", jexcel.mouseMoveControls);\n            document.removeEventListener(\"mouseover\", jexcel.mouseOverControls);\n            document.removeEventListener(\"dblclick\", jexcel.doubleClickControls);\n            document.removeEventListener(\"paste\", jexcel.pasteControls);\n            document.removeEventListener(\"contextmenu\", jexcel.contextMenuControls);\n            document.removeEventListener(\"touchstart\", jexcel.touchStartControls);\n            document.removeEventListener(\"touchend\", jexcel.touchEndControls);\n            document.removeEventListener(\"touchcancel\", jexcel.touchEndControls);\n            jexcel = null;\n        }\n    }\n}\n\njexcel.build = function() {\n    document.addEventListener(\"keydown\", jexcel.keyDownControls);\n    document.addEventListener(\"mouseup\", jexcel.mouseUpControls);\n    document.addEventListener(\"mousedown\", jexcel.mouseDownControls);\n    document.addEventListener(\"mousemove\", jexcel.mouseMoveControls);\n    document.addEventListener(\"mouseover\", jexcel.mouseOverControls);\n    document.addEventListener(\"dblclick\", jexcel.doubleClickControls);\n    document.addEventListener(\"paste\", jexcel.pasteControls);\n    document.addEventListener(\"contextmenu\", jexcel.contextMenuControls);\n    document.addEventListener(\"touchstart\", jexcel.touchStartControls);\n    document.addEventListener(\"touchend\", jexcel.touchEndControls);\n    document.addEventListener(\"touchcancel\", jexcel.touchEndControls);\n    document.addEventListener(\"touchmove\", jexcel.touchEndControls);\n}\n\n/**\n * Events\n */\njexcel.keyDownControls = function(e) {\n    if (jexcel.current) {\n        if (jexcel.current.edition) {\n            if (e.which == 27) {\n                // Escape\n                if (jexcel.current.edition) {\n                    // Exit without saving\n                    jexcel.current.closeEditor(jexcel.current.edition[0], false);\n                }\n                e.preventDefault();\n            } else if (e.which == 13) {\n                // Enter\n                if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\n                    jexcel.current.editor[0].children[0].calendar.close(1);\n                } else if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'dropdown' ||\n                           jexcel.current.options.columns[jexcel.current.edition[2]].type == 'autocomplete') {\n                    // Do nothing\n                } else {\n                    // Alt enter -> do not close editor\n                    if ((jexcel.current.options.wordWrap == true ||\n                         jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap == true ||\n                         jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length > 200) && e.altKey) {\n                        // Add new line to the editor\n                        var editorTextarea = jexcel.current.edition[0].children[0];\n                        var editorValue = jexcel.current.edition[0].children[0].value;\n                        var editorIndexOf = editorTextarea.selectionStart;\n                        editorValue = editorValue.slice(0, editorIndexOf) + \"\\n\" + editorValue.slice(editorIndexOf);\n                        editorTextarea.value = editorValue;\n                        editorTextarea.focus();\n                        editorTextarea.selectionStart = editorIndexOf + 1;\n                        editorTextarea.selectionEnd = editorIndexOf + 1;\n                    } else {\n                        jexcel.current.edition[0].children[0].blur();\n                    }\n                }\n            } else if (e.which == 9) {\n                // Tab\n                if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\n                    jexcel.current.edition[0].children[0].calendar.close(1);\n                } else {\n                    jexcel.current.edition[0].children[0].blur();\n                }\n            }\n        }\n\n        if (! jexcel.current.edition && jexcel.current.selectedCell) {\n            // Which key\n            if (e.which == 37) {\n                jexcel.current.left(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 39) {\n                jexcel.current.right(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 38) {\n                jexcel.current.up(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 40) {\n                jexcel.current.down(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 36) {\n                jexcel.current.first(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 35) {\n                jexcel.current.last(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 32) {\n                if (jexcel.current.options.editable == true) {\n                    jexcel.current.setCheckRadioValue();\n                }\n                e.preventDefault();\n            } else if (e.which == 46) {\n                // Delete\n                if (jexcel.current.options.editable == true) {\n                    if (jexcel.current.selectedRow) {\n                        if (jexcel.current.options.allowDeleteRow == true) {\n                            if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)) {\n                                jexcel.current.deleteRow();\n                            }\n                        }\n                    } else if (jexcel.current.selectedHeader) {\n                        if (jexcel.current.options.allowDeleteColumn == true) {\n                            if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)) {\n                                jexcel.current.deleteColumn();\n                            }\n                        }\n                    } else {\n                        // Change value\n                        jexcel.current.setValue(jexcel.current.highlighted, '');\n                    }\n                }\n            } else if (e.which == 13) {\n                // Move cursor\n                if (e.shiftKey) {\n                    jexcel.current.up();\n                } else {\n                    if (jexcel.current.options.allowInsertRow == true) {\n                        if (jexcel.current.options.allowManualInsertRow == true) {\n                            if (jexcel.current.selectedCell[1] == jexcel.current.options.data.length - 1) {\n                                // New record in case selectedCell in the last row\n                                jexcel.current.insertRow();\n                            }\n                        }\n                    }\n\n                    jexcel.current.down();\n                }\n                e.preventDefault();\n            } else if (e.which == 9) {\n                // Tab\n                if (e.shiftKey) {\n                    jexcel.current.left();\n                } else {\n                    if (jexcel.current.options.allowInsertColumn == true) {\n                        if (jexcel.current.options.allowManualInsertColumn == true) {\n                            if (jexcel.current.selectedCell[0] == jexcel.current.options.data[0].length - 1) {\n                                // New record in case selectedCell in the last column\n                                jexcel.current.insertColumn();\n                            }\n                        }\n                    }\n\n                    jexcel.current.right();\n                }\n                e.preventDefault();\n            } else {\n                if ((e.ctrlKey || e.metaKey) && ! e.shiftKey) {\n                    if (e.which == 65) {\n                        // Ctrl + A\n                        jexcel.current.selectAll();\n                        e.preventDefault();\n                    } else if (e.which == 83) {\n                        // Ctrl + S\n                        jexcel.current.download();\n                        e.preventDefault();\n                    } else if (e.which == 89) {\n                        // Ctrl + Y\n                        jexcel.current.redo();\n                        e.preventDefault();\n                    } else if (e.which == 90) {\n                        // Ctrl + Z\n                        jexcel.current.undo();\n                        e.preventDefault();\n                    } else if (e.which == 67) {\n                        // Ctrl + C\n                        jexcel.current.copy(true);\n                        e.preventDefault();\n                    } else if (e.which == 67) {\n                        // Ctrl + C\n                        jexcel.current.copy(true);\n                        e.preventDefault();\n                    } else if (e.which == 88) {\n                        // Ctrl + X\n                        if (jexcel.current.options.editable == true) {\n                            jexcel.cutControls();\n                        } else {\n                            jexcel.copyControls();\n                        }\n                        e.preventDefault();\n                    } else if (e.which == 86) {\n                        // Ctrl + V\n                        jexcel.pasteControls();\n                    }\n                } else {\n                    if (jexcel.current.selectedCell) {\n                        if (jexcel.current.options.editable == true) {\n                            var rowId = jexcel.current.selectedCell[1];\n                            var columnId = jexcel.current.selectedCell[0];\n\n                            // If is not readonly\n                            if (jexcel.current.options.columns[columnId].type != 'readonly') {\n                                // Characters able to start a edition\n                                if (e.keyCode == 32) {\n                                    // Space\n                                    if (jexcel.current.options.columns[columnId].type == 'checkbox' ||\n                                        jexcel.current.options.columns[columnId].type == 'radio') {\n                                        e.preventDefault();\n                                    } else {\n                                        // Start edition\n                                        jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\n                                    }\n                                } else if (e.keyCode == 113) {\n                                    // Start edition with current content F2\n                                    jexcel.current.openEditor(jexcel.current.records[rowId][columnId], false);\n                                } else if ((e.keyCode == 8) ||\n                                           (e.keyCode >= 48 && e.keyCode <= 57) ||\n                                           (e.keyCode >= 96 && e.keyCode <= 111) ||\n                                           (e.keyCode == 187) ||\n                                           (e.keyCode == 189) ||\n                                           ((String.fromCharCode(e.keyCode) == e.key || String.fromCharCode(e.keyCode).toLowerCase() == e.key.toLowerCase()) && jexcel.validLetter(String.fromCharCode(e.keyCode)))) {\n                                    // Start edition\n                                    jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\n                                    // Prevent entries in the calendar\n                                    if (jexcel.current.options.columns[columnId].type == 'calendar') {\n                                        e.preventDefault();\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        } else {\n            if (e.target.classList.contains('jexcel_search')) {\n                if (jexcel.timeControl) {\n                    clearTimeout(jexcel.timeControl);\n                }\n\n                jexcel.timeControl = setTimeout(function() {\n                    jexcel.current.search(e.target.value);\n                }, 200);\n            }\n        }\n    }\n}\n\njexcel.isMouseAction = false;\n\njexcel.mouseDownControls = function(e) {\n    e = e || window.event;\n    if (e.buttons) {\n        var mouseButton = e.buttons;\n    } else if (e.button) {\n        var mouseButton = e.button;\n    } else {\n        var mouseButton = e.which;\n    }\n\n    // Get elements\n    var jexcelTable = jexcel.getElement(e.target);\n\n    if (jexcelTable[0]) {\n        if (jexcel.current != jexcelTable[0].jexcel) {\n            if (jexcel.current) {\n                jexcel.current.resetSelection();\n            }\n            jexcel.current = jexcelTable[0].jexcel;\n        }\n    } else {\n        if (jexcel.current) {\n            jexcel.current.resetSelection(true);\n            jexcel.current = null;\n        }\n    }\n\n    if (jexcel.current && mouseButton == 1) {\n        if (e.target.classList.contains('jexcel_selectall')) {\n            if (jexcel.current) {\n                jexcel.current.selectAll();\n            }\n        } else if (e.target.classList.contains('jexcel_corner')) {\n            if (jexcel.current.options.editable == true) {\n                jexcel.current.selectedCorner = true;\n            }\n        } else {\n            // Header found\n            if (jexcelTable[1] == 1) {\n                var columnId = e.target.getAttribute('data-x');\n                if (columnId) {\n                    // Update cursor\n                    var info = e.target.getBoundingClientRect();\n                    if (jexcel.current.options.columnResize == true && info.width - e.offsetX < 6) {\n                        // Resize helper\n                        jexcel.current.resizing = {\n                            mousePosition: e.pageX,\n                            column: columnId,\n                            width: info.width,\n                        };\n\n                        // Border indication\n                        jexcel.current.headers[columnId].classList.add('resizing');\n                        for (var j = 0; j < jexcel.current.records.length; j++) {\n                            if (jexcel.current.records[j][columnId]) {\n                                jexcel.current.records[j][columnId].classList.add('resizing');\n                            }\n                        }\n                    } else if (jexcel.current.options.columnDrag == true && info.height - e.offsetY < 6) {\n                        if (jexcel.current.isColMerged(columnId).length) {\n                            console.error('JEXCEL: This column is part of a merged cell.');\n                        } else {\n                            // Reset selection\n                            jexcel.current.resetSelection();\n                            // Drag helper\n                            jexcel.current.dragging = {\n                                element: e.target,\n                                column:columnId,\n                                destination:columnId,\n                            };\n                            // Border indication\n                            jexcel.current.headers[columnId].classList.add('dragging');\n                            for (var j = 0; j < jexcel.current.records.length; j++) {\n                                if (jexcel.current.records[j][columnId]) {\n                                    jexcel.current.records[j][columnId].classList.add('dragging');\n                                }\n                            }\n                        }\n                    } else {\n                        if (jexcel.current.selectedHeader && (e.shiftKey || e.ctrlKey)) {\n                            var o = jexcel.current.selectedHeader;\n                            var d = columnId;\n                        } else {\n                            // Press to rename\n                            if (jexcel.current.selectedHeader == columnId && jexcel.current.options.allowRenameColumn == true) {\n                                jexcel.timeControl = setTimeout(function() {\n                                    jexcel.current.setHeader(columnId);\n                                }, 800);\n                            }\n\n                            // Keep track of which header was selected first\n                            jexcel.current.selectedHeader = columnId;\n\n                            // Update selection single column\n                            var o = columnId;\n                            var d = columnId;\n                        }\n\n                        // Update selection\n                        jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\n                    }\n                } else {\n                    if (e.target.parentNode.classList.contains('jexcel_nested')) {\n                        if (e.target.getAttribute('data-column')) {\n                            var column = e.target.getAttribute('data-column').split(',');\n                            var c1 = parseInt(column[0]);\n                            var c2 = parseInt(column[column.length-1]);\n                        } else {\r\n                            var c1 = 0;\r\n                            var c2 = jexcel.current.options.columns.length - 1;\r\n                        }\n                        jexcel.current.updateSelectionFromCoords(c1, 0, c2, jexcel.current.options.data.length - 1);\n                    }\n                }\n            } else {\n                jexcel.current.selectedHeader = false;\n            }\n\n            // Body found\n            if (jexcelTable[1] == 2) {\n                var rowId = e.target.getAttribute('data-y');\n\n                if (e.target.classList.contains('jexcel_row')) {\n                    var info = e.target.getBoundingClientRect();\n                    if (jexcel.current.options.rowResize == true && info.height - e.offsetY < 6) {\n                        // Resize helper\n                        jexcel.current.resizing = {\n                            element: e.target.parentNode,\n                            mousePosition: e.pageY,\n                            row: rowId,\n                            height: info.height,\n                        };\n                        // Border indication\n                        e.target.parentNode.classList.add('resizing');\n                    } else if (jexcel.current.options.rowDrag == true && info.width - e.offsetX < 6) {\n                        if (jexcel.current.isRowMerged(rowId).length) {\n                            console.error('JEXCEL: This row is part of a merged cell');\n                        } else if (jexcel.current.options.search == true && jexcel.current.results) {\n                            console.error('JEXCEL: Please clear your search before perform this action');\n                        } else {\n                            // Reset selection\n                            jexcel.current.resetSelection();\n                            // Drag helper\n                            jexcel.current.dragging = {\n                                element: e.target.parentNode,\n                                row:rowId,\n                                destination:rowId,\n                            };\n                            // Border indication\n                            e.target.parentNode.classList.add('dragging');\n                        }\n                    } else {\n                        if (jexcel.current.selectedRow && (e.shiftKey || e.ctrlKey)) {\n                            var o = jexcel.current.selectedRow;\n                            var d = rowId;\n                        } else {\n                            // Keep track of which header was selected first\n                            jexcel.current.selectedRow = rowId;\n\n                            // Update selection single column\n                            var o = rowId;\n                            var d = rowId;\n                        }\n\n                        // Update selection\n                        jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\n                    }\n                } else {\n                    // Jclose\n                    if (e.target.classList.contains('jclose') && e.target.clientWidth - e.offsetX < 50 && e.offsetY < 50) {\n                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                    } else {\n                        var getCellCoords = function(element) {\n                            var x = element.getAttribute('data-x');\n                            var y = element.getAttribute('data-y');\n                            if (x && y) {\n                                return [x, y];\n                            } else {\n                                if (element.parentNode) {\n                                    return getCellCoords(element.parentNode);\n                                }\n                            }\n                        };\n\n                        var position = getCellCoords(e.target);\n                        if (position) {\n                            var columnId = position[0];\n                            var rowId = position[1];\n                            // Close edition\n                            if (jexcel.current.edition) {\n                                if (jexcel.current.edition[2] != columnId || jexcel.current.edition[3] != rowId) {\n                                    jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                                }\n                            }\n\n                            if (! jexcel.current.edition) {\n                                // Update cell selection\n                                if (e.shiftKey) {\n                                    jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\n                                } else {\n                                    jexcel.current.updateSelectionFromCoords(columnId, rowId);\n                                }\n                            }\n\n                            // No full row selected\n                            jexcel.current.selectedHeader = null;\n                            jexcel.current.selectedRow = null;\n                        }\n                    }\n                }\n            } else {\n                jexcel.current.selectedRow = false;\n            }\n\n            // Pagination\n            if (e.target.classList.contains('jexcel_page')) {\n                if (e.target.innerText == '<') {\n                    jexcel.current.page(0);\n                } else if (e.target.innerText == '>') {\n                    jexcel.current.page(e.target.getAttribute('title') - 1);\n                } else {\n                    jexcel.current.page(e.target.innerText - 1);\n                }\n            }\n        }\n\n        if (jexcel.current.edition) {\n            jexcel.isMouseAction = false;\n        } else {\n            jexcel.isMouseAction = true;\n        }\n    } else {\n        jexcel.isMouseAction = false;\n    }\n}\n\njexcel.mouseUpControls = function(e) {\n    if (jexcel.current) {\n        // Update cell size\n        if (jexcel.current.resizing) {\n            // Columns to be updated\n            if (jexcel.current.resizing.column) {\n                // Remove Class\n                jexcel.current.headers[jexcel.current.resizing.column].classList.remove('resizing');\n                var newWidth = jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute('width');\n                jexcel.current.setWidth(jexcel.current.resizing.column, newWidth, jexcel.current.resizing.width);\n                // Remove border\n                jexcel.current.headers[jexcel.current.resizing.column].classList.remove('resizing');\n                for (var j = 0; j < jexcel.current.records.length; j++) {\n                    if (jexcel.current.records[j][jexcel.current.resizing.column]){\n                        jexcel.current.records[j][jexcel.current.resizing.column].classList.remove('resizing');\n                    }\n                }\n            } else {\n                // Remove Class\n                jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove('resizing');\n                var newHeight = jexcel.current.rows[jexcel.current.resizing.row].getAttribute('height');\n                jexcel.current.setHeight(jexcel.current.resizing.row, newHeight, jexcel.current.resizing.height);\n                // Remove border\n                jexcel.current.resizing.element.classList.remove('resizing');\n            }\n            // Reset resizing helper\n            jexcel.current.resizing = null;\n        } else if (jexcel.current.dragging) {\n            // Reset dragging helper\n            if (jexcel.current.dragging) {\n                if (jexcel.current.dragging.column) {\n                    // Target\n                    var columnId = e.target.getAttribute('data-x');\n                    // Remove move style\n                    jexcel.current.headers[jexcel.current.dragging.column].classList.remove('dragging');\n                    for (var j = 0; j < jexcel.current.rows.length; j++) {\n                        if (jexcel.current.records[j][jexcel.current.dragging.column]) {\n                            jexcel.current.records[j][jexcel.current.dragging.column].classList.remove('dragging');\n                        }\n                    }\n                    for (var i = 0; i < jexcel.current.headers.length; i++) {\n                        jexcel.current.headers[i].classList.remove('dragging-left');\n                        jexcel.current.headers[i].classList.remove('dragging-right');\n                    }\n                    // Update position\n                    if (columnId) {\n                        if (jexcel.current.dragging.column != jexcel.current.dragging.destination) {\n                            jexcel.current.moveColumn(jexcel.current.dragging.column, jexcel.current.dragging.destination);\n                        }\n                    }\n                } else {\n                    var position = Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children, jexcel.current.dragging.element);\n                    if (jexcel.current.dragging.row != position) {\n                        jexcel.current.moveRow(jexcel.current.dragging.row, position, true);\n                    }\n                    jexcel.current.dragging.element.classList.remove('dragging');\n                }\n                jexcel.current.dragging = null;\n            }\n        } else {\n            // Close any corner selection\n            if (jexcel.current.selectedCorner) {\n                jexcel.current.selectedCorner = false;\n\n                // Data to be copied\n                if (jexcel.current.selection.length > 0) {\n                    // Copy data\n                    jexcel.current.copyData(jexcel.current.selection[0], jexcel.current.selection[jexcel.current.selection.length - 1]);\n\n                    // Remove selection\n                    jexcel.current.removeCopySelection();\n                }\n            }\n        }\n    }\n\n    // Clear any time control\n    if (jexcel.timeControl) {\n        clearTimeout(jexcel.timeControl);\n        jexcel.timeControl = null;\n    }\n\n    // Mouse up\n    jexcel.isMouseAction = false;\n}\n\n// Mouse move controls\njexcel.mouseMoveControls = function(e) {\n    e = e || window.event;\n    if (e.buttons) {\n        var mouseButton = e.buttons;\n    } else if (e.button) {\n        var mouseButton = e.button;\n    } else {\n        var mouseButton = e.which;\n    }\n\n    if (! mouseButton) {\n        jexcel.isMouseAction = false;\n    }\n\n    if (jexcel.current) {\n        if (jexcel.isMouseAction == true) {\n            // Resizing is ongoing\n            if (jexcel.current.resizing) {\n                if (jexcel.current.resizing.column) {\n                    var width = e.pageX - jexcel.current.resizing.mousePosition;\n\n                    if (jexcel.current.resizing.width + width > 0) {\n                        var tempWidth = jexcel.current.resizing.width + width;\n                        jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute('width', tempWidth);\n\n                        jexcel.current.updateCornerPosition();\n                    }\n                } else {\n                    var height = e.pageY - jexcel.current.resizing.mousePosition;\n\n                    if (jexcel.current.resizing.height + height > 0) {\n                        var tempHeight = jexcel.current.resizing.height + height;\n                        jexcel.current.rows[jexcel.current.resizing.row].setAttribute('height', tempHeight);\n\n                        jexcel.current.updateCornerPosition();\n                    }\n                }\n            }\n        } else {\n            var x = e.target.getAttribute('data-x');\n            var y = e.target.getAttribute('data-y');\n            var rect = e.target.getBoundingClientRect();\n\n            if (jexcel.current.cursor) {\n                jexcel.current.cursor.style.cursor = '';\n                jexcel.current.cursor = null;\n            }\n\n            if (e.target.parentNode.parentNode && e.target.parentNode.parentNode.className) {\n                if (e.target.parentNode.parentNode.classList.contains('resizable')) {\n                    if (e.target && x && ! y && (rect.width - (e.clientX - rect.left) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'col-resize';\n                    } else if (e.target && ! x && y && (rect.height - (e.clientY - rect.top) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'row-resize';\n                    }\n                }\n\n                if (e.target.parentNode.parentNode.classList.contains('draggable')) {\n                    if (e.target && ! x && y && (rect.width - (e.clientX - rect.left) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'move';\n                    } else if (e.target && x && ! y && (rect.height - (e.clientY - rect.top) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'move';\n                    }\n                }\n            }\n        }\n    }\n}\n\njexcel.mouseOverControls = function(e) {\n    e = e || window.event;\n    if (e.buttons) {\n        var mouseButton = e.buttons;\n    } else if (e.button) {\n        var mouseButton = e.button;\n    } else {\n        var mouseButton = e.which;\n    }\n\n    if (! mouseButton) {\n        jexcel.isMouseAction = false;\n    }\n\n    if (jexcel.current && jexcel.isMouseAction == true) {\n        // Get elements\n        var jexcelTable = jexcel.getElement(e.target);\n\n        if (jexcelTable[0]) {\n            // Avoid cross reference\n            if (jexcel.current != jexcelTable[0].jexcel) {\n                if (jexcel.current) {\n                    return false;\n                }\n            }\n\n            var columnId = e.target.getAttribute('data-x');\n            var rowId = e.target.getAttribute('data-y');\n\n            if (jexcel.current.dragging) {\n                if (jexcel.current.dragging.column) {\n                    if (columnId) {\n                        if (jexcel.current.isColMerged(columnId).length) {\n                            console.error('JEXCEL: This column is part of a merged cell.');\n                        } else {\n                            for (var i = 0; i < jexcel.current.headers.length; i++) {\n                                jexcel.current.headers[i].classList.remove('dragging-left');\n                                jexcel.current.headers[i].classList.remove('dragging-right');\n                            }\n\n                            if (jexcel.current.dragging.column == columnId) {\n                                jexcel.current.dragging.destination = parseInt(columnId);\n                            } else {\n                                if (e.target.clientWidth / 2 > e.offsetX) {\n                                    if (jexcel.current.dragging.column < columnId) {\n                                        jexcel.current.dragging.destination = parseInt(columnId) - 1;\n                                    } else {\n                                        jexcel.current.dragging.destination = parseInt(columnId);\n                                    }\n                                    jexcel.current.headers[columnId].classList.add('dragging-left');\n                                } else {\n                                    if (jexcel.current.dragging.column < columnId) {\n                                        jexcel.current.dragging.destination = parseInt(columnId);\n                                    } else {\n                                        jexcel.current.dragging.destination = parseInt(columnId) + 1;\n                                    }\n                                    jexcel.current.headers[columnId].classList.add('dragging-right');\n                                }\n                            }\n                        }\n                    }\n                } else {\n                    if (rowId) {\n                        if (jexcel.current.isRowMerged(rowId).length) {\n                            console.error('JEXCEL: This row is part of a merged cell.');\n                        } else {\n                            var target = (e.target.clientHeight / 2 > e.offsetY) ? e.target.parentNode.nextSibling : e.target.parentNode;\n                            e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element, target);\n                        }\n                    }\n                }\n            } else if (jexcel.current.resizing) {\n            } else {\n                // Header found\n                if (jexcelTable[1] == 1) {\n                    if (jexcel.current.selectedHeader) {\n                        var columnId = e.target.getAttribute('data-x');\n                        var o = jexcel.current.selectedHeader;\n                        var d = columnId;\n                        // Update selection\n                        jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\n                    }\n                }\n\n                // Body found\n                if (jexcelTable[1] == 2) {\n                    if (e.target.classList.contains('jexcel_row')) {\n                        if (jexcel.current.selectedRow) {\n                            var o = jexcel.current.selectedRow;\n                            var d = rowId;\n                            // Update selection\n                            jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\n                        }\n                    } else {\n                        // Do not select edtion is in progress\n                        if (! jexcel.current.edition) {\n                            if (columnId && rowId) {\n                                if (jexcel.current.selectedCorner) {\n                                    jexcel.current.updateCopySelection(columnId, rowId);\n                                } else {\n                                    if (jexcel.current.selectedCell) {\n                                        jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    // Clear any time control\n    if (jexcel.timeControl) {\n        clearTimeout(jexcel.timeControl);\n        jexcel.timeControl = null;\n    }\n}\n\n/**\n * Double click event handler: controls the double click in the corner, cell edition or column re-ordering.\n */\njexcel.doubleClickControls = function(e) {\n    // Jexcel is selected\n    if (jexcel.current) {\n        // Corner action\n        if (e.target.classList.contains('jexcel_corner')) {\n            // Any selected cells\n            if (jexcel.current.highlighted.length > 0) {\n                // Copy from this\n                var x1 = jexcel.current.highlighted[0].getAttribute('data-x');\n                var y1 = parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-y')) + 1;\n                // Until this\n                var x2 = jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-x');\n                var y2 = jexcel.current.records.length - 1\n                // Execute copy\n                jexcel.current.copyData(jexcel.current.records[y1][x1], jexcel.current.records[y2][x2]);\n            }\n        } else {\n            // Get table\n            var jexcelTable = jexcel.getElement(e.target);\n\n            // Double click over header\n            if (jexcelTable[1] == 1 && jexcel.current.options.columnSorting == true) {\n                // Check valid column header coords\n                var columnId = e.target.getAttribute('data-x');\n                if (columnId) {\n                    jexcel.current.orderBy(columnId);\n                }\n            }\n\n            // Double click over body\n            if (jexcelTable[1] == 2 && jexcel.current.options.editable == true) {\n                if (! jexcel.current.edition) {\n                    var getCellCoords = function(element) {\n                        if (element.parentNode) {\n                            var x = element.getAttribute('data-x');\n                            var y = element.getAttribute('data-y');\n                            if (x && y) {\n                                return element;\n                            } else {\n                                return getCellCoords(element.parentNode);\n                            }\n                        }\n                    }\n                    var cell = getCellCoords(e.target);\n                    if (cell && cell.classList.contains('highlight')) {\n                        jexcel.current.openEditor(cell);\n                    }\n                }\n            }\n        }\n    }\n}\n\njexcel.copyControls = function(e) {\n    if (jexcel.current && jexcel.copyControls.enabled) {\n        if (! jexcel.current.edition) {\n            jexcel.current.copy(true);\n        }\n    }\n}\n\njexcel.cutControls = function(e) {\n    if (jexcel.current) {\n        if (! jexcel.current.edition) {\n            jexcel.current.copy(true);\n            if (jexcel.current.options.editable == true) {\n                jexcel.current.setValue(jexcel.current.highlighted, '');\n            }\n        }\n    }\n}\n\njexcel.pasteControls = function(e) {\n    if (jexcel.current && jexcel.current.selectedCell) {\n        if (! jexcel.current.edition) {\n            if (jexcel.current.options.editable == true) {\n                if (e && e.clipboardData) {\n                    jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], e.clipboardData.getData('text'));\n                    e.preventDefault();\n                } else if (window.clipboardData) {\n                    jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], window.clipboardData.getData('text'));\n                }\n            }\n        }\n    }\n}\n\njexcel.contextMenuControls = function(e) {\n    e = e || window.event;\n    if (\"buttons\" in e) {\n        var mouseButton = e.buttons;\n    } else {\n        var mouseButton = e.which || e.button;\n    }\n\n    if (jexcel.current) {\n        if (jexcel.current.edition) {\n            e.preventDefault();\n        } else if (jexcel.current.options.contextMenu) {\n            jexcel.current.contextMenu.contextmenu.close();\n\n            if (jexcel.current) {\n                var x = e.target.getAttribute('data-x');\n                var y = e.target.getAttribute('data-y');\n\n                if (x || y) {\n                    // Table found\n                    var items = jexcel.current.options.contextMenu(jexcel.current, x, y, e);\n                    // The id is depending on header and body\n                    jexcel.current.contextMenu.contextmenu.open(e, items);\n                    // Avoid the real one\n                    e.preventDefault();\n                }\n            }\n        }\n    }\n}\n\njexcel.touchStartControls = function(e) {\n    var jexcelTable = jexcel.getElement(e.target);\n\n    if (jexcelTable[0]) {\n        if (jexcel.current != jexcelTable[0].jexcel) {\n            if (jexcel.current) {\n                jexcel.current.resetSelection();\n            }\n            jexcel.current = jexcelTable[0].jexcel;\n        }\n    } else {\n        if (jexcel.current) {\n            jexcel.current.resetSelection();\n            jexcel.current = null;\n        }\n    }\n\n    if (jexcel.current) {\n        if (! jexcel.current.edition) {\n            var columnId = e.target.getAttribute('data-x');\n            var rowId = e.target.getAttribute('data-y');\n\n            if (columnId && rowId) {\n                jexcel.current.updateSelectionFromCoords(columnId, rowId);\n\n                jexcel.timeControl = setTimeout(function() {\n                    // Keep temporary reference to the element\r\n                    if (jexcel.current.options.columns[columnId].type == 'color') {\r\n                        jexcel.tmpElement = null;\r\n                    } else {\r\n                        jexcel.tmpElement = e.target;\r\n                    }\r\n                    jexcel.current.openEditor(e.target, false, e);\n                }, 500);\n            }\n        }\n    }\n}\n\njexcel.touchEndControls = function(e) {\n    // Clear any time control\n    if (jexcel.timeControl) {\n        clearTimeout(jexcel.timeControl);\n        jexcel.timeControl = null;\n        // Element\r\n        if (jexcel.tmpElement && jexcel.tmpElement.children[0].tagName == 'INPUT') {\r\n            jexcel.tmpElement.children[0].focus();\r\n        }\n        jexcel.tmpElement = null;\n    }\r\n}\r\n\r\n/**\r\n * Jexcel extensions\r\n */\r\n\r\njexcel.createTabs = function(tabs, result) {\r\n    // Create tab container\r\n    tabs.innerHTML = '';\r\n    tabs.classList.add('jexcel_tabs');\r\n    var spreadsheet = []\r\n    var link = [];\r\n    for (var i = 0; i < result.length; i++) {\r\n        // Spreadsheet container\r\n        spreadsheet[i] = document.createElement('div');\r\n        spreadsheet[i].classList.add('jexcel_tab');\r\n        // Tab link\r\n        link[i] = document.createElement('div');\r\n        link[i].classList.add('jexcel_tab_link');\r\n        link[i].setAttribute('data-spreadsheet', i);\r\n        link[i].innerHTML = result[i].sheetName;\r\n        link[i].onclick = function() {\r\n            for (var j = 0; j < spreadsheet.length; j++) {\r\n                spreadsheet[j].style.display = 'none';\r\n                link[j].classList.remove('selected');\r\n            }\r\n            var i = this.getAttribute('data-spreadsheet');\r\n            spreadsheet[i].style.display = 'block';\r\n            link[i].classList.add('selected')\r\n        }\r\n        tabs.appendChild(link[i]);\r\n    }\r\n\r\n    // Append spreadsheet\r\n    for (var i = 0; i < spreadsheet.length - 1; i++) {\r\n        tabs.appendChild(spreadsheet[i]);\r\n        jexcel(spreadsheet[i], result[i]);\r\n    }\r\n\r\n    // First tab\r\n    spreadsheet[0].style.display = 'block';\r\n    link[0].classList.add('selected')\r\n}\r\n\r\njexcel.fromSpreadsheet = function(file, __callback) {\r\n    var convert = function(workbook) {\r\n        var spreadsheets = [];\r\n        workbook.SheetNames.forEach(function(sheetName) {\r\n            var spreadsheet = {};\r\n            spreadsheet.rows = [];\r\n            spreadsheet.columns = [];\r\n            spreadsheet.data = [];\r\n            spreadsheet.style = {};\r\n            spreadsheet.sheetName = sheetName;\r\n\r\n            // Column widths\r\n            var temp = workbook.Sheets[sheetName]['!cols'];\r\n            if (temp && temp.length) {\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    spreadsheet.columns[i] = {};\r\n                    if (temp[i] && temp[i].wpx) {\r\n                        spreadsheet.columns[i].width = temp[i].wpx + 'px';\r\n                    }\r\n                }\r\n            }\r\n            // Rows heights\r\n            var temp = workbook.Sheets[sheetName]['!rows'];\r\n            if (temp && temp.length) {\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    if (temp[i] && temp[i].hpx) {\r\n                        spreadsheet.rows[i] = {};\r\n                        spreadsheet.rows[i].height = temp[i].hpx + 'px';\r\n                    }\r\n                }\r\n            }\r\n            // Merge cells\r\n            var temp = workbook.Sheets[sheetName]['!merges'];\r\n            if (temp && temp.length > 0) {\r\n                spreadsheet.mergeCells = [];\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    var x1 = temp[i].s.c;\r\n                    var y1 = temp[i].s.r;\r\n                    var x2 = temp[i].e.c;\r\n                    var y2 = temp[i].e.r;\r\n                    var key = jexcel.getColumnNameFromId([x1,y1]);\r\n                    spreadsheet.mergeCells[key] = [ x2-x1+1, y2-y1+1 ];\r\n                }\r\n            }\r\n            // Data container\r\n            var max_x = 0;\r\n            var max_y = 0;\r\n            var temp = Object.keys(workbook.Sheets[sheetName]);\r\n            for (var i = 0; i < temp.length; i++) {\r\n                if (temp[i].substr(0,1) != '!') {\r\n                    var cell = workbook.Sheets[sheetName][temp[i]];\r\n                    var info = jexcel.getIdFromColumnName(temp[i], true);\r\n                    if (! spreadsheet.data[info[1]]) {\r\n                        spreadsheet.data[info[1]] = [];\r\n                    }\r\n                    spreadsheet.data[info[1]][info[0]] = cell.f ? '=' + cell.f : cell.w;\r\n                    if (max_x < info[0]) {\r\n                        max_x = info[0];\r\n                    }\r\n                    if (max_y < info[1]) {\r\n                        max_y = info[1];\r\n                    }\r\n                    // Style\r\n                    if (cell.style && Object.keys(cell.style).length > 0) {\r\n                        spreadsheet.style[temp[i]] = cell.style;\r\n                    }\r\n                    if (cell.s && cell.s.fgColor) {\r\n                        if (spreadsheet.style[temp[i]]) {\r\n                            spreadsheet.style[temp[i]] += ';';\r\n                        }\r\n                        spreadsheet.style[temp[i]] += 'background-color:#' + cell.s.fgColor.rgb;\r\n                    }\r\n                }\r\n            }\r\n            var numColumns = spreadsheet.columns;\r\n            for (var j = 0; j <= max_y; j++) {\r\n                for (var i = 0; i <= max_x; i++) {\r\n                    if (! spreadsheet.data[j]) {\r\n                        spreadsheet.data[j] = [];\r\n                    }\r\n                    if (! spreadsheet.data[j][i]) {\r\n                        if (numColumns < i) {\r\n                            spreadsheet.data[j][i] = '';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            spreadsheets.push(spreadsheet);\r\n        });\r\n\r\n        return spreadsheets;\r\n    }\r\n\r\n    var oReq;\r\n    oReq = new XMLHttpRequest();\r\n    oReq.open(\"GET\", file, true);\r\n\r\n    if(typeof Uint8Array !== 'undefined') {\r\n        oReq.responseType = \"arraybuffer\";\r\n        oReq.onload = function(e) {\r\n            var arraybuffer = oReq.response;\r\n            var data = new Uint8Array(arraybuffer);\r\n            var wb = XLSX.read(data, {type:\"array\", cellFormula:true, cellStyles:true });\r\n            __callback(convert(wb))\r\n        };\r\n    } else {\r\n        oReq.setRequestHeader(\"Accept-Charset\", \"x-user-defined\");  \r\n        oReq.onreadystatechange = function() { if(oReq.readyState == 4 && oReq.status == 200) {\r\n            var ff = convertResponseBodyToText(oReq.responseBody);\r\n            var wb = XLSX.read(ff, {type:\"binary\", cellFormula:true, cellStyles:true });\r\n            __callback(convert(wb))\r\n        }};\r\n    }\r\n\r\n    oReq.send();\r\n}\r\n\r\n/**\r\n * Valid international letter\r\n */\r\n\r\njexcel.validLetter = function (text) {\r\n    var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC-\\u0400-\\u04FF']+)/g;\r\n    return text.match(regex) ? 1 : 0;\r\n}\r\n\r\n/**\r\n * Helper injectArray\r\n */\r\njexcel.injectArray = function(o, idx, arr) {\r\n    return o.slice(0, idx).concat(arr).concat(o.slice(idx));\r\n}\r\n\r\n/**\r\n * Get letter based on a number\r\n * \r\n * @param integer i\r\n * @return string letter\r\n */\r\njexcel.getColumnName = function(i) {\r\n    var letter = '';\r\n    if (i > 701) {\r\n        letter += String.fromCharCode(64 + parseInt(i / 676));\r\n        letter += String.fromCharCode(64 + parseInt((i % 676) / 26));\r\n    } else if (i > 25) {\r\n        letter += String.fromCharCode(64 + parseInt(i / 26));\r\n    }\r\n    letter += String.fromCharCode(65 + (i % 26));\r\n\r\n    return letter;\r\n}\r\n\r\n/**\r\n * Convert excel like column to jexcel id\r\n * \r\n * @param string id\r\n * @return string id\r\n */\r\njexcel.getIdFromColumnName = function (id, arr) {\r\n    // Get the letters\r\n    var t = /^[a-zA-Z]+/.exec(id);\r\n\r\n    if (t) {\r\n        // Base 26 calculation\r\n        var code = 0;\r\n        for (var i = 0; i < t[0].length; i++) {\r\n            code += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, (t[0].length - 1 - i));\r\n        }\r\n        code--;\r\n        // Make sure jexcel starts on zero\r\n        if (code < 0) {\r\n            code = 0;\r\n        }\r\n\r\n        // Number\r\n        var number = parseInt(/[0-9]+$/.exec(id));\r\n        if (number > 0) {\r\n            number--;\r\n        }\r\n\r\n        if (arr == true) {\r\n            id = [ code, number ];\r\n        } else {\r\n            id = code + '-' + number;\r\n        }\r\n    }\r\n\r\n    return id;\r\n}\r\n\r\n/**\r\n * Convert jexcel id to excel like column name\r\n * \r\n * @param string id\r\n * @return string id\r\n */\r\njexcel.getColumnNameFromId = function (cellId) {\r\n    if (! Array.isArray(cellId)) {\r\n        cellId = cellId.split('-');\r\n    }\r\n\r\n    return jexcel.getColumnName(parseInt(cellId[0])) + (parseInt(cellId[1]) + 1);\r\n}\r\n\r\n/**\r\n * Verify element inside jexcel table\r\n * \r\n * @param string id\r\n * @return string id\r\n */\r\njexcel.getElement = function(element) {\r\n    var jexcelSection = 0;\r\n    var jexcelElement = 0;\r\n\r\n    function path (element) {\r\n        if (element.className) {\r\n            if (element.classList.contains('jexcel_container')) {\r\n                jexcelElement = element;\r\n            }\r\n        }\r\n\r\n        if (element.tagName == 'THEAD') {\r\n            jexcelSection = 1;\r\n        } else if (element.tagName == 'TBODY') {\r\n            jexcelSection = 2;\r\n        }\r\n\r\n        if (element.parentNode) {\r\n            path(element.parentNode);\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return [ jexcelElement, jexcelSection ];\r\n}\r\n\r\njexcel.doubleDigitFormat = function(v) {\r\n    v = ''+v;\r\n    if (v.length == 1) {\r\n        v = '0'+v;\r\n    }\r\n    return v;\r\n}\r\n\r\n/**\r\n * Jquery Support\r\n */\r\nif (typeof(jQuery) != 'undefined') {\r\n    (function($){\r\n        $.fn.jexcel = function(method) {\r\n            var spreadsheetContainer = $(this).get(0);\r\n            if (! spreadsheetContainer.jexcel) {\r\n                return jexcel($(this).get(0), arguments[0]);\r\n            } else {\r\n                return spreadsheetContainer.jexcel[method].apply(this, Array.prototype.slice.call( arguments, 1 ));\r\n            }\r\n        };\r\n\r\n    })(jQuery);\r\n}\r\n\r\n\r\n// Based on sutoiku work (https://github.com/sutoiku)\r\n\r\nvar error = (function() {\r\n    var exports = {};\r\n\r\n    exports.nil = new Error('#NULL!');\r\n    exports.div0 = new Error('#DIV/0!');\r\n    exports.value = new Error('#VALUE!');\r\n    exports.ref = new Error('#REF!');\r\n    exports.name = new Error('#NAME?');\r\n    exports.num = new Error('#NUM!');\r\n    exports.na = new Error('#N/A');\r\n    exports.error = new Error('#ERROR!');\r\n    exports.data = new Error('#GETTING_DATA');\r\n\r\n    return exports;\r\n})();\r\n\r\nvar utils = (function() {\r\n    var exports = {};\r\n\r\n    exports.flattenShallow = function(array) {\r\n        if (!array || !array.reduce) {\r\n            return array;\r\n        }\r\n\r\n        return array.reduce(function(a, b) {\r\n            var aIsArray = Array.isArray(a);\r\n            var bIsArray = Array.isArray(b);\r\n\r\n            if (aIsArray && bIsArray) {\r\n                return a.concat(b);\r\n            }\r\n            if (aIsArray) {\r\n                a.push(b);\r\n\r\n                return a;\r\n            }\r\n            if (bIsArray) {\r\n                return [ a ].concat(b);\r\n            }\r\n\r\n            return [ a, b ];\r\n        });\r\n    };\r\n\r\n    exports.isFlat = function(array) {\r\n        if (!array) {\r\n            return false;\r\n        }\r\n\r\n        for (var i = 0; i < array.length; ++i) {\r\n            if (Array.isArray(array[i])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    exports.flatten = function() {\r\n        var result = exports.argsToArray.apply(null, arguments);\r\n\r\n        while (!exports.isFlat(result)) {\r\n            result = exports.flattenShallow(result);\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.argsToArray = function(args) {\r\n        var result = [];\r\n\r\n        exports.arrayEach(args, function(value) {\r\n            result.push(value);\r\n        });\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.numbers = function() {\r\n        var possibleNumbers = this.flatten.apply(null, arguments);\r\n        return possibleNumbers.filter(function(el) {\r\n            return typeof el === 'number';\r\n        });\r\n    };\r\n\r\n    exports.cleanFloat = function(number) {\r\n        var power = 1e14;\r\n        return Math.round(number * power) / power;\r\n    };\r\n\r\n    exports.parseBool = function(bool) {\r\n        if (typeof bool === 'boolean') {\r\n            return bool;\r\n        }\r\n\r\n        if (bool instanceof Error) {\r\n            return bool;\r\n        }\r\n\r\n        if (typeof bool === 'number') {\r\n            return bool !== 0;\r\n        }\r\n\r\n        if (typeof bool === 'string') {\r\n            var up = bool.toUpperCase();\r\n            if (up === 'TRUE') {\r\n                return true;\r\n            }\r\n\r\n            if (up === 'FALSE') {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (bool instanceof Date && !isNaN(bool)) {\r\n            return true;\r\n        }\r\n\r\n        return error.value;\r\n    };\r\n\r\n    exports.parseNumber = function(string) {\r\n        if (string === undefined || string === '') {\r\n            return error.value;\r\n        }\r\n        if (!isNaN(string)) {\r\n            return parseFloat(string);\r\n        }\r\n\r\n        return error.value;\r\n    };\r\n\r\n    exports.parseNumberArray = function(arr) {\r\n        var len;\r\n\r\n        if (!arr || (len = arr.length) === 0) {\r\n            return error.value;\r\n        }\r\n\r\n        var parsed;\r\n\r\n        while (len--) {\r\n            parsed = exports.parseNumber(arr[len]);\r\n            if (parsed === error.value) {\r\n                return parsed;\r\n            }\r\n            arr[len] = parsed;\r\n        }\r\n\r\n        return arr;\r\n    };\r\n\r\n    exports.parseMatrix = function(matrix) {\r\n        var n;\r\n\r\n        if (!matrix || (n = matrix.length) === 0) {\r\n            return error.value;\r\n        }\r\n        var pnarr;\r\n\r\n        for (var i = 0; i < matrix.length; i++) {\r\n            pnarr = exports.parseNumberArray(matrix[i]);\r\n            matrix[i] = pnarr;\r\n\r\n            if (pnarr instanceof Error) {\r\n                return pnarr;\r\n            }\r\n        }\r\n\r\n        return matrix;\r\n    };\r\n\r\n    var d1900 = new Date(Date.UTC(1900, 0, 1));\r\n    exports.parseDate = function(date) {\r\n        if (!isNaN(date)) {\r\n            if (date instanceof Date) {\r\n                return new Date(date);\r\n            }\r\n            var d = parseInt(date, 10);\r\n            if (d < 0) {\r\n                return error.num;\r\n            }\r\n            if (d <= 60) {\r\n                return new Date(d1900.getTime() + (d - 1) * 86400000);\r\n            }\r\n            return new Date(d1900.getTime() + (d - 2) * 86400000);\r\n        }\r\n        if (typeof date === 'string') {\r\n            date = new Date(date);\r\n            if (!isNaN(date)) {\r\n                return date;\r\n            }\r\n        }\r\n        return error.value;\r\n    };\r\n\r\n    exports.parseDateArray = function(arr) {\r\n        var len = arr.length;\r\n        var parsed;\r\n        while (len--) {\r\n            parsed = this.parseDate(arr[len]);\r\n            if (parsed === error.value) {\r\n                return parsed;\r\n            }\r\n            arr[len] = parsed;\r\n        }\r\n        return arr;\r\n    };\r\n\r\n    exports.anyIsError = function() {\r\n        var n = arguments.length;\r\n        while (n--) {\r\n            if (arguments[n] instanceof Error) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    exports.arrayValuesToNumbers = function(arr) {\r\n        var n = arr.length;\r\n        var el;\r\n        while (n--) {\r\n            el = arr[n];\r\n            if (typeof el === 'number') {\r\n                continue;\r\n            }\r\n            if (el === true) {\r\n                arr[n] = 1;\r\n                continue;\r\n            }\r\n            if (el === false) {\r\n                arr[n] = 0;\r\n                continue;\r\n            }\r\n            if (typeof el === 'string') {\r\n                var number = this.parseNumber(el);\r\n                if (number instanceof Error) {\r\n                    arr[n] = 0;\r\n                } else {\r\n                    arr[n] = number;\r\n                }\r\n            }\r\n        }\r\n        return arr;\r\n    };\r\n\r\n    exports.rest = function(array, idx) {\r\n        idx = idx || 1;\r\n        if (!array || typeof array.slice !== 'function') {\r\n            return array;\r\n        }\r\n        return array.slice(idx);\r\n    };\r\n\r\n    exports.initial = function(array, idx) {\r\n        idx = idx || 1;\r\n        if (!array || typeof array.slice !== 'function') {\r\n            return array;\r\n        }\r\n        return array.slice(0, array.length - idx);\r\n    };\r\n\r\n    exports.arrayEach = function(array, iteratee) {\r\n        var index = -1, length = array.length;\r\n\r\n        while (++index < length) {\r\n            if (iteratee(array[index], index, array) === false) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        return array;\r\n    };\r\n\r\n    exports.transpose = function(matrix) {\r\n        if (!matrix) {\r\n            return error.value;\r\n        }\r\n\r\n        return matrix[0].map(function(col, i) {\r\n            return matrix.map(function(row) {\r\n                return row[i];\r\n            });\r\n        });\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods = {};\r\n\r\njexcel.methods.datetime = (function() {\r\n    var exports = {};\r\n\r\n    var d1900 = new Date(1900, 0, 1);\r\n    var WEEK_STARTS = [\r\n        undefined,\r\n        0,\r\n        1,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        1,\r\n        2,\r\n        3,\r\n        4,\r\n        5,\r\n        6,\r\n        0\r\n    ];\r\n    var WEEK_TYPES = [\r\n        [],\r\n        [1, 2, 3, 4, 5, 6, 7],\r\n        [7, 1, 2, 3, 4, 5, 6],\r\n        [6, 0, 1, 2, 3, 4, 5],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [7, 1, 2, 3, 4, 5, 6],\r\n        [6, 7, 1, 2, 3, 4, 5],\r\n        [5, 6, 7, 1, 2, 3, 4],\r\n        [4, 5, 6, 7, 1, 2, 3],\r\n        [3, 4, 5, 6, 7, 1, 2],\r\n        [2, 3, 4, 5, 6, 7, 1],\r\n        [1, 2, 3, 4, 5, 6, 7]\r\n    ];\r\n    var WEEKEND_TYPES = [\r\n        [],\r\n        [6, 0],\r\n        [0, 1],\r\n        [1, 2],\r\n        [2, 3],\r\n        [3, 4],\r\n        [4, 5],\r\n        [5, 6],\r\n        undefined,\r\n        undefined,\r\n        undefined, [0, 0],\r\n        [1, 1],\r\n        [2, 2],\r\n        [3, 3],\r\n        [4, 4],\r\n        [5, 5],\r\n        [6, 6]\r\n    ];\r\n\r\n    exports.DATE = function(year, month, day) {\r\n        year = utils.parseNumber(year);\r\n        month = utils.parseNumber(month);\r\n        day = utils.parseNumber(day);\r\n        if (utils.anyIsError(year, month, day)) {\r\n            return error.value;\r\n        }\r\n        if (year < 0 || month < 0 || day < 0) {\r\n            return error.num;\r\n        }\r\n        var date = new Date(year, month - 1, day);\r\n        return date;\r\n    };\r\n\r\n    exports.DATEVALUE = function(date_text) {\r\n        if (typeof date_text !== 'string') {\r\n            return error.value;\r\n        }\r\n        var date = Date.parse(date_text);\r\n        if (isNaN(date)) {\r\n            return error.value;\r\n        }\r\n        if (date <= -2203891200000) {\r\n            return (date - d1900) / 86400000 + 1;\r\n        }\r\n        return (date - d1900) / 86400000 + 2;\r\n    };\r\n\r\n    exports.DAY = function(serial_number) {\r\n        var date = utils.parseDate(serial_number);\r\n        if (date instanceof Error) {\r\n            return date;\r\n        }\r\n        return date.getDate();\r\n    };\r\n\r\n    exports.DAYS = function(end_date, start_date) {\r\n        end_date = utils.parseDate(end_date);\r\n        start_date = utils.parseDate(start_date);\r\n        if (end_date instanceof Error) {\r\n            return end_date;\r\n        }\r\n        if (start_date instanceof Error) {\r\n            return start_date;\r\n        }\r\n        return serial(end_date) - serial(start_date);\r\n    };\r\n\r\n    exports.DAYS360 = function(start_date, end_date, method) {\r\n    };\r\n\r\n    exports.EDATE = function(start_date, months) {\r\n        start_date = utils.parseDate(start_date);\r\n        if (start_date instanceof Error) {\r\n            return start_date;\r\n        }\r\n        if (isNaN(months)) {\r\n            return error.value;\r\n        }\r\n        months = parseInt(months, 10);\r\n        start_date.setMonth(start_date.getMonth() + months);\r\n        return serial(start_date);\r\n    };\r\n\r\n    exports.EOMONTH = function(start_date, months) {\r\n        start_date = utils.parseDate(start_date);\r\n        if (start_date instanceof Error) {\r\n            return start_date;\r\n        }\r\n        if (isNaN(months)) {\r\n            return error.value;\r\n        }\r\n        months = parseInt(months, 10);\r\n        return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\r\n    };\r\n\r\n    exports.HOUR = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getHours();\r\n    };\r\n\r\n    exports.INTERVAL = function(second) {\r\n        if (typeof second !== 'number' && typeof second !== 'string') {\r\n            return error.value;\r\n        } else {\r\n            second = parseInt(second, 10);\r\n        }\r\n\r\n        var year  = Math.floor(second/946080000);\r\n        second    = second%946080000;\r\n        var month = Math.floor(second/2592000);\r\n        second    = second%2592000;\r\n        var day   = Math.floor(second/86400);\r\n        second    = second%86400;\r\n\r\n        var hour  = Math.floor(second/3600);\r\n        second    = second%3600;\r\n        var min   = Math.floor(second/60);\r\n        second    = second%60;\r\n        var sec   = second;\r\n\r\n        year  = (year  > 0) ? year  + 'Y' : '';\r\n        month = (month > 0) ? month + 'M' : '';\r\n        day   = (day   > 0) ? day   + 'D' : '';\r\n        hour  = (hour  > 0) ? hour  + 'H' : '';\r\n        min   = (min   > 0) ? min   + 'M' : '';\r\n        sec   = (sec   > 0) ? sec   + 'S' : '';\r\n\r\n        return 'P' + year + month + day + 'T' + hour + min + sec;\r\n    };\r\n\r\n    exports.ISOWEEKNUM = function(date) {\r\n        date = utils.parseDate(date);\r\n        if (date instanceof Error) {\r\n            return date;\r\n        }\r\n\r\n        date.setHours(0, 0, 0);\r\n        date.setDate(date.getDate() + 4 - (date.getDay() || 7));\r\n        var yearStart = new Date(date.getFullYear(), 0, 1);\r\n        return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\r\n    };\r\n\r\n    exports.MINUTE = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getMinutes();\r\n    };\r\n\r\n    exports.MONTH = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getMonth() + 1;\r\n    };\r\n\r\n    exports.NETWORKDAYS = function(start_date, end_date, holidays) {\r\n    };\r\n\r\n    exports.NETWORKDAYS.INTL = function(start_date, end_date, weekend, holidays) {\r\n    };\r\n\r\n    exports.NOW = function() {\r\n        return new Date();\r\n    };\r\n\r\n    exports.SECOND = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getSeconds();\r\n    };\r\n\r\n    exports.TIME = function(hour, minute, second) {\r\n        hour = utils.parseNumber(hour);\r\n        minute = utils.parseNumber(minute);\r\n        second = utils.parseNumber(second);\r\n        if (utils.anyIsError(hour, minute, second)) {\r\n            return error.value;\r\n        }\r\n        if (hour < 0 || minute < 0 || second < 0) {\r\n            return error.num;\r\n        }\r\n        return (3600 * hour + 60 * minute + second) / 86400;\r\n    };\r\n\r\n    exports.TIMEVALUE = function(time_text) {\r\n        time_text = utils.parseDate(time_text);\r\n        if (time_text instanceof Error) {\r\n            return time_text;\r\n        }\r\n        return (3600 * time_text.getHours() + 60 * time_text.getMinutes() + time_text.getSeconds()) / 86400;\r\n    };\r\n\r\n    exports.TODAY = function() {\r\n        return new Date();\r\n    };\r\n\r\n    exports.WEEKDAY = function(serial_number, return_type) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        if (return_type === undefined) {\r\n            return_type = 1;\r\n        }\r\n        var day = serial_number.getDay();\r\n        return WEEK_TYPES[return_type][day];\r\n    };\r\n\r\n    exports.WEEKNUM = function(serial_number, return_type) {\r\n    };\r\n\r\n    exports.WORKDAY = function(start_date, days, holidays) {\r\n    };\r\n\r\n    exports.WORKDAY.INTL = function(start_date, days, weekend, holidays) {\r\n    };\r\n\r\n    exports.YEAR = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getFullYear();\r\n    };\r\n\r\n    function isLeapYear(year) {\r\n        return new Date(year, 1, 29).getMonth() === 1;\r\n    }\r\n\r\n    exports.YEARFRAC = function(start_date, end_date, basis) {\r\n    };\r\n\r\n    function serial(date) {\r\n        var addOn = (date > -2203891200000)?2:1;\r\n        return (date - d1900) / 86400000 + addOn;\r\n    }\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.database = (function() {\r\n    var exports = {};\r\n\r\n    function compact(array) {\r\n        if (!array) {\r\n            return array;\r\n        }\r\n        var result = [];\r\n        for (var i = 0; i < array.length; ++i) {\r\n            if (!array[i]) {\r\n                continue;\r\n            }\r\n            result.push(array[i]);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    exports.FINDFIELD = function(database, title) {\r\n        var index = null;\r\n        for (var i = 0; i < database.length; i++) {\r\n            if (database[i][0] === title) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Return error if the input field title is incorrect\r\n        if (index == null) {\r\n            return error.value;\r\n        }\r\n        return index;\r\n    };\r\n\r\n    function findResultIndex(database, criterias) {\r\n        var matches = {};\r\n        for (var i = 1; i < database[0].length; ++i) {\r\n            matches[i] = true;\r\n        }\r\n        var maxCriteriaLength = criterias[0].length;\r\n        for (i = 1; i < criterias.length; ++i) {\r\n            if (criterias[i].length > maxCriteriaLength) {\r\n                maxCriteriaLength = criterias[i].length;\r\n            }\r\n        }\r\n\r\n        for (var k = 1; k < database.length; ++k) {\r\n            for (var l = 1; l < database[k].length; ++l) {\r\n                var currentCriteriaResult = false;\r\n                var hasMatchingCriteria = false;\r\n                for (var j = 0; j < criterias.length; ++j) {\r\n                    var criteria = criterias[j];\r\n                    if (criteria.length < maxCriteriaLength) {\r\n                        continue;\r\n                    }\r\n\r\n                    var criteriaField = criteria[0];\r\n                    if (database[k][0] !== criteriaField) {\r\n                        continue;\r\n                    }\r\n                    hasMatchingCriteria = true;\r\n                    for (var p = 1; p < criteria.length; ++p) {\r\n                        currentCriteriaResult = currentCriteriaResult\r\n                                || eval(database[k][l] + criteria[p]); // jshint\r\n                                                                        // ignore:line\r\n                    }\r\n                }\r\n                if (hasMatchingCriteria) {\r\n                    matches[l] = matches[l] && currentCriteriaResult;\r\n                }\r\n            }\r\n        }\r\n\r\n        var result = [];\r\n        for (var n = 0; n < database[0].length; ++n) {\r\n            if (matches[n]) {\r\n                result.push(n - 1);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Database functions\r\n    exports.DAVERAGE = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var sum = 0;\r\n        for (var i = 0; i < resultIndexes.length; i++) {\r\n            sum += targetFields[resultIndexes[i]];\r\n        }\r\n        return resultIndexes.length === 0 ? error.div0 : sum / resultIndexes.length;\r\n    };\r\n\r\n    exports.DCOUNT = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DCOUNTA = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DGET = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        // Return error if no record meets the criteria\r\n        if (resultIndexes.length === 0) {\r\n            return error.value;\r\n        }\r\n        // Returns the #NUM! error value because more than one record meets the\r\n        // criteria\r\n        if (resultIndexes.length > 1) {\r\n            return error.num;\r\n        }\r\n\r\n        return targetFields[resultIndexes[0]];\r\n    };\r\n\r\n    exports.DMAX = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var maxValue = targetFields[resultIndexes[0]];\r\n        for (var i = 1; i < resultIndexes.length; i++) {\r\n            if (maxValue < targetFields[resultIndexes[i]]) {\r\n                maxValue = targetFields[resultIndexes[i]];\r\n            }\r\n        }\r\n        return maxValue;\r\n    };\r\n\r\n    exports.DMIN = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var minValue = targetFields[resultIndexes[0]];\r\n        for (var i = 1; i < resultIndexes.length; i++) {\r\n            if (minValue > targetFields[resultIndexes[i]]) {\r\n                minValue = targetFields[resultIndexes[i]];\r\n            }\r\n        }\r\n        return minValue;\r\n    };\r\n\r\n    exports.DPRODUCT = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var targetValues = [];\r\n        for (var i = 0; i < resultIndexes.length; i++) {\r\n            targetValues[i] = targetFields[resultIndexes[i]];\r\n        }\r\n        targetValues = compact(targetValues);\r\n        var result = 1;\r\n        for (i = 0; i < targetValues.length; i++) {\r\n            result *= targetValues[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.DSTDEV = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DSTDEVP = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DSUM = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DVAR = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DVARP = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.MATCH = function(lookupValue, lookupArray, matchType) {\r\n        if (!lookupValue && !lookupArray) {\r\n            return error.na;\r\n        }\r\n        if (arguments.length === 2) {\r\n            matchType = 1;\r\n        }\r\n        if (!(lookupArray instanceof Array)) {\r\n            return error.na;\r\n        }\r\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\r\n            return error.na;\r\n        }\r\n\r\n        var index;\r\n        var indexValue;\r\n\r\n        for (var idx = 0; idx < lookupArray.length; idx++) {\r\n            if (matchType === 1) {\r\n                if (lookupArray[idx] === lookupValue) {\r\n                    return idx + 1;\r\n                } else if (lookupArray[idx] < lookupValue) {\r\n                    if (!indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    } else if (lookupArray[idx] > indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    }\r\n                }\r\n            } else if (matchType === 0) {\r\n                if (typeof lookupValue === 'string') {\r\n                    lookupValue = lookupValue.replace(/\\?/g, '.');\r\n                    if (lookupArray[idx].toLowerCase().match(lookupValue.toLowerCase())) {\r\n                        return idx + 1;\r\n                    }\r\n                } else {\r\n                    if (lookupArray[idx] === lookupValue) {\r\n                        return idx + 1;\r\n                    }\r\n                }\r\n            } else if (matchType === -1) {\r\n                if (lookupArray[idx] === lookupValue) {\r\n                    return idx + 1;\r\n                } else if (lookupArray[idx] > lookupValue) {\r\n                    if (!indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    } else if (lookupArray[idx] < indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return index ? index : error.na;\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.engineering = (function() {\r\n    var exports = {};\r\n\r\n    function isValidBinaryNumber(number) {\r\n        return (/^[01]{1,10}$/).test(number);\r\n    }\r\n\r\n    exports.BESSELI = function(x, n) {\r\n    };\r\n\r\n    exports.BESSELJ = function(x, n) {\r\n    };\r\n\r\n    exports.BESSELK = function(x, n) {\r\n    };\r\n\r\n    exports.BESSELY = function(x, n) {\r\n    };\r\n\r\n    exports.BIN2DEC = function(number) {\r\n        // Return error if number is not binary or contains more than 10\r\n        // characters (10 digits)\r\n        if (!isValidBinaryNumber(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert binary number to decimal\r\n        var result = parseInt(number, 2);\r\n\r\n        // Handle negative numbers\r\n        var stringified = number.toString();\r\n        if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n            return parseInt(stringified.substring(1), 2) - 512;\r\n        } else {\r\n            return result;\r\n        }\r\n    };\r\n\r\n    exports.BIN2HEX = function(number, places) {\r\n        // Return error if number is not binary or contains more than 10\r\n        // characters (10 digits)\r\n        if (!isValidBinaryNumber(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character hexadecimal number if number\r\n        // is negative\r\n        var stringified = number.toString();\r\n        if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n            return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\r\n        }\r\n\r\n        // Convert binary number to hexadecimal\r\n        var result = parseInt(number, 2).toString(16);\r\n\r\n        // Return hexadecimal number using the minimum number of characters\r\n        // necessary if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.BIN2OCT = function(number, places) {\r\n        // Return error if number is not binary or contains more than 10\r\n        // characters (10 digits)\r\n        if (!isValidBinaryNumber(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        var stringified = number.toString();\r\n        if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n            return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\r\n        }\r\n\r\n        // Convert binary number to octal\r\n        var result = parseInt(number, 2).toString(8);\r\n\r\n        // Return octal number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.BITAND = function(number1, number2) {\r\n        // Return error if either number is a non-numeric value\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either number is less than 0\r\n        if (number1 < 0 || number2 < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is a non-integer\r\n        if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is greater than (2^48)-1\r\n        if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bitwise AND of two numbers\r\n        return number1 & number2;\r\n    };\r\n\r\n    exports.BITLSHIFT = function(number, shift) {\r\n        number = utils.parseNumber(number);\r\n        shift = utils.parseNumber(shift);\r\n        if (utils.anyIsError(number, shift)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if number is less than 0\r\n        if (number < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is a non-integer\r\n        if (Math.floor(number) !== number) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is greater than (2^48)-1\r\n        if (number > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if the absolute value of shift is greater than 53\r\n        if (Math.abs(shift) > 53) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return number shifted by shift bits to the left or to the right if\r\n        // shift is negative\r\n        return (shift >= 0) ? number << shift : number >> -shift;\r\n    };\r\n\r\n    exports.BITOR = function(number1, number2) {\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either number is less than 0\r\n        if (number1 < 0 || number2 < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is a non-integer\r\n        if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is greater than (2^48)-1\r\n        if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bitwise OR of two numbers\r\n        return number1 | number2;\r\n    };\r\n\r\n    exports.BITRSHIFT = function(number, shift) {\r\n        number = utils.parseNumber(number);\r\n        shift = utils.parseNumber(shift);\r\n        if (utils.anyIsError(number, shift)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if number is less than 0\r\n        if (number < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is a non-integer\r\n        if (Math.floor(number) !== number) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is greater than (2^48)-1\r\n        if (number > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if the absolute value of shift is greater than 53\r\n        if (Math.abs(shift) > 53) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return number shifted by shift bits to the right or to the left if\r\n        // shift is negative\r\n        return (shift >= 0) ? number >> shift : number << -shift;\r\n    };\r\n\r\n    exports.BITXOR = function(number1, number2) {\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either number is less than 0\r\n        if (number1 < 0 || number2 < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is a non-integer\r\n        if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is greater than (2^48)-1\r\n        if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bitwise XOR of two numbers\r\n        return number1 ^ number2;\r\n    };\r\n\r\n    exports.COMPLEX = function(real, imaginary, suffix) {\r\n        real = utils.parseNumber(real);\r\n        imaginary = utils.parseNumber(imaginary);\r\n        if (utils.anyIsError(real, imaginary)) {\r\n            return real;\r\n        }\r\n\r\n        // Set suffix\r\n        suffix = (suffix === undefined) ? 'i' : suffix;\r\n\r\n        // Return error if suffix is neither \"i\" nor \"j\"\r\n        if (suffix !== 'i' && suffix !== 'j') {\r\n            return error.value;\r\n        }\r\n\r\n        // Return complex number\r\n        if (real === 0 && imaginary === 0) {\r\n            return 0;\r\n        } else if (real === 0) {\r\n            return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\r\n        } else if (imaginary === 0) {\r\n            return real.toString();\r\n        } else {\r\n            var sign = (imaginary > 0) ? '+' : '';\r\n            return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\r\n        }\r\n    };\r\n\r\n    exports.CONVERT = function(number, from_unit, to_unit) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // List of units supported by CONVERT and units defined by the\r\n        // International System of Units\r\n        // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion\r\n        // ratio]\r\n        var units = [\r\n            [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n            [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\r\n            [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\r\n            [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\r\n            [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n            [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\r\n            [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\r\n            [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\r\n            [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\r\n            [\"ngstrm\", \"\", [\"ang\"], \"length\", false, true, 1e-10],\r\n            [\"are\", \"ar\", null, \"area\", false, true, 100],\r\n            [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\r\n            [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\r\n            [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\r\n            [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\r\n            [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\r\n            [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\r\n            [\"byte\", \"byte\", null, \"information\", false, true, 8],\r\n            [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\r\n            [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\r\n            [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\r\n            [\"cubic ngstrm\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\r\n            [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\r\n            [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\r\n            [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\r\n            [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\r\n            [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\r\n            [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\r\n            [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\r\n            [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\r\n            [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\r\n            [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\r\n            [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\r\n            [\"degree\", \"\", null, \"angle\", false, false, 0.0174532925199433],\r\n            [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\r\n            [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\r\n            [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\r\n            [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\r\n            [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\r\n            [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\r\n            [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\r\n            [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\r\n            [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\r\n            [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\r\n            [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\r\n            [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\r\n            [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\r\n            [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\r\n            [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\r\n            [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\r\n            [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\r\n            [\"henry\", \"H\", null, \"inductance\", true, false, 1],\r\n            [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\r\n            [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\r\n            [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\r\n            [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\r\n            [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\r\n            [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\r\n            [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\r\n            [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\r\n            [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\r\n            [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\r\n            [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\r\n            [\"joule\", \"J\", null, \"energy\", true, true, 1],\r\n            [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\r\n            [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\r\n            [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\r\n            [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\r\n            [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\r\n            [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\r\n            [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\r\n            [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\r\n            [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\r\n            [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\r\n            [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\r\n            [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\r\n            [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\r\n            [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\r\n            [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\r\n            [\"metre\", \"m\", null, \"length\", true, true, 1],\r\n            [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\r\n            [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\r\n            [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\r\n            [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\r\n            [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\r\n            [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\r\n            [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\r\n            [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n            [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n            [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\r\n            [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\r\n            [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1852],\r\n            [\"newton\", \"N\", null, \"force\", true, true, 1],\r\n            [\"rsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\r\n            [\"ohm\", \"\", null, \"electric_resistance\", true, false, 1],\r\n            [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\r\n            [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\r\n            [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\r\n            [\"pferdestrke\", \"PS\", null, \"power\", false, true, 735.49875],\r\n            [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\r\n            [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\r\n            [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\r\n            [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\r\n            [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\r\n            [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\r\n            [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\r\n            [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\r\n            [\"radian\", \"rad\", null, \"angle\", true, false, 1],\r\n            [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\r\n            [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\r\n            [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\r\n            [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\r\n            [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\r\n            [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\r\n            [\"square ngstrm\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\r\n            [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\r\n            [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\r\n            [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\r\n            [\"square meter\", \"m?\", null, \"area\", true, true, 1],\r\n            [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\r\n            [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\r\n            [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\r\n            [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\r\n            [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\r\n            [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\r\n            [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\r\n            [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\r\n            [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\r\n            [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\r\n            [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\r\n            [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\r\n            [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\r\n            [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\r\n            [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\r\n            [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\r\n            [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\r\n            [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\r\n            [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\r\n            [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\r\n            [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\r\n            [\"volt\", \"V\", null, \"voltage\", true, false, 1],\r\n            [\"watt\", \"W\", null, \"power\", true, true, 1],\r\n            [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\r\n            [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\r\n            [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\r\n            [\"year\", \"yr\", null, \"time\", false, true, 31557600]\r\n        ];\r\n\r\n        // Binary prefixes\r\n        // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived\r\n        // from]\r\n        var binary_prefixes = {\r\n            Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\r\n            Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\r\n            Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\r\n            Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\r\n            Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\r\n            Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\r\n            Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\r\n            ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\r\n        };\r\n\r\n        // Unit prefixes\r\n        // [Name, Multiplier, Abbreviation]\r\n        var unit_prefixes = {\r\n            Y: [\"yotta\", 1e+24, \"Y\"],\r\n            Z: [\"zetta\", 1e+21, \"Z\"],\r\n            E: [\"exa\", 1e+18, \"E\"],\r\n            P: [\"peta\", 1e+15, \"P\"],\r\n            T: [\"tera\", 1e+12, \"T\"],\r\n            G: [\"giga\", 1e+09, \"G\"],\r\n            M: [\"mega\", 1e+06, \"M\"],\r\n            k: [\"kilo\", 1e+03, \"k\"],\r\n            h: [\"hecto\", 1e+02, \"h\"],\r\n            e: [\"dekao\", 1e+01, \"e\"],\r\n            d: [\"deci\", 1e-01, \"d\"],\r\n            c: [\"centi\", 1e-02, \"c\"],\r\n            m: [\"milli\", 1e-03, \"m\"],\r\n            u: [\"micro\", 1e-06, \"u\"],\r\n            n: [\"nano\", 1e-09, \"n\"],\r\n            p: [\"pico\", 1e-12, \"p\"],\r\n            f: [\"femto\", 1e-15, \"f\"],\r\n            a: [\"atto\", 1e-18, \"a\"],\r\n            z: [\"zepto\", 1e-21, \"z\"],\r\n            y: [\"yocto\", 1e-24, \"y\"]\r\n        };\r\n\r\n        // Initialize units and multipliers\r\n        var from = null;\r\n        var to = null;\r\n        var base_from_unit = from_unit;\r\n        var base_to_unit = to_unit;\r\n        var from_multiplier = 1;\r\n        var to_multiplier = 1;\r\n        var alt;\r\n\r\n        // Lookup from and to units\r\n        for (var i = 0; i < units.length; i++) {\r\n            alt = (units[i][2] === null) ? [] : units[i][2];\r\n            if (units[i][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n              from = units[i];\r\n            }\r\n            if (units[i][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n              to = units[i];\r\n            }\r\n        }\r\n\r\n        // Lookup from prefix\r\n        if (from === null) {\r\n            var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\r\n            var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\r\n\r\n            // Handle dekao unit prefix (only unit prefix with two characters)\r\n            if (from_unit.substring(0, 2) === 'da') {\r\n              from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n            }\r\n\r\n            // Handle binary prefixes first (so that 'Yi' is processed before\r\n            // 'Y')\r\n            if (from_binary_prefix) {\r\n              from_multiplier = from_binary_prefix[2];\r\n              base_from_unit = from_unit.substring(2);\r\n            } else if (from_unit_prefix) {\r\n              from_multiplier = from_unit_prefix[1];\r\n              base_from_unit = from_unit.substring(from_unit_prefix[2].length);\r\n            }\r\n\r\n            // Lookup from unit\r\n            for (var j = 0; j < units.length; j++) {\r\n              alt = (units[j][2] === null) ? [] : units[j][2];\r\n              if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n                  from = units[j];\r\n              }\r\n            }\r\n        }\r\n\r\n        // Lookup to prefix\r\n        if (to === null) {\r\n            var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\r\n            var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\r\n\r\n            // Handle dekao unit prefix (only unit prefix with two characters)\r\n            if (to_unit.substring(0, 2) === 'da') {\r\n              to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n            }\r\n\r\n            // Handle binary prefixes first (so that 'Yi' is processed before\r\n            // 'Y')\r\n            if (to_binary_prefix) {\r\n              to_multiplier = to_binary_prefix[2];\r\n              base_to_unit = to_unit.substring(2);\r\n            } else if (to_unit_prefix) {\r\n              to_multiplier = to_unit_prefix[1];\r\n              base_to_unit = to_unit.substring(to_unit_prefix[2].length);\r\n            }\r\n\r\n            // Lookup to unit\r\n            for (var k = 0; k < units.length; k++) {\r\n              alt = (units[k][2] === null) ? [] : units[k][2];\r\n              if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n                  to = units[k];\r\n              }\r\n            }\r\n        }\r\n\r\n        // Return error if a unit does not exist\r\n        if (from === null || to === null) {\r\n            return error.na;\r\n        }\r\n\r\n        // Return error if units represent different quantities\r\n        if (from[3] !== to[3]) {\r\n            return error.na;\r\n        }\r\n\r\n        // Return converted number\r\n        return number * from[6] * from_multiplier / (to[6] * to_multiplier);\r\n    };\r\n\r\n    exports.DEC2BIN = function(number, places) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // Return error if number is not decimal, is lower than -512, or is\r\n        // greater than 511\r\n        if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character binary number if number is\r\n        // negative\r\n        if (number < 0) {\r\n            return '1' + REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\r\n        }\r\n\r\n        // Convert decimal number to binary\r\n        var result = parseInt(number, 10).toString(2);\r\n\r\n        // Return binary number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.DEC2HEX = function(number, places) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // Return error if number is not decimal, is lower than -549755813888,\r\n        // or is greater than 549755813887\r\n        if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character hexadecimal number if number\r\n        // is negative\r\n        if (number < 0) {\r\n            return (1099511627776 + number).toString(16);\r\n        }\r\n\r\n        // Convert decimal number to hexadecimal\r\n        var result = parseInt(number, 10).toString(16);\r\n\r\n        // Return hexadecimal number using the minimum number of characters\r\n        // necessary if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.DEC2OCT = function(number, places) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // Return error if number is not decimal, is lower than -549755813888,\r\n        // or is greater than 549755813887\r\n        if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        if (number < 0) {\r\n            return (1073741824 + number).toString(8);\r\n        }\r\n\r\n        // Convert decimal number to octal\r\n        var result = parseInt(number, 10).toString(8);\r\n\r\n        // Return octal number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.DELTA = function(number1, number2) {\r\n        // Set number2 to zero if undefined\r\n        number2 = (number2 === undefined) ? 0 : number2;\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return delta\r\n        return (number1 === number2) ? 1 : 0;\r\n    };\r\n\r\n    exports.ERF = function(lower_bound, upper_bound) {\r\n    };\r\n\r\n    exports.ERF.PRECISE = function() {\r\n    };\r\n\r\n    exports.ERFC = function(x) {\r\n    };\r\n\r\n    exports.ERFC.PRECISE = function() {\r\n    };\r\n\r\n    exports.GESTEP = function(number, step) {\r\n        step = step || 0;\r\n        number = utils.parseNumber(number);\r\n        if (utils.anyIsError(step, number)) {\r\n            return number;\r\n        }\r\n\r\n        // Return delta\r\n        return (number >= step) ? 1 : 0;\r\n    };\r\n\r\n    exports.HEX2BIN = function(number, places) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Check if number is negative\r\n        var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\r\n\r\n        // Convert hexadecimal number to decimal\r\n        var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\r\n\r\n        // Return error if number is lower than -512 or greater than 511\r\n        if (decimal < -512 || decimal > 511) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character binary number if number is\r\n        // negative\r\n        if (negative) {\r\n            return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n        }\r\n\r\n        // Convert decimal number to binary\r\n        var result = decimal.toString(2);\r\n\r\n        // Return binary number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.HEX2DEC = function(number) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert hexadecimal number to decimal\r\n        var decimal = parseInt(number, 16);\r\n\r\n        // Return decimal number\r\n        return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\r\n    };\r\n\r\n    exports.HEX2OCT = function(number, places) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert hexadecimal number to decimal\r\n        var decimal = parseInt(number, 16);\r\n\r\n        // Return error if number is positive and greater than 0x1fffffff\r\n        // (536870911)\r\n        if (decimal > 536870911 && decimal < 1098974756864) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        if (decimal >= 1098974756864) {\r\n            return (decimal - 1098437885952).toString(8);\r\n        }\r\n\r\n        // Convert decimal number to octal\r\n        var result = decimal.toString(8);\r\n\r\n        // Return octal number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.IMABS = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return absolute value of complex number\r\n        return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\r\n    };\r\n\r\n    exports.IMAGINARY = function(inumber) {\r\n        if (inumber === undefined || inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return 0 if inumber is equal to 0\r\n        if (inumber === 0 || inumber === '0') {\r\n            return 0;\r\n        }\r\n\r\n        // Handle special cases\r\n        if (['i', 'j'].indexOf(inumber) >= 0) {\r\n            return 1;\r\n        }\r\n\r\n        // Normalize imaginary coefficient\r\n        inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\r\n\r\n        // Lookup sign\r\n        var plus = inumber.indexOf('+');\r\n        var minus = inumber.indexOf('-');\r\n        if (plus === 0) {\r\n            plus = inumber.indexOf('+', 1);\r\n        }\r\n\r\n        if (minus === 0) {\r\n            minus = inumber.indexOf('-', 1);\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var last = inumber.substring(inumber.length - 1, inumber.length);\r\n        var unit = (last === 'i' || last === 'j');\r\n\r\n        if (plus >= 0 || minus >= 0) {\r\n            // Return error if imaginary unit is neither i nor j\r\n            if (!unit) {\r\n              return error.num;\r\n            }\r\n\r\n            // Return imaginary coefficient of complex number\r\n            if (plus >= 0) {\r\n              return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  Number(inumber.substring(plus + 1, inumber.length - 1));\r\n            } else {\r\n              return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  -Number(inumber.substring(minus + 1, inumber.length - 1));\r\n            }\r\n        } else {\r\n            if (unit) {\r\n              return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\r\n            } else {\r\n              return (isNaN(inumber)) ? error.num : 0;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.IMARGUMENT = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if inumber is equal to zero\r\n        if (x === 0 && y === 0) {\r\n            return error.div0;\r\n        }\r\n\r\n        // Return PI/2 if x is equal to zero and y is positive\r\n        if (x === 0 && y > 0) {\r\n            return Math.PI / 2;\r\n        }\r\n\r\n        // Return -PI/2 if x is equal to zero and y is negative\r\n        if (x === 0 && y < 0) {\r\n            return -Math.PI / 2;\r\n        }\r\n\r\n        // Return zero if x is negative and y is equal to zero\r\n        if (y === 0 && x > 0) {\r\n            return 0;\r\n        }\r\n\r\n        // Return zero if x is negative and y is equal to zero\r\n        if (y === 0 && x < 0) {\r\n            return -Math.PI;\r\n        }\r\n\r\n        // Return argument of complex number\r\n        if (x > 0) {\r\n            return Math.atan(y / x);\r\n        } else if (x < 0 && y >= 0) {\r\n            return Math.atan(y / x) + Math.PI;\r\n        } else {\r\n            return Math.atan(y / x) - Math.PI;\r\n        }\r\n    };\r\n\r\n    exports.IMCONJUGATE = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return conjugate of complex number\r\n        return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\r\n    };\r\n\r\n    exports.IMCOS = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return cosine of complex number\r\n        return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n    };\r\n\r\n    exports.IMCOSH = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return hyperbolic cosine of complex number\r\n        return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\r\n    };\r\n\r\n    exports.IMCOT = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return cotangent of complex number\r\n        return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\r\n    };\r\n\r\n    exports.IMDIV = function(inumber1, inumber2) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var a = exports.IMREAL(inumber1);\r\n        var b = exports.IMAGINARY(inumber1);\r\n        var c = exports.IMREAL(inumber2);\r\n        var d = exports.IMAGINARY(inumber2);\r\n\r\n        if (utils.anyIsError(a, b, c, d)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit1 = inumber1.substring(inumber1.length - 1);\r\n        var unit2 = inumber2.substring(inumber2.length - 1);\r\n        var unit = 'i';\r\n        if (unit1 === 'j') {\r\n            unit = 'j';\r\n        } else if (unit2 === 'j') {\r\n            unit = 'j';\r\n        }\r\n\r\n        // Return error if inumber2 is null\r\n        if (c === 0 && d === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return exponential of complex number\r\n        var den = c * c + d * d;\r\n        return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\r\n    };\r\n\r\n    exports.IMEXP = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        var e = Math.exp(x);\r\n        return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\r\n    };\r\n\r\n    exports.IMLN = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\r\n    };\r\n\r\n    exports.IMLOG10 = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\r\n    };\r\n\r\n    exports.IMLOG2 = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\r\n    };\r\n\r\n    exports.IMPOWER = function(inumber, number) {\r\n        number = utils.parseNumber(number);\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n        if (utils.anyIsError(number, x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Calculate power of modulus\r\n        var p = Math.pow(exports.IMABS(inumber), number);\r\n\r\n        // Calculate argument\r\n        var t = exports.IMARGUMENT(inumber);\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\r\n    };\r\n\r\n    exports.IMPRODUCT = function() {\r\n        // Initialize result\r\n        var result = arguments[0];\r\n\r\n        // Loop on all numbers\r\n        for (var i = 1; i < arguments.length; i++) {\r\n            // Lookup coefficients of two complex numbers\r\n            var a = exports.IMREAL(result);\r\n            var b = exports.IMAGINARY(result);\r\n            var c = exports.IMREAL(arguments[i]);\r\n            var d = exports.IMAGINARY(arguments[i]);\r\n\r\n            if (utils.anyIsError(a, b, c, d)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Complute product of two complex numbers\r\n            result = exports.COMPLEX(a * c - b * d, a * d + b * c);\r\n        }\r\n\r\n        // Return product of complex numbers\r\n        return result;\r\n    };\r\n\r\n    exports.IMREAL = function(inumber) {\r\n        if (inumber === undefined || inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return 0 if inumber is equal to 0\r\n        if (inumber === 0 || inumber === '0') {\r\n            return 0;\r\n        }\r\n\r\n        // Handle special cases\r\n        if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\r\n            return 0;\r\n        }\r\n\r\n        // Lookup sign\r\n        var plus = inumber.indexOf('+');\r\n        var minus = inumber.indexOf('-');\r\n        if (plus === 0) {\r\n            plus = inumber.indexOf('+', 1);\r\n        }\r\n        if (minus === 0) {\r\n            minus = inumber.indexOf('-', 1);\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var last = inumber.substring(inumber.length - 1, inumber.length);\r\n        var unit = (last === 'i' || last === 'j');\r\n\r\n        if (plus >= 0 || minus >= 0) {\r\n            // Return error if imaginary unit is neither i nor j\r\n            if (!unit) {\r\n              return error.num;\r\n            }\r\n\r\n            // Return real coefficient of complex number\r\n            if (plus >= 0) {\r\n              return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  Number(inumber.substring(0, plus));\r\n            } else {\r\n              return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  Number(inumber.substring(0, minus));\r\n            }\r\n        } else {\r\n            if (unit) {\r\n              return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\r\n            } else {\r\n              return (isNaN(inumber)) ? error.num : inumber;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.IMSEC = function(inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return secant of complex number\r\n        return exports.IMDIV('1', exports.IMCOS(inumber));\r\n    };\r\n\r\n    exports.IMSECH = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return hyperbolic secant of complex number\r\n        return exports.IMDIV('1', exports.IMCOSH(inumber));\r\n    };\r\n\r\n    exports.IMSIN = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return sine of complex number\r\n        return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n    };\r\n\r\n    exports.IMSINH = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return hyperbolic sine of complex number\r\n        return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\r\n    };\r\n\r\n    exports.IMSQRT = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Calculate power of modulus\r\n        var s = Math.sqrt(exports.IMABS(inumber));\r\n\r\n        // Calculate argument\r\n        var t = exports.IMARGUMENT(inumber);\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\r\n    };\r\n\r\n    exports.IMCSC = function (inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return cosecant of complex number\r\n        return exports.IMDIV('1', exports.IMSIN(inumber));\r\n    };\r\n\r\n    exports.IMCSCH = function (inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return hyperbolic cosecant of complex number\r\n        return exports.IMDIV('1', exports.IMSINH(inumber));\r\n    };\r\n\r\n    exports.IMSUB = function(inumber1, inumber2) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var a = this.IMREAL(inumber1);\r\n        var b = this.IMAGINARY(inumber1);\r\n        var c = this.IMREAL(inumber2);\r\n        var d = this.IMAGINARY(inumber2);\r\n\r\n        if (utils.anyIsError(a, b, c, d)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit1 = inumber1.substring(inumber1.length - 1);\r\n        var unit2 = inumber2.substring(inumber2.length - 1);\r\n        var unit = 'i';\r\n        if (unit1 === 'j') {\r\n            unit = 'j';\r\n        } else if (unit2 === 'j') {\r\n            unit = 'j';\r\n        }\r\n\r\n        // Return _ of two complex numbers\r\n        return this.COMPLEX(a - c, b - d, unit);\r\n    };\r\n\r\n    exports.IMSUM = function() {\r\n        var args = utils.flatten(arguments);\r\n\r\n        // Initialize result\r\n        var result = args[0];\r\n\r\n        // Loop on all numbers\r\n        for (var i = 1; i < args.length; i++) {\r\n            // Lookup coefficients of two complex numbers\r\n            var a = this.IMREAL(result);\r\n            var b = this.IMAGINARY(result);\r\n            var c = this.IMREAL(args[i]);\r\n            var d = this.IMAGINARY(args[i]);\r\n\r\n            if (utils.anyIsError(a, b, c, d)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Complute product of two complex numbers\r\n            result = this.COMPLEX(a + c, b + d);\r\n        }\r\n\r\n        // Return sum of complex numbers\r\n        return result;\r\n    };\r\n\r\n    exports.IMTAN = function(inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return tangent of complex number\r\n        return this.IMDIV(this.IMSIN(inumber), this.IMCOS(inumber));\r\n    };\r\n\r\n    exports.OCT2BIN = function(number, places) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-7]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Check if number is negative\r\n        var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\r\n\r\n        // Convert octal number to decimal\r\n        var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\r\n\r\n        // Return error if number is lower than -512 or greater than 511\r\n        if (decimal < -512 || decimal > 511) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character binary number if number is\r\n        // negative\r\n        if (negative) {\r\n            return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n        }\r\n\r\n        // Convert decimal number to binary\r\n        var result = decimal.toString(2);\r\n\r\n        // Return binary number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.OCT2DEC = function(number) {\r\n        // Return error if number is not octal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-7]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert octal number to decimal\r\n        var decimal = parseInt(number, 8);\r\n\r\n        // Return decimal number\r\n        return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\r\n    };\r\n\r\n    exports.OCT2HEX = function(number, places) {\r\n        // Return error if number is not octal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-7]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert octal number to decimal\r\n        var decimal = parseInt(number, 8);\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        if (decimal >= 536870912) {\r\n            return 'ff' + (decimal + 3221225472).toString(16);\r\n        }\r\n\r\n        // Convert decimal number to hexadecimal\r\n        var result = decimal.toString(16);\r\n\r\n        // Return hexadecimal number using the minimum number of characters\r\n        // necessary if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.financial = (function() {\r\n    var exports = {};\r\n\r\n    function validDate(d) {\r\n        return d && d.getTime && !isNaN(d.getTime());\r\n    }\r\n\r\n    function ensureDate(d) {\r\n        return (d instanceof Date)?d:new Date(d);\r\n    }\r\n\r\n    exports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\r\n        // Return error if either date is invalid\r\n        issue        = ensureDate(issue);\r\n        first        = ensureDate(first);\r\n        settlement = ensureDate(settlement);\r\n        if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\r\n            return '#VALUE!';\r\n        }\r\n\r\n        // Return error if either rate or par are lower than or equal to zero\r\n        if (rate <= 0 || par <= 0) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Return error if frequency is neither 1, 2, or 4\r\n        if ([1, 2, 4].indexOf(frequency) === -1) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Return error if basis is neither 0, 1, 2, 3, or 4\r\n        if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Return error if settlement is before or equal to issue\r\n        if (settlement <= issue) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Set default values\r\n        par   = par   || 0;\r\n        basis = basis || 0;\r\n\r\n        // Compute accrued interest\r\n        return par * rate * YEARFRAC(issue, settlement, basis);\r\n    };\r\n\r\n    exports.ACCRINTM = null;\r\n\r\n    exports.AMORDEGRC = null;\r\n\r\n    exports.AMORLINC = null;\r\n\r\n    exports.COUPDAYBS = null;\r\n\r\n    exports.COUPDAYS = null;\r\n\r\n    exports.COUPDAYSNC = null;\r\n\r\n    exports.COUPNCD = null;\r\n\r\n    exports.COUPNUM = null;\r\n\r\n    exports.COUPPCD = null;\r\n\r\n    exports.CUMIPMT = function(rate, periods, value, start, end, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n        // Credits: Hannes Stiebitzhofer for the translations of function and\r\n            // variable names\r\n        // Requires exports.FV() and exports.PMT() from exports.js\r\n            // [http://stoic.com/exports/]\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        value = utils.parseNumber(value);\r\n        if (utils.anyIsError(rate, periods, value)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either rate, periods, or value are lower than or\r\n            // equal to zero\r\n        if (rate <= 0 || periods <= 0 || value <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if start < 1, end < 1, or start > end\r\n        if (start < 1 || end < 1 || start > end) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if type is neither 0 nor 1\r\n        if (type !== 0 && type !== 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Compute cumulative interest\r\n        var payment = exports.PMT(rate, periods, value, 0, type);\r\n        var interest = 0;\r\n\r\n        if (start === 1) {\r\n            if (type === 0) {\r\n                interest = -value;\r\n                start++;\r\n            }\r\n        }\r\n\r\n        for (var i = start; i <= end; i++) {\r\n            if (type === 1) {\r\n                interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\r\n            } else {\r\n                interest += exports.FV(rate, i - 1, payment, value, 0);\r\n            }\r\n        }\r\n        interest *= rate;\r\n\r\n        // Return cumulative interest\r\n        return interest;\r\n    };\r\n\r\n    exports.CUMPRINC = function(rate, periods, value, start, end, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n        // Credits: Hannes Stiebitzhofer for the translations of function and\r\n            // variable names\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        value = utils.parseNumber(value);\r\n        if (utils.anyIsError(rate, periods, value)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either rate, periods, or value are lower than or\r\n            // equal to zero\r\n        if (rate <= 0 || periods <= 0 || value <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if start < 1, end < 1, or start > end\r\n        if (start < 1 || end < 1 || start > end) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if type is neither 0 nor 1\r\n        if (type !== 0 && type !== 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Compute cumulative principal\r\n        var payment = exports.PMT(rate, periods, value, 0, type);\r\n        var principal = 0;\r\n        if (start === 1) {\r\n            if (type === 0) {\r\n                principal = payment + value * rate;\r\n            } else {\r\n                principal = payment;\r\n            }\r\n            start++;\r\n        }\r\n        for (var i = start; i <= end; i++) {\r\n            if (type > 0) {\r\n                principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\r\n            } else {\r\n                principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\r\n            }\r\n        }\r\n\r\n        // Return cumulative principal\r\n        return principal;\r\n    };\r\n\r\n    exports.DB = function(cost, salvage, life, period, month) {\r\n        // Initialize month\r\n        month = (month === undefined) ? 12 : month;\r\n\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        period = utils.parseNumber(period);\r\n        month = utils.parseNumber(month);\r\n        if (utils.anyIsError(cost, salvage, life, period, month)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if any of the parameters is negative\r\n        if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if month is not an integer between 1 and 12\r\n        if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if period is greater than life\r\n        if (period > life) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return 0 (zero) if salvage is greater than or equal to cost\r\n        if (salvage >= cost) {\r\n            return 0;\r\n        }\r\n\r\n        // Rate is rounded to three decimals places\r\n        var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\r\n\r\n        // Compute initial depreciation\r\n        var initial = cost * rate * month / 12;\r\n\r\n        // Compute total depreciation\r\n        var total = initial;\r\n        var current = 0;\r\n        var ceiling = (period === life) ? life - 1 : period;\r\n        for (var i = 2; i <= ceiling; i++) {\r\n            current = (cost - total) * rate;\r\n            total += current;\r\n        }\r\n\r\n        // Depreciation for the first and last periods are special cases\r\n        if (period === 1) {\r\n            // First period\r\n            return initial;\r\n        } else if (period === life) {\r\n            // Last period\r\n            return (cost - total) * rate;\r\n        } else {\r\n            return current;\r\n        }\r\n    };\r\n\r\n    exports.DDB = function(cost, salvage, life, period, factor) {\r\n        // Initialize factor\r\n        factor = (factor === undefined) ? 2 : factor;\r\n\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        period = utils.parseNumber(period);\r\n        factor = utils.parseNumber(factor);\r\n        if (utils.anyIsError(cost, salvage, life, period, factor)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if any of the parameters is negative or if factor is\r\n            // null\r\n        if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if period is greater than life\r\n        if (period > life) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return 0 (zero) if salvage is greater than or equal to cost\r\n        if (salvage >= cost) {\r\n            return 0;\r\n        }\r\n\r\n        // Compute depreciation\r\n        var total = 0;\r\n        var current = 0;\r\n        for (var i = 1; i <= period; i++) {\r\n            current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\r\n            total += current;\r\n        }\r\n\r\n        // Return depreciation\r\n        return current;\r\n    };\r\n\r\n    exports.DISC = null;\r\n\r\n    exports.DOLLARDE = function(dollar, fraction) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        dollar = utils.parseNumber(dollar);\r\n        fraction = utils.parseNumber(fraction);\r\n        if (utils.anyIsError(dollar, fraction)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if fraction is negative\r\n        if (fraction < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if fraction is greater than or equal to 0 and less than\r\n            // 1\r\n        if (fraction >= 0 && fraction < 1) {\r\n            return error.div0;\r\n        }\r\n\r\n        // Truncate fraction if it is not an integer\r\n        fraction = parseInt(fraction, 10);\r\n\r\n        // Compute integer part\r\n        var result = parseInt(dollar, 10);\r\n\r\n        // Add decimal part\r\n        result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\r\n\r\n        // Round result\r\n        var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\r\n        result = Math.round(result * power) / power;\r\n\r\n        // Return converted dollar price\r\n        return result;\r\n    };\r\n\r\n    exports.DOLLARFR = function(dollar, fraction) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        dollar = utils.parseNumber(dollar);\r\n        fraction = utils.parseNumber(fraction);\r\n        if (utils.anyIsError(dollar, fraction)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if fraction is negative\r\n        if (fraction < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if fraction is greater than or equal to 0 and less than\r\n            // 1\r\n        if (fraction >= 0 && fraction < 1) {\r\n            return error.div0;\r\n        }\r\n\r\n        // Truncate fraction if it is not an integer\r\n        fraction = parseInt(fraction, 10);\r\n\r\n        // Compute integer part\r\n        var result = parseInt(dollar, 10);\r\n\r\n        // Add decimal part\r\n        result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\r\n\r\n        // Return converted dollar price\r\n        return result;\r\n    };\r\n\r\n    exports.DURATION = null;\r\n\r\n    exports.EFFECT = function(rate, periods) {\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        if (utils.anyIsError(rate, periods)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if rate <=0 or periods < 1\r\n        if (rate <= 0 || periods < 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Truncate periods if it is not an integer\r\n        periods = parseInt(periods, 10);\r\n\r\n        // Return effective annual interest rate\r\n        return Math.pow(1 + rate / periods, periods) - 1;\r\n    };\r\n\r\n    exports.FV = function(rate, periods, payment, value, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        value = value || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        payment = utils.parseNumber(payment);\r\n        value = utils.parseNumber(value);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, payment, value, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return future value\r\n        var result;\r\n        if (rate === 0) {\r\n            result = value + payment * periods;\r\n        } else {\r\n            var term = Math.pow(1 + rate, periods);\r\n            if (type === 1) {\r\n                result = value * term + payment * (1 + rate) * (term - 1) / rate;\r\n            } else {\r\n                result = value * term + payment * (term - 1) / rate;\r\n            }\r\n        }\r\n        return -result;\r\n    };\r\n\r\n    exports.FVSCHEDULE = function(principal, schedule) {\r\n        principal = utils.parseNumber(principal);\r\n        schedule = utils.parseNumberArray(utils.flatten(schedule));\r\n        if (utils.anyIsError(principal, schedule)) {\r\n            return error.value;\r\n        }\r\n\r\n        var n = schedule.length;\r\n        var future = principal;\r\n\r\n        // Apply all interests in schedule\r\n        for (var i = 0; i < n; i++) {\r\n            // Apply scheduled interest\r\n            future *= 1 + schedule[i];\r\n        }\r\n\r\n        // Return future value\r\n        return future;\r\n    };\r\n\r\n    exports.INTRATE = null;\r\n\r\n    exports.IPMT = function(rate, period, periods, present, future, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        period = utils.parseNumber(period);\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, period, periods, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Compute payment\r\n        var payment = exports.PMT(rate, periods, present, future, type);\r\n\r\n        // Compute interest\r\n        var interest;\r\n        if (period === 1) {\r\n            if (type === 1) {\r\n                interest = 0;\r\n            } else {\r\n                interest = -present;\r\n            }\r\n        } else {\r\n            if (type === 1) {\r\n                interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\r\n            } else {\r\n                interest = exports.FV(rate, period - 1, payment, present, 0);\r\n            }\r\n        }\r\n\r\n        // Return interest\r\n        return interest * rate;\r\n    };\r\n\r\n    exports.IRR = function(values, guess) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        guess = guess || 0;\r\n\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        guess = utils.parseNumber(guess);\r\n        if (utils.anyIsError(values, guess)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Calculates the resulting amount\r\n        var irrResult = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = values[0];\r\n            for (var i = 1; i < values.length; i++) {\r\n                result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Calculates the first derivation\r\n        var irrResultDeriv = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = 0;\r\n            for (var i = 1; i < values.length; i++) {\r\n                var frac = (dates[i] - dates[0]) / 365;\r\n                result -= frac * values[i] / Math.pow(r, frac + 1);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Initialize dates and check that values contains at least one positive\r\n            // value and one negative value\r\n        var dates = [];\r\n        var positive = false;\r\n        var negative = false;\r\n        for (var i = 0; i < values.length; i++) {\r\n            dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\r\n            if (values[i] > 0) {\r\n                positive = true;\r\n            }\r\n            if (values[i] < 0) {\r\n                negative = true;\r\n            }\r\n        }\r\n\r\n        // Return error if values does not contain at least one positive value\r\n            // and one negative value\r\n        if (!positive || !negative) {\r\n            return error.num;\r\n        }\r\n\r\n        // Initialize guess and resultRate\r\n        guess = (guess === undefined) ? 0.1 : guess;\r\n        var resultRate = guess;\r\n\r\n        // Set maximum epsilon for end of iteration\r\n        var epsMax = 1e-10;\r\n\r\n        // Implement Newton's method\r\n        var newRate, epsRate, resultValue;\r\n        var contLoop = true;\r\n        do {\r\n            resultValue = irrResult(values, dates, resultRate);\r\n            newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n            epsRate = Math.abs(newRate - resultRate);\r\n            resultRate = newRate;\r\n            contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n        } while (contLoop);\r\n\r\n        // Return internal rate of return\r\n        return resultRate;\r\n    };\r\n\r\n    exports.ISPMT = function(rate, period, periods, value) {\r\n        rate = utils.parseNumber(rate);\r\n        period = utils.parseNumber(period);\r\n        periods = utils.parseNumber(periods);\r\n        value = utils.parseNumber(value);\r\n        if (utils.anyIsError(rate, period, periods, value)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return interest\r\n        return value * rate * (period / periods - 1);\r\n    };\r\n\r\n    exports.MDURATION = null;\r\n\r\n    exports.MIRR = function(values, finance_rate, reinvest_rate) {\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        finance_rate = utils.parseNumber(finance_rate);\r\n        reinvest_rate = utils.parseNumber(reinvest_rate);\r\n        if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Initialize number of values\r\n        var n = values.length;\r\n\r\n        // Lookup payments (negative values) and incomes (positive values)\r\n        var payments = [];\r\n        var incomes = [];\r\n        for (var i = 0; i < n; i++) {\r\n            if (values[i] < 0) {\r\n                payments.push(values[i]);\r\n            } else {\r\n                incomes.push(values[i]);\r\n            }\r\n        }\r\n\r\n        // Return modified internal rate of return\r\n        var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\r\n        var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\r\n        return Math.pow(num / den, 1 / (n - 1)) - 1;\r\n    };\r\n\r\n    exports.NOMINAL = function(rate, periods) {\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        if (utils.anyIsError(rate, periods)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if rate <=0 or periods < 1\r\n        if (rate <= 0 || periods < 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Truncate periods if it is not an integer\r\n        periods = parseInt(periods, 10);\r\n\r\n        // Return nominal annual interest rate\r\n        return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\r\n    };\r\n\r\n    exports.NPER = function(rate, payment, present, future, type) {\r\n        type = (type === undefined) ? 0 : type;\r\n        future = (future === undefined) ? 0 : future;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        payment = utils.parseNumber(payment);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, payment, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return number of periods\r\n        var num = payment * (1 + rate * type) - future * rate;\r\n        var den = (present * rate + payment * (1 + rate * type));\r\n        return Math.log(num / den) / Math.log(1 + rate);\r\n    };\r\n\r\n    exports.NPV = function() {\r\n        var args = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (args instanceof Error) {\r\n            return args;\r\n        }\r\n\r\n        // Lookup rate\r\n        var rate = args[0];\r\n\r\n        // Initialize net present value\r\n        var value = 0;\r\n\r\n        // Loop on all values\r\n        for (var j = 1; j < args.length; j++) {\r\n            value += args[j] / Math.pow(1 + rate, j);\r\n        }\r\n\r\n        // Return net present value\r\n        return value;\r\n    };\r\n\r\n    exports.ODDFPRICE = null;\r\n\r\n    exports.ODDFYIELD = null;\r\n\r\n    exports.ODDLPRICE = null;\r\n\r\n    exports.ODDLYIELD = null;\r\n\r\n    exports.PDURATION = function(rate, present, future) {\r\n        rate = utils.parseNumber(rate);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        if (utils.anyIsError(rate, present, future)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if rate <=0\r\n        if (rate <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return number of periods\r\n        return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\r\n    };\r\n\r\n    exports.PMT = function(rate, periods, present, future, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return payment\r\n        var result;\r\n        if (rate === 0) {\r\n            result = (present + future) / periods;\r\n        } else {\r\n            var term = Math.pow(1 + rate, periods);\r\n            if (type === 1) {\r\n                result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\r\n            } else {\r\n                result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\r\n            }\r\n        }\r\n        return -result;\r\n    };\r\n\r\n    exports.PPMT = function(rate, period, periods, present, future, type) {\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\r\n    };\r\n\r\n    exports.PRICE = null;\r\n\r\n    exports.PRICEDISC = null;\r\n\r\n    exports.PRICEMAT = null;\r\n\r\n    exports.PV = function(rate, periods, payment, future, type) {\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        payment = utils.parseNumber(payment);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, payment, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return present value\r\n        if (rate === 0) {\r\n            return -payment * periods - future;\r\n        } else {\r\n            return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\r\n        }\r\n    };\r\n\r\n    exports.RATE = function(periods, payment, present, future, type, guess) {\r\n        // Credits: rabugento\r\n\r\n        guess = (guess === undefined) ? 0.01 : guess;\r\n        future = (future === undefined) ? 0 : future;\r\n        type = (type === undefined) ? 0 : type;\r\n\r\n        periods = utils.parseNumber(periods);\r\n        payment = utils.parseNumber(payment);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        guess = utils.parseNumber(guess);\r\n        if (utils.anyIsError(periods, payment, present, future, type, guess)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Set maximum epsilon for end of iteration\r\n        var epsMax = 1e-6;\r\n\r\n        // Set maximum number of iterations\r\n        var iterMax = 100;\r\n        var iter = 0;\r\n        var close = false;\r\n        var rate = guess;\r\n\r\n        while (iter < iterMax && !close) {\r\n            var t1 = Math.pow(rate + 1, periods);\r\n            var t2 = Math.pow(rate + 1, periods - 1);\r\n\r\n            var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\r\n            var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\r\n            var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\r\n\r\n            var newRate = rate - f1 / (f2 + f3);\r\n\r\n            if (Math.abs(newRate - rate) < epsMax) close = true;\r\n            iter++\r\n            rate = newRate;\r\n        }\r\n\r\n        if (!close) return Number.NaN + rate;\r\n        return rate;\r\n    };\r\n\r\n    // TODO\r\n    exports.RECEIVED = null;\r\n\r\n    exports.RRI = function(periods, present, future) {\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        if (utils.anyIsError(periods, present, future)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if periods or present is equal to 0 (zero)\r\n        if (periods === 0 || present === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return equivalent interest rate\r\n        return Math.pow(future / present, 1 / periods) - 1;\r\n    };\r\n\r\n    exports.SLN = function(cost, salvage, life) {\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        if (utils.anyIsError(cost, salvage, life)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if life equal to 0 (zero)\r\n        if (life === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return straight-line depreciation\r\n        return (cost - salvage) / life;\r\n    };\r\n\r\n    exports.SYD = function(cost, salvage, life, period) {\r\n        // Return error if any of the parameters is not a number\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        period = utils.parseNumber(period);\r\n        if (utils.anyIsError(cost, salvage, life, period)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if life equal to 0 (zero)\r\n        if (life === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if period is lower than 1 or greater than life\r\n        if (period < 1 || period > life) {\r\n            return error.num;\r\n        }\r\n\r\n        // Truncate period if it is not an integer\r\n        period = parseInt(period, 10);\r\n\r\n        // Return straight-line depreciation\r\n        return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\r\n    };\r\n\r\n    exports.TBILLEQ = function(settlement, maturity, discount) {\r\n        settlement = utils.parseDate(settlement);\r\n        maturity = utils.parseDate(maturity);\r\n        discount = utils.parseNumber(discount);\r\n        if (utils.anyIsError(settlement, maturity, discount)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if discount is lower than or equal to zero\r\n        if (discount <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if settlement is greater than maturity\r\n        if (settlement > maturity) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if maturity is more than one year after settlement\r\n        if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bond-equivalent yield\r\n        return (365 * discount) / (360 - discount * DAYS360(settlement, maturity, false));\r\n    };\r\n\r\n    exports.TBILLPRICE = function(settlement, maturity, discount) {\r\n        settlement = utils.parseDate(settlement);\r\n        maturity = utils.parseDate(maturity);\r\n        discount = utils.parseNumber(discount);\r\n        if (utils.anyIsError(settlement, maturity, discount)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if discount is lower than or equal to zero\r\n        if (discount <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if settlement is greater than maturity\r\n        if (settlement > maturity) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if maturity is more than one year after settlement\r\n        if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bond-equivalent yield\r\n        return 100 * (1 - discount * DAYS360(settlement, maturity, false) / 360);\r\n    };\r\n\r\n    exports.TBILLYIELD = function(settlement, maturity, price) {\r\n        settlement = utils.parseDate(settlement);\r\n        maturity = utils.parseDate(maturity);\r\n        price = utils.parseNumber(price);\r\n        if (utils.anyIsError(settlement, maturity, price)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if price is lower than or equal to zero\r\n        if (price <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if settlement is greater than maturity\r\n        if (settlement > maturity) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if maturity is more than one year after settlement\r\n        if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bond-equivalent yield\r\n        return (100 - price) * 360 / (price * DAYS360(settlement, maturity, false));\r\n    };\r\n\r\n    exports.VDB = null;\r\n\r\n    exports.XIRR = function(values, dates, guess) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        dates = utils.parseDateArray(utils.flatten(dates));\r\n        guess = utils.parseNumber(guess);\r\n        if (utils.anyIsError(values, dates, guess)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Calculates the resulting amount\r\n        var irrResult = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = values[0];\r\n            for (var i = 1; i < values.length; i++) {\r\n                result += values[i] / Math.pow(r, DAYS(dates[i], dates[0]) / 365);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Calculates the first derivation\r\n        var irrResultDeriv = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = 0;\r\n            for (var i = 1; i < values.length; i++) {\r\n                var frac = DAYS(dates[i], dates[0]) / 365;\r\n                result -= frac * values[i] / Math.pow(r, frac + 1);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Check that values contains at least one positive value and one\r\n            // negative value\r\n        var positive = false;\r\n        var negative = false;\r\n        for (var i = 0; i < values.length; i++) {\r\n            if (values[i] > 0) {\r\n                positive = true;\r\n            }\r\n            if (values[i] < 0) {\r\n                negative = true;\r\n            }\r\n        }\r\n\r\n        // Return error if values does not contain at least one positive value\r\n            // and one negative value\r\n        if (!positive || !negative) {\r\n            return error.num;\r\n        }\r\n\r\n        // Initialize guess and resultRate\r\n        guess = guess || 0.1;\r\n        var resultRate = guess;\r\n\r\n        // Set maximum epsilon for end of iteration\r\n        var epsMax = 1e-10;\r\n\r\n        // Implement Newton's method\r\n        var newRate, epsRate, resultValue;\r\n        var contLoop = true;\r\n        do {\r\n            resultValue = irrResult(values, dates, resultRate);\r\n            newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n            epsRate = Math.abs(newRate - resultRate);\r\n            resultRate = newRate;\r\n            contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n        } while (contLoop);\r\n\r\n        // Return internal rate of return\r\n        return resultRate;\r\n    };\r\n\r\n    exports.XNPV = function(rate, values, dates) {\r\n        rate = utils.parseNumber(rate);\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        dates = utils.parseDateArray(utils.flatten(dates));\r\n        if (utils.anyIsError(rate, values, dates)) {\r\n            return error.value;\r\n        }\r\n\r\n        var result = 0;\r\n        for (var i = 0; i < values.length; i++) {\r\n            result += values[i] / Math.pow(1 + rate, DAYS(dates[i], dates[0]) / 365);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.YIELD = null;\r\n\r\n    exports.YIELDDISC = null;\r\n\r\n    exports.YIELDMAT = null;\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.information = (function() {\r\n    var exports = {};\r\n    exports.CELL = null;\r\n\r\n    exports.ERROR = {};\r\n    exports.ERROR.TYPE = function(error_val) {\r\n        switch (error_val) {\r\n            case error.nil: return 1;\r\n            case error.div0: return 2;\r\n            case error.value: return 3;\r\n            case error.ref: return 4;\r\n            case error.name: return 5;\r\n            case error.num: return 6;\r\n            case error.na: return 7;\r\n            case error.data: return 8;\r\n        }\r\n        return error.na;\r\n    };\r\n\r\n    exports.INFO = null;\r\n\r\n    exports.ISBLANK = function(value) {\r\n        return value === null;\r\n    };\r\n\r\n    exports.ISBINARY = function (number) {\r\n        return (/^[01]{1,10}$/).test(number);\r\n    };\r\n\r\n    exports.ISERR = function(value) {\r\n        return ([error.value, error.ref, error.div0, error.num, error.name, error.nil]).indexOf(value) >= 0 ||\r\n            (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\r\n    };\r\n\r\n    exports.ISERROR = function(value) {\r\n        return exports.ISERR(value) || value === error.na;\r\n    };\r\n\r\n    exports.ISEVEN = function(number) {\r\n        return (Math.floor(Math.abs(number)) & 1) ? false : true;\r\n    };\r\n\r\n    // TODO\r\n    exports.ISFORMULA = null;\r\n\r\n    exports.ISLOGICAL = function(value) {\r\n        return value === true || value === false;\r\n    };\r\n\r\n    exports.ISNA = function(value) {\r\n        return value === error.na;\r\n    };\r\n\r\n    exports.ISNONTEXT = function(value) {\r\n        return typeof(value) !== 'string';\r\n    };\r\n\r\n    exports.ISNUMBER = function(value) {\r\n        return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\r\n    };\r\n\r\n    exports.ISODD = function(number) {\r\n        return (Math.floor(Math.abs(number)) & 1) ? true : false;\r\n    };\r\n\r\n    exports.ISREF = null;\r\n\r\n    exports.ISTEXT = function(value) {\r\n        return typeof(value) === 'string';\r\n    };\r\n\r\n    exports.N = function(value) {\r\n        if (this.ISNUMBER(value)) {\r\n            return value;\r\n        }\r\n        if (value instanceof Date) {\r\n            return value.getTime();\r\n        }\r\n        if (value === true) {\r\n            return 1;\r\n        }\r\n        if (value === false) {\r\n            return 0;\r\n        }\r\n        if (this.ISERROR(value)) {\r\n            return value;\r\n        }\r\n        return 0;\r\n    };\r\n\r\n    exports.NA = function() {\r\n        return error.na;\r\n    };\r\n\r\n    exports.SHEET = null;\r\n\r\n    exports.SHEETS = null;\r\n\r\n    exports.TYPE = function(value) {\r\n        if (this.ISNUMBER(value)) {\r\n            return 1;\r\n        }\r\n        if (this.ISTEXT(value)) {\r\n            return 2;\r\n        }\r\n        if (this.ISLOGICAL(value)) {\r\n            return 4;\r\n        }\r\n        if (this.ISERROR(value)) {\r\n            return 16;\r\n        }\r\n        if (Array.isArray(value)) {\r\n            return 64;\r\n        }\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.logical = (function() {\r\n    var exports = {};\r\n\r\n    exports.AND = function() {\r\n        var args = utils.flatten(arguments);\r\n        var result = true;\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (!args[i]) {\r\n                result = false;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.CHOOSE = function() {\r\n        if (arguments.length < 2) {\r\n            return error.na;\r\n        }\r\n\r\n        var index = arguments[0];\r\n        if (index < 1 || index > 254) {\r\n            return error.value;\r\n        }\r\n\r\n        if (arguments.length < index + 1) {\r\n            return error.value;\r\n        }\r\n\r\n        return arguments[index];\r\n    };\r\n\r\n    exports.FALSE = function() {\r\n        return false;\r\n    };\r\n\r\n    exports.IF = function(test, then_value, otherwise_value) {\r\n        return test ? then_value : otherwise_value;\r\n    };\r\n\r\n    exports.IFERROR = function(value, valueIfError) {\r\n        if (ISERROR(value)) {\r\n            return valueIfError;\r\n        }\r\n        return value;\r\n    };\r\n\r\n    exports.IFNA = function(value, value_if_na) {\r\n        return value === error.na ? value_if_na : value;\r\n    };\r\n\r\n    exports.NOT = function(logical) {\r\n        return !logical;\r\n    };\r\n\r\n    exports.OR = function() {\r\n        var args = utils.flatten(arguments);\r\n        var result = false;\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (args[i]) {\r\n                result = true;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.TRUE = function() {\r\n        return true;\r\n    };\r\n\r\n    exports.XOR = function() {\r\n        var args = utils.flatten(arguments);\r\n        var result = 0;\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (args[i]) {\r\n                result++;\r\n            }\r\n        }\r\n        return (Math.floor(Math.abs(result)) & 1) ? true : false;\r\n    };\r\n\r\n    exports.SWITCH = function() {\r\n        var result;\r\n        if (arguments.length > 0)  {\r\n            var targetValue = arguments[0];\r\n            var argc = arguments.length - 1;\r\n            var switchCount = Math.floor(argc / 2);\r\n            var switchSatisfied = false;\r\n            var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\r\n\r\n            if (switchCount) {\r\n                for (var index = 0; index < switchCount; index++) {\r\n                    if (targetValue === arguments[index * 2 + 1]) {\r\n                      result = arguments[index * 2 + 2];\r\n                      switchSatisfied = true;\r\n                      break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!switchSatisfied && defaultClause) {\r\n                result = defaultClause;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.math = (function() {\r\n    var exports = {};\r\n\r\n    exports.ABS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.abs(utils.parseNumber(number));\r\n    };\r\n\r\n    exports.ACOS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.acos(number);\r\n    };\r\n\r\n    exports.ACOSH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number + Math.sqrt(number * number - 1));\r\n    };\r\n\r\n    exports.ACOT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.atan(1 / number);\r\n    };\r\n\r\n    exports.ACOTH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 0.5 * Math.log((number + 1) / (number - 1));\r\n    };\r\n\r\n    exports.AGGREGATE = null\r\n\r\n    exports.ARABIC = function(text) {\r\n        // Credits: Rafa? Kukawski\r\n        if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\r\n            return error.value;\r\n        }\r\n        var r = 0;\r\n        text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function(i) {\r\n            r += {\r\n                M: 1000,\r\n                CM: 900,\r\n                D: 500,\r\n                CD: 400,\r\n                C: 100,\r\n                XC: 90,\r\n                L: 50,\r\n                XL: 40,\r\n                X: 10,\r\n                IX: 9,\r\n                V: 5,\r\n                IV: 4,\r\n                I: 1\r\n            }[i];\r\n        });\r\n        return r;\r\n    };\r\n\r\n    exports.ASIN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.asin(number);\r\n    };\r\n\r\n    exports.ASINH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number + Math.sqrt(number * number + 1));\r\n    };\r\n\r\n    exports.ATAN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.atan(number);\r\n    };\r\n\r\n    exports.ATAN2 = function(number_x, number_y) {\r\n        number_x = utils.parseNumber(number_x);\r\n        number_y = utils.parseNumber(number_y);\r\n        if (utils.anyIsError(number_x, number_y)) {\r\n            return error.value;\r\n        }\r\n        return Math.atan2(number_x, number_y);\r\n    };\r\n\r\n    exports.ATANH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log((1 + number) / (1 - number)) / 2;\r\n    };\r\n\r\n    exports.BASE = function(number, radix, min_length) {\r\n        min_length = min_length || 0;\r\n\r\n        number = utils.parseNumber(number);\r\n        radix = utils.parseNumber(radix);\r\n        min_length = utils.parseNumber(min_length);\r\n        if (utils.anyIsError(number, radix, min_length)) {\r\n            return error.value;\r\n        }\r\n        min_length = (min_length === undefined) ? 0 : min_length;\r\n        var result = number.toString(radix);\r\n        return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\r\n    };\r\n\r\n    exports.CEILING = function(number, significance, mode) {\r\n        significance = (significance === undefined) ? 1 : significance;\r\n        mode = (mode === undefined) ? 0 : mode;\r\n\r\n        number = utils.parseNumber(number);\r\n        significance = utils.parseNumber(significance);\r\n        mode = utils.parseNumber(mode);\r\n        if (utils.anyIsError(number, significance, mode)) {\r\n            return error.value;\r\n        }\r\n        if (significance === 0) {\r\n            return 0;\r\n        }\r\n\r\n        significance = Math.abs(significance);\r\n        if (number >= 0) {\r\n            return Math.ceil(number / significance) * significance;\r\n        } else {\r\n            if (mode === 0) {\r\n                return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n            } else {\r\n                return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.CEILING.MATH = exports.CEILING;\r\n\r\n    exports.CEILING.PRECISE = exports.CEILING;\r\n\r\n    exports.COMBIN = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\r\n    };\r\n\r\n    exports.COMBINA = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\r\n    };\r\n\r\n    exports.COS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.cos(number);\r\n    };\r\n\r\n    exports.COSH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return (Math.exp(number) + Math.exp(-number)) / 2;\r\n    };\r\n\r\n    exports.COT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 1 / Math.tan(number);\r\n    };\r\n\r\n    exports.COTH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var e2 = Math.exp(2 * number);\r\n        return (e2 + 1) / (e2 - 1);\r\n    };\r\n\r\n    exports.CSC = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 1 / Math.sin(number);\r\n    };\r\n\r\n    exports.CSCH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 2 / (Math.exp(number) - Math.exp(-number));\r\n    };\r\n\r\n    exports.DECIMAL = function(number, radix) {\r\n        if (arguments.length < 1) {\r\n            return error.value;\r\n        }\r\n\r\n\r\n        return parseInt(number, radix);\r\n    };\r\n\r\n    exports.DEGREES = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return number * 180 / Math.PI;\r\n    };\r\n\r\n    exports.EVEN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return exports.CEILING(number, -2, -1);\r\n    };\r\n\r\n    exports.EXP = Math.exp;\r\n\r\n    var MEMOIZED_FACT = [];\r\n    exports.FACT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var n = Math.floor(number);\r\n        if (n === 0 || n === 1) {\r\n            return 1;\r\n        } else if (MEMOIZED_FACT[n] > 0) {\r\n            return MEMOIZED_FACT[n];\r\n        } else {\r\n            MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\r\n            return MEMOIZED_FACT[n];\r\n        }\r\n    };\r\n\r\n    exports.FACTDOUBLE = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var n = Math.floor(number);\r\n        if (n <= 0) {\r\n            return 1;\r\n        } else {\r\n            return n * exports.FACTDOUBLE(n - 2);\r\n        }\r\n    };\r\n\r\n    exports.FLOOR = function(number, significance, mode) {\r\n        significance = (significance === undefined) ? 1 : significance;\r\n        mode = (mode === undefined) ? 0 : mode;\r\n\r\n        number = utils.parseNumber(number);\r\n        significance = utils.parseNumber(significance);\r\n        mode = utils.parseNumber(mode);\r\n        if (utils.anyIsError(number, significance, mode)) {\r\n            return error.value;\r\n        }\r\n        if (significance === 0) {\r\n            return 0;\r\n        }\r\n\r\n        significance = Math.abs(significance);\r\n        if (number >= 0) {\r\n            return Math.floor(number / significance) * significance;\r\n        } else {\r\n            if (mode === 0) {\r\n                return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n            } else {\r\n                return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.FLOOR.MATH = exports.FLOOR;\r\n\r\n    exports.GCD = null;\r\n\r\n    exports.INT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.floor(number);\r\n    };\r\n\r\n    exports.LCM = function() {\r\n        // Credits: Jonas Raoni Soares Silva\r\n        var o = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (o instanceof Error) {\r\n            return o;\r\n        }\r\n        for (var i, j, n, d, r = 1;\r\n            (n = o.pop()) !== undefined;) {\r\n            while (n > 1) {\r\n                if (n % 2) {\r\n                    for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\r\n                      //empty\r\n                    }\r\n                    d = (i <= j) ? i : n;\r\n                } else {\r\n                    d = 2;\r\n                }\r\n                for (n /= d, r *= d, i = o.length; i;\r\n                    (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\r\n                    //empty\r\n                }\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n\r\n    exports.LN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number);\r\n    };\r\n\r\n    exports.LOG = function(number, base) {\r\n        number = utils.parseNumber(number);\r\n        base = (base === undefined) ? 10 : utils.parseNumber(base);\r\n\r\n        if (utils.anyIsError(number, base)) {\r\n            return error.value;\r\n        }\r\n\r\n        return Math.log(number) / Math.log(base);\r\n    };\r\n\r\n    exports.LOG10 = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number) / Math.log(10);\r\n    };\r\n\r\n    exports.MDETERM = null;\r\n\r\n    exports.MINVERSE = null;\r\n\r\n    exports.MMULT = null;\r\n\r\n    exports.MOD = function(dividend, divisor) {\r\n        dividend = utils.parseNumber(dividend);\r\n        divisor = utils.parseNumber(divisor);\r\n        if (utils.anyIsError(dividend, divisor)) {\r\n            return error.value;\r\n        }\r\n        if (divisor === 0) {\r\n            return error.div0;\r\n        }\r\n        var modulus = Math.abs(dividend % divisor);\r\n        return (divisor > 0) ? modulus : -modulus;\r\n    };\r\n\r\n    exports.MROUND = function(number, multiple) {\r\n        number = utils.parseNumber(number);\r\n        multiple = utils.parseNumber(multiple);\r\n        if (utils.anyIsError(number, multiple)) {\r\n            return error.value;\r\n        }\r\n        if (number * multiple < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        return Math.round(number / multiple) * multiple;\r\n    };\r\n\r\n    exports.MULTINOMIAL = function() {\r\n        var args = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (args instanceof Error) {\r\n            return args;\r\n        }\r\n        var sum = 0;\r\n        var divisor = 1;\r\n        for (var i = 0; i < args.length; i++) {\r\n            sum += args[i];\r\n            divisor *= exports.FACT(args[i]);\r\n        }\r\n        return exports.FACT(sum) / divisor;\r\n    };\r\n\r\n    exports.MUNIT = null;\r\n\r\n    exports.ODD = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var temp = Math.ceil(Math.abs(number));\r\n        temp = (temp & 1) ? temp : temp + 1;\r\n        return (number > 0) ? temp : -temp;\r\n    };\r\n\r\n    exports.PI = function() {\r\n        return Math.PI;\r\n    };\r\n\r\n    exports.POWER = function(number, power) {\r\n        number = utils.parseNumber(number);\r\n        power = utils.parseNumber(power);\r\n        if (utils.anyIsError(number, power)) {\r\n            return error.value;\r\n        }\r\n        var result = Math.pow(number, power);\r\n        if (isNaN(result)) {\r\n            return error.num;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.PRODUCT = function() {\r\n        var args = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (args instanceof Error) {\r\n            return args;\r\n        }\r\n        var result = 1;\r\n        for (var i = 0; i < args.length; i++) {\r\n            result *= args[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.QUOTIENT = function(numerator, denominator) {\r\n        numerator = utils.parseNumber(numerator);\r\n        denominator = utils.parseNumber(denominator);\r\n        if (utils.anyIsError(numerator, denominator)) {\r\n            return error.value;\r\n        }\r\n        return parseInt(numerator / denominator, 10);\r\n    };\r\n\r\n    exports.RADIANS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return number * Math.PI / 180;\r\n    };\r\n\r\n    exports.RAND = function() {\r\n        return Math.random();\r\n    };\r\n\r\n    exports.RANDBETWEEN = function(bottom, top) {\r\n        bottom = utils.parseNumber(bottom);\r\n        top = utils.parseNumber(top);\r\n        if (utils.anyIsError(bottom, top)) {\r\n            return error.value;\r\n        }\r\n        // Creative Commons Attribution 3.0 License\r\n        // Copyright (c) 2012 eqcode\r\n        return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\r\n    };\r\n\r\n    exports.ROMAN = null;\r\n\r\n    exports.ROUND = function(number, digits) {\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\r\n    };\r\n\r\n    exports.ROUNDDOWN = function(number, digits) {\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        var sign = (number > 0) ? 1 : -1;\r\n        return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n    };\r\n\r\n    exports.ROUNDUP = function(number, digits) {\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        var sign = (number > 0) ? 1 : -1;\r\n        return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n    };\r\n\r\n    exports.SEC = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 1 / Math.cos(number);\r\n    };\r\n\r\n    exports.SECH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 2 / (Math.exp(number) + Math.exp(-number));\r\n    };\r\n\r\n    exports.SERIESSUM = function(x, n, m, coefficients) {\r\n        x = utils.parseNumber(x);\r\n        n = utils.parseNumber(n);\r\n        m = utils.parseNumber(m);\r\n        coefficients = utils.parseNumberArray(coefficients);\r\n        if (utils.anyIsError(x, n, m, coefficients)) {\r\n            return error.value;\r\n        }\r\n        var result = coefficients[0] * Math.pow(x, n);\r\n        for (var i = 1; i < coefficients.length; i++) {\r\n            result += coefficients[i] * Math.pow(x, n + i * m);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SIGN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        if (number < 0) {\r\n            return -1;\r\n        } else if (number === 0) {\r\n            return 0;\r\n        } else {\r\n            return 1;\r\n        }\r\n    };\r\n\r\n    exports.SIN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.sin(number);\r\n    };\r\n\r\n    exports.SINH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return (Math.exp(number) - Math.exp(-number)) / 2;\r\n    };\r\n\r\n    exports.SQRT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        if (number < 0) {\r\n            return error.num;\r\n        }\r\n        return Math.sqrt(number);\r\n    };\r\n\r\n    exports.SQRTPI = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.sqrt(number * Math.PI);\r\n    };\r\n\r\n    exports.SUBTOTAL = null;\r\n\r\n    exports.ADD = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.value;\r\n        }\r\n\r\n        return num1 + num2;\r\n    };\r\n\r\n    exports.MINUS = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.value;\r\n        }\r\n\r\n        return num1 - num2;\r\n    };\r\n\r\n    exports.DIVIDE = function (dividend, divisor) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        dividend = utils.parseNumber(dividend);\r\n        divisor = utils.parseNumber(divisor);\r\n        if (utils.anyIsError(dividend, divisor)) {\r\n            return error.value;\r\n        }\r\n\r\n        if (divisor === 0) {\r\n            return error.div0;\r\n        }\r\n\r\n        return dividend / divisor;\r\n    };\r\n\r\n    exports.MULTIPLY = function (factor1, factor2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        factor1 = utils.parseNumber(factor1);\r\n        factor2 = utils.parseNumber(factor2);\r\n        if (utils.anyIsError(factor1, factor2)) {\r\n            return error.value;\r\n        }\r\n\r\n        return factor1 * factor2;\r\n    };\r\n\r\n    exports.GTE = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.error;\r\n        }\r\n\r\n        return num1 >= num2;\r\n    };\r\n\r\n    exports.LT = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.error;\r\n        }\r\n\r\n        return num1 < num2;\r\n    };\r\n\r\n    exports.LTE = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.error;\r\n        }\r\n\r\n        return num1 <= num2;\r\n    };\r\n\r\n    exports.EQ = function (value1, value2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        return value1 === value2;\r\n    };\r\n\r\n    exports.NE = function (value1, value2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        return value1 !== value2;\r\n    };\r\n\r\n    exports.POW = function (base, exponent) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        base = utils.parseNumber(base);\r\n        exponent = utils.parseNumber(exponent);\r\n        if (utils.anyIsError(base, exponent)) {\r\n            return error.error;\r\n        }\r\n\r\n        return exports.POWER(base, exponent);\r\n    };\r\n\r\n    exports.SUM = function() {\r\n        var result = 0;\r\n        var argsKeys = Object.keys(arguments);\r\n        for (var i = 0; i < argsKeys.length; ++i) {\r\n            var elt = arguments[argsKeys[i]];\r\n            if (typeof elt === 'number') {\r\n                result += elt;\r\n            } else if (typeof elt === 'string') {\r\n                var parsed = parseFloat(elt);\r\n                !isNaN(parsed) && (result += parsed);\r\n            } else if (Array.isArray(elt)) {\r\n                result += exports.SUM.apply(null, elt);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMIF = function(range, criteria) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        var result = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMIFS = function() {\r\n        var args = utils.argsToArray(arguments);\r\n        var range = utils.parseNumberArray(utils.flatten(args.shift()));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        var criteria = args;\r\n\r\n        var n_range_elements = range.length;\r\n        var n_criterias = criteria.length;\r\n\r\n        var result = 0;\r\n        for (var i = 0; i < n_range_elements; i++) {\r\n            var el = range[i];\r\n            var condition = '';\r\n            for (var c = 0; c < n_criterias; c++) {\r\n                condition += el + criteria[c];\r\n                if (c !== n_criterias - 1) {\r\n                    condition += '&&';\r\n                }\r\n            }\r\n            if (eval(condition)) { // jshint ignore:line\r\n                result += el;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMPRODUCT = null;\r\n\r\n    exports.SUMSQ = function() {\r\n        var numbers = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (numbers instanceof Error) {\r\n            return numbers;\r\n        }\r\n        var result = 0;\r\n        var length = numbers.length;\r\n        for (var i = 0; i < length; i++) {\r\n            result += (ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMX2MY2 = function(array_x, array_y) {\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        if (utils.anyIsError(array_x, array_y)) {\r\n            return error.value;\r\n        }\r\n        var result = 0;\r\n        for (var i = 0; i < array_x.length; i++) {\r\n            result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMX2PY2 = function(array_x, array_y) {\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        if (utils.anyIsError(array_x, array_y)) {\r\n            return error.value;\r\n        }\r\n        var result = 0;\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        for (var i = 0; i < array_x.length; i++) {\r\n            result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMXMY2 = function(array_x, array_y) {\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        if (utils.anyIsError(array_x, array_y)) {\r\n            return error.value;\r\n        }\r\n        var result = 0;\r\n        array_x = utils.flatten(array_x);\r\n        array_y = utils.flatten(array_y);\r\n        for (var i = 0; i < array_x.length; i++) {\r\n            result += Math.pow(array_x[i] - array_y[i], 2);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.TAN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.tan(number);\r\n    };\r\n\r\n    exports.TANH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var e2 = Math.exp(2 * number);\r\n        return (e2 - 1) / (e2 + 1);\r\n    };\r\n\r\n    exports.TRUNC = function(number, digits) {\r\n        digits = (digits === undefined) ? 0 : digits;\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        var sign = (number > 0) ? 1 : -1;\r\n        return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.misc = (function() {\r\n    var exports = {};\r\n\r\n    exports.UNIQUE = function () {\r\n        var result = [];\r\n        for (var i = 0; i < arguments.length; ++i) {\r\n            var hasElement = false;\r\n            var element = arguments[i];\r\n\r\n            // Check if we've already seen this element.\r\n            for (var j = 0; j < result.length; ++j) {\r\n                hasElement = result[j] === element;\r\n                if (hasElement) { break; }\r\n            }\r\n\r\n            // If we did not find it, add it to the result.\r\n            if (!hasElement) {\r\n                result.push(element);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.FLATTEN = utils.flatten;\r\n\r\n    exports.ARGS2ARRAY = function () {\r\n        return Array.prototype.slice.call(arguments, 0);\r\n    };\r\n\r\n    exports.REFERENCE = function (context, reference) {\r\n        try {\r\n            var path = reference.split('.');\r\n            var result = context;\r\n            for (var i = 0; i < path.length; ++i) {\r\n                var step = path[i];\r\n                if (step[step.length - 1] === ']') {\r\n                    var opening = step.indexOf('[');\r\n                    var index = step.substring(opening + 1, step.length - 1);\r\n                    result = result[step.substring(0, opening)][index];\r\n                } else {\r\n                    result = result[step];\r\n                }\r\n            }\r\n            return result;\r\n        } catch (error) {}\r\n    };\r\n\r\n    exports.JOIN = function (array, separator) {\r\n        return array.join(separator);\r\n    };\r\n\r\n    exports.NUMBERS = function () {\r\n        var possibleNumbers = utils.flatten(arguments);\r\n        return possibleNumbers.filter(function (el) {\r\n            return typeof el === 'number';\r\n        });\r\n    };\r\n\r\n    exports.NUMERAL = null;\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.text = (function() {\r\n    var exports = {};\r\n\r\n    exports.ASC = null;\r\n\r\n    exports.BAHTTEXT = null;\r\n\r\n    exports.CHAR = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return String.fromCharCode(number);\r\n    };\r\n\r\n    exports.CLEAN = function(text) {\r\n        text = text || '';\r\n        var re = /[\\0-\\x1F]/g;\r\n        return text.replace(re, \"\");\r\n    };\r\n\r\n    exports.CODE = function(text) {\r\n        text = text || '';\r\n        return text.charCodeAt(0);\r\n    };\r\n\r\n    exports.CONCATENATE = function() {\r\n        var args = utils.flatten(arguments);\r\n\r\n        var trueFound = 0;\r\n        while ((trueFound = args.indexOf(true)) > -1) {\r\n            args[trueFound] = 'TRUE';\r\n        }\r\n\r\n        var falseFound = 0;\r\n        while ((falseFound = args.indexOf(false)) > -1) {\r\n            args[falseFound] = 'FALSE';\r\n        }\r\n\r\n        return args.join('');\r\n    };\r\n\r\n    exports.DBCS = null;\r\n\r\n    exports.DOLLAR = null;\r\n\r\n    exports.EXACT = function(text1, text2) {\r\n        return text1 === text2;\r\n    };\r\n\r\n    exports.FIND = function(find_text, within_text, position) {\r\n        position = (position === undefined) ? 0 : position;\r\n        return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\r\n    };\r\n\r\n    exports.FIXED = null;\r\n\r\n    exports.HTML2TEXT = function (value) {\r\n        var result = '';\r\n\r\n        if (value) {\r\n            if (value instanceof Array) {\r\n                value.forEach(function (line) {\r\n                    if (result !== '') {\r\n                      result += '\\n';\r\n                    }\r\n                    result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\r\n                });\r\n            } else {\r\n                result = value.replace(/<(?:.|\\n)*?>/gm, '');\r\n            }\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.LEFT = function(text, number) {\r\n        number = (number === undefined) ? 1 : number;\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error || typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text ? text.substring(0, number) : null;\r\n    };\r\n\r\n    exports.LEN = function(text) {\r\n        if (arguments.length === 0) {\r\n            return error.error;\r\n        }\r\n\r\n        if (typeof text === 'string') {\r\n            return text ? text.length : 0;\r\n        }\r\n\r\n        if (text.length) {\r\n            return text.length;\r\n        }\r\n\r\n        return error.value;\r\n    };\r\n\r\n    exports.LOWER = function(text) {\r\n        if (typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text ? text.toLowerCase() : text;\r\n    };\r\n\r\n    exports.MID = function(text, start, number) {\r\n        start = utils.parseNumber(start);\r\n        number = utils.parseNumber(number);\r\n        if (utils.anyIsError(start, number) || typeof text !== 'string') {\r\n            return number;\r\n        }\r\n\r\n        var begin = start - 1;\r\n        var end = begin + number;\r\n\r\n        return text.substring(begin, end);\r\n    };\r\n\r\n    exports.NUMBERVALUE = null;\r\n\r\n    exports.PRONETIC = null;\r\n\r\n    exports.PROPER = function(text) {\r\n        if (text === undefined || text.length === 0) {\r\n            return error.value;\r\n        }\r\n        if (text === true) {\r\n            text = 'TRUE';\r\n        }\r\n        if (text === false) {\r\n            text = 'FALSE';\r\n        }\r\n        if (isNaN(text) && typeof text === 'number') {\r\n            return error.value;\r\n        }\r\n        if (typeof text === 'number') {\r\n            text = '' + text;\r\n        }\r\n\r\n        return text.replace(/\\w\\S*/g, function(txt) {\r\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\r\n        });\r\n    };\r\n\r\n    exports.REGEXEXTRACT = function (text, regular_expression) {\r\n        var match = text.match(new RegExp(regular_expression));\r\n        return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\r\n    };\r\n\r\n    exports.REGEXMATCH = function (text, regular_expression, full) {\r\n        var match = text.match(new RegExp(regular_expression));\r\n        return full ? match : !!match;\r\n    };\r\n\r\n    exports.REGEXREPLACE = function (text, regular_expression, replacement) {\r\n        return text.replace(new RegExp(regular_expression), replacement);\r\n    };\r\n\r\n    exports.REPLACE = function(text, position, length, new_text) {\r\n        position = utils.parseNumber(position);\r\n        length = utils.parseNumber(length);\r\n        if (utils.anyIsError(position, length) ||\r\n            typeof text !== 'string' ||\r\n            typeof new_text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\r\n    };\r\n\r\n    exports.REPT = function(text, number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return new Array(number + 1).join(text);\r\n    };\r\n\r\n    exports.RIGHT = function(text, number) {\r\n        number = (number === undefined) ? 1 : number;\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return text ? text.substring(text.length - number) : null;\r\n    };\r\n\r\n    exports.SEARCH = function(find_text, within_text, position) {\r\n        var foundAt;\r\n        if (typeof find_text !== 'string' || typeof within_text !== 'string') {\r\n            return error.value;\r\n        }\r\n        position = (position === undefined) ? 0 : position;\r\n        foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\r\n        return (foundAt === 0)?error.value:foundAt;\r\n    };\r\n\r\n    exports.SPLIT = function (text, separator) {\r\n        return text.split(separator);\r\n    };\r\n\r\n    exports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\r\n        if (!text || !old_text || !new_text) {\r\n            return text;\r\n        } else if (occurrence === undefined) {\r\n            return text.replace(new RegExp(old_text, 'g'), new_text);\r\n        } else {\r\n            var index = 0;\r\n            var i = 0;\r\n            while (text.indexOf(old_text, index) > 0) {\r\n                index = text.indexOf(old_text, index + 1);\r\n                i++;\r\n                if (i === occurrence) {\r\n                    return text.substring(0, index) + new_text + text.substring(index + old_text.length);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.T = function(value) {\r\n        return (typeof value === \"string\") ? value : '';\r\n    };\r\n\r\n    exports.TEXT = null;\r\n\r\n    exports.TRIM = function(text) {\r\n        if (typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text.replace(/ +/g, ' ').trim();\r\n    };\r\n\r\n    exports.UNICHAR = exports.CHAR;\r\n\r\n    exports.UNICODE = exports.CODE;\r\n\r\n    exports.UPPER = function(text) {\r\n        if (typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text.toUpperCase();\r\n    };\r\n\r\n    exports.VALUE = null;\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.stats = (function() {\r\n    var exports = {};\r\n\r\n    var SQRT2PI = 2.5066282746310002;\r\n\r\n    exports.AVEDEV = null;\r\n\r\n    exports.AVERAGE = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        var n = range.length;\r\n        var sum = 0;\r\n        var count = 0;\r\n        for (var i = 0; i < n; i++) {\r\n            sum += range[i];\r\n            count += 1;\r\n        }\r\n        return sum / count;\r\n    };\r\n\r\n    exports.AVERAGEA = function() {\r\n        var range = utils.flatten(arguments);\r\n        var n = range.length;\r\n        var sum = 0;\r\n        var count = 0;\r\n        for (var i = 0; i < n; i++) {\r\n            var el = range[i];\r\n            if (typeof el === 'number') {\r\n                sum += el;\r\n            }\r\n            if (el === true) {\r\n                sum++;\r\n            }\r\n            if (el !== null) {\r\n                count++;\r\n            }\r\n        }\r\n        return sum / count;\r\n    };\r\n\r\n    exports.AVERAGEIF = function(range, criteria, average_range) {\r\n        average_range = average_range || range;\r\n        range = utils.flatten(range);\r\n        average_range = utils.parseNumberArray(utils.flatten(average_range));\r\n        if (average_range instanceof Error) {\r\n            return average_range;\r\n        }\r\n        var average_count = 0;\r\n        var result = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                result += average_range[i];\r\n                average_count++;\r\n            }\r\n        }\r\n        return result / average_count;\r\n    };\r\n\r\n    exports.AVERAGEIFS = null;\r\n\r\n    exports.COUNT = function() {\r\n        return utils.numbers(utils.flatten(arguments)).length;\r\n    };\r\n\r\n    exports.COUNTA = function() {\r\n        var range = utils.flatten(arguments);\r\n        return range.length - exports.COUNTBLANK(range);\r\n    };\r\n\r\n    exports.COUNTIN = function (range, value) {\r\n        var result = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            if (range[i] === value) {\r\n                result++;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.COUNTBLANK = function() {\r\n        var range = utils.flatten(arguments);\r\n        var blanks = 0;\r\n        var element;\r\n        for (var i = 0; i < range.length; i++) {\r\n            element = range[i];\r\n            if (element === null || element === '') {\r\n                blanks++;\r\n            }\r\n        }\r\n        return blanks;\r\n    };\r\n\r\n    exports.COUNTIF = function(range, criteria) {\r\n        range = utils.flatten(range);\r\n        if (!/[<>=!]/.test(criteria)) {\r\n            criteria = '==\"' + criteria + '\"';\r\n        }\r\n        var matches = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            if (typeof range[i] !== 'string') {\r\n                if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                    matches++;\r\n                }\r\n            } else {\r\n                if (eval('\"' + range[i] + '\"' + criteria)) { // jshint ignore:line\r\n                    matches++;\r\n                }\r\n            }\r\n        }\r\n        return matches;\r\n    };\r\n\r\n    exports.COUNTIFS = function() {\r\n        var args = utils.argsToArray(arguments);\r\n        var results = new Array(utils.flatten(args[0]).length);\r\n        for (var i = 0; i < results.length; i++) {\r\n            results[i] = true;\r\n        }\r\n        for (i = 0; i < args.length; i += 2) {\r\n            var range = utils.flatten(args[i]);\r\n            var criteria = args[i + 1];\r\n            if (!/[<>=!]/.test(criteria)) {\r\n                criteria = '==\"' + criteria + '\"';\r\n            }\r\n            for (var j = 0; j < range.length; j++) {\r\n                if (typeof range[j] !== 'string') {\r\n                    results[j] = results[j] && eval(range[j] + criteria); // jshint ignore:line\r\n                } else {\r\n                    results[j] = results[j] && eval('\"' + range[j] + '\"' + criteria); // jshint ignore:line\r\n                }\r\n            }\r\n        }\r\n        var result = 0;\r\n        for (i = 0; i < results.length; i++) {\r\n            if (results[i]) {\r\n                result++;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.COUNTUNIQUE = function () {\r\n        return UNIQUE.apply(null, utils.flatten(arguments)).length;\r\n    };\r\n\r\n    exports.FISHER = function(x) {\r\n        x = utils.parseNumber(x);\r\n        if (x instanceof Error) {\r\n            return x;\r\n        }\r\n        return Math.log((1 + x) / (1 - x)) / 2;\r\n    };\r\n\r\n    exports.FISHERINV = function(y) {\r\n        y = utils.parseNumber(y);\r\n        if (y instanceof Error) {\r\n            return y;\r\n        }\r\n        var e2y = Math.exp(2 * y);\r\n        return (e2y - 1) / (e2y + 1);\r\n    };\r\n\r\n    exports.FREQUENCY = function(data, bins) {\r\n        data = utils.parseNumberArray(utils.flatten(data));\r\n        bins = utils.parseNumberArray(utils.flatten(bins));\r\n        if (utils.anyIsError(data, bins)) {\r\n            return error.value;\r\n        }\r\n        var n = data.length;\r\n        var b = bins.length;\r\n        var r = [];\r\n        for (var i = 0; i <= b; i++) {\r\n            r[i] = 0;\r\n            for (var j = 0; j < n; j++) {\r\n                if (i === 0) {\r\n                    if (data[j] <= bins[0]) {\r\n                        r[0] += 1;\r\n                    }\r\n                } else if (i < b) {\r\n                    if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\r\n                        r[i] += 1;\r\n                    }\r\n                } else if (i === b) {\r\n                    if (data[j] > bins[b - 1]) {\r\n                        r[b] += 1;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n\r\n    exports.LARGE = function(range, k) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(range, k)) {\r\n            return range;\r\n        }\r\n        return range.sort(function(a, b) {\r\n            return b - a;\r\n        })[k - 1];\r\n    };\r\n\r\n    exports.MAX = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n    };\r\n\r\n    exports.MAXA = function() {\r\n        var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n    };\r\n\r\n    exports.MIN = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n    };\r\n\r\n    exports.MINA = function() {\r\n        var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n    };\r\n\r\n    exports.MODE = {};\r\n\r\n    exports.MODE.MULT = function() {\r\n        // Credits: Ronan\r\n        var range = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        var n = range.length;\r\n        var count = {};\r\n        var maxItems = [];\r\n        var max = 0;\r\n        var currentItem;\r\n\r\n        for (var i = 0; i < n; i++) {\r\n            currentItem = range[i];\r\n            count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\r\n            if (count[currentItem] > max) {\r\n                max = count[currentItem];\r\n                maxItems = [];\r\n            }\r\n            if (count[currentItem] === max) {\r\n                maxItems[maxItems.length] = currentItem;\r\n            }\r\n        }\r\n        return maxItems;\r\n    };\r\n\r\n    exports.MODE.SNGL = function() {\r\n        var range = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        return exports.MODE.MULT(range).sort(function(a, b) {\r\n            return a - b;\r\n        })[0];\r\n    };\r\n\r\n    exports.PERCENTILE = {};\r\n\r\n    exports.PERCENTILE.EXC = function(array, k) {\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(array, k)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            {\r\n                return a - b;\r\n            }\r\n        });\r\n        var n = array.length;\r\n        if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\r\n            return error.num;\r\n        }\r\n        var l = k * (n + 1) - 1;\r\n        var fl = Math.floor(l);\r\n        return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n    };\r\n\r\n    exports.PERCENTILE.INC = function(array, k) {\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(array, k)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var n = array.length;\r\n        var l = k * (n - 1);\r\n        var fl = Math.floor(l);\r\n        return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n    };\r\n\r\n    exports.PERCENTRANK = {};\r\n\r\n    exports.PERCENTRANK.EXC = function(array, x, significance) {\r\n        significance = (significance === undefined) ? 3 : significance;\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        x = utils.parseNumber(x);\r\n        significance = utils.parseNumber(significance);\r\n        if (utils.anyIsError(array, x, significance)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var uniques = UNIQUE.apply(null, array);\r\n        var n = array.length;\r\n        var m = uniques.length;\r\n        var power = Math.pow(10, significance);\r\n        var result = 0;\r\n        var match = false;\r\n        var i = 0;\r\n        while (!match && i < m) {\r\n            if (x === uniques[i]) {\r\n                result = (array.indexOf(uniques[i]) + 1) / (n + 1);\r\n                match = true;\r\n            } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\r\n                match = true;\r\n            }\r\n            i++;\r\n        }\r\n        return Math.floor(result * power) / power;\r\n    };\r\n\r\n    exports.PERCENTRANK.INC = function(array, x, significance) {\r\n        significance = (significance === undefined) ? 3 : significance;\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        x = utils.parseNumber(x);\r\n        significance = utils.parseNumber(significance);\r\n        if (utils.anyIsError(array, x, significance)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var uniques = UNIQUE.apply(null, array);\r\n        var n = array.length;\r\n        var m = uniques.length;\r\n        var power = Math.pow(10, significance);\r\n        var result = 0;\r\n        var match = false;\r\n        var i = 0;\r\n        while (!match && i < m) {\r\n            if (x === uniques[i]) {\r\n                result = array.indexOf(uniques[i]) / (n - 1);\r\n                match = true;\r\n            } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\r\n                match = true;\r\n            }\r\n            i++;\r\n        }\r\n        return Math.floor(result * power) / power;\r\n    };\r\n\r\n    exports.PERMUT = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return FACT(number) / FACT(number - number_chosen);\r\n    };\r\n\r\n    exports.PERMUTATIONA = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return Math.pow(number, number_chosen);\r\n    };\r\n\r\n    exports.PHI = function(x) {\r\n        x = utils.parseNumber(x);\r\n        if (x instanceof Error) {\r\n            return error.value;\r\n        }\r\n        return Math.exp(-0.5 * x * x) / SQRT2PI;\r\n    };\r\n\r\n    exports.PROB = function(range, probability, lower, upper) {\r\n        if (lower === undefined) {\r\n            return 0;\r\n        }\r\n        upper = (upper === undefined) ? lower : upper;\r\n\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        probability = utils.parseNumberArray(utils.flatten(probability));\r\n        lower = utils.parseNumber(lower);\r\n        upper = utils.parseNumber(upper);\r\n        if (utils.anyIsError(range, probability, lower, upper)) {\r\n            return error.value;\r\n        }\r\n\r\n        if (lower === upper) {\r\n            return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\r\n        }\r\n\r\n        var sorted = range.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var n = sorted.length;\r\n        var result = 0;\r\n        for (var i = 0; i < n; i++) {\r\n            if (sorted[i] >= lower && sorted[i] <= upper) {\r\n                result += probability[range.indexOf(sorted[i])];\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.QUARTILE = {};\r\n\r\n    exports.QUARTILE.EXC = function(range, quart) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        quart = utils.parseNumber(quart);\r\n        if (utils.anyIsError(range, quart)) {\r\n            return error.value;\r\n        }\r\n        switch (quart) {\r\n            case 1:\r\n                return exports.PERCENTILE.EXC(range, 0.25);\r\n            case 2:\r\n                return exports.PERCENTILE.EXC(range, 0.5);\r\n            case 3:\r\n                return exports.PERCENTILE.EXC(range, 0.75);\r\n            default:\r\n                return error.num;\r\n        }\r\n    };\r\n\r\n    exports.QUARTILE.INC = function(range, quart) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        quart = utils.parseNumber(quart);\r\n        if (utils.anyIsError(range, quart)) {\r\n            return error.value;\r\n        }\r\n        switch (quart) {\r\n            case 1:\r\n                return exports.PERCENTILE.INC(range, 0.25);\r\n            case 2:\r\n                return exports.PERCENTILE.INC(range, 0.5);\r\n            case 3:\r\n                return exports.PERCENTILE.INC(range, 0.75);\r\n            default:\r\n                return error.num;\r\n        }\r\n    };\r\n\r\n    exports.RANK = {};\r\n\r\n    exports.RANK.AVG = function(number, range, order) {\r\n        number = utils.parseNumber(number);\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        if (utils.anyIsError(number, range)) {\r\n            return error.value;\r\n        }\r\n        range = utils.flatten(range);\r\n        order = order || false;\r\n        var sort = (order) ? function(a, b) {\r\n            return a - b;\r\n        } : function(a, b) {\r\n            return b - a;\r\n        };\r\n        range = range.sort(sort);\r\n\r\n        var length = range.length;\r\n        var count = 0;\r\n        for (var i = 0; i < length; i++) {\r\n            if (range[i] === number) {\r\n                count++;\r\n            }\r\n        }\r\n\r\n        return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\r\n    };\r\n\r\n    exports.RANK.EQ = function(number, range, order) {\r\n        number = utils.parseNumber(number);\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        if (utils.anyIsError(number, range)) {\r\n            return error.value;\r\n        }\r\n        order = order || false;\r\n        var sort = (order) ? function(a, b) {\r\n            return a - b;\r\n        } : function(a, b) {\r\n            return b - a;\r\n        };\r\n        range = range.sort(sort);\r\n        return range.indexOf(number) + 1;\r\n    };\r\n\r\n    exports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\r\n        data_x = utils.parseNumberArray(utils.flatten(data_x));\r\n        data_y = utils.parseNumberArray(utils.flatten(data_y));\r\n        if (utils.anyIsError(data_x, data_y)) {\r\n            return error.value;\r\n        }\r\n        return Math.pow(exports.PEARSON(data_x, data_y), 2);\r\n    };\r\n\r\n    exports.SMALL = function(range, k) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(range, k)) {\r\n            return range;\r\n        }\r\n        return range.sort(function(a, b) {\r\n            return a - b;\r\n        })[k - 1];\r\n    };\r\n\r\n    exports.STANDARDIZE = function(x, mean, sd) {\r\n        x = utils.parseNumber(x);\r\n        mean = utils.parseNumber(mean);\r\n        sd = utils.parseNumber(sd);\r\n        if (utils.anyIsError(x, mean, sd)) {\r\n            return error.value;\r\n        }\r\n        return (x - mean) / sd;\r\n    };\r\n\r\n    exports.STDEV = {};\r\n\r\n    exports.STDEV.P = function() {\r\n        var v = exports.VAR.P.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.STDEV.S = function() {\r\n        var v = exports.VAR.S.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.STDEVA = function() {\r\n        var v = exports.VARA.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.STDEVPA = function() {\r\n        var v = exports.VARPA.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.VAR = {};\r\n\r\n    exports.VAR.P = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var mean = exports.AVERAGE(range);\r\n        for (var i = 0; i < n; i++) {\r\n            sigma += Math.pow(range[i] - mean, 2);\r\n        }\r\n        return sigma / n;\r\n    };\r\n\r\n    exports.VAR.S = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var mean = exports.AVERAGE(range);\r\n        for (var i = 0; i < n; i++) {\r\n            sigma += Math.pow(range[i] - mean, 2);\r\n        }\r\n        return sigma / (n - 1);\r\n    };\r\n\r\n    exports.VARA = function() {\r\n        var range = utils.flatten(arguments);\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var count = 0;\r\n        var mean = exports.AVERAGEA(range);\r\n        for (var i = 0; i < n; i++) {\r\n            var el = range[i];\r\n            if (typeof el === 'number') {\r\n                sigma += Math.pow(el - mean, 2);\r\n            } else if (el === true) {\r\n                sigma += Math.pow(1 - mean, 2);\r\n            } else {\r\n                sigma += Math.pow(0 - mean, 2);\r\n            }\r\n\r\n            if (el !== null) {\r\n                count++;\r\n            }\r\n        }\r\n        return sigma / (count - 1);\r\n    };\r\n\r\n    exports.VARPA = function() {\r\n        var range = utils.flatten(arguments);\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var count = 0;\r\n        var mean = exports.AVERAGEA(range);\r\n        for (var i = 0; i < n; i++) {\r\n            var el = range[i];\r\n            if (typeof el === 'number') {\r\n                sigma += Math.pow(el - mean, 2);\r\n            } else if (el === true) {\r\n                sigma += Math.pow(1 - mean, 2);\r\n            } else {\r\n                sigma += Math.pow(0 - mean, 2);\r\n            }\r\n\r\n            if (el !== null) {\r\n                count++;\r\n            }\r\n        }\r\n        return sigma / count;\r\n    };\r\n\r\n    exports.WEIBULL = {};\r\n\r\n    exports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\r\n        x = utils.parseNumber(x);\r\n        alpha = utils.parseNumber(alpha);\r\n        beta = utils.parseNumber(beta);\r\n        if (utils.anyIsError(x, alpha, beta)) {\r\n            return error.value;\r\n        }\r\n        return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\r\n    };\r\n\r\n    exports.Z = {};\r\n\r\n    exports.Z.TEST = function(range, x, sd) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        x = utils.parseNumber(x);\r\n        if (utils.anyIsError(range, x)) {\r\n            return error.value;\r\n        }\r\n\r\n        sd = sd || exports.STDEV.S(range);\r\n        var n = range.length;\r\n        return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\nfor (var i = 0; i < Object.keys(jexcel.methods).length; i++) {\r\n    var methods = jexcel.methods[Object.keys(jexcel.methods)[i]];\r\n    for (var j = 0; j < Object.keys(methods).length; j++) {\r\n        if (typeof(methods[Object.keys(methods)[j]]) == 'function') {\r\n            window[Object.keys(methods)[j]] = methods[Object.keys(methods)[j]];\r\n        } else {\r\n            window[Object.keys(methods)[j]] = function() {\r\n                return Object.keys(methods)[j] + 'Not implemented';\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n    return jexcel;\r\n\r\n})));","\r\n/**\r\n * (c) jSuites Javascript Web Components (v2.7)\r\n *\r\n * Author: Paul Hodel <paul.hodel@gmail.com>\r\n * Website: https://bossanova.uk/jsuites/\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jSuites = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\nvar jSuites = function(options) {\n    var obj = {}\n\n    obj.init = function() {\n        // Find root element\n        var app = document.querySelector('.japp');\n\n        // Root element\n        if (app) {\n            obj.el = app;\n        } else {\n            obj.el = document.body;\n        }\n    }\n\n    obj.guid = function() {\n        var guid = '';\n        for (var i = 0; i < 32; i++) {\n            guid += Math.floor(Math.random()*0xF).toString(0xF);\n        }\n        return guid;\n    }\n\n    obj.getWindowWidth = function() {\n        var w = window,\n        d = document,\n        e = d.documentElement,\n        g = d.getElementsByTagName('body')[0],\n        x = w.innerWidth || e.clientWidth || g.clientWidth;\n        return x;\n    }\n\n    obj.getWindowHeight = function() {\n        var w = window,\n        d = document,\n        e = d.documentElement,\n        g = d.getElementsByTagName('body')[0],\n        y = w.innerHeight|| e.clientHeight|| g.clientHeight;\n        return  y;\n    }\n\n    obj.getPosition = function(e) {\n        if (e.changedTouches && e.changedTouches[0]) {\n            var x = e.changedTouches[0].pageX;\n            var y = e.changedTouches[0].pageY;\n        } else {\n            var x = (window.Event) ? e.pageX : e.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft);\n            var y = (window.Event) ? e.pageY : e.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop);\n        }\n\n        return [ x, y ];\n    }\n\n    obj.click = function(el) {\n        if (el.click) {\n            el.click();\n        } else {\n            var evt = new MouseEvent('click', {\n                bubbles: true,\n                cancelable: true,\n                view: window\n            });\n            el.dispatchEvent(evt);\n        }\n    }\n\n    obj.getElement = function(element, className) {\n        var foundElement = false;\n\n        function path (element) {\n            if (element.className) {\n                if (element.classList.contains(className)) {\n                    foundElement = element;\n                }\n            }\n\n            if (element.parentNode) {\n                path(element.parentNode);\n            }\n        }\n\n        path(element);\n\n        return foundElement;\n    }\n\n    obj.getLinkElement = function(element) {\n        var targetElement = false;\n\n        function path (element) {\n            if ((element.tagName == 'A' || element.tagName == 'DIV') && element.getAttribute('data-href')) {\n                targetElement = element;\n            }\n\n            if (element.parentNode) {\n                path(element.parentNode);\n            }\n        }\n\n        path(element);\n\n        return targetElement;\n    }\n\n    obj.getFormElements = function(formObject) {\n        var ret = {};\n\n        if (formObject) {\n            var elements = formObject.querySelectorAll(\"input, select, textarea\");\n        } else {\n            var elements = document.querySelectorAll(\"input, select, textarea\");\n        }\n\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var name = element.name;\n            var value = element.value;\n\n            if (name) {\n                ret[name] = value;\n            }\n        }\n\n        return ret;\n    }\n\n    obj.exists = function(url, __callback) {\n        var http = new XMLHttpRequest();\n        http.open('HEAD', url, false);\n        http.send();\n        if (http.status) {\n            __callback(http.status);\n        }\n    }\n\n    obj.getFiles = function(element) {\n        if (! element) {\n            console.error('No element defined in the arguments of your method');\n        }\n\n        // Get attachments\n        var files = element.querySelectorAll('.jfile');\n\n        if (files.length > 0) {\n            var data = [];\n            for (var i = 0; i < files.length; i++) {\n                var file = {};\n\n                var src = files[i].getAttribute('src');\n\n                if (files[i].classList.contains('jremove')) {\n                    file.remove = 1;\n                } else {\n                    if (src.substr(0,4) == 'data') {\n                        file.content = src.substr(src.indexOf(',') + 1);\n                        file.extension = files[i].getAttribute('data-extension');\n                    } else {\n                        file.file = src;\n                        file.extension = files[i].getAttribute('data-extension');\n                        if (! file.extension) {\n                            file.extension =  src.substr(src.lastIndexOf('.') + 1);\n                        }\n                        if (jSuites.files[file.file]) {\n                            file.content = jSuites.files[file.file];\n                        }\n                    }\n\n                    // Optional file information\n                    if (files[i].getAttribute('data-name')) {\n                        file.name = files[i].getAttribute('data-name');\n                    }\n\n                    if (files[i].getAttribute('data-file')) {\n                        file.file = files[i].getAttribute('data-file');\n                    }\n\n                    if (files[i].getAttribute('data-size')) {\n                        file.size = files[i].getAttribute('data-size');\n                    }\n\n                    if (files[i].getAttribute('data-date')) {\n                        file.date = files[i].getAttribute('data-date');\n                    }\n\n                    if (files[i].getAttribute('data-cover')) {\n                        file.cover = files[i].getAttribute('data-cover');\n                    }\n                }\n\n                // TODO SMALL thumbs?\n\n                data[i] = file;\n            }\n\n            return data;\n        }\n    }\n\n    obj.ajax = function(options) {\n        if (! options.data) {\n            options.data = {};\n        }\n\n        if (options.type) {\n            options.method = options.type;\n        }\n\n        if (options.data) {\n            var data = [];\n            var keys = Object.keys(options.data);\n\n            if (keys.length) {\n                for (var i = 0; i < keys.length; i++) {\n                    if (typeof(options.data[keys[i]]) == 'object') {\n                        var o = options.data[keys[i]];\n                        for (var j = 0; j < o.length; j++) {\n                            if (typeof(o[j]) == 'string') {\n                                data.push(keys[i] + '[' + j + ']=' + encodeURIComponent(o[j]));\n                            } else {\n                                var prop = Object.keys(o[j]);\n                                for (var z = 0; z < prop.length; z++) {\n                                    data.push(keys[i] + '[' + j + '][' + prop[z] + ']=' + encodeURIComponent(o[j][prop[z]]));\n                                }\n                            }\n                        }\n                    } else {\n                        data.push(keys[i] + '=' + encodeURIComponent(options.data[keys[i]]));\n                    }\n                }\n            }\n\n            if (options.method == 'GET' && data.length > 0) {\n                if (options.url.indexOf('?') < 0) {\n                    options.url += '?';\n                }\n                options.url += data.join('&');\n            }\n        }\n\n        var httpRequest = new XMLHttpRequest();\n        httpRequest.open(options.method, options.url, true);\n\n        if (options.method == 'POST') {\n            httpRequest.setRequestHeader('Accept', 'application/json');\n            httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n        } else {\n            if (options.dataType == 'json') {\n                httpRequest.setRequestHeader('Content-Type', 'text/json');\n            }\n        }\n\n        // No cache\n        httpRequest.setRequestHeader('pragma', 'no-cache');\n        httpRequest.setRequestHeader('cache-control', 'no-cache');\n\n        httpRequest.onload = function() {\n            if (httpRequest.status === 200) {\n                if (options.dataType == 'json') {\n                    try {\n                        var result = JSON.parse(httpRequest.responseText);\n\n                        if (options.success && typeof(options.success) == 'function') {\n                            options.success(result);\n                        }\n                    } catch(err) {\n                        if (options.error && typeof(options.error) == 'function') {\n                            options.error(result);\n                        }\n                    }\n                } else {\n                    var result = httpRequest.responseText;\n\n                    if (options.success && typeof(options.success) == 'function') {\n                        options.success(result);\n                    }\n                }\n            } else {\n                if (options.error && typeof(options.error) == 'function') {\n                    options.error(httpRequest.responseText);\n                }\n            }\n\n            // Global complete method\n            if (obj.ajax.requests && obj.ajax.requests.length) {\n                // Get index of this request in the container\n                var index = obj.ajax.requests.indexOf(httpRequest)\n                // Remove from the ajax requests container\n                obj.ajax.requests.splice(index, 1);\n                // Last one?\n                if (! obj.ajax.requests.length) {\n                    if (options.complete && typeof(options.complete) == 'function') {\n                        options.complete(result);\n                    }\n                }\n            }\n        }\n\n        if (data) {\n            httpRequest.send(data.join('&'));\n        } else {\n            httpRequest.send();\n        }\n\n        obj.ajax.requests.push(httpRequest);\n\n        return httpRequest;\n    }\n\n    obj.ajax.requests = [];\n\n    obj.slideLeft = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-left-in');\n            setTimeout(function() {\n                element.classList.remove('slide-left-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-left-out');\n            setTimeout(function() {\n                element.classList.remove('slide-left-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        }\n    }\n\n    obj.slideRight = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-right-in');\n            setTimeout(function() {\n                element.classList.remove('slide-right-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-right-out');\n            setTimeout(function() {\n                element.classList.remove('slide-right-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        }\n    }\n\n    obj.slideTop = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-top-in');\n            setTimeout(function() {\n                element.classList.remove('slide-top-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-top-out');\n            setTimeout(function() {\n                element.classList.remove('slide-top-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        }\n    }\n\n    obj.slideBottom = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-bottom-in');\n            setTimeout(function() {\n                element.classList.remove('slide-bottom-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-bottom-out');\n            setTimeout(function() {\n                element.classList.remove('slide-bottom-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 100);\n        }\n    }\n\n    obj.fadeIn = function(element, done) {\n        element.classList.add('fade-in');\n        setTimeout(function() {\n            element.classList.remove('fade-in');\n            if (typeof(done) == 'function') {\n                done();\n            }\n        }, 2000);\n    }\n\n    obj.fadeOut = function(element, done) {\n        element.classList.add('fade-out');\n        setTimeout(function() {\n            element.classList.remove('fade-out');\n            if (typeof(done) == 'function') {\n                done();\n            }\n        }, 1000);\n    }\n\n    obj.keyDownControls = function(e) {\n        if (e.which == 27) {\n            var nodes = document.querySelectorAll('.jslider');\n            if (nodes.length > 0) {\n                for (var i = 0; i < nodes.length; i++) {\n                    nodes[i].slider.close();\n                }\n            }\n\n            if (document.querySelector('.jdialog')) {\n                jSuites.dialog.close();\n            }\n        } else if (e.which == 13) {\n            if (document.querySelector('.jdialog')) {\n                if (typeof(jSuites.dialog.options.onconfirm) == 'function') {\n                    jSuites.dialog.options.onconfirm();\n                }\n                jSuites.dialog.close();\n            }\n        }\n\n        // Verify mask\n        if (jSuites.mask) {\n            jSuites.mask.apply(e);\n        }\n    }\n\n    var actionUpControl = function(e) {\n        var element = null;\n        if (element = jSuites.getLinkElement(e.target)) {\n            var link = element.getAttribute('data-href');\n            if (link == '#back') {\n                window.history.back();\n            } else if (link == '#panel') {\n                jSuites.panel();\n            } else {\n                jSuites.pages(link);\n            }\n        }\n    }\n\n    var controlSwipeLeft = function(e) {\n        var element = jSuites.getElement(e.target, 'option');\n\n        if (element && element.querySelector('.option-actions')) {\n            element.scrollTo({\n                left: 100,\n                behavior: 'smooth'\n            });\n        } else {\n            var element = jSuites.getElement(e.target, 'jcalendar');\n            if (element && jSuites.calendar.current) {\n                jSuites.calendar.current.prev();\n            } else {\n                if (jSuites.panel) {\n                    var element = jSuites.panel.get();\n                    if (element) {\n                        if (element.style.display != 'none') {\n                            jSuites.panel.close();\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    var controlSwipeRight = function(e) {\n        var element = jSuites.getElement(e.target, 'option');\n        if (element && element.querySelector('.option-actions')) {\n            element.scrollTo({\n                left: 0,\n                behavior: 'smooth'\n            });\n        } else {\n            var element = jSuites.getElement(e.target, 'jcalendar');\n            if (element && jSuites.calendar.current) {\n                jSuites.calendar.current.next();\n            } else {\n                if (jSuites.panel) {\n                    var element = jSuites.panel.get();\n                    if (element) {\n                        if (element.style.display == 'none') {\n                            jSuites.panel();\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    var actionOverControl = function(e) {\n        // Tooltip\n        if (jSuites.tooltip) {\n            jSuites.tooltip(e);\n        }\n    }\n\n    var actionOutControl = function(e) {\n        // Tooltip\n        if (jSuites.tooltip) {\n            jSuites.tooltip.hide();\n        }\n    }\n\n    // Create page container\n    document.addEventListener('swipeleft', controlSwipeLeft);\n    document.addEventListener('swiperight', controlSwipeRight);\n    document.addEventListener('keydown', obj.keyDownControls);\n\n    if ('ontouchend' in document.documentElement === true) {\n        document.addEventListener('touchend', actionUpControl);\n    } else {\n        document.addEventListener('mouseup', actionUpControl);\n    }\n\n    // Onmouseover\n    document.addEventListener('mouseover', actionOverControl);\n    document.addEventListener('mouseout', actionOutControl);\n    document.addEventListener('DOMContentLoaded', function() {\n        obj.init();\n    });\n\n    // Pop state control\n    window.onpopstate = function(e) {\n        if (e.state && e.state.route) {\n            if (jSuites.pages.get(e.state.route)) {\n                jSuites.pages(e.state.route, { ignoreHistory:true });\n            }\n        }\n    }\n\n    return obj;\n}();\n\njSuites.files = [];\r\n\r\njSuites.calendar = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Global container\n    if (! jSuites.calendar.current) {\n        jSuites.calendar.current = null;\n    }\n\n    // Default configuration\n    var defaults = {\n        // Date format\n        format: 'DD/MM/YYYY',\n        // Allow keyboard date entry\n        readonly: true,\n        // Today is default\n        today: false,\n        // Show timepicker\n        time: false,\n        // Show the reset button\n        resetButton: true,\n        // Placeholder\n        placeholder: '',\n        // Translations can be done here\n        months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n        weekdays: ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],\n        weekdays_short: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\n        // Value\n        value: null,\n        // Events\n        onclose: null,\n        onchange: null,\n        // Fullscreen (this is automatic set for screensize < 800)\n        fullscreen: false,\n        // Internal mode controller\n        mode: null,\n        position: null,\n        // Create the calendar closed as default\n        opened: false,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Value\n    if (! obj.options.value && el.value) {\n        obj.options.value = el.value;\n    }\n\n    // Make sure use upper case in the format\n    obj.options.format = obj.options.format.toUpperCase();\n\n    if (obj.options.value) {\n        var date = obj.options.value.split(' ');\n        var time = date[1];\n        var date = date[0].split('-');\n        var y = parseInt(date[0]);\n        var m = parseInt(date[1]);\n        var d = parseInt(date[2]);\n\n        if (time) {\n            var time = time.split(':');\n            var h = parseInt(time[0]);\n            var i = parseInt(time[1]);\n        } else {\n            var h = 0;\n            var i = 0;\n        }\n    } else {\n        var date = new Date();\n        var y = date.getFullYear();\n        var m = date.getMonth() + 1;\n        var d = date.getDate();\n        var h = date.getHours();\n        var i = date.getMinutes();\n    }\n\n    // Current value\n    obj.date = [ y, m, d, h, i, 0 ];\n\n    // Two digits\n    var two = function(value) {\n        value = '' + value;\n        if (value.length == 1) {\n            value = '0' + value;\n        }\n        return value;\n    }\n\n    // Element\n    el.classList.add('jcalendar-input');\n\n    // Calendar elements\n    var calendarReset = document.createElement('div');\n    calendarReset.className = 'jcalendar-reset';\n    calendarReset.innerHTML = 'Reset';\n\n    var calendarConfirm = document.createElement('div');\n    calendarConfirm.className = 'jcalendar-confirm';\n    calendarConfirm.innerHTML = 'Done';\n\n    var calendarControls = document.createElement('div');\n    calendarControls.className = 'jcalendar-controls'\n    if (obj.options.resetButton) {\n        calendarControls.appendChild(calendarReset);\n    }\n    calendarControls.appendChild(calendarConfirm);\n\n    var calendarContainer = document.createElement('div');\n    calendarContainer.className = 'jcalendar-container';\n\n    var calendarContent = document.createElement('div');\n    calendarContent.className = 'jcalendar-content';\n    calendarContent.appendChild(calendarControls);\n    calendarContainer.appendChild(calendarContent);\n\n    // Main element\n    var calendar = document.createElement('div');\n    calendar.className = 'jcalendar';\n    calendar.appendChild(calendarContainer);\n\n    // Previous button\n    var calendarHeaderPrev = document.createElement('td');\n    calendarHeaderPrev.setAttribute('colspan', '2');\n    calendarHeaderPrev.className = 'jcalendar-prev';\n\n    // Header with year and month\n    var calendarLabelYear = document.createElement('span');\n    calendarLabelYear.className = 'jcalendar-year';\n\n    var calendarLabelMonth = document.createElement('span');\n    calendarLabelMonth.className = 'jcalendar-month';\n\n    var calendarHeaderTitle = document.createElement('td');\n    calendarHeaderTitle.className = 'jcalendar-header';\n    calendarHeaderTitle.setAttribute('colspan', '3');\n    calendarHeaderTitle.appendChild(calendarLabelMonth);\n    calendarHeaderTitle.appendChild(calendarLabelYear);\n\n    var calendarHeaderNext = document.createElement('td');\n    calendarHeaderNext.setAttribute('colspan', '2');\n    calendarHeaderNext.className = 'jcalendar-next';\n\n    var calendarHeaderRow = document.createElement('tr');\n    calendarHeaderRow.appendChild(calendarHeaderPrev);\n    calendarHeaderRow.appendChild(calendarHeaderTitle);\n    calendarHeaderRow.appendChild(calendarHeaderNext);\n\n    var calendarHeader = document.createElement('thead');\n    calendarHeader.appendChild(calendarHeaderRow);\n\n    var calendarBody = document.createElement('tbody');\n    var calendarFooter = document.createElement('tfoot');\n\n    // Calendar table\n    var calendarTable = document.createElement('table');\n    calendarTable.setAttribute('cellpadding', '0');\n    calendarTable.setAttribute('cellspacing', '0');\n    calendarTable.appendChild(calendarHeader);\n    calendarTable.appendChild(calendarBody);\n    calendarTable.appendChild(calendarFooter);\n    calendarContent.appendChild(calendarTable);\n\n    var calendarSelectHour = document.createElement('select');\n    calendarSelectHour.className = 'jcalendar-select';\n    calendarSelectHour.onchange = function() {\n        obj.date[3] = this.value; \n    }\n\n    for (var i = 0; i < 24; i++) {\n        var element = document.createElement('option');\n        element.value = i;\n        element.innerHTML = two(i);\n        calendarSelectHour.appendChild(element);\n    }\n\n    var calendarSelectMin = document.createElement('select');\n    calendarSelectMin.className = 'jcalendar-select';\n    calendarSelectMin.onchange = function() {\n        obj.date[4] = this.value; \n    }\n\n    for (var i = 0; i < 60; i++) {\n        var element = document.createElement('option');\n        element.value = i;\n        element.innerHTML = two(i);\n        calendarSelectMin.appendChild(element);\n    }\n\n    // Footer controls\n    var calendarControls = document.createElement('div');\n    calendarControls.className = 'jcalendar-controls';\n\n    var calendarControlsTime = document.createElement('div');\n    calendarControlsTime.className = 'jcalendar-time';\n    calendarControlsTime.style.maxWidth = '140px';\n    calendarControlsTime.appendChild(calendarSelectHour);\n    calendarControlsTime.appendChild(calendarSelectMin);\n\n    var calendarControlsUpdate = document.createElement('div');\n    calendarControlsUpdate.style.flexGrow = '10';\n    calendarControlsUpdate.innerHTML = '<input type=\"button\" class=\"jcalendar-update\" value=\"Update\">'\n    calendarControls.appendChild(calendarControlsTime);\n    calendarControls.appendChild(calendarControlsUpdate);\n    calendarContent.appendChild(calendarControls);\n\n    var calendarBackdrop = document.createElement('div');\n    calendarBackdrop.className = 'jcalendar-backdrop';\n    calendar.appendChild(calendarBackdrop);\n\n    // Methods\n    obj.open = function (value) {\n        if (! calendar.classList.contains('jcalendar-focus')) {\n            if (jSuites.calendar.current) {\n                jSuites.calendar.current.close();\n            }\n            // Current\n            jSuites.calendar.current = obj;\n            // Show calendar\n            calendar.classList.add('jcalendar-focus');\n            // Get days\n            obj.getDays();\n            // Hour\n            if (obj.options.time) {\n                calendarSelectHour.value = obj.date[3];\n                calendarSelectMin.value = obj.date[4];\n            }\n\n            // Get the position of the corner helper\n            if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen) {\n                // Full\n                calendar.classList.add('jcalendar-fullsize');\n                // Animation\n                jSuites.slideBottom(calendarContent, 1);\n            } else {\n                const rect = el.getBoundingClientRect();\n                const rectContent = calendarContent.getBoundingClientRect();\n\n                if (obj.options.position) {\n                    calendarContainer.style.position = 'fixed';\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\n                        calendarContainer.style.top = (rect.top - (rectContent.height + 2)) + 'px';\n                    } else {\n                        calendarContainer.style.top = (rect.top + rect.height + 2) + 'px';\n                    }\n                    calendarContainer.style.left = rect.left + 'px';\n                } else {\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\n                        calendarContainer.style.bottom = (1 * rect.height + rectContent.height + 2) + 'px';\n                    } else {\n                        calendarContainer.style.top = 2 + 'px'; \n                    }\n                }\n            }\n        }\n    }\n\n    obj.close = function (ignoreEvents, update) {\n        // Current\n        jSuites.calendar.current = null;\n\n        if (update != false && el.tagName == 'INPUT') {\n            obj.setValue(obj.getValue());\n        }\n\n        // Animation\n        if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\n            obj.options.onclose(el);\n        }\n\n        // Hide\n        calendar.classList.remove('jcalendar-focus');\n\n        return obj.getValue(); \n    }\n\n    obj.prev = function() {\n        // Check if the visualization is the days picker or years picker\n        if (obj.options.mode == 'years') {\n            obj.date[0] = obj.date[0] - 12;\n\n            // Update picker table of days\n            obj.getYears();\n        } else {\n            // Go to the previous month\n            if (obj.date[1] < 2) {\n                obj.date[0] = obj.date[0] - 1;\n                obj.date[1] = 12;\n            } else {\n                obj.date[1] = obj.date[1] - 1;\n            }\n\n            // Update picker table of days\n            obj.getDays();\n        }\n    }\n\n    obj.next = function() {\n        // Check if the visualization is the days picker or years picker\n        if (obj.options.mode == 'years') {\n            obj.date[0] = parseInt(obj.date[0]) + 12;\n\n            // Update picker table of days\n            obj.getYears();\n        } else {\n            // Go to the previous month\n            if (obj.date[1] > 11) {\n                obj.date[0] = obj.date[0] + 1;\n                obj.date[1] = 1;\n            } else {\n                obj.date[1] = obj.date[1] + 1;\n            }\n\n            // Update picker table of days\n            obj.getDays();\n        }\n    }\n\n    obj.setValue = function(val) {\n        if (val) {\n            // Keep value\n            obj.options.value = val;\n            // Set label\n            var value = obj.setLabel(val, obj.options.format);\n            var date = obj.options.value.split(' ');\n            if (! date[1]) {\n                date[1] = '00:00:00';\n            }\n            var time = date[1].split(':')\n            var date = date[0].split('-');\n            var y = parseInt(date[0]);\n            var m = parseInt(date[1]);\n            var d = parseInt(date[2]);\n            var h = parseInt(time[0]);\n            var i = parseInt(time[1]);\n            obj.date = [ y, m, d, h, i, 0 ];\n            var val = obj.setLabel(val, obj.options.format);\n\n            if (el.value != val) {\n                el.value = val;\n                // On change\n                if (typeof(obj.options.onchange) ==  'function') {\n                    obj.options.onchange(el, val, obj.date);\n                }\n            }\n\n            obj.getDays();\n        }\n    }\n\n    obj.getValue = function() {\n        if (obj.date) {\n            if (obj.options.time) {\n                return two(obj.date[0]) + '-' + two(obj.date[1]) + '-' + two(obj.date[2]) + ' ' + two(obj.date[3]) + ':' + two(obj.date[4]) + ':' + two(0);\n            } else {\n                return two(obj.date[0]) + '-' + two(obj.date[1]) + '-' + two(obj.date[2]) + ' ' + two(0) + ':' + two(0) + ':' + two(0);\n            }\n        } else {\n            return \"\";\n        }\n    }\n\n    /**\n     * Update calendar\n     */\n    obj.update = function(element) {\n        obj.date[2] = element.innerText;\n\n        if (! obj.options.time) {\n            obj.close();\n        } else {\n            obj.date[3] = calendarSelectHour.value;\n            obj.date[4] = calendarSelectMin.value;\n        }\n\n        var elements = calendar.querySelector('.jcalendar-selected');\n        if (elements) {\n            elements.classList.remove('jcalendar-selected');\n        }\n        element.classList.add('jcalendar-selected')\n    }\n\n    /**\n     * Set to blank\n     */\n    obj.reset = function() {\n        // Clear element\n        obj.date = null;\n        // Reset element\n        el.value = '';\n        // Close calendar\n        obj.close();\n    }\n\n    /**\n     * Get calendar days\n     */\n    obj.getDays = function() {\n        // Mode\n        obj.options.mode = 'days';\n\n        // Variables\n        var d = 0;\n        var today = 0;\n        var today_d = 0;\n        var calendar_day;\n\n        // Setting current values in case of NULLs\n        var date = new Date();\n\n        var year = obj.date && obj.date[0] ? obj.date[0] : parseInt(date.getFullYear());\n        var month = obj.date && obj.date[1] ? obj.date[1] : parseInt(date.getMonth()) + 1;\n        var day = obj.date && obj.date[2] ? obj.date[2] : parseInt(date.getDay());\n        var hour = obj.date && obj.date[3] ? obj.date[3] : parseInt(date.getHours());\n        var min = obj.date && obj.date[4] ? obj.date[4] : parseInt(date.getMinutes());\n\n        obj.date = [year, month, day, hour, min, 0 ];\n\n        // Update title\n        calendarLabelYear.innerHTML = year;\n        calendarLabelMonth.innerHTML = obj.options.months[month - 1];\n\n        // Flag if this is the current month and year\n        if ((date.getMonth() == month-1) && (date.getFullYear() == year)) {\n            today = 1;\n            today_d = date.getDate();\n        }\n\n        var date = new Date(year, month, 0, 0, 0);\n        var nd = date.getDate();\n\n        var date = new Date(year, month-1, 0, hour, min);\n        var fd = date.getDay() + 1;\n\n        // Reset table\n        calendarBody.innerHTML = '';\n\n        // Weekdays Row\n        var row = document.createElement('tr');\n        row.setAttribute('align', 'center');\n        calendarBody.appendChild(row);\n\n        for (var i = 0; i < 7; i++) {\n            var cell = document.createElement('td');\n            cell.setAttribute('width', '30');\n            cell.classList.add('jcalendar-weekday')\n            cell.innerHTML = obj.options.weekdays_short[i];\n            row.appendChild(cell);\n        }\n\n        // Avoid a blank line\n        if (fd == 7) {\n            var j = 7;\n        } else {\n            var j = 0;\n        }\n\n        // Days inside the table\n        var row = document.createElement('tr');\n        row.setAttribute('align', 'center');\n        calendarBody.appendChild(row);\n\n        // Days in the month\n        for (var i = j; i < (Math.ceil((nd + fd) / 7) * 7); i++) {\n            // Create row\n            if ((i > 0) && (!(i % 7))) {\n                var row = document.createElement('tr');\n                row.setAttribute('align', 'center');\n                calendarBody.appendChild(row);\n            }\n\n            if ((i >= fd) && (i < nd + fd)) {\n                d += 1;\n            } else {\n                d = 0;\n            }\n\n            // Create cell\n            var cell = document.createElement('td');\n            cell.setAttribute('width', '30');\n            cell.classList.add('jcalendar-set-day');\n            row.appendChild(cell);\n\n            if (d == 0) {\n                cell.innerHTML = '';\n            } else {\n                if (d < 10) {\n                    cell.innerHTML = 0 + d;\n                } else {\n                    cell.innerHTML = d;\n                }\n            }\n\n            // Selected\n            if (d && d == day) {\n                cell.classList.add('jcalendar-selected');\n            }\n\n            // Sundays\n            if (! (i % 7)) {\n                cell.style.color = 'red';\n            }\n\n            // Today\n            if ((today == 1) && (today_d == d)) {\n                cell.style.fontWeight = 'bold';\n            }\n        }\n\n        // Show time controls\n        if (obj.options.time) {\n            calendarControlsTime.style.display = '';\n        } else {\n            calendarControlsTime.style.display = 'none';\n        }\n    }\n\n    obj.getMonths = function() {\n        // Mode\n        obj.options.mode = 'months';\n\n        // Loading month labels\n        var months = obj.options.months;\n\n        // Update title\n        calendarLabelYear.innerHTML = obj.date[0];\n        calendarLabelMonth.innerHTML = '';\n\n        // Create months table\n        var html = '<td colspan=\"7\"><table width=\"100%\"><tr align=\"center\">';\n\n        for (i = 0; i < 12; i++) {\n            if ((i > 0) && (!(i % 4))) {\n                html += '</tr><tr align=\"center\">';\n            }\n\n            var month = parseInt(i) + 1;\n            html += '<td class=\"jcalendar-set-month\" data-value=\"' + month + '\">' + months[i] +'</td>';\n        }\n\n        html += '</tr></table></td>';\n\n        calendarBody.innerHTML = html;\n    }\n\n    obj.getYears = function() { \n        // Mode\n        obj.options.mode = 'years';\n\n        // Array of years\n        var y = [];\n        for (i = 0; i < 25; i++) {\n            y[i] = parseInt(obj.date[0]) + (i - 12);\n        }\n\n        // Assembling the year tables\n        var html = '<td colspan=\"7\"><table width=\"100%\"><tr align=\"center\">';\n\n        for (i = 0; i < 25; i++) {\n            if ((i > 0) && (!(i % 5))) {\n                html += '</tr><tr align=\"center\">';\n            }\n            html += '<td class=\"jcalendar-set-year\">'+ y[i] +'</td>';\n        }\n\n        html += '</tr></table></td>';\n\n        calendarBody.innerHTML = html;\n    }\n\n    obj.setLabel = function(value, format) {\n        return jSuites.calendar.getDateString(value, format);\n    }\n\n    obj.fromFormatted = function (value, format) {\n        return jSuites.calendar.extractDateFromString(value, format);\n    }\n\n    // Add properties\n    el.setAttribute('autocomplete', 'off');\n    el.setAttribute('data-mask', obj.options.format.toLowerCase());\n\n    if (obj.options.readonly) {\n        el.setAttribute('readonly', 'readonly');\n    }\n\n    if (obj.options.placeholder) {\n        el.setAttribute('placeholder', obj.options.placeholder);\n    }\n\n    var mouseUpControls = function(e) {\n        var action = e.target.className;\n\n        // Object id\n        if (action == 'jcalendar-prev') {\n            obj.prev();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-next') {\n            obj.next();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-month') {\n            obj.getMonths();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-year') {\n            obj.getYears();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-set-year') {\n            obj.date[0] = e.target.innerText;\n            obj.getDays();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-set-month') {\n            obj.date[1] = parseInt(e.target.getAttribute('data-value'));\n            obj.getDays();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-confirm' || action == 'jcalendar-update') {\n            obj.close();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-close') {\n            obj.close();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-backdrop') {\n            obj.close(false, false);\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-reset') {\n            obj.reset();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (e.target.classList.contains('jcalendar-set-day')) {\n            if (e.target.innerText) {\n                obj.update(e.target);\n                e.stopPropagation();\n                e.preventDefault();\n            }\n        }\n    }\n\n    var keyUpControls = function(e) {\n        if (e.target.value && e.target.value.length > 3) {\n            var test = jSuites.calendar.extractDateFromString(e.target.value, obj.options.format);\n            if (test) {\n                if (e.target.getAttribute('data-completed') == 'true') {\n                    obj.setValue(test);\n                }\n            }\n        }\n    }\n\n    var verifyControls = function(e) {\n        console.log(e.target.className)\n    }\n\n    // Handle events\n    el.addEventListener(\"keyup\", keyUpControls);\n\n    // Add global events\n    calendar.addEventListener(\"swipeleft\", function(e) {\n        jSuites.slideLeft(calendarTable, 0, function() {\n            obj.next();\n            jSuites.slideRight(calendarTable, 1);\n        });\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    calendar.addEventListener(\"swiperight\", function(e) {\n        jSuites.slideRight(calendarTable, 0, function() {\n            obj.prev();\n            jSuites.slideLeft(calendarTable, 1);\n        });\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    if ('ontouchend' in document.documentElement === true) {\n        calendar.addEventListener(\"touchend\", mouseUpControls);\n\n        el.addEventListener(\"touchend\", function(e) {\n            obj.open();\n        });\n    } else {\n        calendar.addEventListener(\"mouseup\", mouseUpControls);\n\n        el.addEventListener(\"mouseup\", function(e) {\n            obj.open();\n        });\n    }\n\n    // Append element to the DOM\n    el.parentNode.insertBefore(calendar, el.nextSibling);\n\n    // Keep object available from the node\n    el.calendar = obj;\n\n    if (obj.options.opened == true) {\n        obj.open();\n    }\n\n    return obj;\n});\n\njSuites.calendar.prettify = function(d, texts) {\n    if (! texts) {\n        var texts = {\n            justNow: 'Just now',\n            xMinutesAgo: '{0}m ago',\n            xHoursAgo: '{0}h ago',\n            xDaysAgo: '{0}d ago',\n            xWeeksAgo: '{0}w ago',\n            xMonthsAgo: '{0} mon ago',\n            xYearsAgo: '{0}y ago',\n        }\n    }\n\n    var d1 = new Date();\n    var d2 = new Date(d);\n    var total = parseInt((d1 - d2) / 1000 / 60);\n\n    String.prototype.format = function(o) {\n        return this.replace('{0}', o);\n    }\n\n    if (total == 0) {\n        var text = texts.justNow;\n    } else if (total < 90) {\n        var text = texts.xMinutesAgo.format(total);\n    } else if (total < 1440) { // One day\n        var text = texts.xHoursAgo.format(Math.round(total/60));\n    } else if (total < 20160) { // 14 days\n        var text = texts.xDaysAgo.format(Math.round(total / 1440));\n    } else if (total < 43200) { // 30 days\n        var text = texts.xWeeksAgo.format(Math.round(total / 10080));\n    } else if (total < 1036800) { // 24 months\n        var text = texts.xMonthsAgo.format(Math.round(total / 43200));\n    } else { // 24 months+\n        var text = texts.xYearsAgo.format(Math.round(total / 525600));\n    }\n\n    return text;\n}\n\njSuites.calendar.prettifyAll = function() {\n    var elements = document.querySelectorAll('.prettydate');\n    for (var i = 0; i < elements.length; i++) {\n        if (elements[i].getAttribute('data-date')) {\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].getAttribute('data-date'));\n        } else {\n            elements[i].setAttribute('data-date', elements[i].innerHTML);\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].innerHTML);\n        }\n    }\n}\n\njSuites.calendar.now = function() {\n    var date = new Date();\n    var y = date.getFullYear();\n    var m = date.getMonth() + 1;\n    var d = date.getDate();\n    var h = date.getHours();\n    var i = date.getMinutes();\n    var s = date.getSeconds();\n\n    // Two digits\n    var two = function(value) {\n        value = '' + value;\n        if (value.length == 1) {\n            value = '0' + value;\n        }\n        return value;\n    }\n\n    return two(y) + '-' + two(m) + '-' + two(d) + ' ' + two(h) + ':' + two(i) + ':' + two(s);\n}\n\n// Helper to extract date from a string\njSuites.calendar.extractDateFromString = function(date, format) {\n    var v1 = '' + date;\n    var v2 = format.replace(/[0-9]/g,'');\n\n    var test = 1;\n\n    // Get year\n    var y = v2.search(\"YYYY\");\n    y = v1.substr(y,4);\n    if (parseInt(y) != y) {\n        test = 0;\n    }\n\n    // Get month\n    var m = v2.search(\"MM\");\n    m = v1.substr(m,2);\n    if (parseInt(m) != m || d > 12) {\n        test = 0;\n    }\n\n    // Get day\n    var d = v2.search(\"DD\");\n    d = v1.substr(d,2);\n    if (parseInt(d) != d  || d > 31) {\n        test = 0;\n    }\n\n    // Get hour\n    var h = v2.search(\"HH\");\n    if (h >= 0) {\n        h = v1.substr(h,2);\n        if (! parseInt(h) || h > 23) {\n            h = '00';\n        }\n    } else {\n        h = '00';\n    }\n    \n    // Get minutes\n    var i = v2.search(\"MI\");\n    if (i >= 0) {\n        i = v1.substr(i,2);\n        if (! parseInt(i) || i > 59) {\n            i = '00';\n        }\n    } else {\n        i = '00';\n    }\n\n    // Get seconds\n    var s = v2.search(\"SS\");\n    if (s >= 0) {\n        s = v1.substr(s,2);\n        if (! parseInt(s) || s > 59) {\n            s = '00';\n        }\n    } else {\n        s = '00';\n    }\n\n    if (test == 1 && date.length == v2.length) {\n        // Update source\n        var data = y + '-' + m + '-' + d + ' ' + h + ':' +  i + ':' + s;\n\n        return data;\n    }\n\n    return '';\n}\n\n// Helper to convert date into string\njSuites.calendar.getDateString = function(value, format) {\n    // Default calendar\n    if (! format) {\n        var format = 'DD/MM/YYYY';\n    }\n\n    if (value) {\n        var d = ''+value;\n        d = d.split(' ');\n\n        var h = '';\n        var m = '';\n        var s = '';\n\n        if (d[1]) {\n            h = d[1].split(':');\n            m = h[1] ? h[1] : '00';\n            s = h[2] ? h[2] : '00';\n            h = h[0] ? h[0] : '00';\n        } else {\n            h = '00';\n            m = '00';\n            s = '00';\n        }\n\n        d = d[0].split('-');\n\n        if (d[0] && d[1] && d[2] && d[0] > 0 && d[1] > 0 && d[1] < 13 && d[2] > 0 && d[2] < 32) {\n            var calendar = new Date(d[0], d[1]-1, d[2]);\n            var weekday = new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday');\n            var months = new Array('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');\n\n            d[1] = (d[1].length < 2 ? '0' : '') + d[1];\n            d[2] = (d[2].length < 2 ? '0' : '') + d[2];\n            h = (h.length < 2 ? '0' : '') + h;\n            m = (m.length < 2 ? '0' : '') + m;\n            s = (s.length < 2 ? '0' : '') + s;\n\n            value = format;\n            value = value.replace('WD', weekday[calendar.getDay()]);\n            value = value.replace('DD', d[2]);\n            value = value.replace('MM', d[1]);\n            value = value.replace('YYYY', d[0]);\n            value = value.replace('YY', d[0].substring(2,4));\n            value = value.replace('MON', months[parseInt(d[1])-1].toUpperCase());\n\n            if (h) {\n                value = value.replace('HH24', h);\n            }\n\n            if (h > 12) {\n                value = value.replace('HH12', h - 12);\n                value = value.replace('HH', h);\n            } else {\n                value = value.replace('HH12', h);\n                value = value.replace('HH', h);\n            }\n\n            value = value.replace('MI', m);\n            value = value.replace('MM', m);\n            value = value.replace('SS', s);\n        } else {\n            value = '';\n        }\n    }\n\n    return value;\n}\n\njSuites.calendar.isOpen = function(e) {\n    if (jSuites.calendar.current) {\n        if (! e.target.className || e.target.className.indexOf('jcalendar') == -1) {\n            jSuites.calendar.current.close();\n        }\n    }\n}\n\nif ('ontouchstart' in document.documentElement === true) {\n    document.addEventListener(\"touchstart\", jSuites.calendar.isOpen);\n} else {\n    document.addEventListener(\"mousedown\", jSuites.calendar.isOpen);\n}\r\n\r\njSuites.color = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n    obj.values = [];\n\n    // Global container\n    if (! jSuites.color.current) {\n        jSuites.color.current = null;\n    }\n\n    /**\n     * @typedef {Object} defaults\n     * @property {(string|Array)} value - Initial value of the compontent\n     * @property {string} placeholder - The default instruction text on the element\n     * @property {requestCallback} onchange - Method to be execute after any changes on the element\n     * @property {requestCallback} onclose - Method to be execute when the element is closed\n     */\n    var defaults = {\n        placeholder: '',\n        value: null,\n        onclose: null,\n        onchange: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    var palette = {\n          \"red\": {\n            \"50\": \"#ffebee\",\n            \"100\": \"#ffcdd2\",\n            \"200\": \"#ef9a9a\",\n            \"300\": \"#e57373\",\n            \"400\": \"#ef5350\",\n            \"500\": \"#f44336\",\n            \"600\": \"#e53935\",\n            \"700\": \"#d32f2f\",\n            \"800\": \"#c62828\",\n            \"900\": \"#b71c1c\",\n          },\n          \"pink\": {\n            \"50\": \"#fce4ec\",\n            \"100\": \"#f8bbd0\",\n            \"200\": \"#f48fb1\",\n            \"300\": \"#f06292\",\n            \"400\": \"#ec407a\",\n            \"500\": \"#e91e63\",\n            \"600\": \"#d81b60\",\n            \"700\": \"#c2185b\",\n            \"800\": \"#ad1457\",\n            \"900\": \"#880e4f\",\n          },\n          \"purple\": {\n            \"50\": \"#f3e5f5\",\n            \"100\": \"#e1bee7\",\n            \"200\": \"#ce93d8\",\n            \"300\": \"#ba68c8\",\n            \"400\": \"#ab47bc\",\n            \"500\": \"#9c27b0\",\n            \"600\": \"#8e24aa\",\n            \"700\": \"#7b1fa2\",\n            \"800\": \"#6a1b9a\",\n            \"900\": \"#4a148c\",\n          },\n          \"indigo\": {\n            \"50\": \"#e8eaf6\",\n            \"100\": \"#c5cae9\",\n            \"200\": \"#9fa8da\",\n            \"300\": \"#7986cb\",\n            \"400\": \"#5c6bc0\",\n            \"500\": \"#3f51b5\",\n            \"600\": \"#3949ab\",\n            \"700\": \"#303f9f\",\n            \"800\": \"#283593\",\n            \"900\": \"#1a237e\",\n          },\n          \"blue\": {\n            \"50\": \"#e3f2fd\",\n            \"100\": \"#bbdefb\",\n            \"200\": \"#90caf9\",\n            \"300\": \"#64b5f6\",\n            \"400\": \"#42a5f5\",\n            \"500\": \"#2196f3\",\n            \"600\": \"#1e88e5\",\n            \"700\": \"#1976d2\",\n            \"800\": \"#1565c0\",\n            \"900\": \"#0d47a1\",\n          },\n          \"cyan\": {\n            \"50\": \"#e0f7fa\",\n            \"100\": \"#b2ebf2\",\n            \"200\": \"#80deea\",\n            \"300\": \"#4dd0e1\",\n            \"400\": \"#26c6da\",\n            \"500\": \"#00bcd4\",\n            \"600\": \"#00acc1\",\n            \"700\": \"#0097a7\",\n            \"800\": \"#00838f\",\n            \"900\": \"#006064\",\n          },\n          \"teal\": {\n            \"50\": \"#e0f2f1\",\n            \"100\": \"#b2dfdb\",\n            \"200\": \"#80cbc4\",\n            \"300\": \"#4db6ac\",\n            \"400\": \"#26a69a\",\n            \"500\": \"#009688\",\n            \"600\": \"#00897b\",\n            \"700\": \"#00796b\",\n            \"800\": \"#00695c\",\n            \"900\": \"#004d40\",\n          },\n          \"green\": {\n            \"50\": \"#e8f5e9\",\n            \"100\": \"#c8e6c9\",\n            \"200\": \"#a5d6a7\",\n            \"300\": \"#81c784\",\n            \"400\": \"#66bb6a\",\n            \"500\": \"#4caf50\",\n            \"600\": \"#43a047\",\n            \"700\": \"#388e3c\",\n            \"800\": \"#2e7d32\",\n            \"900\": \"#1b5e20\",\n          },\n          \"lightgreen\": {\n            \"50\": \"#f1f8e9\",\n            \"100\": \"#dcedc8\",\n            \"200\": \"#c5e1a5\",\n            \"300\": \"#aed581\",\n            \"400\": \"#9ccc65\",\n            \"500\": \"#8bc34a\",\n            \"600\": \"#7cb342\",\n            \"700\": \"#689f38\",\n            \"800\": \"#558b2f\",\n            \"900\": \"#33691e\",\n          },\n          \"lime\": {\n            \"50\": \"#f9fbe7\",\n            \"100\": \"#f0f4c3\",\n            \"200\": \"#e6ee9c\",\n            \"300\": \"#dce775\",\n            \"400\": \"#d4e157\",\n            \"500\": \"#cddc39\",\n            \"600\": \"#c0ca33\",\n            \"700\": \"#afb42b\",\n            \"800\": \"#9e9d24\",\n            \"900\": \"#827717\",\n          },\n          \"yellow\": {\n            \"50\": \"#fffde7\",\n            \"100\": \"#fff9c4\",\n            \"200\": \"#fff59d\",\n            \"300\": \"#fff176\",\n            \"400\": \"#ffee58\",\n            \"500\": \"#ffeb3b\",\n            \"600\": \"#fdd835\",\n            \"700\": \"#fbc02d\",\n            \"800\": \"#f9a825\",\n            \"900\": \"#f57f17\",\n          },\n          \"amber\": {\n            \"50\": \"#fff8e1\",\n            \"100\": \"#ffecb3\",\n            \"200\": \"#ffe082\",\n            \"300\": \"#ffd54f\",\n            \"400\": \"#ffca28\",\n            \"500\": \"#ffc107\",\n            \"600\": \"#ffb300\",\n            \"700\": \"#ffa000\",\n            \"800\": \"#ff8f00\",\n            \"900\": \"#ff6f00\",\n          },\n          \"orange\": {\n            \"50\": \"#fff3e0\",\n            \"100\": \"#ffe0b2\",\n            \"200\": \"#ffcc80\",\n            \"300\": \"#ffb74d\",\n            \"400\": \"#ffa726\",\n            \"500\": \"#ff9800\",\n            \"600\": \"#fb8c00\",\n            \"700\": \"#f57c00\",\n            \"800\": \"#ef6c00\",\n            \"900\": \"#e65100\",\n          },\n          \"deeporange\": {\n            \"50\": \"#fbe9e7\",\n            \"100\": \"#ffccbc\",\n            \"200\": \"#ffab91\",\n            \"300\": \"#ff8a65\",\n            \"400\": \"#ff7043\",\n            \"500\": \"#ff5722\",\n            \"600\": \"#f4511e\",\n            \"700\": \"#e64a19\",\n            \"800\": \"#d84315\",\n            \"900\": \"#bf360c\",\n          },\n          \"brown\": {\n            \"50\": \"#efebe9\",\n            \"100\": \"#d7ccc8\",\n            \"200\": \"#bcaaa4\",\n            \"300\": \"#a1887f\",\n            \"400\": \"#8d6e63\",\n            \"500\": \"#795548\",\n            \"600\": \"#6d4c41\",\n            \"700\": \"#5d4037\",\n            \"800\": \"#4e342e\",\n            \"900\": \"#3e2723\"\n          },\n          \"grey\": {\n            \"50\": \"#fafafa\",\n            \"100\": \"#f5f5f5\",\n            \"200\": \"#eeeeee\",\n            \"300\": \"#e0e0e0\",\n            \"400\": \"#bdbdbd\",\n            \"500\": \"#9e9e9e\",\n            \"600\": \"#757575\",\n            \"700\": \"#616161\",\n            \"800\": \"#424242\",\n            \"900\": \"#212121\"\n          },\n          \"bluegrey\": {\n            \"50\": \"#eceff1\",\n            \"100\": \"#cfd8dc\",\n            \"200\": \"#b0bec5\",\n            \"300\": \"#90a4ae\",\n            \"400\": \"#78909c\",\n            \"500\": \"#607d8b\",\n            \"600\": \"#546e7a\",\n            \"700\": \"#455a64\",\n            \"800\": \"#37474f\",\n            \"900\": \"#263238\"\n          }\n    };\n\n    var x = 0;\n    var y = 0;\n    var colors = [];\n\n    var col = Object.keys(palette);\n    var shade = Object.keys(palette[col[0]]);\n\n    for (var i = 0; i < col.length; i++) {\n        for (var j = 0; j < shade.length; j++) {\n            if (! colors[j]) {\n                colors[j] = [];\n            }\n            colors[j][i] = palette[col[i]][shade[j]];\n        }\n    };\n\n    // Value\n    if (obj.options.value) {\n        el.value = obj.options.value;\n    }\n\n    // Table container\n    var container = document.createElement('div');\n    container.className = 'jcolor';\n\n    // Table container\n    var backdrop = document.createElement('div');\n    backdrop.className = 'jcolor-backdrop';\n    container.appendChild(backdrop);\n\n    // Content\n    var content = document.createElement('div');\n    content.className = 'jcolor-content';\n\n    // Close button\n    var closeButton  = document.createElement('div');\n    closeButton.className = 'jcolor-close';\n    closeButton.innerHTML = 'Done';\n    closeButton.onclick = function() {\n        obj.close();\n    }\n    content.appendChild(closeButton);\n\n    // Table pallete\n    var table = document.createElement('table');\n    table.setAttribute('cellpadding', '7');\n    table.setAttribute('cellspacing', '0');\n\n    for (var i = 0; i < colors.length; i++) {\n        var tr = document.createElement('tr');\n        for (var j = 0; j < colors[i].length; j++) {\n            var td = document.createElement('td');\n            td.style.backgroundColor = colors[i][j];\n            td.setAttribute('data-value', colors[i][j]);\n            td.innerHTML = '';\n            tr.appendChild(td);\n\n            // Selected color\n            if (obj.options.value == colors[i][j]) {\n                td.classList.add('jcolor-selected');\n            }\n\n            // Possible values\n            obj.values[colors[i][j]] = td;\n        }\n        table.appendChild(tr);\n    }\n\n    /**\n     * Open color pallete\n     */\n    obj.open = function() {\n        if (jSuites.color.current) {\n            if (jSuites.color.current != obj) {\n                jSuites.color.current.close();\n            }\n        }\n\n        if (! jSuites.color.current) {\n            // Persist element\n            jSuites.color.current = obj;\n            // Show colorpicker\n            container.classList.add('jcolor-focus');\n\n            const rectContent = content.getBoundingClientRect();\n\n            if (jSuites.getWindowWidth() < 800) {\n                content.style.top = '';\n                content.classList.add('jcolor-fullscreen');\n                jSuites.slideBottom(content, 1);\n                backdrop.style.display = 'block';\n            } else {\n                if (content.classList.contains('jcolor-fullscreen')) {\n                    content.classList.remove('jcolor-fullscreen');\n                    backdrop.style.display = '';\n                }\n\n                const rect = el.getBoundingClientRect();\n\n                if (window.innerHeight < rect.bottom + rectContent.height) {\n                    content.style.top = -1 * (rectContent.height + 2) + 'px';\n                } else {\n                    content.style.top = rect.height + 'px';\n                }\n            }\n\n            container.focus();\n        }\n    }\n\n    /**\n     * Close color pallete\n     */\n    obj.close = function(ignoreEvents) {\n        if (jSuites.color.current) {\n            jSuites.color.current = null;\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\n                obj.options.onclose(el);\n            }\n            container.classList.remove('jcolor-focus');\n        }\n\n        // Make sure backdrop is hidden\n        backdrop.style.display = '';\n\n        return obj.options.value;\n    }\n\n    /**\n     * Set value\n     */\n    obj.setValue = function(color) {\n        if (color) {\n            el.value = color;\n            obj.options.value = color;\n        }\n\n        // Remove current selecded mark\n        var selected = container.querySelector('.jcolor-selected');\n        if (selected) {\n            selected.classList.remove('jcolor-selected');\n        }\n\n        // Mark cell as selected\n        obj.values[color].classList.add('jcolor-selected');\n\n        // Onchange\n        if (typeof(obj.options.onchange) == 'function') {\n            obj.options.onchange(el, color);\n        }\n    }\n\n    /**\n     * Get value\n     */\n    obj.getValue = function() {\n        return obj.options.value;\n    }\n\n    /**\n     * If element is focus open the picker\n     */\n    el.addEventListener(\"focus\", function(e) {\n        obj.open();\n    });\n\n    el.addEventListener(\"mousedown\", function(e) {\n        obj.open();\n    });\n\n    // Select color\n    container.addEventListener(\"mouseup\", function(e) {\n        if (e.target.tagName == 'TD') {\n            jSuites.color.current.setValue(e.target.getAttribute('data-value'));\n            jSuites.color.current.close();\n        }\n    });\n\n    // Close controller\n    document.addEventListener(\"mousedown\", function(e) {\n        if (jSuites.color.current) {\n            var element = jSuites.getElement(e.target, 'jcolor');\n            if (! element) {\n                jSuites.color.current.close();\n            }\n        }\n    });\n\n    // Possible to focus the container\n    container.setAttribute('tabindex', '900');\n\n    // Placeholder\n    if (obj.options.placeholder) {\n        el.setAttribute('placeholder', obj.options.placeholder);\n    }\n\n    // Append to the table\n    content.appendChild(table);\n    container.appendChild(content);\n\n    // Insert picker after the element\n    el.parentNode.insertBefore(container, el);\n\n    // Keep object available from the node\n    el.color = obj;\n\n    return obj;\n});\n\r\n\r\njSuites.contextmenu = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Default configuration\n    var defaults = {\n        items: null,\n        onclick: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Class definition\n    el.classList.add('jcontextmenu');\n    // Focusable\n    el.setAttribute('tabindex', '900');\n\n    /**\n     * Open contextmenu\n     */\n    obj.open = function(e, items) {\n        if (items) {\n            // Update content\n            obj.options.items = items;\n            // Create items\n            obj.create(items);\n        }\n        // Coordinates\n        if (e.target) {\n            var x = e.clientX;\n            var y = e.clientY;\n        } else {\n            var x = e.x;\n            var y = e.y;\n        }\n\n        el.classList.add('jcontextmenu-focus');\n        el.focus();\n\n        const rect = el.getBoundingClientRect();\n\n        if (window.innerHeight < y + rect.height) {\n            el.style.top = (y - rect.height) + 'px';\n        } else {\n            el.style.top = y + 'px';\n        }\n\n        if (window.innerWidth < x + rect.width) {\n            if (x - rect.width > 0) {\n                el.style.left = (x - rect.width) + 'px';\n            } else {\n                el.style.left = '10px';\n            }\n        } else {\n            el.style.left = x + 'px';\n        }\n    }\n\n    /**\n     * Close menu\n     */\n    obj.close = function() {\n        if (el.classList.contains('jcontextmenu-focus')) {\n            el.classList.remove('jcontextmenu-focus');\n        }\n    }\n\n    /**\n     * Create items based on the declared objectd\n     * @param {object} items - List of object\n     */\n    obj.create = function(items) {\n        // Update content\n        el.innerHTML = '';\n\n        // Append items\n        for (var i = 0; i < items.length; i++) {\n            if (items[i].type && items[i].type == 'line') {\n                var itemContainer = document.createElement('hr');\n            } else {\n                var itemContainer = document.createElement('div');\n                var itemText = document.createElement('a');\n                itemText.innerHTML = items[i].title;\n\n                if (items[i].disabled) {\n                    itemContainer.className = 'jcontextmenu-disabled';\n                } else if (items[i].onclick) {\n                    itemContainer.method = items[i].onclick;\n                    itemContainer.addEventListener(\"mouseup\", function() {\n                        // Execute method\n                        this.method(this);\n                    });\n                }\n                itemContainer.appendChild(itemText);\n\n                if (items[i].shortcut) {\n                    var itemShortCut = document.createElement('span');\n                    itemShortCut.innerHTML = items[i].shortcut;\n                    itemContainer.appendChild(itemShortCut);\n                }\n            }\n\n            el.appendChild(itemContainer);\n        }\n    }\n\n    if (typeof(obj.options.onclick) == 'function') {\n        el.addEventListener('click', function(e) {\n            obj.options.onclick(obj);\n        });\n    }\n\n    el.addEventListener('blur', function(e) {\n        setTimeout(function() {\n            obj.close();\n        }, 120);\n    });\n\n    window.addEventListener(\"mousewheel\", function() {\n        obj.close();\n    });\n\n    // Create items\n    if (obj.options.items) {\n        obj.create(obj.options.items);\n    }\n\n    el.contextmenu = obj;\n\n    return obj;\n});\n\njSuites.contextmenu.getElement = function(element) {\n    var foundId = 0;\n\n    function path (element) {\n        if (element.parentNode && element.getAttribute('aria-contextmenu-id')) {\n            foundId = element.getAttribute('aria-contextmenu-id')\n        } else {\n            if (element.parentNode) {\n                path(element.parentNode);\n            }\n        }\n    }\n\n    path(element);\n\n    return foundId;\n}\n\ndocument.addEventListener(\"contextmenu\", function(e) {\n    var id = jSuites.contextmenu.getElement(e.target);\n    if (id) {\n        var element = document.querySelector('#' + id);\n        if (! element) {\n            console.error('JSUITES: Contextmenu id not found');\n        } else {\n            element.contextmenu.open(e);\n            e.preventDefault();\n        }\n    }\n});\r\n\r\n/**\n * Dialog v1.0.1\n * Author: paul.hodel@gmail.com\n * https://github.com/paulhodel/jtools\n */\n \njSuites.dialog = (function() {\n    var obj = {};\n    obj.options = {};\n\n    var dialog = document.createElement('div');\n    dialog.setAttribute('tabindex', '901');\n    dialog.className = 'jdialog';\n    dialog.id = 'dialog';\n\n    var dialogHeader = document.createElement('div');\n    dialogHeader.className = 'jdialog-header';\n\n    var dialogTitle = document.createElement('div');\n    dialogTitle.className = 'jdialog-title';\n    dialogHeader.appendChild(dialogTitle);\n\n    var dialogMessage = document.createElement('div');\n    dialogMessage.className = 'jdialog-message';\n    dialogHeader.appendChild(dialogMessage);\n\n    var dialogFooter = document.createElement('div');\n    dialogFooter.className = 'jdialog-footer';\n\n    var dialogContainer = document.createElement('div');\n    dialogContainer.className = 'jdialog-container';\n    dialogContainer.appendChild(dialogHeader);\n    dialogContainer.appendChild(dialogFooter);\n\n    // Confirm\n    var dialogConfirm = document.createElement('div');\n    var dialogConfirmButton = document.createElement('input');\n    dialogConfirmButton.value = obj.options.confirmLabel;\n    dialogConfirmButton.type = 'button';\n    dialogConfirmButton.onclick = function() {\n        if (typeof(obj.options.onconfirm) == 'function') {\n            obj.options.onconfirm();\n        }\n        obj.close();\n    };\n    dialogConfirm.appendChild(dialogConfirmButton);\n    dialogFooter.appendChild(dialogConfirm);\n\n    // Cancel\n    var dialogCancel = document.createElement('div');\n    var dialogCancelButton = document.createElement('input');\n    dialogCancelButton.value = obj.options.cancelLabel;\n    dialogCancelButton.type = 'button';\n    dialogCancelButton.onclick = function() {\n        if (typeof(obj.options.oncancel) == 'function') {\n            obj.options.oncancel();\n        }\n        obj.close();\n    }\n    dialogCancel.appendChild(dialogCancelButton);\n    dialogFooter.appendChild(dialogCancel);\n\n    // Dialog\n    dialog.appendChild(dialogContainer);\n\n    obj.open = function(options) {\n        obj.options = options;\n\n        if (obj.options.title) {\n            dialogTitle.innerHTML = obj.options.title;\n        }\n\n        if (obj.options.message) {\n            dialogMessage.innerHTML = obj.options.message;\n        }\n\n        if (! obj.options.confirmLabel) {\n            obj.options.confirmLabel = 'OK';\n        }\n        dialogConfirmButton.value = obj.options.confirmLabel;\n\n        if (! obj.options.cancelLabel) {\n            obj.options.cancelLabel = 'Cancel';\n        }\n        dialogCancelButton.value = obj.options.cancelLabel;\n\n        if (obj.options.type == 'confirm') {\n            dialogCancelButton.parentNode.style.display = '';\n        } else {\n            dialogCancelButton.parentNode.style.display = 'none';\n        }\n\n        // Append element to the app\n        dialog.style.opacity = 100;\n\n        // Append to the page\n        if (jSuites.el) {\n            jSuites.el.appendChild(dialog);\n        } else {\n            document.body.appendChild(dialog);\n        }\n\n        // Focus\n        dialog.focus();\n\n        // Show\n        setTimeout(function() {\n            dialogContainer.style.opacity = 100;\n        }, 0);\n    };\n\n    obj.close = function() {\n        dialog.style.opacity = 0;\n        dialogContainer.style.opacity = 0;\n        setTimeout(function() {\n            dialog.remove();\n        }, 100);\n    };\n\n    return obj;\n})();\n\njSuites.confirm = (function(message, onconfirm) {\n    if (jSuites.getWindowWidth() < 800) {\n        jSuites.dialog.open({\n            type: 'confirm',\n            message: message,\n            title: 'Confirmation',\n            onconfirm: onconfirm,\n        });\n    } else {\n        if (confirm(message)) {\n            onconfirm();\n        }\n    }\n});\n\njSuites.alert = function(message) {\n    if (jSuites.getWindowWidth() < 800) {\n        jSuites.dialog.open({\n            title:'Alert',\n            message:message,\n        });\n    } else {\n        alert(message);\n    }\n}\n\r\n\r\njSuites.dropdown = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // If the element is a SELECT tag, create a configuration object\n    if (el.tagName == 'SELECT') {\n        var ret = jSuites.dropdown.extractFromDom(el, options);\n        el = ret.el;\n        options = ret.options;\n    }\n\n    // Default configuration\n    var defaults = {\n        url: null,\n        data: [],\n        multiple: false,\n        autocomplete: false,\n        type: null,\n        width: null,\n        opened: false,\n        value: null,\n        placeholder: '',\n        position: false,\n        onchange: null,\n        onload: null,\n        onopen: null,\n        onclose: null,\n        onblur: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Global container\n    if (! jSuites.dropdown.current) {\n        jSuites.dropdown.current = null;\n    }\n\n    // Containers\n    obj.items = [];\n    obj.groups = [];\n    obj.selected = [];\n\n    // Create dropdown\n    el.classList.add('jdropdown');\n \n    if (obj.options.type == 'searchbar') {\n        el.classList.add('jdropdown-searchbar');\n    } else if (obj.options.type == 'list') {\n        el.classList.add('jdropdown-list');\n    } else if (obj.options.type == 'picker') {\n        el.classList.add('jdropdown-picker');\n    } else {\n        if (jSuites.getWindowWidth() < 800) {\n            el.classList.add('jdropdown-picker');\n            obj.options.type = 'picker';\n        } else {\n            if (obj.options.width) {\n                el.style.width = obj.options.width;\n                el.style.minWidth = obj.options.width;\n            }\n            el.classList.add('jdropdown-default');\n            obj.options.type = 'default';\n        }\n    }\n\n    // Header container\n    var containerHeader = document.createElement('div');\n    containerHeader.className = 'jdropdown-container-header';\n\n    // Header\n    var header = document.createElement('input');\n    header.className = 'jdropdown-header';\n    if (typeof(obj.options.onblur) == 'function') {\n        header.onblur = function() {\n            obj.options.onblur(el);\n        }\n    }\n\n    // Container\n    var container = document.createElement('div');\n    container.className = 'jdropdown-container';\n\n    // Dropdown content\n    var content = document.createElement('div');\n    content.className = 'jdropdown-content';\n\n    // Close button\n    var closeButton  = document.createElement('div');\n    closeButton.className = 'jdropdown-close';\n    closeButton.innerHTML = 'Done';\n\n    // Create backdrop\n    var backdrop  = document.createElement('div');\n    backdrop.className = 'jdropdown-backdrop';\n\n    // Autocomplete\n    if (obj.options.autocomplete == true) {\n        el.setAttribute('data-autocomplete', true);\n\n        // Handler\n        var keyTimer = null;\n        header.addEventListener('keyup', function(e) {\n            if (keyTimer) {\n                clearTimeout(keyTimer);\n            }\n            keyTimer = setTimeout(function() {\n                obj.find(header.value);\n                keyTimer = null;\n            }, 500);\n\n            if (! el.classList.contains('jdropdown-focus')) {\n                if (e.which > 65) {\n                    obj.open();\n                }\n            }\n        });\n    } else {\n        header.setAttribute('readonly', 'readonly');\n    }\n\n    // Place holder\n    if (! obj.options.placeholder && el.getAttribute('placeholder')) {\n        obj.options.placeholder = el.getAttribute('placeholder');\n    }\n\n    if (obj.options.placeholder) {\n        header.setAttribute('placeholder', obj.options.placeholder);\n    }\n\n    // Append elements\n    containerHeader.appendChild(header);\n    if (obj.options.type == 'searchbar') {\n        containerHeader.appendChild(closeButton);\n    } else {\n        container.appendChild(closeButton);\n    }\n    container.appendChild(content);\n    el.appendChild(containerHeader);\n    el.appendChild(container);\n    el.appendChild(backdrop);\n\n    /**\n     * Init dropdown\n     */\n    obj.init = function() {\n        if (obj.options.url) {\n            jSuites.ajax({\n                url: obj.options.url,\n                method: 'GET',\n                dataType: 'json',\n                success: function(data) {\n                    if (data) {\n                        // Set data\n                        obj.setData(data);\n                        // Set value\n                        if (obj.options.value != null) {\n                            obj.setValue(obj.options.value);\n                        }\n                        // Onload method\n                        if (typeof(obj.options.onload) == 'function') {\n                            obj.options.onload(el, obj, data);\n                        }\n                    }\n                }\n            });\n        } else {\n            // Set data\n            obj.setData();\n            // Set value\n            if (obj.options.value != null) {\n                obj.setValue(obj.options.value);\n            }\n            // Onload\n            if (typeof(obj.options.onload) == 'function') {\n                obj.options.onload(el, obj, data);\n            }\n        }\n\n        // Open dropdown\n        if (obj.options.opened == true) {\n            obj.open();\n        }\n    }\n\n    obj.getUrl = function() {\n        return obj.options.url;\n    }\n\n    obj.setUrl = function(url) {\n        obj.options.url = url;\n\n        jSuites.ajax({\n            url: obj.options.url,\n            method: 'GET',\n            dataType: 'json',\n            success: function(data) {\n                obj.setData(data);\n            }\n        });\n    }\n\n    /**\n     * Create a new item\n     */\n    obj.createItem = function(data) {\n        // Create item\n        var item = {};\n        item.element = document.createElement('div');\n        item.element.className = 'jdropdown-item';\n        item.value = data.id;\n        item.text = data.name;\n        item.textLowerCase = data.name.toLowerCase();\n\n        // Image\n        if (data.image) {\n            var image = document.createElement('img');\n            image.className = 'jdropdown-image';\n            image.src = data.image;\n            if (! data.title) {\n               image.classList.add('jdropdown-image-small');\n            }\n            item.element.appendChild(image);\n        }\n\n        // Set content\n        var node = document.createElement('div');\n        node.className = 'jdropdown-description';\n        node.innerHTML = data.name;\n\n        // Title\n        if (data.title) {\n            var title = document.createElement('div');\n            title.className = 'jdropdown-title';\n            title.innerHTML = data.title;\n            node.appendChild(title);\n        }\n\n        // Add node to item\n        item.element.appendChild(node);\n\n        return item;\n    }\n\n    obj.setData = function(data) {\n        // Update data\n        if (data) {\n            obj.options.data = data;\n        }\n\n        // Data\n        var data = obj.options.data;\n\n        // Make sure the content container is blank\n        content.innerHTML = '';\n\n        // Reset\n        obj.reset();\n\n        // Reset items\n        obj.items = [];\n\n        // Helpers\n        var items = [];\n        var groups = [];\n\n        // Create elements\n        if (data.length) {\n            // Prepare data\n            for (var i = 0; i < data.length; i++) {\n                // Compatibility\n                if (typeof(data[i]) != 'object') {\n                    // Correct format\n                    obj.options.data[i] = data[i] = { id: data[i], name: data[i] };\n                }\n\n                // Process groups\n                if (data[i].group) {\n                    if (! groups[data[i].group]) {\n                        groups[data[i].group] = [];\n                    }\n                    groups[data[i].group].push(i);\n                } else {\n                    items.push(i);\n                }\n            }\n\n            // Groups\n            var groupNames = Object.keys(groups);\n\n            // Append groups in case exists\n            if (groupNames.length > 0) {\n                for (var i = 0; i < groupNames.length; i++) {\n                    // Group container\n                    var group = document.createElement('div');\n                    group.className = 'jdropdown-group';\n                    // Group name\n                    var groupName = document.createElement('div');\n                    groupName.className = 'jdropdown-group-name';\n                    groupName.innerHTML = groupNames[i];\n                    // Group arrow\n                    var groupArrow = document.createElement('i');\n                    groupArrow.className = 'jdropdown-group-arrow jdropdown-group-arrow-down';\n                    groupName.appendChild(groupArrow);\n                    // Group items\n                    var groupContent = document.createElement('div');\n                    groupContent.className = 'jdropdown-group-items';\n                    for (var j = 0; j < groups[groupNames[i]].length; j++) {\n                        var item = obj.createItem(data[groups[groupNames[i]][j]]);\n                        groupContent.appendChild(item.element);\n                        // Items\n                        obj.items.push(item);\n                    }\n                    // Group itens\n                    group.appendChild(groupName);\n                    group.appendChild(groupArrow);\n                    group.appendChild(groupContent);\n                    content.appendChild(group);\n                }\n            }\n\n            if (items.length) {\n                for (var i = 0; i < items.length; i++) {\n                    var item = obj.createItem(data[items[i]]);\n                    obj.items.push(item);\n                    content.appendChild(item.element);\n                }\n            }\n\n            // Create the Indexes\n            for (var i = 0; i < obj.items.length; i++) {\n                obj.items[i].element.setAttribute('data-index', i);\n            }\n        }\n    }\n\n    obj.getText = function(asArray) {\n        // Result\n        var result = [];\n        // Append options\n        for (var i = 0; i < obj.selected.length; i++) {\n            if (obj.items[obj.selected[i]]) {\n                result.push(obj.items[obj.selected[i]].text);\n            }\n        }\n\n        if (asArray) {\n            return result;\n        } else {\n            return result.join('; ');\n        }\n    }\n\n    obj.getValue = function(asArray) {\n        // Result\n        var result = [];\n        // Append options\n        for (var i = 0; i < obj.selected.length; i++) {\n            if (obj.items[obj.selected[i]]) {\n                result.push(obj.items[obj.selected[i]].value);\n            }\n        }\n\n        if (asArray) {\n            return result;\n        } else {\n            return result.join(';');\n        }\n    }\n\n    obj.setValue = function(value) {\n        // Remove values\n        for (var i = 0; i < obj.selected.length; i++) {\n            obj.items[obj.selected[i]].element.classList.remove('jdropdown-selected')\n        } \n\n        // Reset selected\n        obj.selected = [];\n\n        // Set values\n        if (value != null) {\n            if (Array.isArray(value)) {\n                for (var i = 0; i < obj.items.length; i++) {\n                    for (var j = 0; j < value.length; j++) {\n                        if (obj.items[i].value == value[j]) {\n                            // Keep index of the selected item\n                            obj.selected.push(i);\n                            // Visual selection\n                            obj.items[i].element.classList.add('jdropdown-selected');\n                        }\n                    }\n                }\n            } else {\n                for (var i = 0; i < obj.items.length; i++) {\n                    if (obj.items[i].value == value) {\n                        // Keep index of the selected item\n                        obj.selected.push(i);\n                        // Visual selection\n                        obj.items[i].element.classList.add('jdropdown-selected');\n                    }\n                }\n            }\n        }\n\n        // Update labels\n        obj.updateLabel();\n    }\n\n    obj.selectIndex = function(index) {\n        // Only select those existing elements\n        if (obj.items && obj.items[index]) {\n            var index = index = parseInt(index);\n            // Current selection\n            var oldValue = obj.getValue();\n            var oldLabel = obj.getText();\n\n            // Remove cursor style\n            if (obj.currentIndex != null) {\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\n            }\n            // Set cursor style\n            obj.items[index].element.classList.add('jdropdown-cursor');\n\n            // Update cursor position\n            obj.currentIndex = index;\n\n            // Focus behaviour\n            if (! obj.options.multiple) {\n                // Unselect option\n                if (obj.items[index].element.classList.contains('jdropdown-selected')) {\n                    // Reset selected\n                    obj.resetSelected();\n                } else {\n                    // Reset selected\n                    obj.resetSelected();\n                    // Update selected item\n                    obj.items[index].element.classList.add('jdropdown-selected');\n                    // Add to the selected list\n                    obj.selected.push(index);\n                    // Close\n                    obj.close();\n                }\n            } else {\n                // Toggle option\n                if (obj.items[index].element.classList.contains('jdropdown-selected')) {\n                    obj.items[index].element.classList.remove('jdropdown-selected');\n                    // Remove from selected list\n                    var indexToRemove = obj.selected.indexOf(index);\n                    // Remove select\n                    obj.selected.splice(indexToRemove, 1);\n                } else {\n                    // Select element\n                    obj.items[index].element.classList.add('jdropdown-selected');\n                    // Add to the selected list\n                    obj.selected.push(index);\n                }\n\n                // Update labels for multiple dropdown\n                if (! obj.options.autocomplete) {\n                    obj.updateLabel();\n                }\n            }\n\n            // Current selection\n            var newValue = obj.getValue();\n            var newLabel = obj.getText();\n\n            // Events\n            if (typeof(obj.options.onchange) == 'function') {\n                obj.options.onchange(el, index, oldValue, newValue, oldLabel, newLabel);\n            }\n        }\n    }\n\n    obj.selectItem = function(item) {\n        if (jSuites.dropdown.current) {\n            var index = item.getAttribute('data-index');\n            if (index != null) {\n                obj.selectIndex(index);\n            }\n        }\n    }\n\n    obj.find = function(str) {\n        // Force lowercase\n        var str = str ? str.toLowerCase() : null;\n\n        // Append options\n        for (var i = 0; i < obj.items.length; i++) {\n            if (str == null || obj.items[i].textLowerCase.indexOf(str) != -1) {\n                obj.items[i].element.style.display = '';\n            } else {\n                if (obj.selected.indexOf(i) == -1) {\n                    obj.items[i].element.style.display = 'none';\n                } else {\n                    obj.items[i].element.style.display = '';\n                }\n            }\n        }\n\n        var numVisibleItems = function(items) {\n            var visible = 0;\n            for (var j = 0; j < items.length; j++) {\n                if (items[j].style.display != 'none') {\n                    visible++;\n                }\n            }\n            return visible;\n        }\n\n        // Hide groups\n        /*for (var i = 0; i < obj.groups.length; i++) {\n            if (numVisibleItems(obj.groups[i].querySelectorAll('.jdropdown-item'))) {\n                obj.groups[i].children[0].style.display = '';\n            } else {\n                obj.groups[i].children[0].style.display = 'none';\n            }\n        }*/\n    }\n\n    obj.updateLabel = function() {\n        // Update label\n        header.value = obj.getText();\n    }\n\n    obj.open = function() {\n        if (jSuites.dropdown.current != el) {\n            if (jSuites.dropdown.current) {\n                jSuites.dropdown.current.dropdown.close();\n            }\n            jSuites.dropdown.current = el;\n        }\n\n        // Focus\n        if (! el.classList.contains('jdropdown-focus')) {\n            // Add focus\n            el.classList.add('jdropdown-focus');\n\n            // Animation\n            if (jSuites.getWindowWidth() < 800) {\n                if (obj.options.type == null || obj.options.type == 'picker') {\n                    jSuites.slideBottom(container, 1);\n                }\n            }\n\n            // Filter\n            if (obj.options.autocomplete == true) {\n                // Redo search\n                obj.find();\n                // Clear search field\n                header.value = '';\n                header.focus();\n            }\n\n            // Set cursor for the first or first selected element\n            var cursor = (obj.selected && obj.selected[0]) ? obj.selected[0] : 0;\n            obj.updateCursor(cursor);\n\n            // Container Size\n            if (! obj.options.type || obj.options.type == 'default') {\n                const rect = el.getBoundingClientRect();\n                const rectContainer = container.getBoundingClientRect();\n\n                if (obj.options.position) {\n                    container.style.position = 'fixed';\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\n                        container.style.top = (rect.top - rectContainer.height - 2) + 'px';\n                    } else {\n                        container.style.top = (rect.top + rect.height + 1) + 'px';\n                    }\n                    container.style.left = rect.left + 'px';\n                } else {\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\n                        container.style.bottom = (rect.height) + 'px';\n                    } else {\n                        container.style.top = '';\n                        container.style.bottom = '';\n                    }\n                }\n\n                container.style.minWidth = rect.width + 'px';\n            }\n        }\n\n        // Events\n        if (typeof(obj.options.onopen) == 'function') {\n            obj.options.onopen(el);\n        }\n    }\n\n    obj.close = function(ignoreEvents) {\n        if (jSuites.dropdown.current) {\n            // Remove controller\n            jSuites.dropdown.current = null\n            // Remove cursor\n            obj.resetCursor();\n            // Update labels\n            obj.updateLabel();\n            // Events\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\n                obj.options.onclose(el);\n            }\n            // Blur\n            if (header.blur) {\n                header.blur();\n            }\n            // Remove focus\n            el.classList.remove('jdropdown-focus');\n        }\n\n        return obj.getValue();\n    }\n\n    /**\n     * Update position cursor\n     */\n    obj.updateCursor = function(index) {\n        // Set new cursor\n        if (obj.items && obj.items[index] && obj.items[index].element) {\n            // Reset cursor\n            obj.resetCursor();\n\n            // Set new cursor\n            obj.items[index].element.classList.add('jdropdown-cursor');\n\n            // Update position\n            obj.currentIndex = parseInt(index);\n    \n            // Update scroll to the cursor element\n            var container = content.scrollTop;\n            var element = obj.items[obj.currentIndex].element;\n            content.scrollTop = element.offsetTop - element.scrollTop + element.clientTop - 95;\n        }\n    }\n\n    /**\n     * Reset cursor\n     */\n    obj.resetCursor = function() {\n        // Remove current cursor\n        if (obj.currentIndex != null) {\n            // Remove visual cursor\n            if (obj.items && obj.items[obj.currentIndex]) {\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\n            }\n            // Reset cursor\n            obj.currentIndex = null;\n        }\n    }\n\n    /**\n     * Reset cursor\n     */\n    obj.resetSelected = function() {\n        // Unselected all\n        if (obj.selected) {\n            // Remove visual selection\n            for (var i = 0; i < obj.selected.length; i++) {\n                if (obj.items[obj.selected[i]]) {\n                    obj.items[obj.selected[i]].element.classList.remove('jdropdown-selected');\n                }\n            }\n            // Reset current selected items\n            obj.selected = [];\n        }\n    }\n\n    /**\n     * Reset cursor and selected items\n     */\n    obj.reset = function() {\n        // Reset cursor\n        obj.resetCursor();\n\n        // Reset selected\n        obj.resetSelected();\n\n        // Update labels\n        obj.updateLabel();\n    }\n\n    /**\n     * First visible item\n     */\n    obj.firstVisible = function() {\n        var newIndex = null;\n        for (var i = 0; i < obj.items.length; i++) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n                break;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    /**\n     * Navigation\n     */\n    obj.first = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex - 1; i >= 0; i--) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    obj.last = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex + 1; i < obj.items.length; i++) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    obj.next = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex + 1; i < obj.items.length; i++) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n                break;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    obj.prev = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex - 1; i >= 0; i--) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n                break;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    if (! jSuites.dropdown.hasEvents) {\n        if ('ontouchsend' in document.documentElement === true) {\n            document.addEventListener('touchsend', jSuites.dropdown.mouseup);\n        } else {\n            document.addEventListener('mouseup', jSuites.dropdown.mouseup);\n        }\n        document.addEventListener('keydown', jSuites.dropdown.onkeydown);\n\n        jSuites.dropdown.hasEvents = true;\n    }\n\n    // Start dropdown\n    obj.init();\n\n    // Keep object available from the node\n    el.dropdown = obj;\n\n    return obj;\n});\n\njSuites.dropdown.hasEvents = false;\n\njSuites.dropdown.mouseup = function(e) {\n    var element = jSuites.getElement(e.target, 'jdropdown');\n    if (element) {\n        var dropdown = element.dropdown;\n        if (e.target.classList.contains('jdropdown-header')) {\n            if (element.classList.contains('jdropdown-focus') && element.classList.contains('jdropdown-default')) {\n                dropdown.close();\n            } else {\n                dropdown.open();\n            }\n        } else if (e.target.classList.contains('jdropdown-group-name')) {\n            var items = e.target.nextSibling.children;\n            if (e.target.nextSibling.style.display != 'none') {\n                for (var i = 0; i < items.length; i++) {\n                    if (items[i].style.display != 'none') {\n                        dropdown.selectItem(items[i]);\n                    }\n                }\n            }\n        } else if (e.target.classList.contains('jdropdown-group-arrow')) {\n            if (e.target.classList.contains('jdropdown-group-arrow-down')) {\n                e.target.classList.remove('jdropdown-group-arrow-down');\n                e.target.classList.add('jdropdown-group-arrow-up');\n                e.target.parentNode.nextSibling.style.display = 'none';\n            } else {\n                e.target.classList.remove('jdropdown-group-arrow-up');\n                e.target.classList.add('jdropdown-group-arrow-down');\n                e.target.parentNode.nextSibling.style.display = '';\n            }\n        } else if (e.target.classList.contains('jdropdown-item')) {\n            dropdown.selectItem(e.target);\n        } else if (e.target.classList.contains('jdropdown-image')) {\n            dropdown.selectIndex(e.target.parentNode.getAttribute('data-index'));\n        } else if (e.target.classList.contains('jdropdown-description')) {\n            dropdown.selectIndex(e.target.parentNode.getAttribute('data-index'));\n        } else if (e.target.classList.contains('jdropdown-title')) {\n            dropdown.selectIndex(e.target.parentNode.parentNode.getAttribute('data-index'));\n        } else if (e.target.classList.contains('jdropdown-close') || e.target.classList.contains('jdropdown-backdrop')) {\n            // Close\n            dropdown.close();\n        }\n\n        e.stopPropagation();\n        e.preventDefault();\n    } else {\n        if (jSuites.dropdown.current) {\n            jSuites.dropdown.current.dropdown.close();\n        }\n    }\n}\n\n\n// Keydown controls\njSuites.dropdown.onkeydown = function(e) {\n    if (jSuites.dropdown.current) {\n        // Element\n        var element = jSuites.dropdown.current.dropdown;\n        // Index\n        var index = element.currentIndex;\n\n        if (e.shiftKey) {\n\n        } else {\n            if (e.which == 13 || e.which == 27 || e.which == 35 || e.which == 36 || e.which == 38 || e.which == 40) {\n                // Move cursor\n                if (e.which == 13) {\n                    element.selectIndex(index)\n                } else if (e.which == 38) {\n                    if (index == null) {\n                        element.firstVisible();\n                    } else if (index > 0) {\n                        element.prev();\n                    }\n                } else if (e.which == 40) {\n                    if (index == null) {\n                        element.firstVisible();\n                    } else if (index + 1 < element.options.data.length) {\n                        element.next();\n                    }\n                } else if (e.which == 36) {\n                    element.first();\n                } else if (e.which == 35) {\n                    element.last();\n                } else if (e.which == 27) {\n                    element.close();\n                }\n\n                e.stopPropagation();\n                e.preventDefault();\n            }\n        }\n    }\n}\n\njSuites.dropdown.extractFromDom = function(el, options) {\n    // Keep reference\n    var select = el;\n    if (! options) {\n        options = {};\n    }\n    // Prepare configuration\n    if (el.getAttribute('multiple') && (! options || options.multiple == undefined)) {\n        options.multiple = true;\n    }\n    if (el.getAttribute('placeholder') && (! options || options.placeholder == undefined)) {\n        options.placeholder = el.getAttribute('placeholder');\n    }\n    if (el.getAttribute('data-autocomplete') && (! options || options.autocomplete == undefined)) {\n        options.autocomplete = true;\n    }\n    if (! options || options.width == undefined) {\n        options.width = el.offsetWidth;\n    }\n    if (el.value && (! options || options.value == undefined)) {\n        options.value = el.value;\n    }\n    if (! options || options.data == undefined) {\n        options.data = [];\n        for (var j = 0; j < el.children.length; j++) {\n            if (el.children[j].tagName == 'OPTGROUP') {\n                for (var i = 0; i < el.children[j].children.length; i++) {\n                    options.data.push({\n                        id: el.children[j].children[i].value,\n                        name: el.children[j].children[i].innerHTML,\n                        group: el.children[j].getAttribute('label'),\n                    });\n                }\n            } else {\n                options.data.push({\n                    id: el.children[j].value,\n                    name: el.children[j].innerHTML,\n                });\n            }\n        }\n    }\n    if (! options || options.onchange == undefined) {\n        options.onchange = function(a,b,c,d) {\n            if (options.multiple == true) {\n                if (obj.items[b].classList.contains('jdropdown-selected')) {\n                    select.options[b].setAttribute('selected', 'selected');\n                } else {\n                    select.options[b].removeAttribute('selected');\n                }\n            } else {\n                select.value = d;\n            }\n        }\n    }\n    // Create DIV\n    var div = document.createElement('div');\n    el.parentNode.insertBefore(div, el);\n    el.style.display = 'none';\n    el = div;\n\n    return { el:el, options:options };\n}\r\n\r\n/**\n * (c) jTools Text Editor\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Inline richtext editor\n */\n\njSuites.editor = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Default configuration\n    var defaults = {\n        // Initial HTML content\n        value: null,\n        // Initial snippet\n        snippet: null,\n        // Add toolbar\n        toolbar: null,\n        // Max height\n        maxHeight: null,\n        // Website parser is to read websites and images from cross domain\n        remoteParser: null,\n        // Key from youtube to read properties from URL\n        youtubeKey: null,\n        // User list\n        userSearch: null,\n        // Parse URL\n        parseURL: false,\n        // Accept drop files\n        dropZone: true,\n        dropAsAttachment: false,\n        acceptImages: true,\n        acceptFiles: false,\n        maxFileSize: 5000000, \n        // Border\n        border: true,\n        padding: true,\n        focus: false,\n        // Events\n        onclick: null,\n        onfocus: null,\n        onblur: null,\n        onload: null,\n        onenter: null,\n        onkeyup: null,\n        onkeydown: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Private controllers\n    var imageResize = 0;\n    var editorTimer = null;\n    var editorAction = null;\n\n    // Make sure element is empty\n    el.innerHTML = '';\n\n    // Prepare container\n    el.classList.add('jeditor-container');\n\n    // Padding\n    if (obj.options.padding == true) {\n        el.classList.add('jeditor-padding');\n    }\n\n    // Border\n    if (obj.options.border == false) {\n        el.style.border = '0px';\n    }\n\n    // Snippet\n    var snippet = document.createElement('div');\n    snippet.className = 'snippet';\n    snippet.setAttribute('contenteditable', false);\n\n    // Toolbar\n    var toolbar = document.createElement('div');\n    toolbar.className = 'jeditor-toolbar';\n\n    // Create editor\n    var editor = document.createElement('div');\n    editor.setAttribute('contenteditable', true);\n    editor.setAttribute('spellcheck', false);\n    editor.className = 'jeditor';\n\n    // Max height\n    if (obj.options.maxHeight) {\n        editor.style.overflowY = 'auto';\n        editor.style.maxHeight = obj.options.maxHeight;\n    }\n\n    // Set editor initial value\n    if (obj.options.value) {\n        var value = obj.options.value;\n    } else {\n        var value = el.innerHTML ? el.innerHTML : ''; \n    }\n\n    if (! value) {\n        var value = '<br>';\n    }\n\n    /**\n     * Extract images from a HTML string\n     */\n    var extractImageFromHtml = function(html) {\n        // Create temp element\n        var div = document.createElement('div');\n        div.innerHTML = html;\n\n        // Extract images\n        var img = div.querySelectorAll('img');\n\n        if (img.length) {\n            for (var i = 0; i < img.length; i++) {\n                obj.addImage(img[i].src);\n            }\n        }\n    }\n\n    /**\n     * Insert node at caret\n     */\n    var insertNodeAtCaret = function(newNode) {\n        var sel, range;\n\n        if (window.getSelection) {\n            sel = window.getSelection();\n            if (sel.rangeCount) {\n                range = sel.getRangeAt(0);\n                var selectedText = range.toString();\n                range.deleteContents();\n                range.insertNode(newNode); \n                // move the cursor after element\n                range.setStartAfter(newNode);\n                range.setEndAfter(newNode); \n                sel.removeAllRanges();\n                sel.addRange(range);\n            }\n        }\n    }\n\n    /**\n     * Append snippet or thumbs in the editor\n     * @Param object data\n     */\n    var appendElement = function(data) {\n        // Reset snippet\n        snippet.innerHTML = '';\n\n        if (data.image) {\n            var div = document.createElement('div');\n            div.className = 'snippet-image';\n            div.setAttribute('data-k', 'image');\n            snippet.appendChild(div);\n\n            var image = document.createElement('img');\n            image.src = data.image;\n            div.appendChild(image);\n        }\n\n        var div = document.createElement('div');\n        div.className = 'snippet-title';\n        div.setAttribute('data-k', 'title');\n        div.innerHTML = data.title;\n        snippet.appendChild(div);\n\n        var div = document.createElement('div');\n        div.className = 'snippet-description';\n        div.setAttribute('data-k', 'description');\n        div.innerHTML = data.description;\n        snippet.appendChild(div);\n\n        var div = document.createElement('div');\n        div.className = 'snippet-host';\n        div.setAttribute('data-k', 'host');\n        div.innerHTML = data.host;\n        snippet.appendChild(div);\n\n        var div = document.createElement('div');\n        div.className = 'snippet-url';\n        div.setAttribute('data-k', 'url');\n        div.innerHTML = data.url;\n        snippet.appendChild(div);\n\n        editor.appendChild(snippet);\n    }\n\n    var verifyEditor = function() {\n        clearTimeout(editorTimer);\n        editorTimer = setTimeout(function() {\n            var snippet = editor.querySelector('.snippet');\n            var thumbsContainer = el.querySelector('.jeditor-thumbs-container');\n\n            if (! snippet && ! thumbsContainer) {\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\n                var container = document.createElement('div');\n                container.innerHTML = html;\n                var thumbsContainer = container.querySelector('.jeditor-thumbs-container');\n                if (thumbsContainer) {\n                    thumbsContainer.remove();\n                }\n                var text = container.innerText; \n                var url = jSuites.editor.detectUrl(text);\n\n                if (url) {\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\n                        if (jSuites.editor.getDomain(url[0]) == window.location.hostname) {\n                            obj.importImage(url[0], '');\n                        } else {\n                            obj.importImage(obj.options.remoteParser + url[0], '');\n                        }\n                    } else {\n                        var id = jSuites.editor.youtubeParser(url[0]);\n\n                        if (id) {\n                            obj.getYoutube(id);\n                        } else {\n                            obj.getWebsite(url[0]);\n                        }\n                    }\n                }\n            }\n        }, 1000);\n    }\n\n    obj.parseContent = function() {\n        verifyEditor();\n    }\n\n    /**\n     * Get metadata from a youtube video\n     */\n    obj.getYoutube = function(id) {\n        if (! obj.options.youtubeKey) {\n            console.error('The youtubeKey is not defined');\n        } else {\n            jSuites.ajax({\n                url: 'https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&key=' + obj.options.youtubeKey + '&id=' + id,\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    // Only valid elements to be appended\n                    if (result.items && result.items[0]) {\n                        var p = {\n                            title: '',\n                            description: '',\n                            image: '',\n                            host: 'www.youtube.com',\n                            url: 'https://www.youtube.com?watch=' + id,\n                        }\n                        if (result.items[0].snippet.title) {\n                            p.title = result.items[0].snippet.title;\n                        }\n                        if (result.items[0].snippet.description) {\n                            p.description = result.items[0].snippet.description;\n\n                            if (p.description.length > 150) {\n                                p.description = p.description.substr(0, 150) + '...';\n                            }\n                        }\n                        if (result.items[0].snippet.thumbnails.medium.url) {\n                            p.image = result.items[0].snippet.thumbnails.medium.url;\n                        }\n\n                        appendElement(p);\n                    }\n                }\n            });\n        }\n    }\n\n    /**\n     * Get meta information from a website\n     */\n    obj.getWebsite = function(url) {\n        if (! obj.options.remoteParser) {\n            console.log('The remoteParser is not defined');\n        } else {\n            jSuites.ajax({\n                url: obj.options.remoteParser + encodeURI(url.trim()),\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    var p = {\n                        title: '',\n                        description: '',\n                        image: '',\n                        host: url,\n                        url: url,\n                    }\n\n                    if (result.title) {\n                        p.title = result.title;\n                    }\n                    if (result.description) {\n                        p.description = result.description;\n                    }\n                    if (result.image) {\n                        p.image = result.image;\n                    } else if (result['og:image']) {\n                        p.image = result['og:image'];\n                    }\n                    if (result.host) {\n                        p.host = result.host;\n                    }\n                    if (result.url) {\n                        p.url = result.url;\n                    }\n\n                    appendElement(p);\n                }\n            });\n        }\n    }\n\n    /**\n     * Set editor value\n     */\n    obj.setData = function(html) {\n        editor.innerHTML = html;\n        cursor();\n    }\n\n    /**\n     * Get editor data\n     */\n    obj.getData = function(json) {\n        if (! json) {\n            var data = editor.innerHTML;\n        } else {\n            var data = {\n                content : '',\n            }\n\n            // Get tag users\n            var tagged = editor.querySelectorAll('.post-tag');\n            if (tagged.length) {\n                data.users = [];\n                for (var i = 0; i < tagged.length; i++) {\n                    var userId = tagged[i].getAttribute('data-user');\n                    if (userId) {\n                        data.users.push(userId);\n                    }\n                }\n                data.users = data.users.join(',');\n            }\n\n            if (snippet.innerHTML) {\n                var index = 0;\n                data.snippet = {};\n                for (var i = 0; i < snippet.children.length; i++) {\n                    // Get key from element\n                    var key = snippet.children[i].getAttribute('data-k');\n                    if (key) {\n                        if (key == 'image') {\n                            data.snippet.image = snippet.children[i].children[0].getAttribute('src');\n                        } else {\n                            data.snippet[key] = snippet.children[i].innerHTML;\n                        }\n                    }\n                }\n\n                snippet.innerHTML = '';\n                snippet.remove();\n            }\n\n            var text = editor.innerHTML;\n            text = text.replace(/<br>/g, \"\\n\");\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\n            data.content = text.trim();\n            data = JSON.stringify(data);\n        }\n\n        return data;\n    }\n\n    // Reset\n    obj.reset = function() {\n        editor.innerHTML = '';\n    }\n\n    obj.addPdf = function(data) {\n        if (data.result.substr(0,4) != 'data') {\n            console.error('Invalid source');\n        } else {\n            var canvas = document.createElement('canvas');\n            canvas.width = 60;\n            canvas.height = 60;\n\n            var img = new Image();\n            var ctx = canvas.getContext('2d');\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n            canvas.toBlob(function(blob) {\n                var newImage = document.createElement('img');\n                newImage.src = window.URL.createObjectURL(blob);\n                newImage.setAttribute('data-extension', 'pdf');\n                if (data.name) {\n                    newImage.setAttribute('data-name', data.name);\n                }\n                if (data.size) {\n                    newImage.setAttribute('data-size', data.size);\n                }\n                if (data.date) {\n                    newImage.setAttribute('data-date', data.date);\n                }\n                newImage.className = 'jfile pdf';\n\n                insertNodeAtCaret(newImage);\n                jSuites.files[newImage.src] = data.result.substr(data.result.indexOf(',') + 1);\n            });\n        }\n    }\n\n    obj.addImage = function(src, name, size, date) {\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\n            console.error('remoteParser not defined in your initialization');\n        } else {\n            // This is to process cross domain images\n            if (src.substr(0,4) == 'data') {\n                var extension = src.split(';')\n                extension = extension[0].split('/');\n                extension = extension[1];\n            } else {\n                var extension = src.substr(src.lastIndexOf('.') + 1);\n                // Work for cross browsers\n                src = obj.options.remoteParser + src;\n            }\n\n            var img = new Image();\n\n            img.onload = function onload() {\n                var canvas = document.createElement('canvas');\n                canvas.width = img.width;\n                canvas.height = img.height;\n\n                var ctx = canvas.getContext('2d');\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n                canvas.toBlob(function(blob) {\n                    var newImage = document.createElement('img');\n                    newImage.src = window.URL.createObjectURL(blob);\n                    newImage.setAttribute('tabindex', '900');\n                    newImage.setAttribute('data-extension', extension);\n                    if (name) {\n                        newImage.setAttribute('data-name', name);\n                    }\n                    if (size) {\n                        newImage.setAttribute('data-size', size);\n                    }\n                    if (date) {\n                        newImage.setAttribute('data-date', date);\n                    }\n                    newImage.className = 'jfile';\n                    var content = canvas.toDataURL();\n                    insertNodeAtCaret(newImage);\n\n                    jSuites.files[newImage.src] = content.substr(content.indexOf(',') + 1);\n                });\n            };\n\n            img.src = src;\n        }\n    }\n\n    obj.addFile = function(files) {\n        var reader = [];\n\n        for (var i = 0; i < files.length; i++) {\n            if (files[i].size > obj.options.maxFileSize) {\n                alert('The file is too big');\n            } else {\n                // Only PDF or Images\n                var type = files[i].type.split('/');\n\n                if (type[0] == 'image') {\n                    type = 1;\n                } else if (type[1] == 'pdf') {\n                    type = 2;\n                } else {\n                    type = 0;\n                }\n\n                if (type) {\n                    // Create file\n                    reader[i] = new FileReader();\n                    reader[i].index = i;\n                    reader[i].type = type;\n                    reader[i].name = files[i].name;\n                    reader[i].date = files[i].lastModified;\n                    reader[i].size = files[i].size;\n                    reader[i].addEventListener(\"load\", function (data) {\n                        // Get result\n                        if (data.target.type == 2) {\n                            if (obj.options.acceptFiles == true) {\n                                obj.addPdf(data.target);\n                            }\n                        } else {\n                            obj.addImage(data.target.result, data.target.name, data.total, data.target.lastModified);\n                        }\n                    }, false);\n\n                    reader[i].readAsDataURL(files[i])\n                } else {\n                    alert('The extension is not allowed');\n                }\n            }\n        }\n    }\n\n    // Destroy\n    obj.destroy = function() {\n        editor.removeEventListener('mouseup', editorMouseUp);\n        editor.removeEventListener('mousedown', editorMouseDown);\n        editor.removeEventListener('mousemove', editorMouseMove);\n        editor.removeEventListener('keyup', editorKeyUp);\n        editor.removeEventListener('keydown', editorKeyDown);\n        editor.removeEventListener('dragstart', editorDragStart);\n        editor.removeEventListener('dragenter', editorDragEnter);\n        editor.removeEventListener('dragover', editorDragOver);\n        editor.removeEventListener('drop', editorDrop);\n        editor.removeEventListener('paste', editorPaste);\n\n        if (typeof(obj.options.onblur) == 'function') {\n            editor.removeEventListener('blur', editorBlur);\n        }\n        if (typeof(obj.options.onfocus) == 'function') {\n            editor.removeEventListener('focus', editorFocus);\n        }\n\n        el.editor = null;\n        el.classList.remove('jeditor-container');\n\n        toolbar.remove();\n        snippet.remove();\n        editor.remove();\n    }\n\n    var isLetter = function (str) {\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\n        return str.match(regex) ? 1 : 0;\n    }\n\n    // Event handlers\n    var editorMouseUp = function(e) {\n        editorAction = false;\n    }\n\n    var editorMouseDown = function(e) {\n        var close = function(snippet) {\n            var rect = snippet.getBoundingClientRect();\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\n                snippet.innerHTML = '';\n                snippet.remove();\n            }\n        }\n\n        if (e.target.tagName == 'IMG') {\n            if (e.target.style.cursor) {\n                var rect = e.target.getBoundingClientRect();\n                editorAction = {\n                    e: e.target,\n                    x: e.clientX,\n                    y: e.clientY,\n                    w: rect.width,\n                    h: rect.height,\n                    d: e.target.style.cursor,\n                }\n\n                if (! e.target.style.width) {\n                    e.target.style.width = rect.width + 'px';\n                }\n\n                if (! e.target.style.height) {\n                    e.target.style.height = rect.height + 'px';\n                }\n\n                var s = window.getSelection();\n                if (s.rangeCount) {\n                    for (var i = 0; i < s.rangeCount; i++) {\n                        s.removeRange(s.getRangeAt(i));\n                    }\n                }\n            } else {\n                editorAction = true;\n            }\n        } else { \n            if (e.target.classList.contains('snippet')) {\n                close(e.target);\n            } else if (e.target.parentNode.classList.contains('snippet')) {\n                close(e.target.parentNode);\n            }\n\n            editorAction = true;\n        }\n    }\n\n    var editorMouseMove = function(e) {\n        if (e.target.tagName == 'IMG') {\n            if (e.target.getAttribute('tabindex')) {\n                var rect = e.target.getBoundingClientRect();\n                if (e.clientY - rect.top < 5) {\n                    if (rect.width - (e.clientX - rect.left) < 5) {\n                        e.target.style.cursor = 'ne-resize';\n                    } else if (e.clientX - rect.left < 5) {\n                        e.target.style.cursor = 'nw-resize';\n                    } else {\n                        e.target.style.cursor = 'n-resize';\n                    }\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\n                    if (rect.width - (e.clientX - rect.left) < 5) {\n                        e.target.style.cursor = 'se-resize';\n                    } else if (e.clientX - rect.left < 5) {\n                        e.target.style.cursor = 'sw-resize';\n                    } else {\n                        e.target.style.cursor = 's-resize';\n                    }\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\n                    e.target.style.cursor = 'e-resize';\n                } else if (e.clientX - rect.left < 5) {\n                    e.target.style.cursor = 'w-resize';\n                } else {\n                    e.target.style.cursor = '';\n                }\n            }\n        }\n\n        // Move\n        if (e.which == 1 && editorAction && editorAction.d) {\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\n                editorAction.e.style.width = (editorAction.w + (e.clientX - editorAction.x)) + 'px';\n\n                if (e.shiftKey) {\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\n                    editorAction.e.style.height = editorAction.h + newHeight + 'px';\n                } else {\n                    var newHeight =  null;\n                }\n            }\n\n            if (! newHeight) {\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\n                    if (! e.shiftKey) {\n                        editorAction.e.style.height = editorAction.h + (e.clientY - editorAction.y);\n                    }\n                }\n            }\n        }\n    }\n\n    var editorKeyUp = function(e) {\n        if (! editor.innerHTML) {\n            editor.innerHTML = '<div><br></div>';\n        }\n\n        if (typeof(obj.options.onkeyup) == 'function') { \n            obj.options.onkeyup(e, el);\n        }\n    }\n\n\n    var editorKeyDown = function(e) {\n        // Check for URL\n        if (obj.options.parseURL == true) {\n            verifyEditor();\n        }\n\n        // Closable\n        if (typeof(obj.options.onenter) == 'function' && e.which == 13) {\n            var data = obj.getData();\n            obj.options.onenter(obj, el, data, e);\n        }\n\n        if (typeof(obj.options.onkeydown) == 'function') { \n            obj.options.onkeydown(e, el);\n        }\n    }\n\n    var editorPaste = function(e) {\n        if (e.clipboardData || e.originalEvent.clipboardData) {\n            var html = (e.originalEvent || e).clipboardData.getData('text/html');\n            var text = (e.originalEvent || e).clipboardData.getData('text/plain');\n            var file = (e.originalEvent || e).clipboardData.files\n        } else if (window.clipboardData) {\n            var html = window.clipboardData.getData('Html');\n            var text = window.clipboardData.getData('Text');\n            var file = window.clipboardData.files\n        }\n\n        if (file.length) {\n            // Paste a image from the clipboard\n            obj.addFile(file);\n        } else {\n            // Paste text\n            text = text.split('\\r\\n');\n            var str = '';\n            if (e.target.nodeName == 'DIV' && ! e.target.classList.contains('jeditor')) {\n                for (var i = 0; i < text.length; i++) {\n                    if (text[i]) {\n                        str += text[i] + \"<br>\\r\\n\";\n                    }\n                }\n            } else {\n                for (var i = 0; i < text.length; i++) {\n                    if (text[i]) {\n                        str += '<div>' + text[i] + '</div>';\n                    } else {\n                        str += '<div><br></div>';\n                    }\n                }\n            }\n            // Insert text\n            document.execCommand('insertHtml', false, str);\n\n            // Extra images from the paste\n            if (obj.options.acceptImages == true) {\n                extractImageFromHtml(html);\n            }\n        }\n\n        e.preventDefault();\n    }\n\n    var editorDragStart = function(e) {\n        if (editorAction && editorAction.e) {\n            e.preventDefault();\n        }\n    }\n\n    var editorDragEnter = function(e) {\n        if (editorAction || obj.options.dropZone == false) {\n            // Do nothing\n        } else {\n            el.classList.add('jeditor-dragging');\n        }\n    }\n\n    var editorDragOver = function(e) {\n        if (editorAction || obj.options.dropZone == false) {\n            // Do nothing\n        } else {\n            if (editorTimer) {\n                clearTimeout(editorTimer);\n            }\n\n            editorTimer = setTimeout(function() {\n                el.classList.remove('jeditor-dragging');\n            }, 100);\n        }\n    }\n\n    var editorDrop = function(e) {\n        if (editorAction || obj.options.dropZone == false) {\n            // Do nothing\n        } else {\n            // Position caret on the drop\n            var range = null;\n            if (document.caretRangeFromPoint) {\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\n            } else if (e.rangeParent) {\n                range=document.createRange();\n                range.setStart(e.rangeParent,e.rangeOffset);\n            }\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n            sel.anchorNode.parentNode.focus();\n\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\n            var file = (e.originalEvent || e).dataTransfer.files;\n    \n            if (file.length) {\n                obj.addFile(file);\n            } else if (text) {\n                extractImageFromHtml(html);\n            }\n\n            el.classList.remove('jeditor-dragging');\n            e.preventDefault();\n        }\n    }\n\n    var editorBlur = function() {\n        obj.options.onblur(obj, el, obj.getData());\n    }\n\n    var editorFocus = function() {\n        obj.options.onfocus(obj, el, obj.getData());\n    }\n\n    editor.addEventListener('mouseup', editorMouseUp);\n    editor.addEventListener('mousedown', editorMouseDown);\n    editor.addEventListener('mousemove', editorMouseMove);\n    editor.addEventListener('keyup', editorKeyUp);\n    editor.addEventListener('keydown', editorKeyDown);\n    editor.addEventListener('dragstart', editorDragStart);\n    editor.addEventListener('dragenter', editorDragEnter);\n    editor.addEventListener('dragover', editorDragOver);\n    editor.addEventListener('drop', editorDrop);\n    editor.addEventListener('paste', editorPaste);\n\n    // Blur\n    if (typeof(obj.options.onblur) == 'function') {\n        editor.addEventListener('blur', editorBlur);\n    }\n\n    // Focus\n    if (typeof(obj.options.onfocus) == 'function') {\n        editor.addEventListener('focus', editorFocus);\n    }\n\n    // Onload\n    if (typeof(obj.options.onload) == 'function') {\n        obj.options.onload(el, editor);\n    }\n\n    // Set value to the editor\n    editor.innerHTML = value;\n\n    // Append editor to the containre\n    el.appendChild(editor);\n\n    // Snippet\n    if (obj.options.snippet) {\n        appendElement(obj.options.snippet);\n    }\n\n    // Default toolbar\n    if (obj.options.toolbar == null) {\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\n    }\n\n    // Add toolbar\n    if (obj.options.toolbar) {\n        for (var i = 0; i < obj.options.toolbar.length; i++) {\n            if (obj.options.toolbar[i].icon) {\n                var item = document.createElement('div');\n                item.style.userSelect = 'none';\n                var itemIcon = document.createElement('i');\n                itemIcon.className = 'material-icons';\n                itemIcon.innerHTML = obj.options.toolbar[i].icon;\n                itemIcon.onclick = (function (a) {\n                    let b = a;\n                    return function () {\n                        obj.options.toolbar[b].onclick(el, obj, this)\n                    };\n                })(i);\n                item.appendChild(itemIcon);\n                toolbar.appendChild(item);\n            } else {\n                if (obj.options.toolbar[i].type == 'divisor') {\n                    var item = document.createElement('div');\n                    item.className = 'jeditor-toolbar-divisor';\n                    toolbar.appendChild(item);\n                } else if (obj.options.toolbar[i].type == 'button') {\n                    var item = document.createElement('div');\n                    item.classList.add('jeditor-toolbar-button');\n                    item.innerHTML = obj.options.toolbar[i].value;\n                    toolbar.appendChild(item);\n                }\n            }\n        }\n\n        el.appendChild(toolbar);\n    }\n\n    // Focus to the editor\n    if (obj.options.focus) {\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\n    }\n\n    el.editor = obj;\n\n    return obj;\n});\n\njSuites.editor.setCursor = function(element, first) {\n    element.focus();\n    document.execCommand('selectAll');\n    var sel = window.getSelection();\n    var range = sel.getRangeAt(0);\n    if (first == true) {\n        var node = range.startContainer;\n        var size = 0;\n    } else {\n        var node = range.endContainer;\n        var size = node.length;\n    }\n    range.setStart(node, size);\n    range.setEnd(node, size);\n    sel.removeAllRanges();\n    sel.addRange(range);\n}\n\njSuites.editor.getDomain = function(url) {\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\n}\n\njSuites.editor.detectUrl = function(text) {\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\n    var links = text.match(expression);\n\n    if (links) {\n        if (links[0].substr(0,3) == 'www') {\n            links[0] = 'http://' + links[0];\n        }\n    }\n\n    return links;\n}\n\njSuites.editor.youtubeParser = function(url) {\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\n    var match = url.match(regExp);\n\n    return (match && match[7].length == 11) ? match[7] : false;\n}\n\njSuites.editor.getDefaultToolbar = function() { \n    return [\n        {\n            icon:'undo',\n            onclick: function() {\n                document.execCommand('undo');\n            }\n        },\n        {\n            icon:'redo',\n            onclick: function() {\n                document.execCommand('redo');\n            }\n        },\n        {\n            type:'divisor'\n        },\n        {\n            icon:'format_bold',\n            onclick: function(a,b,c) {\n                document.execCommand('bold');\n\n                if (document.queryCommandState(\"bold\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_italic',\n            onclick: function(a,b,c) {\n                document.execCommand('italic');\n\n                if (document.queryCommandState(\"italic\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_underline',\n            onclick: function(a,b,c) {\n                document.execCommand('underline');\n\n                if (document.queryCommandState(\"underline\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            type:'divisor'\n        },\n        {\n            icon:'format_list_bulleted',\n            onclick: function(a,b,c) {\n                document.execCommand('insertUnorderedList');\n\n                if (document.queryCommandState(\"insertUnorderedList\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_list_numbered',\n            onclick: function(a,b,c) {\n                document.execCommand('insertOrderedList');\n\n                if (document.queryCommandState(\"insertOrderedList\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_indent_increase',\n            onclick: function(a,b,c) {\n                document.execCommand('indent', true, null);\n\n                if (document.queryCommandState(\"indent\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_indent_decrease',\n            onclick: function(a,b,c) {\n                document.execCommand('outdent');\n\n                if (document.queryCommandState(\"outdent\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        }\n        /*{\n            type:'select',\n            items: ['Verdana','Arial','Courier New'],\n            onchange: function() {\n            }\n        },\n        {\n            type:'select',\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\n            onchange: function() {\n            }\n        },\n        {\n            icon:'format_align_left',\n            onclick: function() {\n                document.execCommand('JustifyLeft');\n\n                if (document.queryCommandState(\"JustifyLeft\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_align_center',\n            onclick: function() {\n                document.execCommand('justifyCenter');\n\n                if (document.queryCommandState(\"justifyCenter\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_align_right',\n            onclick: function() {\n                document.execCommand('justifyRight');\n\n                if (document.queryCommandState(\"justifyRight\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_align_justify',\n            onclick: function() {\n                document.execCommand('justifyFull');\n\n                if (document.queryCommandState(\"justifyFull\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_list_bulleted',\n            onclick: function() {\n                document.execCommand('insertUnorderedList');\n\n                if (document.queryCommandState(\"insertUnorderedList\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        }*/\n    ];\n}\n\r\n\r\njSuites.image = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        minWidth: false,\r\n        onchange: null,\r\n        singleFile: true,\r\n        remoteParser: null,\r\n        text:{\r\n            extensionNotAllowed:'The extension is not allowed',\r\n            imageTooSmall:'The resolution is too low, try a image with a better resolution. width > 800px',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    // Add image\r\n    obj.addImage = function(file) {\r\n        if (! file.date) {\r\n            file.date = '';\r\n        }\r\n        var img = document.createElement('img');\r\n        img.setAttribute('data-date', file.lastmodified ? file.lastmodified : file.date);\r\n        img.setAttribute('data-name', file.name);\r\n        img.setAttribute('data-size', file.size);\r\n        img.setAttribute('data-small', file.small ? file.small : '');\r\n        img.setAttribute('data-cover', file.cover ? 1 : 0);\r\n        img.setAttribute('data-extension', file.extension);\r\n        img.setAttribute('src', file.file);\r\n        img.className = 'jfile';\r\n        img.style.width = '100%';\r\n\r\n        return img;\r\n    }\r\n\r\n    // Add image\r\n    obj.addImages = function(files) {\r\n        if (obj.options.singleFile == true) {\r\n            el.innerHTML = '';\r\n        }\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            el.appendChild(obj.addImage(files[i]));\r\n        }\r\n    }\r\n\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == 'image') {\r\n            if (obj.options.singleFile == true) {\r\n                el.innerHTML = '';\r\n            }\r\n\r\n            var imageFile = new FileReader();\r\n            imageFile.addEventListener(\"load\", function (v) {\r\n\r\n                var img = new Image();\r\n\r\n                img.onload = function onload() {\r\n                    var canvas = document.createElement('canvas');\r\n                    canvas.width = img.width;\r\n                    canvas.height = img.height;\r\n\r\n                    var ctx = canvas.getContext('2d');\r\n                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                    var data = {\r\n                        file: canvas.toDataURL(),\r\n                        extension: file.name.substr(file.name.lastIndexOf('.') + 1),\r\n                        name: file.name,\r\n                        size: file.size,\r\n                        lastmodified: file.lastModified,\r\n                    }\r\n                    var newImage = obj.addImage(data);\r\n                    el.appendChild(newImage);\r\n\r\n                    // Onchange\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange(newImage);\r\n                    }\r\n                };\r\n\r\n                img.src = v.srcElement.result;\r\n            });\r\n\r\n            imageFile.readAsDataURL(file);\r\n        } else {\r\n            alert(text.extentionNotAllowed);\r\n        }\r\n    }\r\n\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var data = {\r\n                        file: window.URL.createObjectURL(blob),\r\n                        extension: extension\r\n                    }\r\n                    var newImage = obj.addImage(data);\r\n                    el.appendChild(newImage);\r\n\r\n                    // Keep base64 ready to go\r\n                    var content = canvas.toDataURL();\r\n                    jSuites.files[data.file] = content.substr(content.indexOf(',') + 1);\r\n\r\n                    // Onchange\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange(newImage);\r\n                    }\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    var attachmentInput = document.createElement('input');\r\n    attachmentInput.type = 'file';\r\n    attachmentInput.setAttribute('accept', 'image/*');\r\n    attachmentInput.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(attachmentInput);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            if (obj.options.singleFile == true) {\r\n                el.innerHTML = '';\r\n            }\r\n\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelectorAll('img');\r\n\r\n            if (img.length) {\r\n                for (var i = 0; i < img.length; i++) {\r\n                    obj.addFromUrl(img[i].src);\r\n                }\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.image = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n/**\n * (c) jLoading\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Page loading spin\n */\n\njSuites.loading = (function() {\n    var obj = {};\n\n    var loading = document.createElement('div');\n    loading.className = 'jloading';\n\n    obj.show = function() {\n        document.body.appendChild(loading);\n    };\n\n    obj.hide = function() {\n        document.body.removeChild(loading);\n    };\n\n    return obj;\n})();\r\n\r\n/**\n * (c) jLogin\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Login helper\n */\n\njSuites.login = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Default configuration\n    var defaults = {\n        url: window.location.href,\n        prepareRequest: null,\n        accessToken: null,\n        deviceToken: null,\n        facebookUrl: null,\n        maxHeight: null,\n        onload: null,\n        onerror: null,\n        message: null,\n        logo: null,\n        newProfile: false,\n        newProfileUrl: false,\n        newProfileLogin: false,\n        fullscreen: false,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Message console container\n    if (! obj.options.message) {\n        var messageElement = document.querySelector('.message');\n        if (messageElement) {\n            obj.options.message = messageElement;\n        }\n    }\n\n    // Action\n    var action = null;\n\n    // Container\n    var container = document.createElement('form');\n    el.appendChild(container);\n\n    // Logo\n    var divLogo = document.createElement('div');\n    divLogo.className = 'jlogin-logo'\n    container.appendChild(divLogo);\n\n    if (obj.options.logo) {\n        var logo = document.createElement('img');\n        logo.src = obj.options.logo;\n        divLogo.appendChild(logo);\n    }\n\n    // Code\n    var labelCode = document.createElement('label');\n    labelCode.innerHTML = 'Please enter here the code received';\n    var inputCode = document.createElement('input');\n    inputCode.type = 'number';\n    inputCode.id = 'code';\n    inputCode.setAttribute('maxlength', 6);\n    var divCode = document.createElement('div');\n    divCode.appendChild(labelCode);\n    divCode.appendChild(inputCode);\n\n    // Hash\n    var inputHash = document.createElement('input');\n    inputHash.type = 'hidden';\n    inputHash.name = 'h';\n    var divHash = document.createElement('div');\n    divHash.appendChild(inputHash);\n\n    // Recovery\n    var inputRecovery = document.createElement('input');\n    inputRecovery.type = 'hidden';\n    inputRecovery.name = 'recovery';\n    inputRecovery.value = '1';\n    var divRecovery = document.createElement('div');\n    divRecovery.appendChild(inputRecovery);\n\n    // Login\n    var labelLogin = document.createElement('label');\n    labelLogin.innerHTML = 'Login';\n    var inputLogin = document.createElement('input');\n    inputLogin.type = 'text';\n    inputLogin.name = 'login';\n    inputLogin.setAttribute('autocomplete', 'off');\n    inputLogin.onkeyup = function() {\n        this.value = this.value.toLowerCase().replace(/[^a-zA-Z0-9_+]+/gi, '');\n    } \n    var divLogin = document.createElement('div');\n    divLogin.appendChild(labelLogin);\n    divLogin.appendChild(inputLogin);\n\n    // Name\n    var labelName = document.createElement('label');\n    labelName.innerHTML = 'Name';\n    var inputName = document.createElement('input');\n    inputName.type = 'text';\n    inputName.name = 'name';\n    var divName = document.createElement('div');\n    divName.appendChild(labelName);\n    divName.appendChild(inputName);\n\n    // Email\n    var labelUsername = document.createElement('label');\n    labelUsername.innerHTML = 'E-mail';\n    var inputUsername = document.createElement('input');\n    inputUsername.type = 'text';\n    inputUsername.name = 'username';\n    inputUsername.setAttribute('autocomplete', 'new-username');\n    var divUsername = document.createElement('div');\n    divUsername.appendChild(labelUsername);\n    divUsername.appendChild(inputUsername);\n\n    // Password\n    var labelPassword = document.createElement('label');\n    labelPassword.innerHTML = 'Password';\n    var inputPassword = document.createElement('input');\n    inputPassword.type = 'password';\n    inputPassword.name = 'password';\n    inputPassword.setAttribute('autocomplete', 'new-password');\n    var divPassword = document.createElement('div');\n    divPassword.appendChild(labelPassword);\n    divPassword.appendChild(inputPassword);\n    divPassword.onkeydown = function(e) {\n        if (e.keyCode == 13) {\n            obj.execute();\n        }\n    }\n\n    // Repeat password\n    var labelRepeatPassword = document.createElement('label');\n    labelRepeatPassword.innerHTML = 'Password';\n    var inputRepeatPassword = document.createElement('input');\n    inputRepeatPassword.type = 'password';\n    inputRepeatPassword.name = 'password';\n    var divRepeatPassword = document.createElement('div');\n    divRepeatPassword.appendChild(labelRepeatPassword);\n    divRepeatPassword.appendChild(inputRepeatPassword);\n\n    // Remember checkbox\n    var labelRemember = document.createElement('label');\n    labelRemember.innerHTML = 'Remember me on this device';\n    var inputRemember = document.createElement('input');\n    inputRemember.type = 'checkbox';\n    inputRemember.name = 'remember';\n    inputRemember.value = '1';\n    labelRemember.appendChild(inputRemember);\n    var divRememberButton = document.createElement('div');\n    divRememberButton.className = 'rememberButton';\n    divRememberButton.appendChild(labelRemember);\n\n    // Login button\n    var actionButton = document.createElement('input');\n    actionButton.type = 'button';\n    actionButton.value = 'Log In';\n    actionButton.onclick = function() {\n        obj.execute();\n    }\n    var divActionButton = document.createElement('div');\n    divActionButton.appendChild(actionButton);\n\n    // Cancel button\n    var cancelButton = document.createElement('div');\n    cancelButton.innerHTML = 'Cancel';\n    cancelButton.className = 'cancelButton';\n    cancelButton.onclick = function() {\n        obj.requestAccess();\n    }\n    var divCancelButton = document.createElement('div');\n    divCancelButton.appendChild(cancelButton);\n\n    // Captcha\n    var labelCaptcha = document.createElement('label');\n    labelCaptcha.innerHTML = 'Please type here the code below';\n    var inputCaptcha = document.createElement('input');\n    inputCaptcha.type = 'text';\n    inputCaptcha.name = 'captcha';\n    var imageCaptcha = document.createElement('img');\n    var divCaptcha = document.createElement('div');\n    divCaptcha.className = 'jlogin-captcha';\n    divCaptcha.appendChild(labelCaptcha);\n    divCaptcha.appendChild(inputCaptcha);\n    divCaptcha.appendChild(imageCaptcha);\n\n    // Facebook\n    var facebookButton = document.createElement('div');\n    facebookButton.innerHTML = 'Login with Facebook';\n    facebookButton.className = 'facebookButton';\n    var divFacebookButton = document.createElement('div');\n    divFacebookButton.appendChild(facebookButton);\n    divFacebookButton.onclick = function() {\n        obj.requestLoginViaFacebook();\n    }\n    // Forgot password\n    var inputRequest = document.createElement('span');\n    inputRequest.innerHTML = 'Request a new password';\n    var divRequestButton = document.createElement('div');\n    divRequestButton.className = 'requestButton';\n    divRequestButton.appendChild(inputRequest);\n    divRequestButton.onclick = function() {\n        obj.requestNewPassword();\n    }\n    // Create a new Profile\n    var inputNewProfile = document.createElement('span');\n    inputNewProfile.innerHTML = 'Create a new profile';\n    var divNewProfileButton = document.createElement('div');\n    divNewProfileButton.className = 'newProfileButton';\n    divNewProfileButton.appendChild(inputNewProfile);\n    divNewProfileButton.onclick = function() {\n        obj.newProfile();\n    }\n\n    el.className = 'jlogin';\n\n    if (obj.options.fullscreen == true) {\n        el.classList.add('jlogin-fullscreen');\n    }\n\n    /** \n     * Show message\n     */\n    obj.showMessage = function(data) {\n        var message = (typeof(data) == 'object') ? data.message : data;\n\n        if (typeof(obj.options.showMessage) == 'function') {\n            obj.options.showMessage(data);\n        } else {\n            jSuites.alert(data);\n        }\n    }\n\n    /**\n     * New profile\n     */\n    obj.newProfile = function() {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        if (obj.options.newProfileLogin) {\n            container.appendChild(divLogin);\n        }\n        container.appendChild(divName);\n        container.appendChild(divUsername);\n        container.appendChild(divActionButton);\n        container.appendChild(divFacebookButton);\n        container.appendChild(divCancelButton);\n\n        // Reset inputs\n        inputLogin.value = '';\n        inputUsername.value = '';\n        inputPassword.value = '';\n\n        // Button\n        actionButton.value = 'Create new profile';\n\n        // Action\n        action = 'newProfile';\n    }\n\n    /**\n     * Request the email with the recovery instructions\n     */\n    obj.requestNewPassword = function() {\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\n            var captcha = true;\n        }\n\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divRecovery);\n        container.appendChild(divUsername);\n        if (captcha) {\n            container.appendChild(divCaptcha);\n        }\n        container.appendChild(divActionButton);\n        container.appendChild(divCancelButton);\n        actionButton.value = 'Request a new password';\n        inputRecovery.value = 1;\n\n        // Action\n        action = 'requestNewPassword';\n    }\n\n    /**\n     * Confirm recovery code\n     */\n    obj.codeConfirmation = function() {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divHash);\n        container.appendChild(divCode);\n        container.appendChild(divActionButton);\n        container.appendChild(divCancelButton);\n        actionButton.value = 'Confirm code';\n        inputRecovery.value = 2;\n\n        // Action\n        action = 'codeConfirmation';\n    }\n\n    /**\n     * Update my password\n     */\n    obj.changeMyPassword = function(hash) {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divHash);\n        container.appendChild(divPassword);\n        container.appendChild(divRepeatPassword);\n        container.appendChild(divActionButton);\n        container.appendChild(divCancelButton);\n        actionButton.value = 'Change my password';\n        inputHash.value = hash;\n\n        // Action\n        action = 'changeMyPassword';\n    }\n\n    /**\n     * Request access default method\n     */\n    obj.requestAccess = function() {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divUsername);\n        container.appendChild(divPassword);\n        container.appendChild(divActionButton);\n        container.appendChild(divFacebookButton);\n        container.appendChild(divRequestButton);\n        container.appendChild(divRememberButton);\n        container.appendChild(divRequestButton);\n        if (obj.options.newProfile == true) {\n            container.appendChild(divNewProfileButton);\n        }\n\n        // Button\n        actionButton.value = 'Login';\n\n        // Password\n        inputPassword.value = '';\n\n        // Email persistence\n        if (window.localStorage.getItem('username')) {\n            inputUsername.value = window.localStorage.getItem('username');\n            inputPassword.focus();\n        } else {\n            inputUsername.focus();\n        }\n\n        // Action\n        action = 'requestAccess';\n    }\n\n    /**\n     * Request login via facebook\n     */\n    obj.requestLoginViaFacebook = function() {\n        if (typeof(deviceNotificationToken) == 'undefined') {\n            FB.getLoginStatus(function(response) {\n                if (! response.status || response.status != 'connected') {\n                    FB.login(function(response) {\n                        if (response.authResponse) {\n                            obj.execute({ f:response.authResponse.accessToken });\n                        } else {\n                            obj.showMessage('Not authorized by facebook');\n                        }\n                    }, {scope: 'public_profile,email'});\n                } else {\n                    obj.execute({ f:response.authResponse.accessToken });\n                }\n            }, true);\n        } else {\n            jDestroy = function() {\n                fbLogin.removeEventListener('loadstart', jStart);\n                fbLogin.removeEventListener('loaderror', jError);\n                fbLogin.removeEventListener('exit', jExit);\n                fbLogin.close();\n                fbLogin = null;\n            }\n\n            jStart = function(event) {\n                var url = event.url;\n                if (url.indexOf(\"access_token\") >= 0) {\n                    setTimeout(function(){\n                        var u = url.match(/=(.*?)&/);\n                        if (u[1].length > 32) {\n                            obj.execute({ f:u[1] });\n                        }\n                        jDestroy();\n                   },500);\n                }\n\n                if (url.indexOf(\"error=access_denied\") >= 0) {\n                   setTimeout(jDestroy ,500);\n                   // Not authorized by facebook\n                   obj.showMessage('Not authorized by facebook');\n                }\n            }\n\n            jError = function(event) {\n                jDestroy();\n            }\n        \n            jExit = function(event) {\n                jDestroy();\n            }\n\n            fbLogin = window.open(this.facebookUrl, \"_blank\", \"location=no,closebuttoncaption=Exit,disallowoverscroll=yes,toolbar=no\");\n            fbLogin.addEventListener('loadstart', jStart);\n            fbLogin.addEventListener('loaderror', jError);\n            fbLogin.addEventListener('exit', jExit);\n        }\n\n        // Action\n        action = 'requestLoginViaFacebook';\n    }\n\n    // Perform request\n    obj.execute = function(data) {\n        // New profile\n        if (action == 'newProfile') {\n            var pattern = new RegExp(/^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/);\n            if (! inputUsername.value || ! pattern.test(inputUsername.value)) {\n                var message = 'Invalid e-mail address'; \n            }\n\n            var pattern = new RegExp(/^[a-zA-Z0-9\\_\\-\\.\\s+]+$/);\n            if (! inputLogin.value || ! pattern.test(inputLogin.value)) {\n                var message = 'Invalid username, please use only characters and numbers';\n            }\n\n            if (message) {\n                obj.showMessage(message);\n                return false;\n            }\n        }\n\n        // Keep email\n        if (inputUsername.value != '') {\n            window.localStorage.setItem('username', inputUsername.value);\n        }\n\n        // Captcha\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\n            if (inputCaptcha.value == '') {\n                obj.showMessage('Please enter the captch code below');\n                return false;\n            }\n        }\n\n        // Url\n        var url = obj.options.url;\n\n        // Device token\n        if (obj.options.deviceToken) {\n            url += '?token=' + obj.options.deviceToken;\n        }\n\n        // Callback\n        var onsuccess = function(result) {\n            if (result) {\n                // Successfully response\n                if (result.success == 1) {\n                    // Recovery process\n                    if (action == 'requestNewPassword') {\n                        obj.codeConfirmation();\n                    } else if (action == 'codeConfirmation') {\n                        obj.requestAccess();\n                    } else if (action == 'newProfile') {\n                        obj.requestAccess();\n                        // New profile\n                        result.newProfile = true;\n                    }\n\n                    // Token\n                    if (result.token) {\n                        // Set token\n                        obj.options.accessToken = result.token;\n                        // Save token\n                        window.localStorage.setItem('Access-Token', result.token);\n                    }\n                }\n\n                // Show message\n                if (result.message) {\n                    // Show message\n                    obj.showMessage(result.message)\n                }\n\n                // Request captcha code\n                if (! result.data) {\n                    if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\n                        divCaptcha.remove();\n                    }\n                } else {\n                    container.insertBefore(divCaptcha, divActionButton);\n                    imageCaptcha.setAttribute('src', 'data:image/png;base64,' + result.data);\n                }\n\n                // Give time to user see the message\n                if (result.hash) {\n                    // Change password\n                    obj.changeMyPassword(result.hash);\n                } else if (result.url) {\n                    // App initialization\n                    if (result.success == 1) {\n                        if (typeof(obj.options.onload) == 'function') {\n                            obj.options.onload(result);\n                        } else {\n                            if (result.message) {\n                                setTimeout(function() { window.location.href = result.url; }, 2000);\n                            } else {\n                                window.location.href = result.url;\n                            }\n                        }\n                    } else {\n                        if (typeof(obj.options.onerror) == 'function') {\n                            obj.options.onerror(result);\n                        }\n                    }\n                }\n            }\n        }\n\n        // Password\n        if (! data) {\n            var data = jSuites.getFormElements(el);\n            // Encode passworfd\n            if (data.password) {\n                data.password = jSuites.login.sha512(data.password);\n            }\n            // Recovery code\n            if (Array.prototype.indexOf.call(container.children, divCode) >= 0 && inputCode.value) {\n                data.h = jSuites.login.sha512(inputCode.value);\n            }\n        }\n\n        // Loading\n        el.classList.add('jlogin-loading');\n\n        // Url\n        var url = (action == 'newProfile' && obj.options.newProfileUrl) ? obj.options.newProfileUrl : obj.options.url;\n\n        // Remote call\n        jSuites.ajax({\n            url: url,\n            method: 'POST',\n            dataType: 'json',\n            data: data,\n            success: function(result) {\n                // Remove loading\n                el.classList.remove('jlogin-loading');\n                // Callback\n                onsuccess(result);\n            },\n            error: function(result) {\n                // Error\n                el.classList.remove('jlogin-loading');\n\n                if (typeof(obj.options.onerror) == 'function') {\n                    obj.options.onerror(result);\n                }\n            }\n        });\n    }\n\n    obj.requestAccess();\n\n    return obj;\n});\n\njSuites.login.sha512 = (function(str) {\n    function int64(msint_32, lsint_32) {\n        this.highOrder = msint_32;\n        this.lowOrder = lsint_32;\n    }\n\n    var H = [new int64(0x6a09e667, 0xf3bcc908), new int64(0xbb67ae85, 0x84caa73b),\n        new int64(0x3c6ef372, 0xfe94f82b), new int64(0xa54ff53a, 0x5f1d36f1),\n        new int64(0x510e527f, 0xade682d1), new int64(0x9b05688c, 0x2b3e6c1f),\n        new int64(0x1f83d9ab, 0xfb41bd6b), new int64(0x5be0cd19, 0x137e2179)];\n\n    var K = [new int64(0x428a2f98, 0xd728ae22), new int64(0x71374491, 0x23ef65cd),\n        new int64(0xb5c0fbcf, 0xec4d3b2f), new int64(0xe9b5dba5, 0x8189dbbc),\n        new int64(0x3956c25b, 0xf348b538), new int64(0x59f111f1, 0xb605d019),\n        new int64(0x923f82a4, 0xaf194f9b), new int64(0xab1c5ed5, 0xda6d8118),\n        new int64(0xd807aa98, 0xa3030242), new int64(0x12835b01, 0x45706fbe),\n        new int64(0x243185be, 0x4ee4b28c), new int64(0x550c7dc3, 0xd5ffb4e2),\n        new int64(0x72be5d74, 0xf27b896f), new int64(0x80deb1fe, 0x3b1696b1),\n        new int64(0x9bdc06a7, 0x25c71235), new int64(0xc19bf174, 0xcf692694),\n        new int64(0xe49b69c1, 0x9ef14ad2), new int64(0xefbe4786, 0x384f25e3),\n        new int64(0x0fc19dc6, 0x8b8cd5b5), new int64(0x240ca1cc, 0x77ac9c65),\n        new int64(0x2de92c6f, 0x592b0275), new int64(0x4a7484aa, 0x6ea6e483),\n        new int64(0x5cb0a9dc, 0xbd41fbd4), new int64(0x76f988da, 0x831153b5),\n        new int64(0x983e5152, 0xee66dfab), new int64(0xa831c66d, 0x2db43210),\n        new int64(0xb00327c8, 0x98fb213f), new int64(0xbf597fc7, 0xbeef0ee4),\n        new int64(0xc6e00bf3, 0x3da88fc2), new int64(0xd5a79147, 0x930aa725),\n        new int64(0x06ca6351, 0xe003826f), new int64(0x14292967, 0x0a0e6e70),\n        new int64(0x27b70a85, 0x46d22ffc), new int64(0x2e1b2138, 0x5c26c926),\n        new int64(0x4d2c6dfc, 0x5ac42aed), new int64(0x53380d13, 0x9d95b3df),\n        new int64(0x650a7354, 0x8baf63de), new int64(0x766a0abb, 0x3c77b2a8),\n        new int64(0x81c2c92e, 0x47edaee6), new int64(0x92722c85, 0x1482353b),\n        new int64(0xa2bfe8a1, 0x4cf10364), new int64(0xa81a664b, 0xbc423001),\n        new int64(0xc24b8b70, 0xd0f89791), new int64(0xc76c51a3, 0x0654be30),\n        new int64(0xd192e819, 0xd6ef5218), new int64(0xd6990624, 0x5565a910),\n        new int64(0xf40e3585, 0x5771202a), new int64(0x106aa070, 0x32bbd1b8),\n        new int64(0x19a4c116, 0xb8d2d0c8), new int64(0x1e376c08, 0x5141ab53),\n        new int64(0x2748774c, 0xdf8eeb99), new int64(0x34b0bcb5, 0xe19b48a8),\n        new int64(0x391c0cb3, 0xc5c95a63), new int64(0x4ed8aa4a, 0xe3418acb),\n        new int64(0x5b9cca4f, 0x7763e373), new int64(0x682e6ff3, 0xd6b2b8a3),\n        new int64(0x748f82ee, 0x5defb2fc), new int64(0x78a5636f, 0x43172f60),\n        new int64(0x84c87814, 0xa1f0ab72), new int64(0x8cc70208, 0x1a6439ec),\n        new int64(0x90befffa, 0x23631e28), new int64(0xa4506ceb, 0xde82bde9),\n        new int64(0xbef9a3f7, 0xb2c67915), new int64(0xc67178f2, 0xe372532b),\n        new int64(0xca273ece, 0xea26619c), new int64(0xd186b8c7, 0x21c0c207),\n        new int64(0xeada7dd6, 0xcde0eb1e), new int64(0xf57d4f7f, 0xee6ed178),\n        new int64(0x06f067aa, 0x72176fba), new int64(0x0a637dc5, 0xa2c898a6),\n        new int64(0x113f9804, 0xbef90dae), new int64(0x1b710b35, 0x131c471b),\n        new int64(0x28db77f5, 0x23047d84), new int64(0x32caab7b, 0x40c72493),\n        new int64(0x3c9ebe0a, 0x15c9bebc), new int64(0x431d67c4, 0x9c100d4c),\n        new int64(0x4cc5d4be, 0xcb3e42b6), new int64(0x597f299c, 0xfc657e2a),\n        new int64(0x5fcb6fab, 0x3ad6faec), new int64(0x6c44198c, 0x4a475817)];\n\n    var W = new Array(64);\n    var a, b, c, d, e, f, g, h, i, j;\n    var T1, T2;\n    var charsize = 8;\n\n    function utf8_encode(str) {\n        return unescape(encodeURIComponent(str));\n    }\n\n    function str2binb(str) {\n        var bin = [];\n        var mask = (1 << charsize) - 1;\n        var len = str.length * charsize;\n    \n        for (var i = 0; i < len; i += charsize) {\n            bin[i >> 5] |= (str.charCodeAt(i / charsize) & mask) << (32 - charsize - (i % 32));\n        }\n    \n        return bin;\n    }\n\n    function binb2hex(binarray) {\n        var hex_tab = \"0123456789abcdef\";\n        var str = \"\";\n        var length = binarray.length * 4;\n        var srcByte;\n\n        for (var i = 0; i < length; i += 1) {\n            srcByte = binarray[i >> 2] >> ((3 - (i % 4)) * 8);\n            str += hex_tab.charAt((srcByte >> 4) & 0xF) + hex_tab.charAt(srcByte & 0xF);\n        }\n\n        return str;\n    }\n\n    function safe_add_2(x, y) {\n        var lsw, msw, lowOrder, highOrder;\n\n        lsw = (x.lowOrder & 0xFFFF) + (y.lowOrder & 0xFFFF);\n        msw = (x.lowOrder >>> 16) + (y.lowOrder >>> 16) + (lsw >>> 16);\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        lsw = (x.highOrder & 0xFFFF) + (y.highOrder & 0xFFFF) + (msw >>> 16);\n        msw = (x.highOrder >>> 16) + (y.highOrder >>> 16) + (lsw >>> 16);\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        return new int64(highOrder, lowOrder);\n    }\n\n    function safe_add_4(a, b, c, d) {\n        var lsw, msw, lowOrder, highOrder;\n\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF);\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (lsw >>> 16);\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (msw >>> 16);\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (lsw >>> 16);\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        return new int64(highOrder, lowOrder);\n    }\n\n    function safe_add_5(a, b, c, d, e) {\n        var lsw, msw, lowOrder, highOrder;\n\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF) + (e.lowOrder & 0xFFFF);\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (e.lowOrder >>> 16) + (lsw >>> 16);\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (e.highOrder & 0xFFFF) + (msw >>> 16);\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (e.highOrder >>> 16) + (lsw >>> 16);\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        return new int64(highOrder, lowOrder);\n    }\n\n    function maj(x, y, z) {\n        return new int64(\n            (x.highOrder & y.highOrder) ^ (x.highOrder & z.highOrder) ^ (y.highOrder & z.highOrder),\n            (x.lowOrder & y.lowOrder) ^ (x.lowOrder & z.lowOrder) ^ (y.lowOrder & z.lowOrder)\n        );\n    }\n\n    function ch(x, y, z) {\n        return new int64(\n            (x.highOrder & y.highOrder) ^ (~x.highOrder & z.highOrder),\n            (x.lowOrder & y.lowOrder) ^ (~x.lowOrder & z.lowOrder)\n        );\n    }\n\n    function rotr(x, n) {\n        if (n <= 32) {\n            return new int64(\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n)),\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n))\n            );\n        } else {\n            return new int64(\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n)),\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n))\n            );\n        }\n    }\n\n    function sigma0(x) {\n        var rotr28 = rotr(x, 28);\n        var rotr34 = rotr(x, 34);\n        var rotr39 = rotr(x, 39);\n\n        return new int64(\n            rotr28.highOrder ^ rotr34.highOrder ^ rotr39.highOrder,\n            rotr28.lowOrder ^ rotr34.lowOrder ^ rotr39.lowOrder\n        );\n    }\n\n    function sigma1(x) {\n        var rotr14 = rotr(x, 14);\n        var rotr18 = rotr(x, 18);\n        var rotr41 = rotr(x, 41);\n\n        return new int64(\n            rotr14.highOrder ^ rotr18.highOrder ^ rotr41.highOrder,\n            rotr14.lowOrder ^ rotr18.lowOrder ^ rotr41.lowOrder\n        );\n    }\n\n    function gamma0(x) {\n        var rotr1 = rotr(x, 1), rotr8 = rotr(x, 8), shr7 = shr(x, 7);\n\n        return new int64(\n            rotr1.highOrder ^ rotr8.highOrder ^ shr7.highOrder,\n            rotr1.lowOrder ^ rotr8.lowOrder ^ shr7.lowOrder\n        );\n    }\n\n    function gamma1(x) {\n        var rotr19 = rotr(x, 19);\n        var rotr61 = rotr(x, 61);\n        var shr6 = shr(x, 6);\n\n        return new int64(\n            rotr19.highOrder ^ rotr61.highOrder ^ shr6.highOrder,\n            rotr19.lowOrder ^ rotr61.lowOrder ^ shr6.lowOrder\n        );\n    }\n\n    function shr(x, n) {\n        if (n <= 32) {\n            return new int64(\n                x.highOrder >>> n,\n                x.lowOrder >>> n | (x.highOrder << (32 - n))\n            );\n        } else {\n            return new int64(\n                0,\n                x.highOrder << (32 - n)\n            );\n        }\n    }\n\n    var str = utf8_encode(str);\n    var strlen = str.length*charsize;\n    str = str2binb(str);\n\n    str[strlen >> 5] |= 0x80 << (24 - strlen % 32);\n    str[(((strlen + 128) >> 10) << 5) + 31] = strlen;\n\n    for (var i = 0; i < str.length; i += 32) {\n        a = H[0];\n        b = H[1];\n        c = H[2];\n        d = H[3];\n        e = H[4];\n        f = H[5];\n        g = H[6];\n        h = H[7];\n\n        for (var j = 0; j < 80; j++) {\n            if (j < 16) {\n                W[j] = new int64(str[j*2 + i], str[j*2 + i + 1]);\n            } else {\n                W[j] = safe_add_4(gamma1(W[j - 2]), W[j - 7], gamma0(W[j - 15]), W[j - 16]);\n            }\n\n            T1 = safe_add_5(h, sigma1(e), ch(e, f, g), K[j], W[j]);\n            T2 = safe_add_2(sigma0(a), maj(a, b, c));\n            h = g;\n            g = f;\n            f = e;\n            e = safe_add_2(d, T1);\n            d = c;\n            c = b;\n            b = a;\n            a = safe_add_2(T1, T2);\n        }\n\n        H[0] = safe_add_2(a, H[0]);\n        H[1] = safe_add_2(b, H[1]);\n        H[2] = safe_add_2(c, H[2]);\n        H[3] = safe_add_2(d, H[3]);\n        H[4] = safe_add_2(e, H[4]);\n        H[5] = safe_add_2(f, H[5]);\n        H[6] = safe_add_2(g, H[6]);\n        H[7] = safe_add_2(h, H[7]);\n    }\n\n    var binarray = [];\n    for (var i = 0; i < H.length; i++) {\n        binarray.push(H[i].highOrder);\n        binarray.push(H[i].lowOrder);\n    }\n\n    return binb2hex(binarray);\n});\r\n\r\n/**\r\n * (c) jTools Input Mask\r\n * https://github.com/paulhodel/jtools\r\n *\r\n * @author: Paul Hodel <paul.hodel@gmail.com>\r\n * @description: Input mask\r\n */\r\n\r\njSuites.mask = (function() {\r\n    var obj = {};\r\n    var index = 0;\r\n    var values = []\r\n    var pieces = [];\r\n\r\n    obj.run = function(value, mask, decimal) {\r\n        if (value && mask) {\r\n            if (! decimal) {\r\n                decimal = '.';\r\n            }\r\n            if (value == Number(value)) {\r\n                var number = (''+value).split('.');\r\n                var value = number[0];\r\n                var valueDecimal = number[1];\r\n            } else {\r\n                value = '' + value;\r\n            }\r\n            index = 0;\r\n            values = [];\r\n            // Create mask token\r\n            obj.prepare(mask);\r\n            // Current value\r\n            var currentValue = value;\r\n            if (currentValue) {\r\n                // Checking current value\r\n                for (var i = 0; i < currentValue.length; i++) {\r\n                    if (currentValue[i] != null) {\r\n                        obj.process(currentValue[i]);\r\n                    }\r\n                }\r\n            }\r\n            if (valueDecimal) {\r\n                obj.process(decimal);\r\n                var currentValue = valueDecimal;\r\n                if (currentValue) {\r\n                    // Checking current value\r\n                    for (var i = 0; i < currentValue.length; i++) {\r\n                        if (currentValue[i] != null) {\r\n                            obj.process(currentValue[i]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Formatted value\r\n            return values.join('');\r\n        } else {\r\n            return '';\r\n        }\r\n    }\r\n\r\n    obj.apply = function(e) {\r\n        var mask = e.target.getAttribute('data-mask');\r\n        if (mask && e.keyCode > 46) {\r\n            index = 0;\r\n            values = [];\r\n            // Create mask token\r\n            obj.prepare(mask);\r\n            // Current value\r\n            if (e.target.selectionStart < e.target.selectionEnd) {\r\n                var currentValue = e.target.value.substring(0, e.target.selectionStart); \r\n            } else {\r\n                var currentValue = e.target.value;\r\n            }\r\n            if (currentValue) {\r\n                // Checking current value\r\n                for (var i = 0; i < currentValue.length; i++) {\r\n                    if (currentValue[i] != null) {\r\n                        obj.process(currentValue[i]);\r\n                    }\r\n                }\r\n            }\r\n            // New input\r\n            obj.process(obj.fromKeyCode(e));\r\n            // Update value to the element\r\n            e.target.value = values.join('');\r\n            if (pieces.length == values.length && pieces[pieces.length-1].length == values[values.length-1].length) {\r\n                e.target.setAttribute('data-completed', 'true');\r\n            } else {\r\n                e.target.setAttribute('data-completed', 'false');\r\n            }\r\n            // Prevent default\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Process inputs and save to values\r\n     */\r\n    obj.process = function(input) {\r\n        do {\r\n            if (pieces[index] == 'mm') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 1 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 1 && values[index] < 2 && parseInt(input) < 3) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] == 0 && values[index] < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'dd') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 3 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 3 && parseInt(input) < 2) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] < 3 && parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'hh24') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 2 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 2 && parseInt(input) < 4) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] < 2 && parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'hh') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 1 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 1 && parseInt(input) < 3) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] < 1 && parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'mi' || pieces[index] == 'ss') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 5 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                     } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'yy' || pieces[index] == 'yyyy') {\r\n                if (parseInt(input) < 10) {\r\n                    if (values[index] == null || values[index] == '') {\r\n                        values[index] = input;\r\n                    } else {\r\n                        values[index] += input;\r\n                    }\r\n                    \r\n                    if (values[index].length == pieces[index].length) {\r\n                        index++;\r\n                    }\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else if (pieces[index] == '#' || pieces[index] == '#.##' || pieces[index] == '#,##' || pieces[index] == '# ##') {\r\n                if (input.match(/[0-9]/g)) {\r\n                    if (pieces[index] == '#.##') {\r\n                        var separator = '.';\r\n                    } else if (pieces[index] == '#,##') {\r\n                        var separator = ',';\r\n                    } else if (pieces[index] == '# ##') {\r\n                        var separator = ' ';\r\n                    } else {\r\n                        var separator = '';\r\n                    }\r\n                    if (values[index] == null || values[index] == '') {\r\n                        values[index] = input;\r\n                    } else {\r\n                        values[index] += input;\r\n                        if (separator) {\r\n                            values[index] = values[index].match(/[0-9]/g).join('');\r\n                            var t = [];\r\n                            var s = 0;\r\n                            for (var j = values[index].length - 1; j >= 0 ; j--) {\r\n                                t.push(values[index][j]);\r\n                                s++;\r\n                                if (! (s % 3)) {\r\n                                    t.push(separator);\r\n                                }\r\n                            }\r\n                            t = t.reverse();\r\n                            values[index] = t.join('');\r\n                            if (values[index].substr(0,1) == separator) {\r\n                                values[index] = values[index].substr(1);\r\n                            } \r\n                        }\r\n                    }\r\n                    return true;\r\n                } else {\r\n                    if (pieces[index] == '#.##' && input == '.') {\r\n                        // Do nothing\r\n                    } else if (pieces[index] == '#,##' && input == ',') {\r\n                        // Do nothing\r\n                    } else if (pieces[index] == '# ##' && input == ' ') {\r\n                        // Do nothing\r\n                    } else {\r\n                        if (values[index]) {\r\n                            index++;\r\n                            if (pieces[index]) {\r\n                                if (pieces[index] == input) {\r\n                                    values[index] = input;\r\n                                    return true;\r\n                                } else {\r\n                                    if (pieces[index] == '0' && pieces[index+1] == input) {\r\n                                        index++;\r\n                                        values[index] = input;\r\n                                        return true;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return false;\r\n                }\r\n            } else if (pieces[index] == '0') {\r\n                if (input.match(/[0-9]/g)) {\r\n                    values[index] = input;\r\n                    index++;\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else if (pieces[index] == 'a') {\r\n                if (input.match(/[a-zA-Z]/g)) {\r\n                    values[index] = input;\r\n                    index++;\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (pieces[index] != null) {\r\n                    if (pieces[index] == '\\\\a') {\r\n                        var v = 'a';\r\n                    } else if (pieces[index] == '\\\\0') {\r\n                        var v = '0';\r\n                    } else if (pieces[index] == '[-]') {\r\n                        if (input == '-' || input == '+') {\r\n                            var v = input;\r\n                        } else {\r\n                            var v = ' ';\r\n                        }\r\n                    } else {\r\n                        var v = pieces[index];\r\n                    }\r\n                    values[index] = v;\r\n                    if (input == v) {\r\n                        index++;\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            index++;\r\n        } while (pieces[index]);\r\n    }\r\n\r\n    /**\r\n     * Create tokens for the mask\r\n     */\r\n    obj.prepare = function(mask) {\r\n        pieces = [];\r\n        for (var i = 0; i < mask.length; i++) {\r\n            if (mask[i].match(/[0-9]|[a-z]|\\\\/g)) {\r\n                if (mask[i] == 'y' && mask[i+1] == 'y' && mask[i+2] == 'y' && mask[i+3] == 'y') {\r\n                    pieces.push('yyyy');\r\n                    i += 3;\r\n                } else if (mask[i] == 'y' && mask[i+1] == 'y') {\r\n                    pieces.push('yy');\r\n                    i++;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'm' && mask[i+2] == 'm' && mask[i+3] == 'm') {\r\n                    pieces.push('mmmm');\r\n                    i += 3;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'm' && mask[i+2] == 'm') {\r\n                    pieces.push('mmm');\r\n                    i += 2;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'm') {\r\n                    pieces.push('mm');\r\n                    i++;\r\n                } else if (mask[i] == 'd' && mask[i+1] == 'd') {\r\n                    pieces.push('dd');\r\n                    i++;\r\n                } else if (mask[i] == 'h' && mask[i+1] == 'h' && mask[i+2] == '2' && mask[i+3] == '4') {\r\n                    pieces.push('hh24');\r\n                    i += 3;\r\n                } else if (mask[i] == 'h' && mask[i+1] == 'h') {\r\n                    pieces.push('hh');\r\n                    i++;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'i') {\r\n                    pieces.push('mi');\r\n                    i++;\r\n                } else if (mask[i] == 's' && mask[i+1] == 's') {\r\n                    pieces.push('ss');\r\n                    i++;\r\n                } else if (mask[i] == 'a' && mask[i+1] == 'm') {\r\n                    pieces.push('am');\r\n                    i++;\r\n                } else if (mask[i] == 'p' && mask[i+1] == 'm') {\r\n                    pieces.push('pm');\r\n                    i++;\r\n                } else if (mask[i] == '\\\\' && mask[i+1] == '0') {\r\n                    pieces.push('\\\\0');\r\n                    i++;\r\n                } else if (mask[i] == '\\\\' && mask[i+1] == 'a') {\r\n                    pieces.push('\\\\a');\r\n                    i++;\r\n                } else {\r\n                    pieces.push(mask[i]);\r\n                }\r\n            } else {\r\n                if (mask[i] == '#' && mask[i+1] == '.' && mask[i+2] == '#' && mask[i+3] == '#') {\r\n                    pieces.push('#.##');\r\n                    i += 3;\r\n                } else if (mask[i] == '#' && mask[i+1] == ',' && mask[i+2] == '#' && mask[i+3] == '#') {\r\n                    pieces.push('#,##');\r\n                    i += 3;\r\n                } else if (mask[i] == '#' && mask[i+1] == ' ' && mask[i+2] == '#' && mask[i+3] == '#') {\r\n                    pieces.push('# ##');\r\n                    i += 3;\r\n                } else if (mask[i] == '[' && mask[i+1] == '-' && mask[i+2] == ']') {\r\n                    pieces.push('[-]');\r\n                    i += 2;\r\n                } else {\r\n                    pieces.push(mask[i]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /** \r\n     * Thanks for the collaboration\r\n     */\r\n    obj.fromKeyCode = function(e) {\r\n        var _to_ascii = {\r\n            '188': '44',\r\n            '109': '45',\r\n            '190': '46',\r\n            '191': '47',\r\n            '192': '96',\r\n            '220': '92',\r\n            '222': '39',\r\n            '221': '93',\r\n            '219': '91',\r\n            '173': '45',\r\n            '187': '61', //IE Key codes\r\n            '186': '59', //IE Key codes\r\n            '189': '45'  //IE Key codes\r\n        }\r\n\r\n        var shiftUps = {\r\n            \"96\": \"~\",\r\n            \"49\": \"!\",\r\n            \"50\": \"@\",\r\n            \"51\": \"#\",\r\n            \"52\": \"$\",\r\n            \"53\": \"%\",\r\n            \"54\": \"^\",\r\n            \"55\": \"&\",\r\n            \"56\": \"*\",\r\n            \"57\": \"(\",\r\n            \"48\": \")\",\r\n            \"45\": \"_\",\r\n            \"61\": \"+\",\r\n            \"91\": \"{\",\r\n            \"93\": \"}\",\r\n            \"92\": \"|\",\r\n            \"59\": \":\",\r\n            \"39\": \"\\\"\",\r\n            \"44\": \"<\",\r\n            \"46\": \">\",\r\n            \"47\": \"?\"\r\n        };\r\n\r\n        var c = e.which;\r\n\r\n        if (_to_ascii.hasOwnProperty(c)) {\r\n            c = _to_ascii[c];\r\n        }\r\n\r\n        if (!e.shiftKey && (c >= 65 && c <= 90)) {\r\n            c = String.fromCharCode(c + 32);\r\n        } else if (e.shiftKey && shiftUps.hasOwnProperty(c)) {\r\n            c = shiftUps[c];\r\n        } else if (96 <= c && c <= 105) {\r\n            c = String.fromCharCode(c - 48);\r\n        } else {\r\n            c = String.fromCharCode(c);\r\n        }\r\n\r\n        return c;\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.mobile = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    if (jSuites.el) {\r\n        jSuites.el.addEventListener('mousedown', function(e) {\r\n            if (e.target.classList.contains('option-title')) {\r\n                if (e.target.classList.contains('selected')) {\r\n                    e.target.classList.remove('selected');\r\n                } else {\r\n                    e.target.classList.add('selected');\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.pages = (function() {\r\n    var container = null;\r\n    var current = null;\r\n\r\n    // Create a page\r\n    var createPage = function(options, callback) {\r\n        // Create page\r\n        var page = document.createElement('div');\r\n        page.classList.add('page');\r\n\r\n        // Always hidden\r\n        page.style.display = 'none';\r\n\r\n        // Keep options\r\n        page.options = options ? options : {};\r\n\r\n        if (! current) {\r\n            container.appendChild(page);\r\n        } else {\r\n            container.insertBefore(page, current.nextSibling);\r\n        }\r\n\r\n        jSuites.ajax({\r\n            url: page.options.url,\r\n            method: 'GET',\r\n            success: function(result) {\r\n                // Push to refresh controls\r\n                jSuites.refresh(page, page.options.onpush);\r\n\n                // Open page\r\n                page.innerHTML = result;\r\n                // Get javascript\r\n                var script = page.getElementsByTagName('script');\r\n                // Run possible inline scripts\r\n                for (var i = 0; i < script.length; i++) {\r\n                    // Get type\r\n                    var type = script[i].getAttribute('type');\r\n                    if (! type || type == 'text/javascript') {\r\n                        eval(script[i].innerHTML);\r\n                    }\r\n                }\r\n                // Set title\r\n                page.setTitle = function(text) {\r\n                    this.children[0].children[0].children[1].innerHTML = text;\r\n                }\r\n                // Show page\r\n                if (! page.options.closed) {\r\n                    showPage(page);\r\n                }\r\n                // Onload callback\r\n                if (typeof(page.options.onload) == 'function') {\r\n                    page.options.onload(page);\r\n                }\r\n                // Force callback\r\n                if (typeof(callback) == 'function') {\r\n                    callback(page);\r\n                }\r\n            }\r\n        });\r\n\r\n        return page;\r\n    }\r\n\r\n    var showPage = function(page, ignoreHistory, callback) {\r\n        if (current) {\r\n            if (current == page) {\r\n                current = page;\r\n            } else {\r\n                // Keep scroll in the top\r\n                window.scrollTo({ top: 0 });\r\n\r\n                // Show page\r\n                page.style.display = '';\r\n\r\n                var a = Array.prototype.indexOf.call(container.children, current);\r\n                var b = Array.prototype.indexOf.call(container.children, page);\r\n\r\n                // Leave\r\n                if (typeof(current.options.onleave) == 'function') {\r\n                    current.options.onleave(current, page, ignoreHistory);\r\n                }\r\n\r\n                jSuites.slideLeft(container, (a < b ? 0 : 1), function() {\r\n                    current.style.display = 'none';\r\n                    current = page;\r\n                });\r\n\r\n                // Enter\r\n                if (typeof(page.options.onenter) == 'function') {\r\n                    page.options.onenter(page, current, ignoreHistory);\r\n                }\r\n            }\r\n        } else {\r\n            // Show\r\n            page.style.display = '';\r\n\r\n            // Keep current\r\n            current = page;\r\n\r\n            // Enter\r\n            if (typeof(page.options.onenter) == 'function') {\r\n                page.options.onenter(page);\r\n            }\r\n        }\r\n\r\n        // Add history\r\n        if (! ignoreHistory) {\r\n            // Add history\r\n            window.history.pushState({ route: page.options.route }, page.options.title, page.options.route);\r\n        }\r\n\r\n        // Callback\r\n        if (typeof(callback) == 'function') {\r\n            callback(page);\r\n        }\r\n    }\r\n\r\n    // Init method\r\n    var obj = function(route, mixed) {\r\n\r\n        // Create page container\r\n        if (! container) {\r\n            container = document.querySelector('.pages');\r\n            if (! container) {\r\n                container = document.createElement('div');\r\n                container.className = 'pages';\r\n            }\r\n\r\n            // Append container to the application\r\n            if (jSuites.el) {\r\n                jSuites.el.appendChild(container);\r\n            } else {\r\n                document.body.appendChild(container);\r\n            }\r\n        }\r\n\r\n        if (! obj.pages[route]) {\r\n            if (! route) {\r\n                alert('Error, no route provided');\r\n            } else {\r\n                if (typeof(mixed) == 'function') {\r\n                    var options = {};\r\n                    var callback = mixed;\r\n                } else {\r\n                    // Page options\r\n                    var options = mixed ? mixed : {};\r\n                }\r\n\r\n                // Closed\r\n                options.closed = mixed && mixed.closed ? 1 : 0;\r\n                // Keep Route\r\n                options.route = route;\r\n\r\n                // New page url\r\n                if (! options.url) {\r\n                    var routePath = route.split('#');\r\n                    options.url = jSuites.pages.path + routePath[0] + '.html';\r\n                }\r\n                // Title\r\n                if (! options.title) {\r\n                    options.title = 'Untitled';\r\n                }\r\n\r\n                // Create new page\r\n                obj.pages[route] = createPage(options, callback ? callback : null);\r\n            }\r\n        } else {\r\n            // Update config\r\n            if (mixed) {\r\n                // History\r\n                var ignoreHistory = 0;\r\n\r\n                if (typeof(mixed) == 'function') {\r\n                    var callback = mixed;\r\n                } else {\r\n                    if (typeof(mixed.onenter) == 'function') {\r\n                        obj.pages[route].options.onenter = mixed.onenter;\r\n                    }\r\n                    if (typeof(mixed.onleave) == 'function') {\r\n                        obj.pages[route].options.onleave = mixed.onleave;\r\n                    }\r\n\r\n                    // Ignore history\r\n                    ignoreHistory = mixed.ignoreHistory ? 1 : 0; \r\n                }\r\n            }\r\n\r\n            showPage(obj.pages[route], ignoreHistory, callback ? callback : null);\r\n        }\r\n    }\r\n\r\n    obj.pages = {};\r\n\r\n    // Get page\r\n    obj.get = function(route) {\r\n        if (obj.pages[route]) {\r\n            return obj.pages[route]; \r\n        }\r\n    }\r\n\r\n    obj.getContainer = function() {\r\n        return container;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        // Current is null\r\n        current = null;\r\n        // Destroy containers\r\n        obj.pages = {};\r\n        // Reset container\r\n        if (container) {\r\n            container.innerHTML = '';\r\n        }\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\n// Path\r\njSuites.pages.path = 'pages';\r\n\r\n// Panel\r\njSuites.panel = (function() {\r\n    // No initial panel declared\r\n    var panel = null;\r\n\r\n    var obj = function(route) {\r\n        if (! panel) {\r\n            obj.create(jSuites.pages.path + route + '.html');\r\n        }\r\n\r\n        // Show panel\r\n        panel.style.display = '';\r\n\r\n        // Add animation\r\n        if (panel.classList.contains('panel-left')) {\r\n            jSuites.slideLeft(panel, 1);\r\n        } else {\r\n            jSuites.slideRight(panel, 1);\r\n        }\r\n    }\r\n\r\n    obj.create = function(route) {\r\n        if (! panel) {\r\n            // Create element\r\n            panel = document.createElement('div');\r\n            panel.classList.add('panel');\r\n            panel.classList.add('panel-left');\r\n            panel.style.display = 'none';\r\n\r\n            // Bind to the app\r\n            if (jSuites.el) {\r\n                jSuites.el.appendChild(panel);\r\n            } else {\r\n                document.body.appendChild(panel);\r\n            }\r\n        }\r\n\r\n        // Remote content\r\n        if (route) {\r\n\t        var url = jSuites.pages.path + route + '.html';\r\n\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                success: function(result) {\r\n                    // Set content\r\n                    panel.innerHTML = result;\r\n                    // Get javascript\r\n                    var script = panel.getElementsByTagName('script');\r\n                    // Run possible inline scripts\r\n                    for (var i = 0; i < script.length; i++) {\r\n                        // Get type\r\n                        var type = script[i].getAttribute('type');\r\n                        if (! type || type == 'text/javascript') {\r\n                            eval(script[i].innerHTML);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (panel) {\r\n            // Animation\r\n            if (panel.classList.contains('panel-left')) {\r\n                jSuites.slideLeft(panel, 0, function() {\r\n                    panel.style.display = 'none';\r\n                });\r\n            } else {\r\n                jSuites.slideRight(panel, 0, function() {\r\n                    panel.style.display = 'none';\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.get = function() {\r\n        return panel;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        panel.remove();\r\n        panel = null;\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.toolbar = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = options;\r\n\r\n    obj.selectItem = function(element) {\r\n        var elements = toolbarContent.children;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            elements[i].classList.remove('selected');\r\n        }\r\n        element.classList.add('selected');\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.slideBottom(toolbar, 0, function() {\r\n            toolbar.style.display = 'none';\r\n        });\r\n    }\r\n\r\n    obj.show = function() {\r\n        toolbar.style.display = '';\r\n        jSuites.slideBottom(toolbar, 1);\r\n    }\r\n\r\n    obj.get = function() {\r\n        return toolbar;\r\n    }\r\n\r\n    obj.setBadge = function(index, value) {\r\n        toolbarContent.children[index].children[1].firstChild.innerHTML = value;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        toolbar.remove();\r\n        toolbar = null;\r\n    }\r\n\r\n    var toolbar = document.createElement('div');\r\n    toolbar.classList.add('jtoolbar');\r\n    toolbar.onclick = function(e) {\r\n        var element = jSuites.getElement(e.target, 'jtoolbar-item');\r\n        if (element) {\r\n            obj.selectItem(element);\r\n        }\r\n    }\r\n\r\n    var toolbarContent = document.createElement('div');\r\n    toolbar.appendChild(toolbarContent);\r\n\r\n    for (var i = 0; i < options.items.length; i++) {\r\n        let toolbarItem = document.createElement('div');\r\n        toolbarItem.classList.add('jtoolbar-item');\r\n        if (options.items[i].route) {\r\n            toolbarItem.setAttribute('data-href', options.items[i].route);\r\n            jSuites.pages(options.items[i].route, {\r\n                closed: true,\r\n                onenter: function() {\r\n                    obj.selectItem(toolbarItem);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (options.items[i].icon) {\r\n            var toolbarIcon = document.createElement('i');\r\n            toolbarIcon.classList.add('material-icons');\r\n            toolbarIcon.innerHTML = options.items[i].icon;\r\n            toolbarItem.appendChild(toolbarIcon);\r\n        }\r\n\r\n        var toolbarBadge = document.createElement('div');\r\n        toolbarBadge.classList.add('jbadge');\r\n        var toolbarBadgeContent = document.createElement('div');\r\n        toolbarBadgeContent.innerHTML = options.items[i].badge ? options.items[i].badge : '';\r\n        toolbarBadge.appendChild(toolbarBadgeContent);\r\n        toolbarItem.appendChild(toolbarBadge);\r\n\r\n        if (options.items[i].title) {\r\n            var toolbarTitle = document.createElement('span');\r\n            toolbarTitle.innerHTML = options.items[i].title;\r\n            toolbarItem.appendChild(toolbarTitle);\r\n        }\r\n\r\n        toolbarContent.appendChild(toolbarItem);\r\n    }\r\n\r\n    el.toolbar = obj;\r\n\r\n    el.appendChild(toolbar);\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.actionsheet = (function() {\r\n    var actionsheet = document.createElement('div');\r\n    actionsheet.className = 'jactionsheet';\r\n    actionsheet.style.display = 'none';\r\n\r\n    var actionContent = document.createElement('div');\r\n    actionContent.className = 'jactionsheet-content';\r\n    actionsheet.appendChild(actionContent);\r\n\r\n    var obj = function(options) {\r\n        if (options) {\r\n            obj.options = options;\r\n        }\r\n\r\n        // Reset container\r\n        actionContent.innerHTML = '';\r\n\r\n        // Create new elements\r\n        for (var i = 0; i < obj.options.length; i++) {\r\n            var actionGroup = document.createElement('div');\r\n            actionGroup.className = 'jactionsheet-group';\r\n\r\n            for (var j = 0; j < obj.options[i].length; j++) {\r\n                var v = obj.options[i][j];\r\n                var actionItem = document.createElement('div');\r\n                var actionInput = document.createElement('input');\r\n                actionInput.type = 'button';\r\n                actionInput.value = v.title;\r\n                if (v.className) {\r\n                    actionInput.className = v.className; \r\n                }\r\n                if (v.onclick) {\r\n                    actionInput.onclick = v.onclick; \r\n                }\r\n                if (v.action == 'cancel') {\r\n                    actionInput.style.color = 'red';\r\n                }\r\n                actionItem.appendChild(actionInput);\r\n                actionGroup.appendChild(actionItem);\r\n            }\r\n\r\n            actionContent.appendChild(actionGroup);\r\n        }\r\n\r\n        // Show\r\n        actionsheet.style.display = '';\r\n\r\n        // Append\r\n        jSuites.el.appendChild(actionsheet);\r\n\r\n        // Animation\r\n        jSuites.slideBottom(actionContent, true);\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (actionsheet.style.display != 'none') {\r\n            // Remove any existing actionsheet\r\n            jSuites.slideBottom(actionContent, false, function() {\r\n                actionsheet.remove();\r\n                actionsheet.style.display = 'none';\r\n            });\r\n        }\r\n    }\r\n\r\n    var mouseUp = function(e) {\r\n        obj.close();\r\n    }\r\n\r\n    actionsheet.addEventListener('mouseup', mouseUp);\r\n\r\n    obj.options = {};\r\n\r\n    return obj;\r\n})();\r\n\r\n/**\r\n * (c) jSuites modal\r\n * https://github.com/paulhodel/jsuites\r\n *\r\n * @author: Paul Hodel <paul.hodel@gmail.com>\r\n * @description: Modal\r\n */\r\n\r\njSuites.modal = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        onopen: null,\r\n        onclose: null,\r\n        closed: false,\r\n        width: null,\r\n        height: null,\r\n        title: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Title\r\n    if (! obj.options.title && el.getAttribute('title')) {\r\n        obj.options.title = el.getAttribute('title');\r\n    }\r\n\r\n    var temp = document.createElement('div');\r\n    for (var i = 0; i < el.children.length; i++) {\r\n        temp.appendChild(el.children[i]);\r\n    }\r\n\r\n    obj.content = document.createElement('div');\r\n    obj.content.className = 'jmodal_content';\r\n    obj.content.innerHTML = el.innerHTML;\r\n\r\n    for (var i = 0; i < temp.children.length; i++) {\r\n        obj.content.appendChild(temp.children[i]);\r\n    }\r\n\r\n    obj.container = document.createElement('div');\r\n    obj.container.className = 'jmodal';\r\n    obj.container.appendChild(obj.content);\r\n\r\n    if (obj.options.width) {\r\n        obj.container.style.width = obj.options.width;\r\n    }\r\n    if (obj.options.height) {\r\n        obj.container.style.height = obj.options.height;\r\n    }\r\n    if (obj.options.title) {\r\n        obj.container.setAttribute('title', obj.options.title);\r\n    } else {\r\n        obj.container.classList.add('no-title');\r\n    }\r\n    el.innerHTML = '';\r\n    el.style.display = 'none';\r\n    el.appendChild(obj.container);\r\n\r\n    // Backdrop\r\n    var backdrop = document.createElement('div');\r\n    backdrop.className = 'jmodal_backdrop';\r\n    el.appendChild(backdrop);\r\n\r\n    obj.open = function() {\r\n        el.style.display = 'block';\r\n        // Fullscreen\r\n        const rect = obj.container.getBoundingClientRect();\r\n        if (jSuites.getWindowWidth() < rect.width) {\r\n            obj.container.style.top = '';\r\n            obj.container.style.left = '';\r\n            obj.container.classList.add('jmodal_fullscreen');\r\n            jSuites.slideBottom(obj.container, 1);\r\n        } else {\r\n            backdrop.style.display = 'block';\r\n        }\r\n        // Current\r\n        jSuites.modal.current = obj;\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el, obj);\r\n        }\r\n    }\r\n\r\n    obj.resetPosition = function() {\r\n        obj.container.style.top = '';\r\n        obj.container.style.left = '';\r\n    }\r\n\r\n    obj.isOpen = function() {\r\n        return el.style.display != 'none' ? true : false;\r\n    }\r\n\r\n    obj.close = function() {\r\n        el.style.display = 'none';\r\n        // Backdrop\r\n        backdrop.style.display = '';\r\n        // Current\r\n        jSuites.modal.current = null;\r\n        // Remove fullscreen class\r\n        obj.container.classList.remove('jmodal_fullscreen');\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el, obj);\r\n        }\r\n    }\r\n\r\n    if (! jSuites.modal.hasEvents) {\r\n        jSuites.modal.current = obj;\r\n\r\n        if ('ontouchstart' in document.documentElement === true) {\r\n            document.addEventListener(\"touchstart\", jSuites.modal.mouseDownControls);\r\n        } else {\r\n            document.addEventListener('mousedown', jSuites.modal.mouseDownControls);\r\n            document.addEventListener('mousemove', jSuites.modal.mouseMoveControls);\r\n            document.addEventListener('mouseup', jSuites.modal.mouseUpControls);\r\n        }\r\n\r\n        document.addEventListener('keydown', jSuites.modal.keyDownControls);\r\n\r\n        jSuites.modal.hasEvents = true;\r\n    }\r\n\r\n    if (obj.options.url) {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            success: function(data) {\r\n                obj.content.innerHTML = data;\r\n\r\n                if (! obj.options.closed) {\r\n                    obj.open();\r\n                }\r\n            }\r\n        });\r\n    } else {\r\n        if (! obj.options.closed) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    // Keep object available from the node\r\n    el.modal = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.modal.current = null;\r\njSuites.modal.position = null;\r\n\r\njSuites.modal.keyDownControls = function(e) {\r\n    if (e.which == 27) {\r\n        if (jSuites.modal.current) {\r\n            jSuites.modal.current.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseUpControls = function(e) {\r\n    if (jSuites.modal.current) {\r\n        jSuites.modal.current.container.style.cursor = 'auto';\r\n    }\r\n    jSuites.modal.position = null;\r\n}\r\n\r\njSuites.modal.mouseMoveControls = function(e) {\r\n    if (jSuites.modal.current && jSuites.modal.position) {\r\n        if (e.which == 1 || e.which == 3) {\r\n            var position = jSuites.modal.position;\r\n            jSuites.modal.current.container.style.top = (position[1] + (e.clientY - position[3]) + (position[5] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.left = (position[0] + (e.clientX - position[2]) + (position[4] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.cursor = 'move';\r\n        } else {\r\n            jSuites.modal.current.container.style.cursor = 'auto';\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseDownControls = function(e) {\r\n    jSuites.modal.position = [];\r\n\r\n    if (e.target.classList.contains('jmodal')) {\r\n        setTimeout(function() {\r\n            // Get target info\r\n            var rect = e.target.getBoundingClientRect();\r\n\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            if (rect.width - (x - rect.left) < 50 && (y - rect.top) < 50) {\r\n                setTimeout(function() {\r\n                    jSuites.modal.current.close();\r\n                }, 100);\r\n            } else {\r\n                if (e.target.getAttribute('title') && (y - rect.top) < 50) {\r\n                    if (document.selection) {\r\n                        document.selection.empty();\r\n                    } else if ( window.getSelection ) {\r\n                        window.getSelection().removeAllRanges();\r\n                    }\r\n\r\n                    jSuites.modal.position = [\r\n                        rect.left,\r\n                        rect.top,\r\n                        e.clientX,\r\n                        e.clientY,\r\n                        rect.width,\r\n                        rect.height,\r\n                    ];\r\n                }\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n\r\njSuites.notification = (function(options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        icon: null,\r\n        name: 'Notification',\r\n        date: null,\r\n        title: null,\r\n        message: null,\r\n        timeout: 4000,\r\n        autoHide: true,\r\n        closeable: true,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    var notification = document.createElement('div');\r\n    notification.className = 'jnotification';\r\n\r\n    var notificationContainer = document.createElement('div');\r\n    notificationContainer.className = 'jnotification-container';\r\n    notification.appendChild(notificationContainer);\r\n\r\n    var notificationHeader = document.createElement('div');\r\n    notificationHeader.className = 'jnotification-header';\r\n    notificationContainer.appendChild(notificationHeader);\r\n\r\n    var notificationImage = document.createElement('div');\r\n    notificationImage.className = 'jnotification-image';\r\n    notificationHeader.appendChild(notificationImage);\r\n\r\n    if (obj.options.icon) {\r\n        var notificationIcon = document.createElement('img');\r\n        notificationIcon.src = obj.options.icon;\r\n        notificationImage.appendChild(notificationIcon);\r\n    }\r\n\r\n    var notificationName = document.createElement('div');\r\n    notificationName.className = 'jnotification-name';\r\n    notificationName.innerHTML = obj.options.name;\r\n    notificationHeader.appendChild(notificationName);\r\n\r\n    if (obj.options.closeable == true) {\r\n        var notificationClose = document.createElement('div');\r\n        notificationClose.className = 'jnotification-close';\r\n        notificationClose.onclick = function() {\r\n            obj.hide();\r\n        }\r\n        notificationHeader.appendChild(notificationClose);\r\n    }\r\n\r\n    var notificationDate = document.createElement('div');\r\n    notificationDate.className = 'jnotification-date';\r\n    notificationHeader.appendChild(notificationDate);\r\n\r\n    var notificationContent = document.createElement('div');\r\n    notificationContent.className = 'jnotification-content';\r\n    notificationContainer.appendChild(notificationContent);\r\n\r\n    if (obj.options.title) {\r\n        var notificationTitle = document.createElement('div');\r\n        notificationTitle.className = 'jnotification-title';\r\n        notificationTitle.innerHTML = obj.options.title;\r\n        notificationContent.appendChild(notificationTitle);\r\n    }\r\n\r\n    var notificationMessage = document.createElement('div');\r\n    notificationMessage.className = 'jnotification-message';\r\n    notificationMessage.innerHTML = obj.options.message;\r\n    notificationContent.appendChild(notificationMessage);\r\n\r\n    obj.show = function() {\r\n        document.body.appendChild(notification);\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.fadeIn(notification);\r\n        } else {\r\n            jSuites.slideTop(notification, 1);\r\n        }\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.fadeOut(notification, function() {\r\n                notification.parentNode.removeChild(notification);\r\n            });\r\n        } else {\r\n            jSuites.slideTop(notification, 0, function() {\r\n                notification.parentNode.removeChild(notification);\r\n            });\r\n        }\r\n    };\r\n\r\n    obj.show();\r\n\r\n    if (obj.options.autoHide == true) {\r\n        setTimeout(function() {\r\n            obj.hide();\r\n        }, obj.options.timeout);\r\n    }\r\n\r\n    if (jSuites.getWindowWidth() < 800) {\r\n        notification.addEventListener(\"swipeup\", function(e) {\r\n            obj.hide();\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.rating = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        number: 5,\r\n        value: 0,\r\n        tooltip: [ 'Very bad', 'Bad', 'Average', 'Good', 'Very good' ],\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jrating');\r\n\r\n    // Add elements\r\n    for (var i = 0; i < obj.options.number; i++) {\r\n        var div = document.createElement('div');\r\n        div.setAttribute('data-index', (i + 1))\r\n        div.setAttribute('title', obj.options.tooltip[i])\r\n        el.appendChild(div);\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(index) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n                el.children[i].classList.remove('jrating-selected');\r\n            }\r\n        }\r\n\r\n        obj.options.value = index;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, index);\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    if (obj.options.value) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < obj.options.value) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    // Events\r\n    el.addEventListener(\"click\", function(e) {\r\n        var index = e.target.getAttribute('data-index');\r\n        if (index != undefined) {\r\n            if (index == obj.options.value) {\r\n                obj.setValue(0);\r\n            } else {\r\n                obj.setValue(index);\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"mouseover\", function(e) {\r\n        var index = e.target.getAttribute('data-index');\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-over');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"mouseout\", function(e) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            el.children[i].classList.remove('jrating-over');\r\n        }\r\n    });\r\n\r\n    el.rating = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n/**\r\n * (c) Image slider\r\n * https://github.com/paulhodel/jtools\r\n *\r\n * @author: Paul Hodel <paul.hodel@gmail.com>\r\n * @description: Image Slider\r\n */\r\n\r\njSuites.slider = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n    obj.currentImage = null;\r\n\r\n    if (options) {\r\n        obj.options = options;\r\n    }\r\n\r\n    // Items\r\n    obj.options.items = [];\r\n\r\n    if (! el.classList.contains('jslider')) {\r\n        el.classList.add('jslider');\r\n\r\n        // Create container\r\n        var container = document.createElement('div');\r\n        container.className = 'jslider-container';\r\n\r\n        // Move children inside\r\n        if (el.children.length > 0) {\r\n            // Keep children items\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                obj.options.items.push(el.children[i]);\r\n            }\r\n        }\r\n        if (obj.options.items.length > 0) {\r\n            for (var i = 0; i < obj.options.items.length; i++) {\r\n                obj.options.items[i].classList.add('jfile');\r\n                var index = obj.options.items[i].src.lastIndexOf('/');\r\n                if (index < 0) {\r\n                    obj.options.items[i].setAttribute('data-name', obj.options.items[i].src);\r\n                } else {\r\n                    obj.options.items[i].setAttribute('data-name', obj.options.items[i].src.substr(index + 1));\r\n                }\r\n                var index = obj.options.items[i].src.lastIndexOf('/');\r\n\r\n                container.appendChild(obj.options.items[i]);\r\n            }\r\n        }\r\n        el.appendChild(container);\r\n        // Add close buttom\r\n        var close = document.createElement('div');\r\n        close.className = 'jslider-close';\r\n        close.innerHTML = '';\r\n        close.onclick =  function() {\r\n            obj.close();\r\n        }\r\n        el.appendChild(close);\r\n    } else {\r\n        var container = el.querySelector('slider-container');\r\n    }\r\n\r\n    obj.show = function(target) {\r\n        if (! target) {\r\n            var target = container.children[0];\r\n        }\r\n\r\n        if (! container.classList.contains('jslider-preview')) {\r\n            container.classList.add('jslider-preview');\r\n            close.style.display = 'block';\r\n        }\r\n\r\n        // Hide all images\r\n        for (var i = 0; i < container.children.length; i++) {\r\n            container.children[i].style.display = 'none';\r\n        }\r\n\r\n        // Show clicked only\r\n        target.style.display = 'block';\r\n\r\n        // Is there any previous\r\n        if (target.previousSibling) {\r\n            container.classList.add('jslider-left');\r\n        } else {\r\n            container.classList.remove('jslider-left');\r\n        }\r\n\r\n        // Is there any next\r\n        if (target.nextSibling) {\r\n            container.classList.add('jslider-right');\r\n        } else {\r\n            container.classList.remove('jslider-right');\r\n        }\r\n\r\n        obj.currentImage = target;\r\n    }\r\n\r\n    obj.open = function() {\r\n        obj.show();\r\n\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        container.classList.remove('jslider-preview');\r\n        container.classList.remove('jslider-left');\r\n        container.classList.remove('jslider-right');\r\n\r\n        for (var i = 0; i < container.children.length; i++) {\r\n            container.children[i].style.display = '';\r\n        }\r\n\r\n        close.style.display = '';\r\n\r\n        obj.currentImage = null;\r\n\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el);\r\n        }\r\n    }\r\n\r\n    obj.reset = function() {\r\n        container.innerHTML = '';\r\n    }\r\n\r\n    obj.addFile = function(v, ignoreEvents) {\r\n        var img = document.createElement('img');\r\n        img.setAttribute('data-lastmodified', v.lastmodified);\r\n        img.setAttribute('data-name', v.name);\r\n        img.setAttribute('data-size', v.size);\r\n        img.setAttribute('data-extension', v.extension);\r\n        img.setAttribute('data-cover', v.cover);\r\n        img.setAttribute('src', v.file);\r\n        img.className = 'jfile';\r\n        container.appendChild(img);\r\n        obj.options.items.push(img);\r\n\r\n        // Onchange\r\n        if (! ignoreEvents) {\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, v);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.addFiles = function(files) {\r\n        for (var i = 0; i < files.length; i++) {\r\n            obj.addFile(files[i]);\r\n        }\r\n    }\r\n\r\n    obj.next = function() {\r\n        if (obj.currentImage.nextSibling) {\r\n            obj.show(obj.currentImage.nextSibling);\r\n        }\r\n    }\r\n    \r\n    obj.prev = function() {\r\n        if (obj.currentImage.previousSibling) {\r\n            obj.show(obj.currentImage.previousSibling);\r\n        }\r\n    }\r\n\r\n    obj.getData = function() {\r\n        return jSuites.getFiles(container);\r\n    }\r\n\r\n    // Append data\r\n    if (obj.options.data && obj.options.data.length) {\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            if (obj.options.data[i]) {\r\n                obj.addFile(obj.options.data[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Allow insert\r\n    if (obj.options.allowAttachment) {\r\n        var attachmentInput = document.createElement('input');\r\n        attachmentInput.type = 'file';\r\n        attachmentInput.className = 'slider-attachment';\r\n        attachmentInput.setAttribute('accept', 'image/*');\r\n        attachmentInput.style.display = 'none';\r\n        attachmentInput.onchange = function() {\r\n            var reader = [];\r\n\r\n            for (var i = 0; i < this.files.length; i++) {\r\n                var type = this.files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    var extension = this.files[i].name;\r\n                    extension = extension.split('.');\r\n                    extension = extension[extension.length-1];\r\n\r\n                    var file = {\r\n                        size: this.files[i].size,\r\n                        name: this.files[i].name,\r\n                        extension: extension,\r\n                        cover: 0,\r\n                        lastmodified: this.files[i].lastModified,\r\n                    }\r\n\r\n                    reader[i] = new FileReader();\r\n                    reader[i].addEventListener(\"load\", function (e) {\r\n                        file.file = e.target.result;\r\n                        obj.addFile(file);\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(this.files[i]);\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            };\r\n        }\r\n\r\n        var attachmentIcon = document.createElement('i');\r\n        attachmentIcon.innerHTML = 'attachment';\r\n        attachmentIcon.className = 'jslider-attach material-icons';\r\n        attachmentIcon.onclick = function() {\r\n            jSuites.click(attachmentInput);\r\n        }\r\n\r\n        el.appendChild(attachmentInput);\r\n        el.appendChild(attachmentIcon);\r\n    }\r\n\r\n    // Push to refresh\r\n    var longTouchTimer = null;\r\n\r\n    var mouseDown = function(e) {\r\n        if (e.target.tagName == 'IMG') {\r\n            // Remove\r\n            var targetImage = e.target;\r\n            longTouchTimer = setTimeout(function() {\r\n                if (e.target.src.substr(0,4) == 'data') {\r\n                    e.target.remove();\r\n                } else {\r\n                    if (e.target.classList.contains('jremove')) {\r\n                        e.target.classList.remove('jremove');\r\n                    } else {\r\n                        e.target.classList.add('jremove');\r\n                    }\r\n                }\r\n\r\n                // Onchange\r\n                if (typeof(obj.options.onchange) == 'function') {\r\n                    obj.options.onchange(el, e.target);\r\n                }\r\n            }, 1000);\r\n        }\r\n    }\r\n\r\n    var mouseUp = function(e) {\r\n        if (longTouchTimer) {\r\n            clearTimeout(longTouchTimer);\r\n        }\r\n\r\n        // Open slider\r\n        if (e.target.tagName == 'IMG') {\r\n            if (! e.target.classList.contains('jremove')) {\r\n                obj.show(e.target);\r\n            }\r\n        } else {\r\n            // Arrow controls\r\n            if (e.target.clientWidth - e.offsetX < 40) {\r\n                // Show next image\r\n                obj.next();\r\n            } else if (e.offsetX < 40) {\r\n                // Show previous image\r\n                obj.prev();\r\n            }\r\n        }\r\n    }\r\n\r\n    container.addEventListener('mousedown', mouseDown);\r\n    container.addEventListener('touchstart', mouseDown);\r\n    container.addEventListener('mouseup', mouseUp);\r\n    container.addEventListener('touchend', mouseUp);\r\n\r\n    // Add global events\r\n    el.addEventListener(\"swipeleft\", function(e) {\r\n        obj.next();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener(\"swiperight\", function(e) {\r\n        obj.prev();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n\r\n    el.slider = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n/**\n * (c) jTools v1.0.1 - Element sorting\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Element drag and drop sorting\n */\n\njSuites.sorting = (function(el, options) {\n    el.classList.add('jsorting');\n\n    el.addEventListener('dragstart', function(e) {\n        e.target.classList.add('dragging');\n    });\n\n    el.addEventListener('dragover', function(e) {\n        e.preventDefault();\n\n        if (e.target.clientHeight / 2 > e.offsetY) {\n            e.path[0].style.borderTop = '1px dotted #ccc';\n            e.path[0].style.borderBottom = '';\n        } else {\n            e.path[0].style.borderTop = '';\n            e.path[0].style.borderBottom = '1px dotted #ccc';\n        }\n    });\n\n    el.addEventListener('dragleave', function(e) {\n        e.path[0].style.borderTop = '';\n        e.path[0].style.borderBottom = '';\n    });\n\n    el.addEventListener('dragend', function(e) {\n        e.path[1].querySelector('.dragging').classList.remove('dragging');\n    });\n\n    el.addEventListener('drop', function(e) {\n        var element = e.path[1].querySelector('.dragging');\n\n        if (e.target.clientHeight / 2 > e.offsetY) {\n            e.path[1].insertBefore(element, e.path[0]);\n        } else {\n            e.path[1].insertBefore(element, e.path[0].nextSibling);\n        }\n\n        e.path[0].style.borderTop = '';\n        e.path[0].style.borderBottom = '';\n    });\n\n    for (var i = 0; i < el.children.length; i++) {\n        el.children[i].setAttribute('draggable', 'true');\n    };\n\n    return el;\n});\r\n\r\njSuites.tabs = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        data: null,\r\n        onchange: null,\r\n        onload: null,\r\n    };\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jtabs');\r\n\r\n    // Create from data\r\n    if (obj.options.data) {\r\n        // Make sure the component is blank\r\n        el.innerHTML = '';\r\n        var headers = document.createElement('div');\r\n        var content = document.createElement('div');\r\n        headers.classList.add('jtabs-headers');\r\n        content.classList.add('jtabs-content');\r\n        el.appendChild(headers);\r\n        el.appendChild(content);\r\n\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            var headersItem = document.createElement('div');\r\n            headers.appendChild(headersItem);\r\n            var contentItem = document.createElement('div');\r\n            content.appendChild(contentItem);\r\n\r\n            headersItem.innerHTML = obj.options.data[i].title;\r\n            if (obj.options.data[i].content) {\r\n                contentItem.innerHTML = obj.options.data[i].content;\r\n            } else if (obj.options.data[i].url) {\r\n                jSuites.ajax({\r\n                    url: obj.options.data[i].url,\r\n                    type: 'GET',\r\n                    success: function(result) {\r\n                        contentItem.innerHTML = result;\r\n                    },\r\n                    complete: function() {\r\n                        if (typeof(obj.options.onload) == 'function') {\r\n                            obj.options.onload(el);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    } else if (el.children[0] && el.children[1]) {\r\n        // Create from existing elements\r\n        var headers = el.children[0];\r\n        var content = el.children[1];\r\n        headers.classList.add('jtabs-headers');\r\n        content.classList.add('jtabs-content');\r\n    }\r\n\r\n    // Border\r\n    var border = document.createElement('div');\r\n    border.className = 'jtabs-border';\r\n    el.appendChild(border);\r\n\r\n    var setBorder = function(index) {\r\n        var rect = headers.children[index].getBoundingClientRect();\r\n        border.style.width = rect.width + 'px';\r\n        border.style.top = rect.top + rect.height - 2 + 'px';\r\n        border.style.left = rect.left + 'px';\r\n    }\r\n\r\n    // Set value\r\n    obj.open = function(index) {\r\n        for (var i = 0; i < headers.children.length; i++) {\r\n            headers.children[i].classList.remove('jtabs-selected');\r\n            if (content.children[i]) {\r\n                content.children[i].classList.remove('jtabs-selected');\r\n            }\r\n        }\r\n\r\n        headers.children[index].classList.add('jtabs-selected');\r\n        if (content.children[index]) {\r\n            content.children[index].classList.add('jtabs-selected');\r\n        }\r\n\r\n        // Set border\r\n        setTimeout(function() {\r\n            setBorder(index);\r\n        }, 10);\r\n    }\r\n\r\n    // Events\r\n    headers.addEventListener(\"click\", function(e) {\r\n        var index = Array.prototype.indexOf.call(headers.children, e.target);\r\n        if (index >= 0) {\r\n            obj.open(index);\r\n        }\r\n    });\r\n\r\n    obj.open(0);\r\n\r\n    el.tabs = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.tags = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    /**\r\n     * @typedef {Object} defaults\r\n     * @property {(string|Array)} value - Initial value of the compontent\r\n     * @property {number} limit - Max number of tags inside the element\r\n     * @property {string} search - The URL for suggestions\r\n     * @property {string} placeholder - The default instruction text on the element\r\n     * @property {validation} validation - Method to validate the tags\r\n     * @property {requestCallback} onbeforechange - Method to be execute before any changes on the element\r\n     * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n     * @property {requestCallback} onfocus - Method to be execute when on focus\r\n     * @property {requestCallback} onblur - Method to be execute when on blur\r\n     * @property {requestCallback} onload - Method to be execute when the element is loaded\r\n     */\r\n    var defaults = {\r\n        value: null,\r\n        limit: null,\r\n        search: null,\r\n        placeholder: null,\r\n        validation: null,\r\n        onbeforechange: null,\r\n        onchange: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        colors: null,\r\n    };\r\n\r\n    // Loop through though the default configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Search helpers\r\n    var searchContainer = null;\r\n    var searchTerms = null;\r\n    var searchIndex = 0;\r\n    var searchTimer = 0;\r\n\r\n    /**\r\n     * Add a new tag to the element\r\n     * @param {(?string|Array)} value - The value of the new element\r\n     */\r\n    obj.add = function(value) {\r\n        if (typeof(obj.options.onbeforechange) == 'function') {\r\n            var v = obj.options.onbeforechange(el, obj, value);\r\n            if (v != null) {\r\n                value = v;\r\n            }\r\n        }\r\n\r\n        // Close search\r\n        if (searchContainer) {\r\n            searchContainer.style.display = '';\r\n        }\r\n        // Get node\r\n        var node = getSelectionStart();\r\n\r\n        // Mix argument string or array\r\n        if (! value || typeof(value) == 'string') {\r\n            var div = document.createElement('div');\r\n            div.innerHTML = value ? value : '<br>';\r\n            if (node && node.parentNode.classList.contains('jtags')) {\r\n                el.insertBefore(div, node.nextSibling);\r\n            } else {\r\n                el.appendChild(div);\r\n            }\r\n        } else {\r\n            if (node && node.parentNode.classList.contains('jtags')) {\r\n                if (! node.innerText.replace(\"\\n\", \"\")) {\r\n                    el.removeChild(node);\r\n                }\r\n            }\r\n\r\n            for (var i = 0; i < value.length; i++) {\r\n                var div = document.createElement('div');\r\n                div.innerHTML = value[i] ? value[i] : '<br>';\r\n                el.appendChild(div);\r\n            };\r\n\r\n            var div = document.createElement('div');\r\n            div.innerHTML = '<br>';\r\n            el.appendChild(div);\r\n        }\r\n\r\n        // Place caret\r\n        setTimeout(function() {\r\n            caret(div);\r\n        }, 0);\r\n\r\n        // Filter\r\n        filter();\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj, value ? value : '');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get all tags in the element\r\n     * @return {Array} data - All tags as an array\r\n     */\r\n    obj.getData = function() {\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            var value = obj.getValue(i);\r\n            if (value) {\r\n                var id = el.children[i].getAttribute('data-id');\r\n                if (! id) {\r\n                    id = value;\r\n                }\r\n                data.push({ id: id, value: value });\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Get the value of one tag. Null for all tags\r\n     * @param {?number} index - Tag index number. Null for all tags.\r\n     * @return {string} value - All tags separated by comma\r\n     */\r\n    obj.getValue = function(index) {\r\n        var value = null;\r\n\r\n        if (index != null) {\r\n            // Get one individual value\r\n            value = el.children[index].innerText.replace(\"\\n\", \"\");\r\n        } else {\r\n            // Get all\r\n            var data = [];\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                value = el.children[i].innerText.replace(\"\\n\", \"\");\r\n                if (value) {\r\n                    data.push(obj.getValue(i));\r\n                }\r\n            }\r\n            value = data.join(',');\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Set the value of the element based on a string separeted by (,|;|\\r\\n)\r\n     * @param {string} value - A string with the tags\r\n     */\r\n    obj.setValue = function(text) {\r\n        // Remove whitespaces\r\n        text = text.trim();\r\n\r\n        if (text) {\r\n            // Tags\r\n            var data = extractTags(text);\r\n            console.log(data);\r\n            // Add tags to the element\r\n            obj.add(data);\r\n        }\r\n    }\r\n\r\n    obj.reset = function() {\r\n        el.innerHTML = '<div><br></div>';\r\n    }\r\n\r\n    /**\r\n     * Verify if all tags in the element are valid\r\n     * @return {boolean}\r\n     */\r\n    obj.isValid = function() {\r\n        var test = 0;\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (el.children[i].classList.contains('jtags_error')) {\r\n                test++;\r\n            }\r\n        }\r\n        return test == 0 ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Add one element from the suggestions to the element\r\n     * @param {object} item - Node element in the suggestions container\r\n     */ \r\n    obj.selectIndex = function(item) {\r\n        // Reset terms\r\n        searchTerms = '';\r\n        var node = getSelectionStart();\r\n        // Append text to the caret\r\n        node.innerText = item.children[1].innerText;\r\n        // Set node id\r\n        if (item.children[1].getAttribute('data-id')) {\r\n            node.setAttribute('data-id', item.children[1].getAttribute('data-id'));\r\n        }\r\n        // Close container\r\n        if (searchContainer) {\r\n            searchContainer.style.display = '';\r\n            searchContainer.innerHTML = '';\r\n        }\r\n        // Remove any error\r\n        node.classList.remove('jtags_error');\r\n        // Add new item\r\n        obj.add();\r\n    }\r\n\r\n    /**\r\n     * Search for suggestions\r\n     * @param {object} node - Target node for any suggestions\r\n     */\r\n    obj.search = function(node) {\r\n        // Create and append search container to the DOM\r\n        if (! searchContainer) {\r\n            var div = document.createElement('div');\r\n            div.style.position = 'relative';\r\n            el.parentNode.insertBefore(div, el.nextSibling);\r\n\r\n            // Create container\r\n            searchContainer = document.createElement('div');\r\n            searchContainer.classList.add('jtags_search');\r\n            div.appendChild(searchContainer);\r\n        }\r\n\r\n        // Search for\r\n        var terms = node.anchorNode.nodeValue;\r\n\r\n        // Search\r\n        if (node.anchorNode.nodeValue && terms != searchTerms) {\r\n            // Terms\r\n            searchTerms = node.anchorNode.nodeValue;\r\n            // Reset index\r\n            searchIndex = 0;\r\n            // Get remove results\r\n            jSuites.ajax({\r\n                url: obj.options.search + searchTerms,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    // Reset container\r\n                    searchContainer.innerHTML = '';\r\n\r\n                    // Print results\r\n                    if (! data.length) {\r\n                        // Show container\r\n                        searchContainer.style.display = '';\r\n                    } else {\r\n                        // Show container\r\n                        searchContainer.style.display = 'block';\r\n\r\n                        // Show items\r\n                        var len = data.length < 11 ? data.length : 10;\r\n                        for (var i = 0; i < len; i++) {\r\n                            var div = document.createElement('div');\r\n                            if (i == 0) {\r\n                                div.classList.add('selected');\r\n                            }\r\n                            var img = document.createElement('img');\r\n                            if (data[i].image) {\r\n                                img.src = data[i].image;\r\n                            } else {\r\n                                img.style.display = 'none';\r\n                            }\r\n                            div.appendChild(img);\r\n\r\n                            var item = document.createElement('div');\r\n                            item.setAttribute('data-id', data[i].id);\r\n                            item.innerHTML = data[i].name;\r\n                            div.onclick = function() {\r\n                                // Add item\r\n                                obj.selectIndex(this);\r\n                            }\r\n                            div.appendChild(item);\r\n                            // Append item to the container\r\n                            searchContainer.appendChild(div);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Destroy tags element\r\n    obj.destroy = function() {\r\n        // Bind events\r\n        el.removeEventListener('mouseup', tagsMouseUp);\r\n        el.removeEventListener('keydown', tagsKeyDown);\r\n        el.removeEventListener('keyup', tagsKeyUp);\r\n        el.removeEventListener('paste', tagsPaste);\r\n        el.removeEventListener('focus', tagsFocus);\r\n        el.removeEventListener('blur', tagsBlur);\r\n        // Remove element\r\n        el.parentNode.removeChild(el);\r\n    }\r\n\r\n    var getRandomColor = function(index) {\r\n        var rand = function(min, max) {\r\n            return min + Math.random() * (max - min);\r\n        }\r\n        return 'hsl(' + rand(1, 360) + ',' + rand(40, 70) + '%,' + rand(65, 72) + '%)';\r\n    }\r\n\r\n    /**\r\n     * Filter tags\r\n     */\r\n    var filter = function() {\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            // Create label design\r\n            if (! obj.getValue(i)) {\r\n                el.children[i].classList.remove('jtags_label');\r\n            } else {\r\n                el.children[i].classList.add('jtags_label');\r\n\r\n                // Validation in place\r\n                if (typeof(obj.options.validation) == 'function') {\r\n                    if (obj.getValue(i)) {\r\n                        if (! obj.options.validation(el.children[i], el.children[i].innerText, el.children[i].getAttribute('data-id'))) {\r\n                            el.children[i].classList.add('jtags_error');\r\n                        } else {\r\n                            el.children[i].classList.remove('jtags_error');\r\n                        }\r\n                    } else {\r\n                        el.children[i].classList.remove('jtags_error');\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Place caret in the element node\r\n     */\r\n    var caret = function(e) {\r\n        var range = document.createRange();\r\n        var sel = window.getSelection();\r\n        range.setStart(e, e.innerText.length);\r\n        range.collapse(true);\r\n        sel.removeAllRanges();\r\n        sel.addRange(range);\r\n    }\r\n\r\n    /**\r\n     * Selection\r\n     */\r\n    var getSelectionStart = function() {\r\n        var node = document.getSelection().anchorNode;\r\n        if (node) {\r\n            return (node.nodeType == 3 ? node.parentNode : node);\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract tags from a string\r\n     * @param {string} text - Raw string\r\n     * @return {Array} data - Array with extracted tags\r\n     */\r\n    var extractTags = function(text) {\r\n        /** @type {Array} */\r\n        var data = [];\r\n\r\n        /** @type {string} */\r\n        var word = '';\r\n\r\n        // Remove whitespaces\r\n        text = text.trim();\r\n\r\n        if (text) {\r\n            for (var i = 0; i < text.length; i++) {\r\n                if (text[i] == ',' || text[i] == ';' || text[i] == '\\r\\n') {\r\n                    if (word) {\r\n                        data.push(word);\r\n                    }\r\n                } else {\r\n                    word += text[i];\r\n                }\r\n            }\r\n\r\n            if (word) {\r\n                data.push(word);\r\n            }\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    /** @type {number} */\r\n    var anchorOffset = 0;\r\n\r\n    /**\r\n     * Processing event keydown on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyDown = function(e) {\r\n        // Anchoroffset\r\n        anchorOffset = window.getSelection().anchorOffset;\r\n\r\n        // Verify content\r\n        if (! el.children.length) {\r\n            var div = document.createElement('div');\r\n            div.innerHTML = '<br>';\r\n            el.appendChild(div);\r\n        }\r\n        // Comma\r\n        if (e.which == 9 || e.which == 186 || e.which == 188) {\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1) {\r\n                obj.add();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 13) {\r\n            // Enter\r\n            if (searchContainer && searchContainer.style.display != '') {\r\n                obj.selectIndex(searchContainer.children[searchIndex]);\r\n            } else {\r\n                var n = window.getSelection().anchorOffset;\r\n                if (n > 1) {\r\n                    obj.add();\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 38) {\r\n            // Up\r\n            if (searchContainer && searchContainer.style.display != '') {\r\n                searchContainer.children[searchIndex].classList.remove('selected');\r\n                if (searchIndex > 0) {\r\n                    searchIndex--;\r\n                }\r\n                searchContainer.children[searchIndex].classList.add('selected');\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 40) {\r\n            // Down\r\n            if (searchContainer && searchContainer.style.display != '') {\r\n                searchContainer.children[searchIndex].classList.remove('selected');\r\n                if (searchIndex < 9) {\r\n                    searchIndex++;\r\n                }\r\n                searchContainer.children[searchIndex].classList.add('selected');\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event keyup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyUp = function(e) {\r\n        if (e.which == 39) {\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1 && n == anchorOffset) {\r\n                obj.add();\r\n            }\r\n        } else if (e.which == 13 || e.which == 38 || e.which == 40) {\r\n            e.preventDefault();\r\n        } else {\r\n            if (searchTimer) {\r\n                clearTimeout(searchTimer);\r\n            }\r\n\r\n            searchTimer = setTimeout(function() {\r\n                // Current node\r\n                var node = window.getSelection();\r\n                // Search\r\n                if (obj.options.search) {\r\n                    obj.search(node);\r\n                }\r\n                searchTimer = null;\r\n            }, 300);\r\n        }\r\n\r\n        filter();\r\n    }\r\n\r\n    /**\r\n     * Processing event paste on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsPaste =  function(e) {\r\n        if (e.clipboardData || e.originalEvent.clipboardData) {\r\n            var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n            var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n        } else if (window.clipboardData) {\r\n            var html = window.clipboardData.getData('Html');\r\n            var text = window.clipboardData.getData('Text');\r\n        }\r\n\r\n        obj.setValue(text);\r\n        e.preventDefault();\r\n    }\r\n\r\n    /**\r\n     * Processing event mouseup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsMouseUp = function(e) {\r\n        if (e.target.parentNode && e.target.parentNode.classList.contains('jtags')) {\r\n            if (e.target.classList.contains('jtags_label') || e.target.classList.contains('jtags_error')) {\r\n                const rect = e.target.getBoundingClientRect();\r\n                if (rect.width - (e.clientX - rect.left) < 16) {\r\n                    el.removeChild(e.target);\r\n                    el.focus();\r\n                }\r\n            }\r\n        }\r\n\r\n        if (searchContainer) {\r\n            searchContainer.style.display = '';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event focus on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsFocus = function(e) {\r\n        if (! el.children.length || obj.getValue(el.children.length - 1)) {\r\n            var div = document.createElement('div');\r\n            div.innerHTML = '<br>';\r\n            el.appendChild(div);\r\n        }\r\n\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, obj.getValue());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event blur on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsBlur = function(e) {\r\n        if (searchContainer) {\r\n            setTimeout(function() {\r\n                searchContainer.style.display = '';\r\n            }, 200);\r\n        }\r\n\r\n        for (var i = 0; i < el.children.length - 1; i++) {\r\n            // Create label design\r\n            if (! obj.getValue(i)) {\r\n                el.removeChild(el.children[i]);\r\n            }\r\n        }\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, obj.getValue());\r\n        }\r\n    }\r\n\r\n    // Bind events\r\n    el.addEventListener('mouseup', tagsMouseUp);\r\n    el.addEventListener('keydown', tagsKeyDown);\r\n    el.addEventListener('keyup', tagsKeyUp);\r\n    el.addEventListener('paste', tagsPaste);\r\n    el.addEventListener('focus', tagsFocus);\r\n    el.addEventListener('blur', tagsBlur);\r\n\r\n    // Prepare container\r\n    el.classList.add('jtags');\r\n    el.setAttribute('contenteditable', true);\r\n    el.setAttribute('spellcheck', false);\r\n\r\n    if (obj.options.placeholder) {\r\n        el.placeholder = obj.options.placeholder;\r\n    }\r\n\r\n    // Make sure element is empty\r\n    if (obj.options.value) {\r\n        obj.setValue(obj.options.value);\r\n    } else {\r\n        el.innerHTML = '<div><br></div>';\r\n    }\r\n\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj);\r\n    }\r\n\r\n    el.tags = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.tracker = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        message: 'Are you sure? There are unsaved information in your form',\r\n        ignore: false,\r\n        currentHash: null,\r\n        submitButton:null,\r\n        onload: null,\r\n        onbeforesave: null,\r\n        onsave: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    obj.setUrl = function(url) {\r\n        obj.options.url = url;\r\n    }\r\n\r\n    obj.load = function() {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            success: function(data) {\r\n                var elements = el.querySelectorAll(\"input, select, textarea\");\r\n \r\n                for (var i = 0; i < elements.length; i++) {\r\n                    var name = elements[i].getAttribute('name');\r\n                    if (data[name]) {\r\n                        elements[i].value = data[name];\r\n                    }\r\n                }\r\n\r\n                if (typeof(obj.options.onload) == 'function') {\r\n                    obj.options.onload(el, data);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    obj.save = function() {\r\n        var test = obj.validate();\r\n\r\n        if (test) {\r\n            jSuites.alert(test);\r\n        } else {\r\n            var data = obj.getElements(true);\r\n\r\n            if (typeof(obj.options.onbeforesave) == 'function') {\r\n                var data = obj.options.onbeforesave(el, data);\r\n\r\n                if (data === false) {\r\n                    console.log('Onbeforesave returned false');\r\n                    return; \r\n                }\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: data,\r\n                success: function(result) {\r\n                    jSuites.alert(result.message);\r\n\r\n                    if (typeof(obj.options.onsave) == 'function') {\r\n                        var data = obj.options.onsave(el, result);\r\n                    }\r\n\r\n                    obj.reset();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.validateElement = function(element) {\r\n        var emailChecker = function(data) {\r\n            var pattern = new RegExp(/^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/);\r\n            return pattern.test(data) ? true : false; \r\n        }\r\n\r\n        var passwordChecker = function(data) {\r\n            return (data.length > 5) ? true : false;\r\n        }\r\n\r\n        var addError = function(element) {\r\n            // Add error in the element\r\n            element.classList.add('error');\r\n            // Submit button\r\n            if (obj.options.submitButton) {\r\n                obj.options.submitButton.setAttribute('disabled', true);\r\n            }\r\n            // Return error message\r\n            return element.getAttribute('data-error') || 'There is an error in the form';\r\n        }\r\n\r\n        var delError = function(element) {\r\n            var error = false;\r\n            // Remove class from this element\r\n            element.classList.remove('error');\r\n            // Get elements in the form\r\n            var elements = el.querySelectorAll(\"input, select, textarea\");\r\n            // Run all elements \r\n            for (var i = 0; i < elements.length; i++) {\r\n                if (elements[i].getAttribute('data-validation')) {\r\n                    if (elements[i].classList.contains('error')) {\r\n                        error = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (obj.options.submitButton) {\r\n                if (error) {\r\n                    obj.options.submitButton.setAttribute('disabled', true);\r\n                } else {\r\n                    obj.options.submitButton.removeAttribute('disabled');\r\n                }\r\n            }\r\n        }\r\n\r\n        // Blank\r\n        var test = '';\r\n        if (! element.value) {\r\n            test = addError(element);\r\n        } else if (element.getAttribute('data-email') && ! emailChecker(element.value)) {\r\n            test = addError(element);\r\n        } else if (element.getAttribute('data-password') && ! emailChecker(element.value)) {\r\n            test = addError(element);\r\n        } else {\r\n            if (element.classList.contains('error')) {\r\n                delError(element);\r\n            }\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    // Run form validation\r\n    obj.validate = function() {\r\n        var test = '';\r\n        // Get elements in the form\r\n        var elements = el.querySelectorAll(\"input, select, textarea\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (elements[i].getAttribute('data-validation')) {\r\n                if (test) {\r\n                    test += \"<br>\\r\\n\";\r\n                }\r\n                test += obj.validateElement(elements[i]);\r\n            }\r\n        }\r\n        return test;\r\n    }\r\n\r\n    // Check the form\r\n    obj.getError = function() {\r\n        // Validation\r\n        return obj.validation() ? true : false;\r\n    }\r\n\r\n    // Return the form hash\r\n    obj.setHash = function() {\r\n        return obj.getHash(obj.getElements());\r\n    }\r\n\r\n    // Get the form hash\r\n    obj.getHash = function(str) {\r\n        var hash = 0, i, chr;\r\n\r\n        if (str.length === 0) {\r\n            return hash;\r\n        } else {\r\n            for (i = 0; i < str.length; i++) {\r\n              chr = str.charCodeAt(i);\r\n              hash = ((hash << 5) - hash) + chr;\r\n              hash |= 0;\r\n            }\r\n        }\r\n\r\n        return hash;\r\n    }\r\n\r\n    // Is there any change in the form since start tracking?\r\n    obj.isChanged = function() {\r\n        var hash = obj.setHash();\r\n        return (obj.options.currentHash != hash);\r\n    }\r\n\r\n    // Restart tracking\r\n    obj.resetTracker = function() {\r\n        obj.options.currentHash = obj.setHash();\r\n        obj.options.ignore = false;\r\n    }\r\n\r\n    obj.reset = function() {\r\n        obj.options.currentHash = obj.setHash();\r\n        obj.options.ignore = false;\r\n    }\r\n\r\n    // Ignore flag\r\n    obj.setIgnore = function(ignoreFlag) {\r\n        obj.options.ignore = ignoreFlag ? true : false;\r\n    }\r\n\r\n    // Get form elements\r\n    obj.getElements = function(asArray) {\r\n        var data = {};\r\n        var elements = el.querySelectorAll(\"input, select, textarea\");\r\n\r\n        for (var i = 0; i < elements.length; i++) {\r\n            var element = elements[i];\r\n            var name = element.name;\r\n            var value = element.value;\r\n\r\n            if (name) {\r\n                data[name] = value;\r\n            }\r\n        }\r\n\r\n        return asArray == true ? data : JSON.stringify(data);\r\n    }\r\n\r\n    // Start tracking in one second\r\n    setTimeout(function() {\r\n        obj.options.currentHash = obj.setHash();\r\n    }, 1000);\r\n\r\n    // Alert\r\n    window.addEventListener(\"beforeunload\", function (e) {\r\n        if (obj.isChanged() && obj.options.ignore == false) {\r\n            var confirmationMessage =  obj.options.message? obj.options.message : \"\\o/\";\r\n\r\n            if (confirmationMessage) {\r\n                if (typeof e == 'undefined') {\r\n                    e = window.event;\r\n                }\r\n\r\n                if (e) {\r\n                    e.returnValue = confirmationMessage;\r\n                }\r\n\r\n                return confirmationMessage;\r\n            } else {\r\n                return void(0);\r\n            }\r\n        }\r\n    });\r\n\r\n    // Validations\r\n    el.addEventListener(\"keyup\", function(e) {\r\n        if (e.target.getAttribute('data-validation')) {\r\n            obj.validateElement(e.target);\r\n        }\r\n    });\r\n\r\n    el.tracker = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\n    return jSuites;\r\n\r\n})));"],"sourceRoot":""}