{"ast":null,"code":"/**\r\n * jExcel v3.9.1\r\n *\r\n * Author: Paul Hodel <paul.hodel@gmail.com>\r\n * Website: https://bossanova.uk/jexcel/\r\n * Description: Create amazing web based spreadsheets.\r\n *\r\n * This software is distribute under MIT License\r\n */\nif (!jSuites && typeof require === 'function') {\n  var jSuites = require('jsuites');\n\n  require('jsuites/dist/jsuites.css');\n}\n\n;\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : global.jexcel = factory();\n})(this, function () {\n  'use strict'; // Jexcel core object\n\n  var _jexcel = function jexcel(el, options) {\n    // Create jexcel object\n    var obj = {};\n    obj.options = {};\n\n    if (!(el instanceof Element || el instanceof HTMLDocument)) {\n      console.error('JEXCEL: el is not a valid DOM element');\n      return false;\n    } // Loading default configuration\n\n\n    var defaults = {\n      // External data\n      url: null,\n      // Data\n      data: null,\n      // Copy behavior\n      copyCompatibility: false,\n      // Rows and columns definitions\n      rows: [],\n      columns: [],\n      // Deprected legacy options\n      colHeaders: [],\n      colWidths: [],\n      colAlignments: [],\n      nestedHeaders: null,\n      // Column width that is used by default\n      defaultColWidth: 50,\n      defaultColAlign: 'center',\n      // Spare rows and columns\n      minSpareRows: 0,\n      minSpareCols: 0,\n      // Minimal table dimensions\n      minDimensions: [0, 0],\n      // Allow Export\n      allowExport: true,\n      // @type {boolean} - Include the header titles on download\n      includeHeadersOnDownload: false,\n      // Allow column sorting\n      columnSorting: true,\n      // Allow column dragging\n      columnDrag: false,\n      // Allow column resizing\n      columnResize: true,\n      // Allow row resizing\n      rowResize: false,\n      // Allow row dragging\n      rowDrag: true,\n      // Allow table edition\n      editable: true,\n      // Allow new rows\n      allowInsertRow: true,\n      // Allow new rows\n      allowManualInsertRow: true,\n      // Allow new columns\n      allowInsertColumn: true,\n      // Allow new rows\n      allowManualInsertColumn: true,\n      // Allow row delete\n      allowDeleteRow: true,\n      // Allow deleting of all rows\n      allowDeletingAllRows: false,\n      // Allow column delete\n      allowDeleteColumn: true,\n      // Allow rename column\n      allowRenameColumn: true,\n      // Allow comments\n      allowComments: false,\n      // Global wrap\n      wordWrap: false,\n      // Image options\n      imageOptions: null,\n      // CSV source\n      csv: null,\n      // Filename\n      csvFileName: 'jexcel',\n      // Consider first line as header\n      csvHeaders: true,\n      // Delimiters\n      csvDelimiter: ',',\n      // Disable corner selection\n      selectionCopy: true,\n      // Merged cells\n      mergeCells: {},\n      // Create toolbar\n      toolbar: null,\n      // Allow search\n      search: false,\n      // Create pagination\n      pagination: false,\n      paginationOptions: null,\n      // Full screen\n      fullscreen: false,\n      // Lazy loading\n      lazyLoading: false,\n      loadingSpin: false,\n      // Table overflow\n      tableOverflow: false,\n      tableHeight: '300px',\n      tableWidth: null,\n      // Meta\n      meta: null,\n      // Style\n      style: null,\n      // Execute formulas\n      parseFormulas: true,\n      autoIncrement: true,\n      autoCasting: true,\n      // Event handles\n      onundo: null,\n      onredo: null,\n      onload: null,\n      onchange: null,\n      onbeforechange: null,\n      onafterchanges: null,\n      onbeforeinsertrow: null,\n      oninsertrow: null,\n      onbeforeinsertcolumn: null,\n      oninsertcolumn: null,\n      onbeforedeleterow: null,\n      ondeleterow: null,\n      onbeforedeletecolumn: null,\n      ondeletecolumn: null,\n      onmoverow: null,\n      onmovecolumn: null,\n      onresizerow: null,\n      onresizecolumn: null,\n      onsort: null,\n      onselection: null,\n      onpaste: null,\n      onbeforepaste: null,\n      onmerge: null,\n      onfocus: null,\n      onblur: null,\n      onchangeheader: null,\n      oneditionstart: null,\n      oneditionend: null,\n      onchangestyle: null,\n      onchangemeta: null,\n      onchangepage: null,\n      // Customize any cell behavior\n      updateTable: null,\n      // Detach the HTML table when calling updateTable\n      detachForUpdates: false,\n      // Texts\n      text: {\n        noRecordsFound: 'No records found',\n        showingPage: 'Showing page {0} of {1} entries',\n        show: 'Show ',\n        search: 'Search',\n        entries: ' entries',\n        columnName: 'Column name',\n        insertANewColumnBefore: 'Insert a new column before',\n        insertANewColumnAfter: 'Insert a new column after',\n        deleteSelectedColumns: 'Delete selected columns',\n        renameThisColumn: 'Rename this column',\n        orderAscending: 'Order ascending',\n        orderDescending: 'Order descending',\n        insertANewRowBefore: 'Insert a new row before',\n        insertANewRowAfter: 'Insert a new row after',\n        deleteSelectedRows: 'Delete selected rows',\n        editComments: 'Edit comments',\n        addComments: 'Add comments',\n        comments: 'Comments',\n        clearComments: 'Clear comments',\n        copy: 'Copy...',\n        paste: 'Paste...',\n        saveAs: 'Save as...',\n        about: 'About',\n        areYouSureToDeleteTheSelectedRows: 'Are you sure to delete the selected rows?',\n        areYouSureToDeleteTheSelectedColumns: 'Are you sure to delete the selected columns?',\n        thisActionWillDestroyAnyExistingMergedCellsAreYouSure: 'This action will destroy any existing merged cells. Are you sure?',\n        thisActionWillClearYourSearchResultsAreYouSure: 'This action will clear your search results. Are you sure?',\n        thereIsAConflictWithAnotherMergedCell: 'There is a conflict with another merged cell',\n        invalidMergeProperties: 'Invalid merged properties',\n        cellAlreadyMerged: 'Cell already merged',\n        noCellsSelected: 'No cells selected'\n      },\n      // About message\n      about: \"jExcel CE Spreadsheet\\nVersion 3.9.1\\nAuthor: Paul Hodel <paul.hodel@gmail.com>\\nWebsite: https://bossanova.uk/jexcel/v3\"\n    }; // Loading initial configuration from user\n\n    for (var property in defaults) {\n      if (options && options.hasOwnProperty(property)) {\n        if (property === 'text') {\n          obj.options[property] = defaults[property];\n\n          for (var textKey in options[property]) {\n            if (options[property].hasOwnProperty(textKey)) {\n              obj.options[property][textKey] = options[property][textKey];\n            }\n          }\n        } else {\n          obj.options[property] = options[property];\n        }\n      } else {\n        obj.options[property] = defaults[property];\n      }\n    } // Global elements\n\n\n    obj.el = el;\n    obj.corner = null;\n    obj.contextMenu = null;\n    obj.textarea = null;\n    obj.ads = null;\n    obj.content = null;\n    obj.table = null;\n    obj.thead = null;\n    obj.tbody = null;\n    obj.rows = [];\n    obj.results = null;\n    obj.searchInput = null;\n    obj.toolbar = null;\n    obj.pagination = null;\n    obj.pageNumber = null;\n    obj.headerContainer = null;\n    obj.colgroupContainer = null; // Containers\n\n    obj.headers = [];\n    obj.records = [];\n    obj.history = [];\n    obj.formula = [];\n    obj.colgroup = [];\n    obj.selection = [];\n    obj.highlighted = [];\n    obj.selectedCell = null;\n    obj.selectedContainer = null;\n    obj.style = [];\n    obj.data = null; // Internal controllers\n\n    obj.cursor = null;\n    obj.historyIndex = -1;\n    obj.ignoreEvents = false;\n    obj.ignoreHistory = false;\n    obj.edition = null;\n    obj.hashString = null;\n    obj.resizing = null;\n    obj.dragging = null; // Lazy loading\n\n    if (obj.options.lazyLoading == true && obj.options.tableOverflow == false && obj.options.fullscreen == false) {\n      console.error('JEXCEL: The lazyloading only works when tableOverflow = yes or fullscreen = yes');\n      obj.options.lazyLoading = false;\n    }\n    /**\n     * Activate/Disable fullscreen \n     * use programmatically : table.fullscreen(); or table.fullscreen(true); or table.fullscreen(false);\n     * @Param {boolean} activate\n     */\n\n\n    obj.fullscreen = function (activate) {\n      // If activate not defined, get reverse options.fullscreen\n      if (activate == null) {\n        activate = !obj.options.fullscreen;\n      } // If change\n\n\n      if (obj.options.fullscreen != activate) {\n        obj.options.fullscreen = activate; // Test LazyLoading conflict\n\n        if (activate == true) {\n          el.classList.add('fullscreen');\n        } else {\n          el.classList.remove('fullscreen');\n        }\n      }\n    };\n    /**\n     * Prepare the jexcel table\n     * \n     * @Param config\n     */\n\n\n    obj.prepareTable = function () {\n      // Loading initial data from remote sources\n      var results = []; // Number of columns\n\n      var size = obj.options.columns.length;\n\n      if (obj.options.data && typeof obj.options.data[0] !== 'undefined') {\n        // Data keys\n        var keys = Object.keys(obj.options.data[0]);\n\n        if (keys.length > size) {\n          size = keys.length;\n        }\n      } // Minimal dimensions\n\n\n      if (obj.options.minDimensions[0] > size) {\n        size = obj.options.minDimensions[0];\n      } // Requests\n\n\n      var multiple = []; // Preparations\n\n      for (var i = 0; i < size; i++) {\n        // Deprected options. You should use only columns\n        if (!obj.options.colHeaders[i]) {\n          obj.options.colHeaders[i] = '';\n        }\n\n        if (!obj.options.colWidths[i]) {\n          obj.options.colWidths[i] = obj.options.defaultColWidth;\n        }\n\n        if (!obj.options.colAlignments[i]) {\n          obj.options.colAlignments[i] = obj.options.defaultColAlign;\n        } // Default column description\n\n\n        if (!obj.options.columns[i]) {\n          obj.options.columns[i] = {\n            type: 'text'\n          };\n        } else if (!obj.options.columns[i].type) {\n          obj.options.columns[i].type = 'text';\n        }\n\n        if (!obj.options.columns[i].name) {\n          obj.options.columns[i].name = keys && keys[i] ? keys[i] : i;\n        }\n\n        if (!obj.options.columns[i].source) {\n          obj.options.columns[i].source = [];\n        }\n\n        if (!obj.options.columns[i].options) {\n          obj.options.columns[i].options = [];\n        }\n\n        if (!obj.options.columns[i].editor) {\n          obj.options.columns[i].editor = null;\n        }\n\n        if (!obj.options.columns[i].allowEmpty) {\n          obj.options.columns[i].allowEmpty = false;\n        }\n\n        if (!obj.options.columns[i].title) {\n          obj.options.columns[i].title = obj.options.colHeaders[i] ? obj.options.colHeaders[i] : '';\n        }\n\n        if (!obj.options.columns[i].width) {\n          obj.options.columns[i].width = obj.options.colWidths[i] ? obj.options.colWidths[i] : obj.options.defaultColWidth;\n        }\n\n        if (!obj.options.columns[i].align) {\n          obj.options.columns[i].align = obj.options.colAlignments[i] ? obj.options.colAlignments[i] : 'center';\n        } // Pre-load initial source for json autocomplete\n\n\n        if (obj.options.columns[i].type == 'autocomplete' || obj.options.columns[i].type == 'dropdown') {\n          // if remote content\n          if (obj.options.columns[i].url) {\n            multiple.push(jSuites.ajax({\n              url: obj.options.columns[i].url,\n              index: i,\n              method: 'GET',\n              dataType: 'json',\n              multiple: multiple,\n              success: function success(data) {\n                var source = [];\n\n                for (var i = 0; i < data.length; i++) {\n                  obj.options.columns[this.index].source.push(data[i]);\n                }\n              },\n              complete: function complete() {\n                obj.createTable();\n              }\n            }));\n          }\n        } else if (obj.options.columns[i].type == 'calendar') {\n          // Default format for date columns\n          if (!obj.options.columns[i].options.format) {\n            obj.options.columns[i].options.format = 'DD/MM/YYYY';\n          }\n        }\n      } // On complete\n\n\n      if (!multiple.length) {\n        obj.createTable();\n      }\n    };\n\n    obj.createTable = function () {\n      // Elements\n      obj.table = document.createElement('table');\n      obj.thead = document.createElement('thead');\n      obj.tbody = document.createElement('tbody'); // Create headers controllers\n\n      obj.headers = [];\n      obj.colgroup = []; // Create table container\n\n      obj.content = document.createElement('div');\n      obj.content.classList.add('jexcel_content'); // Create toolbar object\n\n      obj.toolbar = document.createElement('div');\n      obj.toolbar.classList.add('jexcel_toolbar'); // Search\n\n      var searchContainer = document.createElement('div');\n      var searchText = document.createTextNode(obj.options.text.search + ': ');\n      obj.searchInput = document.createElement('input');\n      obj.searchInput.classList.add('jexcel_search');\n      searchContainer.appendChild(searchText);\n      searchContainer.appendChild(obj.searchInput);\n\n      obj.searchInput.onfocus = function () {\n        obj.resetSelection();\n      }; // Pagination select option\n\n\n      var paginationUpdateContainer = document.createElement('div');\n\n      if (obj.options.pagination > 0 && obj.options.paginationOptions && obj.options.paginationOptions.length > 0) {\n        obj.paginationDropdown = document.createElement('select');\n        obj.paginationDropdown.classList.add('jexcel_pagination_dropdown');\n\n        obj.paginationDropdown.onchange = function () {\n          obj.options.pagination = parseInt(this.value);\n          obj.page(0);\n        };\n\n        for (var i = 0; i < obj.options.paginationOptions.length; i++) {\n          var temp = document.createElement('option');\n          temp.value = obj.options.paginationOptions[i];\n          temp.innerHTML = obj.options.paginationOptions[i];\n          obj.paginationDropdown.appendChild(temp);\n        }\n\n        paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.show));\n        paginationUpdateContainer.appendChild(obj.paginationDropdown);\n        paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.entries));\n      } // Filter and pagination container\n\n\n      obj.filter = document.createElement('div');\n      obj.filter.classList.add('jexcel_filter');\n      obj.filter.appendChild(paginationUpdateContainer);\n      obj.filter.appendChild(searchContainer); // Colsgroup\n\n      obj.colgroupContainer = document.createElement('colgroup');\n      var tempCol = document.createElement('col');\n      tempCol.setAttribute('width', '50');\n      obj.colgroupContainer.appendChild(tempCol); // Nested\n\n      if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n        // Flexible way to handle nestedheaders\n        if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n          for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n            obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[j]));\n          }\n        } else {\n          obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));\n        }\n      } // Row\n\n\n      obj.headerContainer = document.createElement('tr');\n      var tempCol = document.createElement('td');\n      tempCol.classList.add('jexcel_selectall');\n      obj.headerContainer.appendChild(tempCol);\n\n      for (var i = 0; i < obj.options.columns.length; i++) {\n        // Create header\n        obj.createCellHeader(i); // Append cell to the container\n\n        obj.headerContainer.appendChild(obj.headers[i]);\n        obj.colgroupContainer.appendChild(obj.colgroup[i]);\n      }\n\n      obj.thead.appendChild(obj.headerContainer); // Content table\n\n      obj.table = document.createElement('table');\n      obj.table.classList.add('jexcel');\n      obj.table.setAttribute('cellpadding', '0');\n      obj.table.setAttribute('cellspacing', '0');\n      obj.table.setAttribute('unselectable', 'yes');\n      obj.table.setAttribute('onselectstart', 'return false');\n      obj.table.appendChild(obj.colgroupContainer);\n      obj.table.appendChild(obj.thead);\n      obj.table.appendChild(obj.tbody); // Spreadsheet corner\n\n      obj.corner = document.createElement('div');\n      obj.corner.className = 'jexcel_corner';\n      obj.corner.setAttribute('unselectable', 'on');\n      obj.corner.setAttribute('onselectstart', 'return false');\n\n      if (obj.options.selectionCopy == false) {\n        obj.corner.style.display = 'none';\n      } // Textarea helper\n\n\n      obj.textarea = document.createElement('textarea');\n      obj.textarea.className = 'jexcel_textarea';\n      obj.textarea.id = 'jexcel_textarea';\n      obj.textarea.tabIndex = '-1'; // Contextmenu container\n\n      obj.contextMenu = document.createElement('div');\n      obj.contextMenu.className = 'jexcel_contextmenu'; // Create element\n\n      jSuites.contextmenu(obj.contextMenu, {\n        onclick: function onclick() {\n          obj.contextMenu.contextmenu.close(false);\n        }\n      }); // Powered by jExcel\n\n      var ads = document.createElement('a');\n      ads.setAttribute('href', 'https://bossanova.uk/jexcel/');\n      obj.ads = document.createElement('div');\n      obj.ads.className = 'jexcel_about';\n\n      if (typeof sessionStorage !== \"undefined\" && !sessionStorage.getItem('jexcel')) {\n        sessionStorage.setItem('jexcel', true);\n        var img = document.createElement('img');\n        img.src = '//bossanova.uk/jexcel/logo.png';\n        ads.appendChild(img);\n      }\n\n      var span = document.createElement('span');\n      span.innerHTML = 'Jexcel spreadsheet';\n      ads.appendChild(span);\n      obj.ads.appendChild(ads); // Create table container TODO: frozen columns\n\n      var container = document.createElement('div');\n      container.classList.add('jexcel_table'); // Pagination\n\n      obj.pagination = document.createElement('div');\n      obj.pagination.classList.add('jexcel_pagination');\n      var paginationInfo = document.createElement('div');\n      var paginationPages = document.createElement('div');\n      obj.pagination.appendChild(paginationInfo);\n      obj.pagination.appendChild(paginationPages); // Hide pagination if not in use\n\n      if (!obj.options.pagination) {\n        obj.pagination.style.display = 'none';\n      } // Append containers to the table\n\n\n      if (obj.options.search == true) {\n        el.appendChild(obj.filter);\n      } // Elements\n\n\n      obj.content.appendChild(obj.table);\n      obj.content.appendChild(obj.corner);\n      obj.content.appendChild(obj.textarea);\n      el.appendChild(obj.toolbar);\n      el.appendChild(obj.content);\n      el.appendChild(obj.pagination);\n      el.appendChild(obj.contextMenu);\n      el.appendChild(obj.ads);\n      el.classList.add('jexcel_container'); // Create toolbar\n\n      if (obj.options.toolbar && obj.options.toolbar.length) {\n        obj.createToolbar();\n      } // Fullscreen\n\n\n      if (obj.options.fullscreen == true) {\n        el.classList.add('fullscreen');\n      } else {\n        // Overflow\n        if (obj.options.tableOverflow == true) {\n          if (obj.options.tableHeight) {\n            obj.content.style['overflow-y'] = 'auto';\n            obj.content.style.maxHeight = obj.options.tableHeight;\n          }\n\n          if (obj.options.tableWidth) {\n            obj.content.style['overflow-x'] = 'auto';\n            obj.content.style.width = obj.options.tableWidth;\n          }\n        }\n      } // With toolbars\n\n\n      if (obj.options.tableOverflow != true && obj.options.toolbar) {\n        el.classList.add('with-toolbar');\n      } // Actions\n\n\n      if (obj.options.columnDrag == true) {\n        obj.thead.classList.add('draggable');\n      }\n\n      if (obj.options.columnResize == true) {\n        obj.thead.classList.add('resizable');\n      }\n\n      if (obj.options.rowDrag == true) {\n        obj.tbody.classList.add('draggable');\n      }\n\n      if (obj.options.rowResize == true) {\n        obj.tbody.classList.add('resizable');\n      } // Load data\n\n\n      obj.setData(); // Style\n\n      if (obj.options.style) {\n        obj.setStyle(obj.options.style, null, null, 1, 1);\n      }\n    };\n    /**\r\n     * Refresh the data\r\n     * \r\n     * @return void\r\n     */\n\n\n    obj.refresh = function () {\n      if (obj.options.url) {\n        // Loading\n        if (obj.options.loadingSpin == true) {\n          jSuites.loading.show();\n        }\n\n        jSuites.ajax({\n          url: obj.options.url,\n          method: 'GET',\n          dataType: 'json',\n          success: function success(result) {\n            // Data\n            obj.options.data = result.data ? result.data : result; // Prepare table\n\n            obj.setData(); // Hide spin\n\n            if (obj.options.loadingSpin == true) {\n              jSuites.loading.hide();\n            }\n          }\n        });\n      } else {\n        obj.setData();\n      }\n    };\n    /**\n     * Set data\n     * \n     * @param array data In case no data is sent, default is reloaded\n     * @return void\n     */\n\n\n    obj.setData = function (data) {\n      // Update data\n      if (data) {\n        if (typeof data == 'string') {\n          data = JSON.parse(data);\n        }\n\n        obj.options.data = data;\n      } // Data\n\n\n      if (!obj.options.data) {\n        obj.options.data = [];\n      } // Prepare data\n\n\n      if (obj.options.data) {\n        var data = [];\n\n        for (var j = 0; j < obj.options.data.length; j++) {\n          var row = [];\n\n          for (var i = 0; i < obj.options.columns.length; i++) {\n            row[i] = obj.options.data[j][obj.options.columns[i].name];\n          }\n\n          data.push(row);\n        }\n\n        obj.options.data = data;\n      } // Adjust minimal dimensions\n\n\n      var j = 0;\n      var i = 0;\n      var size_i = obj.options.columns.length;\n      var size_j = obj.options.data.length;\n      var min_i = obj.options.minDimensions[0];\n      var min_j = obj.options.minDimensions[1];\n      var max_i = min_i > size_i ? min_i : size_i;\n      var max_j = min_j > size_j ? min_j : size_j;\n\n      for (j = 0; j < max_j; j++) {\n        for (i = 0; i < max_i; i++) {\n          if (obj.options.data[j] == undefined) {\n            obj.options.data[j] = [];\n          }\n\n          if (obj.options.data[j][i] == undefined) {\n            obj.options.data[j][i] = '';\n          }\n        }\n      } // Reset containers\n\n\n      obj.rows = [];\n      obj.results = null;\n      obj.records = [];\n      obj.history = []; // Reset internal controllers\n\n      obj.historyIndex = -1; // Reset data\n\n      obj.tbody.innerHTML = ''; // Lazy loading\n\n      if (obj.options.lazyLoading == true) {\n        // Load only 100 records\n        var startNumber = 0;\n        var finalNumber = obj.options.data.length < 100 ? obj.options.data.length : 100;\n\n        if (obj.options.pagination) {\n          obj.options.pagination = false;\n          console.error('JEXCEL: Pagination will be disable due the lazyLoading');\n        }\n      } else if (obj.options.pagination) {\n        // Pagination\n        if (!obj.pageNumber) {\n          obj.pageNumber = 0;\n        }\n\n        var quantityPerPage = obj.options.pagination;\n        startNumber = obj.options.pagination * obj.pageNumber;\n        finalNumber = obj.options.pagination * obj.pageNumber + obj.options.pagination;\n\n        if (obj.options.data.length < finalNumber) {\n          finalNumber = obj.options.data.length;\n        }\n      } else {\n        var startNumber = 0;\n        var finalNumber = obj.options.data.length;\n      } // Append nodes to the HTML\n\n\n      for (j = 0; j < obj.options.data.length; j++) {\n        // Create row\n        var tr = obj.createRow(j, obj.options.data[j]); // Append line to the table\n\n        if (j >= startNumber && j < finalNumber) {\n          obj.tbody.appendChild(tr);\n        }\n      }\n\n      if (obj.options.lazyLoading == true) {// Do not create pagination with lazyloading activated\n      } else if (obj.options.pagination) {\n        obj.updatePagination();\n      } // Merge cells\n\n\n      if (obj.options.mergeCells) {\n        var keys = Object.keys(obj.options.mergeCells);\n\n        for (var i = 0; i < keys.length; i++) {\n          var num = obj.options.mergeCells[keys[i]];\n          obj.setMerge(keys[i], num[0], num[1], 1);\n        }\n      } // Updata table with custom configurations if applicable\n\n\n      obj.updateTable(); // Onload\n\n      if (!obj.ignoreEvents) {\n        if (typeof obj.options.onload == 'function') {\n          obj.options.onload(el, obj);\n        }\n      }\n    };\n    /**\n     * Get the whole table data\n     * \n     * @param bool get highlighted cells only\n     * @return array data\n     */\n\n\n    obj.getData = function (highlighted, dataOnly) {\n      // Control vars\n      var dataset = [];\n      var px = 0;\n      var py = 0; // Data type\n\n      var dataType = dataOnly == true || obj.options.copyCompatibility == false ? true : false; // Column and row length\n\n      var x = obj.options.columns.length;\n      var y = obj.options.data.length; // Go through the columns to get the data\n\n      for (var j = 0; j < y; j++) {\n        px = 0;\n\n        for (var i = 0; i < x; i++) {\n          // Cell selected or fullset\n          if (!highlighted || obj.records[j][i].classList.contains('highlight')) {\n            // Get value\n            if (!dataset[py]) {\n              dataset[py] = [];\n            }\n\n            if (!dataType) {\n              dataset[py][px] = obj.records[j][i].innerHTML;\n            } else {\n              dataset[py][px] = obj.options.data[j][i];\n            }\n\n            px++;\n          }\n        }\n\n        if (px > 0) {\n          py++;\n        }\n      }\n\n      return dataset;\n    };\n    /**\n     * Get the whole table data\n     * \n     * @param integer row number\n     * @return string value\n     */\n\n\n    obj.getJson = function (highlighted) {\n      // Control vars\n      var data = []; // Column and row length\n\n      var x = obj.options.columns.length;\n      var y = obj.options.data.length; // Go through the columns to get the data\n\n      for (var j = 0; j < y; j++) {\n        var row = null;\n\n        for (var i = 0; i < x; i++) {\n          if (!highlighted || obj.records[j][i].classList.contains('highlight')) {\n            if (row == null) {\n              row = {};\n            }\n\n            row[obj.options.columns[i].name] = obj.options.data[j][i];\n          }\n        }\n\n        if (row != null) {\n          data.push(row);\n        }\n      }\n\n      return data;\n    };\n    /**\n     * Get a row data by rowNumber\n     */\n\n\n    obj.getRowData = function (rowNumber) {\n      return obj.options.data[rowNumber];\n    };\n    /**\n     * Set a row data by rowNumber\n     */\n\n\n    obj.setRowData = function (rowNumber, data) {\n      for (var i = 0; i < obj.headers.length; i++) {\n        // Update cell\n        var columnName = _jexcel.getColumnNameFromId([i, rowNumber]); // Set value\n\n\n        if (data[i] != null) {\n          obj.setValue(columnName, data[i]);\n        }\n      }\n    };\n    /**\n     * Get a column data by columnNumber\n     */\n\n\n    obj.getColumnData = function (columnNumber) {\n      var dataset = []; // Go through the rows to get the data\n\n      for (var j = 0; j < obj.options.data.length; j++) {\n        dataset.push(obj.options.data[j][columnNumber]);\n      }\n\n      return dataset;\n    };\n    /**\n     * Set a column data by colNumber\n     */\n\n\n    obj.setColumnData = function (colNumber, data) {\n      for (var j = 0; j < obj.rows.length; j++) {\n        // Update cell\n        var columnName = _jexcel.getColumnNameFromId([colNumber, j]); // Set value\n\n\n        if (data[j] != null) {\n          obj.setValue(columnName, data[j]);\n        }\n      }\n    };\n    /**\n     * Create row\n     */\n\n\n    obj.createRow = function (j, data) {\n      // Create container\n      if (!obj.records[j]) {\n        obj.records[j] = [];\n      } // Default data\n\n\n      if (!data) {\n        var data = obj.options.data[j];\n      } // New line of data to be append in the table\n\n\n      obj.rows[j] = document.createElement('tr');\n      obj.rows[j].setAttribute('data-y', j); // Definitions\n\n      if (obj.options.rows[j]) {\n        if (obj.options.rows[j].height) {\n          obj.rows[j].style.height = obj.options.rows[j].height;\n        }\n      } // Row number label\n\n\n      var td = document.createElement('td');\n      td.innerHTML = parseInt(j + 1);\n      td.setAttribute('data-y', j);\n      td.className = 'jexcel_row';\n      obj.rows[j].appendChild(td); // Data columns\n\n      for (i = 0; i < obj.options.columns.length; i++) {\n        // New column of data to be append in the line\n        obj.records[j][i] = obj.createCell(i, j, data[i]); // Add column to the row\n\n        obj.rows[j].appendChild(obj.records[j][i]);\n      } // Add row to the table body\n\n\n      return obj.rows[j];\n    };\n    /**\n     * Create cell\n     */\n\n\n    obj.createCell = function (i, j, value) {\n      // Create cell and properties\n      var td = document.createElement('td');\n      td.setAttribute('data-x', i);\n      td.setAttribute('data-y', j); // Hidden column\n\n      if (obj.options.columns[i].type == 'hidden') {\n        td.style.display = 'none';\n        td.innerHTML = value;\n      } else if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\n        // Create input\n        var element = document.createElement('input');\n        element.type = obj.options.columns[i].type;\n        element.name = 'c' + i;\n        element.checked = value == 1 || value == true || value == 'true' ? true : false;\n\n        element.onclick = function () {\n          obj.setValue(td, this.checked);\n        };\n\n        if (obj.options.columns[i].readOnly == true) {\n          element.setAttribute('disabled', 'disabled');\n        } // Append to the table\n\n\n        td.appendChild(element); // Make sure the values are correct\n\n        obj.options.data[j][i] = element.checked;\n      } else if (obj.options.columns[i].type == 'calendar') {\n        // Try formatted date\n        var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[i].options.format); // Create calendar cell\n\n        td.innerHTML = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[i].options.format);\n      } else if (obj.options.columns[i].type == 'dropdown' || obj.options.columns[i].type == 'autocomplete') {\n        // Create dropdown cell\n        td.classList.add('jexcel_dropdown');\n        td.innerHTML = obj.getDropDownValue(i, value);\n      } else if (obj.options.columns[i].type == 'color') {\n        if (obj.options.columns[i].render == 'square') {\n          var color = document.createElement('div');\n          color.className = 'color';\n          color.style.backgroundColor = value;\n          td.appendChild(color);\n        } else {\n          td.style.color = value;\n          td.innerHTML = value;\n        }\n      } else if (obj.options.columns[i].type == 'image') {\n        if (value && value.substr(0, 10) == 'data:image') {\n          var img = document.createElement('img');\n          img.src = value;\n          td.appendChild(img);\n        }\n      } else {\n        if (('' + value).substr(0, 1) == '=' && obj.options.parseFormulas == true) {\n          value = obj.executeFormula(value, i, j);\n        }\n\n        if (obj.options.columns[i].mask) {\n          var decimal = obj.options.columns[i].decimal || '.';\n          value = '' + jSuites.mask.run(value, obj.options.columns[i].mask, decimal);\n        }\n\n        td.innerHTML = value;\n      } // Readonly\n\n\n      if (obj.options.columns[i].readOnly == true) {\n        td.className = 'readonly';\n      } // Text align\n\n\n      var colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\n      td.style.textAlign = colAlign; // Wrap option\n\n      if (obj.options.columns[i].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[i].wordWrap == true || td.innerHTML.length > 200)) {\n        td.style.whiteSpace = 'pre-wrap';\n      } // Overflow\n\n\n      if (i > 0) {\n        if (value || td.innerHTML) {\n          obj.records[j][i - 1].style.overflow = 'hidden';\n        } else {\n          if (i == obj.options.columns.length - 1) {\n            td.style.overflow = 'hidden';\n          }\n        }\n      }\n\n      return td;\n    };\n\n    obj.createCellHeader = function (colNumber) {\n      // Create col global control\n      var colWidth = obj.options.columns[colNumber].width ? obj.options.columns[colNumber].width : obj.options.defaultColWidth;\n      var colAlign = obj.options.columns[colNumber].align ? obj.options.columns[colNumber].align : obj.options.defaultColAlign; // Create header cell\n\n      obj.headers[colNumber] = document.createElement('td');\n      obj.headers[colNumber].innerHTML = obj.options.columns[colNumber].title ? obj.options.columns[colNumber].title : _jexcel.getColumnName(colNumber);\n      obj.headers[colNumber].setAttribute('data-x', colNumber);\n      obj.headers[colNumber].style.textAlign = colAlign;\n\n      if (obj.options.columns[colNumber].title) {\n        obj.headers[colNumber].setAttribute('title', obj.options.columns[colNumber].title);\n      } // Width control\n\n\n      obj.colgroup[colNumber] = document.createElement('col');\n      obj.colgroup[colNumber].setAttribute('width', colWidth); // Hidden column\n\n      if (obj.options.columns[colNumber].type == 'hidden') {\n        obj.headers[colNumber].style.display = 'none';\n        obj.colgroup[colNumber].style.display = 'none';\n      }\n    };\n\n    obj.createNestedHeader = function (nestedInformation) {\n      var tr = document.createElement('tr');\n      tr.classList.add('jexcel_nested');\n      var td = document.createElement('td');\n      tr.appendChild(td);\n      var headerIndex = 0;\n\n      for (var i = 0; i < nestedInformation.length; i++) {\n        // Default values\n        if (!nestedInformation[i].colspan) {\n          nestedInformation[i].colspan = 1;\n        }\n\n        if (!nestedInformation[i].align) {\n          nestedInformation[i].align = 'center';\n        }\n\n        if (!nestedInformation[i].title) {\n          nestedInformation[i].title = '';\n        } // Number of columns\n\n\n        var numberOfColumns = nestedInformation[i].colspan; // Classes container\n\n        var column = []; // Header classes for this cell\n\n        for (var x = 0; x < numberOfColumns; x++) {\n          if (obj.options.columns[headerIndex] && obj.options.columns[headerIndex].type == 'hidden') {\n            numberOfColumns++;\n          }\n\n          column.push(headerIndex);\n          headerIndex++;\n        } // Created the nested cell\n\n\n        var td = document.createElement('td');\n        td.setAttribute('data-column', column.join(','));\n        td.setAttribute('colspan', nestedInformation[i].colspan);\n        td.setAttribute('align', nestedInformation[i].align);\n        td.innerHTML = nestedInformation[i].title;\n        tr.appendChild(td);\n      }\n\n      return tr;\n    };\n    /**\n     * Create toolbar\n     */\n\n\n    obj.createToolbar = function (toolbar) {\n      if (toolbar) {\n        obj.options.toolbar = toolbar;\n      } else {\n        var toolbar = obj.options.toolbar;\n      }\n\n      for (var i = 0; i < toolbar.length; i++) {\n        if (toolbar[i].type == 'i') {\n          var toolbarItem = document.createElement('i');\n          toolbarItem.classList.add('jexcel_toolbar_item');\n          toolbarItem.classList.add('material-icons');\n          toolbarItem.setAttribute('data-k', toolbar[i].k);\n          toolbarItem.setAttribute('data-v', toolbar[i].v); // Tooltip\n\n          if (toolbar[i].tooltip) {\n            toolbarItem.setAttribute('title', toolbar[i].tooltip);\n          } // Handle click\n\n\n          if (toolbar[i].onclick && typeof toolbar[i].onclick) {\n            toolbarItem.onclick = toolbar[i].onclick;\n          } else {\n            toolbarItem.onclick = function () {\n              var k = this.getAttribute('data-k');\n              var v = this.getAttribute('data-v');\n              obj.setStyle(obj.highlighted, k, v);\n            };\n          } // Append element\n\n\n          toolbarItem.innerHTML = toolbar[i].content;\n          obj.toolbar.appendChild(toolbarItem);\n        } else if (toolbar[i].type == 'select') {\n          var toolbarItem = document.createElement('select');\n          toolbarItem.classList.add('jexcel_toolbar_item');\n          toolbarItem.setAttribute('data-k', toolbar[i].k); // Tooltip\n\n          if (toolbar[i].tooltip) {\n            toolbarItem.setAttribute('title', toolbar[i].tooltip);\n          } // Handle onchange\n\n\n          if (toolbar[i].onchange && typeof toolbar[i].onchange) {\n            toolbarItem.onchange = toolbar[i].onchange;\n          } else {\n            toolbarItem.onchange = function () {\n              var k = this.getAttribute('data-k');\n              obj.setStyle(obj.highlighted, k, this.value);\n            };\n          } // Add options to the dropdown\n\n\n          for (var j = 0; j < toolbar[i].v.length; j++) {\n            var toolbarDropdownOption = document.createElement('option');\n            toolbarDropdownOption.value = toolbar[i].v[j];\n            toolbarDropdownOption.innerHTML = toolbar[i].v[j];\n            toolbarItem.appendChild(toolbarDropdownOption);\n          }\n\n          obj.toolbar.appendChild(toolbarItem);\n        } else if (toolbar[i].type == 'color') {\n          var toolbarItem = document.createElement('i');\n          toolbarItem.classList.add('jexcel_toolbar_item');\n          toolbarItem.classList.add('material-icons');\n          toolbarItem.setAttribute('data-k', toolbar[i].k);\n          toolbarItem.setAttribute('data-v', ''); // Tooltip\n\n          if (toolbar[i].tooltip) {\n            toolbarItem.setAttribute('title', toolbar[i].tooltip);\n          }\n\n          obj.toolbar.appendChild(toolbarItem);\n\n          toolbarItem.onclick = function () {\n            this.color.open();\n          };\n\n          toolbarItem.innerHTML = toolbar[i].content;\n          jSuites.color(toolbarItem, {\n            onchange: function onchange(o, v) {\n              var k = o.getAttribute('data-k');\n              obj.setStyle(obj.highlighted, k, v);\n            }\n          });\n        }\n      }\n    };\n    /**\n     * Merge cells\n     * @param cellName\n     * @param colspan\n     * @param rowspan\n     * @param ignoreHistoryAndEvents\n     */\n\n\n    obj.setMerge = function (cellName, colspan, rowspan, ignoreHistoryAndEvents) {\n      var test = false;\n\n      if (!cellName) {\n        if (!obj.highlighted.length) {\n          alert(obj.options.text.noCellsSelected);\n          return null;\n        } else {\n          var x1 = parseInt(obj.highlighted[0].getAttribute('data-x'));\n          var y1 = parseInt(obj.highlighted[0].getAttribute('data-y'));\n          var x2 = parseInt(obj.highlighted[obj.highlighted.length - 1].getAttribute('data-x'));\n          var y2 = parseInt(obj.highlighted[obj.highlighted.length - 1].getAttribute('data-y'));\n\n          var cellName = _jexcel.getColumnNameFromId([x1, y1]);\n\n          var colspan = x2 - x1 + 1;\n          var rowspan = y2 - y1 + 1;\n        }\n      }\n\n      var cell = _jexcel.getIdFromColumnName(cellName, true);\n\n      if (obj.options.mergeCells[cellName]) {\n        if (obj.records[cell[1]][cell[0]].getAttribute('data-merged')) {\n          test = obj.options.text.cellAlreadyMerged;\n        }\n      } else if ((!colspan || colspan < 2) && (!rowspan || rowspan < 2)) {\n        test = obj.options.text.invalidMergeProperties;\n      } else {\n        var cells = [];\n\n        for (var j = cell[1]; j < cell[1] + rowspan; j++) {\n          for (var i = cell[0]; i < cell[0] + colspan; i++) {\n            var columnName = _jexcel.getColumnNameFromId([i, j]);\n\n            if (obj.records[j][i].getAttribute('data-merged')) {\n              test = obj.options.text.thereIsAConflictWithAnotherMergedCell;\n            }\n          }\n        }\n      }\n\n      if (test) {\n        alert(test);\n      } else {\n        // Add property\n        if (colspan > 1) {\n          obj.records[cell[1]][cell[0]].setAttribute('colspan', colspan);\n        } else {\n          colspan = 1;\n        }\n\n        if (rowspan > 1) {\n          obj.records[cell[1]][cell[0]].setAttribute('rowspan', rowspan);\n        } else {\n          rowspan = 1;\n        } // Keep links to the existing nodes\n\n\n        obj.options.mergeCells[cellName] = [colspan, rowspan, []]; // Mark cell as merged\n\n        obj.records[cell[1]][cell[0]].setAttribute('data-merged', 'true'); // Overflow\n\n        obj.records[cell[1]][cell[0]].style.overflow = 'hidden'; // History data\n\n        var data = []; // Adjust the nodes\n\n        for (var y = cell[1]; y < cell[1] + rowspan; y++) {\n          for (var x = cell[0]; x < cell[0] + colspan; x++) {\n            if (!(cell[0] == x && cell[1] == y)) {\n              data.push(obj.options.data[y][x]);\n              obj.updateCell(x, y, '', true);\n              obj.options.mergeCells[cellName][2].push(obj.records[y][x]);\n              obj.records[y][x].style.display = 'none';\n              obj.records[y][x] = obj.records[cell[1]][cell[0]];\n            }\n          }\n        } // In the initialization is not necessary keep the history\n\n\n        obj.updateSelection(obj.records[cell[1]][cell[0]]);\n\n        if (!ignoreHistoryAndEvents) {\n          obj.setHistory({\n            action: 'setMerge',\n            column: cellName,\n            colspan: colspan,\n            rowspan: rowspan,\n            data: data\n          });\n\n          if (typeof obj.options.onmerge == 'function') {\n            obj.options.onmerge(el, cellName, colspan, rowspan);\n          }\n        }\n      }\n    };\n    /**\n     * Merge cells\n     * @param cellName\n     * @param colspan\n     * @param rowspan\n     * @param ignoreHistoryAndEvents\n     */\n\n\n    obj.getMerge = function (cellName) {\n      var data = {};\n\n      if (cellName) {\n        if (obj.options.mergeCells[cellName]) {\n          data = [obj.options.mergeCells[cellName][0], obj.options.mergeCells[cellName][1]];\n        } else {\n          data = null;\n        }\n      } else {\n        if (obj.options.mergeCells) {\n          var mergedCells = obj.options.mergeCells;\n          var keys = Object.keys(obj.options.mergeCells);\n\n          for (var i = 0; i < keys.length; i++) {\n            data[keys[i]] = [obj.options.mergeCells[keys[i]][0], obj.options.mergeCells[keys[i]][1]];\n          }\n        }\n      }\n\n      return data;\n    };\n    /**\n     * Remove merge by cellname\n     * @param cellName\n     */\n\n\n    obj.removeMerge = function (cellName, data, keepOptions) {\n      if (obj.options.mergeCells[cellName]) {\n        var cell = _jexcel.getIdFromColumnName(cellName, true);\n\n        obj.records[cell[1]][cell[0]].removeAttribute('colspan');\n        obj.records[cell[1]][cell[0]].removeAttribute('rowspan');\n        obj.records[cell[1]][cell[0]].removeAttribute('data-merged');\n        var info = obj.options.mergeCells[cellName];\n        var index = 0;\n\n        for (var j = 0; j < info[1]; j++) {\n          for (var i = 0; i < info[0]; i++) {\n            if (j > 0 || i > 0) {\n              obj.records[cell[1] + j][cell[0] + i] = info[2][index];\n              obj.records[cell[1] + j][cell[0] + i].style.display = ''; // Recover data\n\n              if (data && data[index]) {\n                obj.updateCell(cell[0] + i, cell[1] + j, data[index]);\n              }\n\n              index++;\n            }\n          }\n        } // Update selection\n\n\n        obj.updateSelection(obj.records[cell[1]][cell[0]], obj.records[cell[1] + j - 1][cell[0] + i - 1]);\n\n        if (!keepOptions) {\n          delete obj.options.mergeCells[cellName];\n        }\n      }\n    };\n    /**\n     * Remove all merged cells\n     */\n\n\n    obj.destroyMerged = function (keepOptions) {\n      // Remove any merged cells\n      if (obj.options.mergeCells) {\n        var mergedCells = obj.options.mergeCells;\n        var keys = Object.keys(obj.options.mergeCells);\n\n        for (var i = 0; i < keys.length; i++) {\n          obj.removeMerge(keys[i], null, keepOptions);\n        }\n      }\n    };\n    /**\n     * Is column merged\n     */\n\n\n    obj.isColMerged = function (x, insertBefore) {\n      var cols = []; // Remove any merged cells\n\n      if (obj.options.mergeCells) {\n        var keys = Object.keys(obj.options.mergeCells);\n\n        for (var i = 0; i < keys.length; i++) {\n          var info = _jexcel.getIdFromColumnName(keys[i], true);\n\n          var colspan = obj.options.mergeCells[keys[i]][0];\n          var x1 = info[0];\n          var x2 = info[0] + (colspan > 1 ? colspan - 1 : 0);\n\n          if (insertBefore == null) {\n            if (x1 <= x && x2 >= x) {\n              cols.push(keys[i]);\n            }\n          } else {\n            if (insertBefore) {\n              if (x1 < x && x2 >= x) {\n                cols.push(keys[i]);\n              }\n            } else {\n              if (x1 <= x && x2 > x) {\n                cols.push(keys[i]);\n              }\n            }\n          }\n        }\n      }\n\n      return cols;\n    };\n    /**\n     * Is rows merged\n     */\n\n\n    obj.isRowMerged = function (y, insertBefore) {\n      var rows = []; // Remove any merged cells\n\n      if (obj.options.mergeCells) {\n        var keys = Object.keys(obj.options.mergeCells);\n\n        for (var i = 0; i < keys.length; i++) {\n          var info = _jexcel.getIdFromColumnName(keys[i], true);\n\n          var rowspan = obj.options.mergeCells[keys[i]][1];\n          var y1 = info[1];\n          var y2 = info[1] + (rowspan > 1 ? rowspan - 1 : 0);\n\n          if (insertBefore == null) {\n            if (y1 <= y && y2 >= y) {\n              rows.push(keys[i]);\n            }\n          } else {\n            if (insertBefore) {\n              if (y1 < y && y2 >= y) {\n                rows.push(keys[i]);\n              }\n            } else {\n              if (y1 <= y && y2 > y) {\n                rows.push(keys[i]);\n              }\n            }\n          }\n        }\n      }\n\n      return rows;\n    };\n    /**\n     * Open the editor\n     * \n     * @param object cell\n     * @return void\n     */\n\n\n    obj.openEditor = function (cell, empty, e) {\n      // Get cell position\n      var y = cell.getAttribute('data-y');\n      var x = cell.getAttribute('data-x'); // On edition start\n\n      if (!obj.ignoreEvents) {\n        if (typeof obj.options.oneditionstart == 'function') {\n          obj.options.oneditionstart(el, cell, x, y);\n        }\n      } // Overflow\n\n\n      if (x > 0) {\n        obj.records[y][x - 1].style.overflow = 'hidden';\n      } // Create editor\n\n\n      var createEditor = function createEditor(type) {\n        // Cell information\n        var info = cell.getBoundingClientRect(); // Create dropdown\n\n        var editor = document.createElement(type);\n        editor.style.width = info.width + 'px';\n        editor.style.height = info.height - 2 + 'px';\n        editor.style.minHeight = info.height - 2 + 'px'; // Edit cell\n\n        cell.classList.add('editor');\n        cell.innerHTML = '';\n        cell.appendChild(editor);\n        return editor;\n      }; // Readonly\n\n\n      if (cell.classList.contains('readonly') == true) {// Do nothing\n      } else {\n        // Holder\n        obj.edition = [obj.records[y][x], obj.records[y][x].innerHTML, x, y]; // If there is a custom editor for it\n\n        if (obj.options.columns[x].editor) {\n          // Custom editors\n          obj.options.columns[x].editor.openEditor(cell, el, empty, e);\n        } else {\n          // Native functions\n          if (obj.options.columns[x].type == 'hidden') {// Do nothing\n          } else if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n            // Get value\n            var value = cell.children[0].checked ? false : true; // Toogle value\n\n            obj.setValue(cell, value); // Do not keep edition open\n\n            obj.edition = null;\n          } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n            // Get current value\n            var value = obj.options.data[y][x]; // Create dropdown\n\n            if (typeof obj.options.columns[x].filter == 'function') {\n              var source = obj.options.columns[x].filter(el, cell, x, y, obj.options.columns[x].source);\n            } else {\n              var source = obj.options.columns[x].source;\n            } // Create editor\n\n\n            var editor = createEditor('div');\n            var options = {\n              data: source,\n              multiple: obj.options.columns[x].multiple ? true : false,\n              autocomplete: obj.options.columns[x].autocomplete || obj.options.columns[x].type == 'autocomplete' ? true : false,\n              opened: true,\n              value: obj.options.columns[x].multiple ? value.split(';') : value,\n              width: '100%',\n              height: editor.style.minHeight,\n              position: obj.options.tableOverflow == true || obj.options.fullscreen == true ? true : false,\n              onclose: function onclose() {\n                obj.closeEditor(cell, true);\n              }\n            };\n\n            if (obj.options.columns[x].options && obj.options.columns[x].options.type) {\n              options.type = obj.options.columns[x].options.type;\n            }\n\n            jSuites.dropdown(editor, options);\n          } else if (obj.options.columns[x].type == 'calendar' || obj.options.columns[x].type == 'color') {\n            // Value\n            var value = obj.options.data[y][x]; // Create editor\n\n            var editor = createEditor('input');\n            editor.value = value;\n\n            if (obj.options.tableOverflow == true || obj.options.fullscreen == true) {\n              obj.options.columns[x].options.position = true;\n            }\n\n            obj.options.columns[x].options.value = obj.options.data[y][x];\n            obj.options.columns[x].options.opened = true;\n\n            obj.options.columns[x].options.onclose = function (el, value) {\n              obj.closeEditor(cell, true);\n            }; // Current value\n\n\n            if (obj.options.columns[x].type == 'color') {\n              jSuites.color(editor, obj.options.columns[x].options);\n            } else {\n              var calendar = jSuites.calendar(editor, obj.options.columns[x].options);\n              calendar.setValue(value);\n            } // Focus on editor\n\n\n            editor.focus();\n          } else if (obj.options.columns[x].type == 'image') {\n            // Value\n            var img = cell.children[0]; // Create editor\n\n            var editor = createEditor('div');\n            editor.style.position = 'relative';\n            var div = document.createElement('div');\n            div.classList.add('jclose');\n\n            if (img && img.src) {\n              div.appendChild(img);\n            }\n\n            editor.appendChild(div);\n            jSuites.image(div, obj.options.imageOptions);\n            var rect = cell.getBoundingClientRect();\n            var rectContent = div.getBoundingClientRect();\n\n            if (window.innerHeight < rect.bottom + rectContent.height) {\n              div.style.top = rect.top - (rectContent.height + 2) + 'px';\n            } else {\n              div.style.top = rect.top + 'px';\n            }\n          } else {\n            // Value\n            var value = empty == true ? '' : obj.options.data[y][x]; // Basic editor\n\n            if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true)) {\n              var editor = createEditor('textarea');\n            } else {\n              var editor = createEditor('input'); // Mask\n\n              if (obj.options.columns[x].mask) {\n                editor.setAttribute('data-mask', obj.options.columns[x].mask);\n              }\n            }\n\n            editor.value = value;\n\n            editor.onblur = function () {\n              obj.closeEditor(cell, true);\n            };\n\n            editor.focus();\n          }\n        }\n      }\n    };\n    /**\n     * Close the editor and save the information\n     * \n     * @param object cell\n     * @param boolean save\n     * @return void\n     */\n\n\n    obj.closeEditor = function (cell, save) {\n      var x = parseInt(cell.getAttribute('data-x'));\n      var y = parseInt(cell.getAttribute('data-y')); // Get cell properties\n\n      if (save == true) {\n        // If custom editor\n        if (obj.options.columns[x].editor) {\n          // Custom editor\n          var value = obj.options.columns[x].editor.closeEditor(cell, save);\n        } else {\n          // Native functions\n          if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio' || obj.options.columns[x].type == 'hidden') {// Do nothing\n          } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n            var value = cell.children[0].dropdown.close(true);\n          } else if (obj.options.columns[x].type == 'calendar') {\n            var value = cell.children[0].calendar.close(true);\n          } else if (obj.options.columns[x].type == 'color') {\n            var value = cell.children[1].color.close(true);\n          } else if (obj.options.columns[x].type == 'image') {\n            var img = cell.children[0].children[0].children[0];\n            var value = img && img.tagName == 'IMG' ? img.src : '';\n          } else if (obj.options.columns[x].type == 'numeric') {\n            var value = cell.children[0].value;\n\n            if (value.substr(0, 1) != '=') {\n              if (value == '') {\n                value = obj.options.columns[x].allowEmpty ? '' : 0;\n              }\n            }\n\n            cell.children[0].onblur = null;\n          } else {\n            var value = cell.children[0].value;\n            cell.children[0].onblur = null;\n          }\n        } // Ignore changes if the value is the same\n\n\n        if (obj.options.data[y][x] == value) {\n          cell.innerHTML = obj.edition[1];\n        } else {\n          obj.setValue(cell, value);\n        }\n      } else {\n        if (obj.options.columns[x].editor) {\n          // Custom editor\n          obj.options.columns[x].editor.closeEditor(cell, save);\n        } else {\n          if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n            cell.children[0].dropdown.close(true);\n          } else if (obj.options.columns[x].type == 'calendar') {\n            cell.children[0].calendar.close(true);\n          } else if (obj.options.columns[x].type == 'color') {\n            cell.children[1].color.close(true);\n          } else {\n            cell.children[0].onblur = null;\n          }\n        } // Restore value\n\n\n        cell.innerHTML = obj.edition && obj.edition[1] ? obj.edition[1] : '';\n      } // On edition end\n\n\n      if (!obj.ignoreEvents) {\n        if (typeof obj.options.oneditionend == 'function') {\n          obj.options.oneditionend(el, cell, x, y, value, save);\n        }\n      } // Remove editor class\n\n\n      cell.classList.remove('editor'); // Finish edition\n\n      obj.edition = null;\n    };\n    /**\n     * Get the cell object\n     * \n     * @param object cell\n     * @return string value\n     */\n\n\n    obj.getCell = function (cell) {\n      // Convert in case name is excel liked ex. A10, BB92\n      cell = _jexcel.getIdFromColumnName(cell, true);\n      var x = cell[0];\n      var y = cell[1];\n      return obj.records[y][x];\n    };\n    /**\n     * Get the cell object from coords\n     * \n     * @param object cell\n     * @return string value\n     */\n\n\n    obj.getCellFromCoords = function (x, y) {\n      return obj.records[y][x];\n    };\n    /**\n     * Get label\n     * \n     * @param object cell\n     * @return string value\n     */\n\n\n    obj.getLabel = function (cell) {\n      // Convert in case name is excel liked ex. A10, BB92\n      cell = _jexcel.getIdFromColumnName(cell, true);\n      var x = cell[0];\n      var y = cell[1];\n      return obj.records[y][x].innerHTML;\n    };\n    /**\n     * Get labelfrom coords\n     * \n     * @param object cell\n     * @return string value\n     */\n\n\n    obj.getLabelFromCoords = function (x, y) {\n      return obj.records[y][x].innerHTML;\n    };\n    /**\n     * Get the value from a cell\n     * \n     * @param object cell\n     * @return string value\n     */\n\n\n    obj.getValue = function (cell, processedValue) {\n      if (typeof cell == 'object') {\n        var x = cell.getAttribute('data-x');\n        var y = cell.getAttribute('data-y');\n      } else {\n        cell = _jexcel.getIdFromColumnName(cell, true);\n        var x = cell[0];\n        var y = cell[1];\n      }\n\n      var value = null;\n\n      if (x != null && y != null) {\n        if (obj.records[y] && obj.records[y][x] && (processedValue || obj.options.copyCompatibility == true)) {\n          value = obj.records[y][x].innerHTML;\n        } else {\n          if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n            value = obj.options.data[y][x];\n          }\n        }\n      }\n\n      return value;\n    };\n    /**\n     * Get the value from a coords\n     * \n     * @param int x\n     * @param int y\n     * @return string value\n     */\n\n\n    obj.getValueFromCoords = function (x, y, processedValue) {\n      var value = null;\n\n      if (x != null && y != null) {\n        if (obj.records[y] && obj.records[y][x] && processedValue || obj.options.copyCompatibility == true) {\n          value = obj.records[y][x].innerHTML;\n        } else {\n          if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n            value = obj.options.data[y][x];\n          }\n        }\n      }\n\n      return value;\n    };\n    /**\n     * Set a cell value\n     * \n     * @param mixed cell destination cell\n     * @param string value value\n     * @return void\n     */\n\n\n    obj.setValue = function (cell, value, force) {\n      var records = [];\n\n      if (typeof cell == 'string') {\n        var columnId = _jexcel.getIdFromColumnName(cell, true);\n\n        var x = columnId[0];\n        var y = columnId[1]; // Update cell\n\n        records.push(obj.updateCell(x, y, value, force)); // Update all formulas in the chain\n\n        obj.updateFormulaChain(x, y, records);\n      } else {\n        var x = null;\n        var y = null;\n\n        if (cell && cell.getAttribute) {\n          var x = cell.getAttribute('data-x');\n          var y = cell.getAttribute('data-y');\n        } // Update cell\n\n\n        if (x != null && y != null) {\n          records.push(obj.updateCell(x, y, value, force)); // Update all formulas in the chain\n\n          obj.updateFormulaChain(x, y, records);\n        } else {\n          var keys = Object.keys(cell);\n\n          if (keys.length > 0) {\n            for (var i = 0; i < keys.length; i++) {\n              if (typeof cell[i] == 'string') {\n                var columnId = _jexcel.getIdFromColumnName(cell[i], true);\n\n                var x = columnId[0];\n                var y = columnId[1];\n              } else {\n                var x = cell[i].getAttribute('data-x');\n                var y = cell[i].getAttribute('data-y');\n              } // Update cell\n\n\n              if (x != null && y != null) {\n                records.push(obj.updateCell(x, y, value, force)); // Update all formulas in the chain\n\n                obj.updateFormulaChain(x, y, records);\n              }\n            }\n          }\n        }\n      } // Update history\n\n\n      obj.setHistory({\n        action: 'setValue',\n        records: records,\n        selection: obj.selectedCell\n      }); // Update table with custom configurations if applicable\n\n      obj.updateTable(); // On after changes\n\n      obj.onafterchanges(el, records);\n    };\n    /**\n     * Set a cell value based on coordinates\n     * \n     * @param int x destination cell\n     * @param int y destination cell\n     * @param string value\n     * @return void\n     */\n\n\n    obj.setValueFromCoords = function (x, y, value, force) {\n      var records = [];\n      records.push(obj.updateCell(x, y, value, force)); // Update all formulas in the chain\n\n      obj.updateFormulaChain(x, y, records); // Update history\n\n      obj.setHistory({\n        action: 'setValue',\n        records: records,\n        selection: obj.selectedCell\n      }); // Update table with custom configurations if applicable\n\n      obj.updateTable(); // On after changes\n\n      obj.onafterchanges(el, records);\n    };\n    /**\n     * Toogle\n     */\n\n\n    obj.setCheckRadioValue = function () {\n      var records = [];\n      var keys = Object.keys(obj.highlighted);\n\n      for (var i = 0; i < keys.length; i++) {\n        var x = obj.highlighted[i].getAttribute('data-x');\n        var y = obj.highlighted[i].getAttribute('data-y');\n\n        if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n          // Update cell\n          records.push(obj.updateCell(x, y, !obj.options.data[y][x]));\n        }\n      }\n\n      if (records.length) {\n        // Update history\n        obj.setHistory({\n          action: 'setValue',\n          records: records,\n          selection: obj.selectedCell\n        }); // On after changes\n\n        obj.onafterchanges(el, records);\n      }\n    };\n    /**\n     * Update cell content\n     * \n     * @param object cell\n     * @return void\n     */\n\n\n    obj.updateCell = function (x, y, value, force) {\n      // Changing value depending on the column type\n      if (obj.records[y][x].classList.contains('readonly') == true && !force) {\n        // Do nothing\n        var record = {\n          x: x,\n          y: y,\n          col: x,\n          row: y\n        };\n      } else {\n        // On change\n        if (!obj.ignoreEvents) {\n          if (typeof obj.options.onbeforechange == 'function') {\n            // Overwrite a value\n            var val = obj.options.onbeforechange(el, obj.records[y][x], x, y, value); // If you return something this will overwrite the value\n\n            if (val != undefined) {\n              value = val;\n            }\n          }\n        } // History format\n\n\n        var record = {\n          x: x,\n          y: y,\n          col: x,\n          row: y,\n          newValue: value,\n          oldValue: obj.options.data[y][x]\n        };\n\n        if (obj.options.columns[x].editor) {\n          // Update data and cell\n          obj.options.data[y][x] = value;\n          obj.options.columns[x].editor.setValue(obj.records[y][x], value, force);\n        } else {\n          // Native functions\n          if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n            // Unchecked all options\n            if (obj.options.columns[x].type == 'radio') {\n              for (var j = 0; j < obj.options.data.length; j++) {\n                obj.options.data[j][x] = false;\n              }\n            } // Update data and cell\n\n\n            obj.records[y][x].children[0].checked = value == 1 || value == true || value == 'true' || value == 'TRUE' ? true : false;\n            obj.options.data[y][x] = obj.records[y][x].children[0].checked;\n          } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n            // Update data and cell\n            obj.options.data[y][x] = value;\n            obj.records[y][x].innerHTML = obj.getDropDownValue(x, value);\n          } else if (obj.options.columns[x].type == 'calendar') {\n            // Update calendar\n            var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[x].options.format); // Update data and cell\n\n            obj.options.data[y][x] = value;\n            obj.records[y][x].innerHTML = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[x].options.format);\n          } else if (obj.options.columns[x].type == 'color') {\n            // Update color\n            obj.options.data[y][x] = value; // Render\n\n            if (obj.options.columns[x].render == 'square') {\n              var color = document.createElement('div');\n              color.className = 'color';\n              color.style.backgroundColor = value;\n              obj.records[y][x].innerHTML = '';\n              obj.records[y][x].appendChild(color);\n            } else {\n              obj.records[y][x].style.color = value;\n              obj.records[y][x].innerHTML = value;\n            }\n          } else if (obj.options.columns[x].type == 'image') {\n            value = '' + value;\n            obj.options.data[y][x] = value;\n            obj.records[y][x].innerHTML = '';\n\n            if (value && value.substr(0, 10) == 'data:image') {\n              var img = document.createElement('img');\n              img.src = value;\n              obj.records[y][x].appendChild(img);\n            }\n          } else {\n            // Update data and cell\n            obj.options.data[y][x] = value; // Label\n\n            if (('' + value).substr(0, 1) == '=' && obj.options.parseFormulas == true) {\n              value = obj.executeFormula(value, x, y);\n            }\n\n            if (obj.options.columns[x].mask) {\n              var decimal = obj.options.columns[x].decimal || '.';\n              value = '' + jSuites.mask.run(value, obj.options.columns[x].mask, decimal);\n            }\n\n            obj.records[y][x].innerHTML = value; // Handle big text inside a cell\n\n            if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true || obj.records[y][x].innerHTML.length > 200)) {\n              obj.records[y][x].style.whiteSpace = 'pre-wrap';\n            } else {\n              obj.records[y][x].style.whiteSpace = '';\n            }\n          }\n        } // Overflow\n\n\n        if (x > 0) {\n          if (value) {\n            obj.records[y][x - 1].style.overflow = 'hidden';\n          } else {\n            obj.records[y][x - 1].style.overflow = '';\n          }\n        } // On change\n\n\n        if (!obj.ignoreEvents) {\n          if (typeof obj.options.onchange == 'function') {\n            obj.options.onchange(el, obj.records[y] && obj.records[y][x] ? obj.records[y][x] : null, x, y, value, record.oldValue);\n          }\n        }\n      }\n\n      return record;\n    };\n    /**\n     * Helper function to copy data using the corner icon\n     */\n\n\n    obj.copyData = function (o, d) {\n      // Get data from all selected cells\n      var data = obj.getData(true, true); // Selected cells\n\n      var h = obj.selectedContainer; // Cells\n\n      var x1 = parseInt(o.getAttribute('data-x'));\n      var y1 = parseInt(o.getAttribute('data-y'));\n      var x2 = parseInt(d.getAttribute('data-x'));\n      var y2 = parseInt(d.getAttribute('data-y')); // Records\n\n      var records = [];\n      var breakControl = false;\n\n      if (h[0] == x1) {\n        // Vertical copy\n        if (y1 < h[1]) {\n          var rowNumber = y1 - h[1];\n        } else {\n          var rowNumber = 1;\n        }\n\n        var colNumber = 0;\n      } else {\n        if (x1 < h[0]) {\n          var colNumber = x1 - h[0];\n        } else {\n          var colNumber = 1;\n        }\n\n        var rowNumber = 0;\n      } // Copy data procedure\n\n\n      var posx = 0;\n      var posy = 0;\n\n      for (var j = y1; j <= y2; j++) {\n        // Skip hidden rows\n        if (obj.rows[j] && obj.rows[j].style.display == 'none') {\n          continue;\n        } // Controls\n\n\n        if (data[posy] == undefined) {\n          posy = 0;\n        }\n\n        posx = 0; // Data columns\n\n        if (h[0] != x1) {\n          if (x1 < h[0]) {\n            var colNumber = x1 - h[0];\n          } else {\n            var colNumber = 1;\n          }\n        } // Data columns\n\n\n        for (var i = x1; i <= x2; i++) {\n          // Update non-readonly\n          if (obj.records[j][i] && !obj.records[j][i].classList.contains('readonly') && obj.records[j][i].style.display != 'none' && breakControl == false) {\n            // Stop if contains value\n            if (!obj.selection.length) {\n              if (obj.options.data[j][i] != '') {\n                breakControl = true;\n                continue;\n              }\n            } // Column\n\n\n            if (data[posy] == undefined) {\n              posx = 0;\n            } else if (data[posy][posx] == undefined) {\n              posx = 0;\n            } // Value\n\n\n            var value = data[posy][posx];\n\n            if (value && !data[1] && obj.options.autoIncrement == true) {\n              if (obj.options.columns[i].type == 'text' || obj.options.columns[i].type == 'number') {\n                if (('' + value).substr(0, 1) == '=') {\n                  var tokens = value.match(/([A-Z]+[0-9]+)/g);\n\n                  if (tokens) {\n                    var affectedTokens = [];\n\n                    for (var index = 0; index < tokens.length; index++) {\n                      var position = _jexcel.getIdFromColumnName(tokens[index], 1);\n\n                      position[0] += colNumber;\n                      position[1] += rowNumber;\n\n                      if (position[1] < 0) {\n                        position[1] = 0;\n                      }\n\n                      var token = _jexcel.getColumnNameFromId([position[0], position[1]]);\n\n                      if (token != tokens[index]) {\n                        affectedTokens[tokens[index]] = token;\n                      }\n                    } // Update formula\n\n\n                    if (affectedTokens) {\n                      value = obj.updateFormula(value, affectedTokens);\n                    }\n                  }\n                } else {\n                  if (value == Number(value)) {\n                    value = Number(value) + rowNumber;\n                  }\n                }\n              } else if (obj.options.columns[i].type == 'calendar') {\n                var date = new Date(value);\n                date.setDate(date.getDate() + rowNumber);\n                value = date.getFullYear() + '-' + _jexcel.doubleDigitFormat(parseInt(date.getMonth() + 1)) + '-' + _jexcel.doubleDigitFormat(date.getDate()) + ' ' + '00:00:00';\n              }\n            }\n\n            records.push(obj.updateCell(i, j, value)); // Update all formulas in the chain\n\n            obj.updateFormulaChain(i, j, records);\n          }\n\n          posx++;\n\n          if (h[0] != x1) {\n            colNumber++;\n          }\n        }\n\n        posy++;\n        rowNumber++;\n      } // Update history\n\n\n      obj.setHistory({\n        action: 'setValue',\n        records: records,\n        selection: obj.selectedCell\n      }); // Update table with custom configuration if applicable\n\n      obj.updateTable(); // On after changes\n\n      obj.onafterchanges(el, records);\n    };\n    /**\n     * Refresh current selection\n     */\n\n\n    obj.refreshSelection = function () {\n      if (obj.selectedCell) {\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n      }\n    };\n    /**\n     * Move coords to A1 in case ovelaps with an excluded cell\n     */\n\n\n    obj.conditionalSelectionUpdate = function (type, o, d) {\n      if (type == 1) {\n        if (obj.selectedCell && (o >= obj.selectedCell[1] && o <= obj.selectedCell[3] || d >= obj.selectedCell[1] && d <= obj.selectedCell[3])) {\n          obj.resetSelection();\n          return;\n        }\n      } else {\n        if (obj.selectedCell && (o >= obj.selectedCell[0] && o <= obj.selectedCell[2] || d >= obj.selectedCell[0] && d <= obj.selectedCell[2])) {\n          obj.resetSelection();\n          return;\n        }\n      }\n    };\n    /**\n     * Clear table selection\n     */\n\n\n    obj.resetSelection = function (blur) {\n      // Remove style\n      if (!obj.highlighted.length) {\n        var previousStatus = 0;\n      } else {\n        var previousStatus = 1;\n\n        for (var i = 0; i < obj.highlighted.length; i++) {\n          obj.highlighted[i].classList.remove('highlight');\n          obj.highlighted[i].classList.remove('highlight-left');\n          obj.highlighted[i].classList.remove('highlight-right');\n          obj.highlighted[i].classList.remove('highlight-top');\n          obj.highlighted[i].classList.remove('highlight-bottom');\n          obj.highlighted[i].classList.remove('highlight-selected');\n          var px = parseInt(obj.highlighted[i].getAttribute('data-x'));\n          var py = parseInt(obj.highlighted[i].getAttribute('data-y')); // Check for merged cells\n\n          if (obj.highlighted[i].getAttribute('data-merged')) {\n            var colspan = parseInt(obj.highlighted[i].getAttribute('colspan'));\n            var rowspan = parseInt(obj.highlighted[i].getAttribute('rowspan'));\n            var ux = colspan > 0 ? px + (colspan - 1) : px;\n            var uy = rowspan > 0 ? py + (rowspan - 1) : py;\n          } else {\n            var ux = px;\n            var uy = py;\n          } // Remove selected from headers\n\n\n          for (var j = px; j <= ux; j++) {\n            if (obj.headers[j]) {\n              obj.headers[j].classList.remove('selected');\n            }\n          } // Remove selected from rows\n\n\n          for (var j = py; j <= uy; j++) {\n            if (obj.rows[j]) {\n              obj.rows[j].classList.remove('selected');\n            }\n          }\n        }\n      } // Reset highlighed cells\n\n\n      obj.highlighted = []; // Reset\n\n      obj.selectedCell = null; // Hide corner\n\n      obj.corner.style.top = '-2000px';\n      obj.corner.style.left = '-2000px';\n\n      if (obj.ignoreEvents != true && blur == true) {\n        if (obj.options.onblur) {\n          if (typeof obj.options.onblur == 'function') {\n            if (previousStatus == 1) {\n              obj.options.onblur(el);\n            }\n          }\n        }\n      }\n\n      return previousStatus;\n    };\n    /**\n     * Update selection based on two cells\n     */\n\n\n    obj.updateSelection = function (el1, el2, origin) {\n      var x1 = el1.getAttribute('data-x');\n      var y1 = el1.getAttribute('data-y');\n\n      if (el2) {\n        var x2 = el2.getAttribute('data-x');\n        var y2 = el2.getAttribute('data-y');\n      } else {\n        var x2 = x1;\n        var y2 = y1;\n      }\n\n      obj.updateSelectionFromCoords(x1, y1, x2, y2, origin);\n    };\n    /**\n     * Update selection from coords\n     */\n\n\n    obj.updateSelectionFromCoords = function (x1, y1, x2, y2, origin) {\n      // Reset Selection\n      var updated = null;\n      var previousState = obj.resetSelection(); // Same element\n\n      if (x2 == null) {\n        x2 = x1;\n      }\n\n      if (y2 == null) {\n        y2 = y1;\n      } // Selection must be within the existing data\n\n\n      if (x1 >= obj.headers.length) {\n        x1 = obj.headers.length - 1;\n      }\n\n      if (y1 >= obj.rows.length) {\n        y1 = obj.rows.length - 1;\n      }\n\n      if (x2 >= obj.headers.length) {\n        x2 = obj.headers.length - 1;\n      }\n\n      if (y2 >= obj.rows.length) {\n        y2 = obj.rows.length - 1;\n      } // Keep selected cell\n\n\n      obj.selectedCell = [x1, y1, x2, y2]; // Select cells\n\n      if (x1 != null) {\n        // Add selected cell\n        if (obj.records[y1][x1]) {\n          obj.records[y1][x1].classList.add('highlight-selected');\n        } // Origin & Destination\n\n\n        if (parseInt(x1) < parseInt(x2)) {\n          var px = parseInt(x1);\n          var ux = parseInt(x2);\n        } else {\n          var px = parseInt(x2);\n          var ux = parseInt(x1);\n        }\n\n        if (parseInt(y1) < parseInt(y2)) {\n          var py = parseInt(y1);\n          var uy = parseInt(y2);\n        } else {\n          var py = parseInt(y2);\n          var uy = parseInt(y1);\n        } // Verify merged columns\n\n\n        for (var i = px; i <= ux; i++) {\n          for (var j = py; j <= uy; j++) {\n            if (obj.records[j][i] && obj.records[j][i].getAttribute('data-merged')) {\n              var x = parseInt(obj.records[j][i].getAttribute('data-x'));\n              var y = parseInt(obj.records[j][i].getAttribute('data-y'));\n              var colspan = parseInt(obj.records[j][i].getAttribute('colspan'));\n              var rowspan = parseInt(obj.records[j][i].getAttribute('rowspan'));\n\n              if (colspan > 1) {\n                if (x < px) {\n                  px = x;\n                }\n\n                if (x + colspan > ux) {\n                  ux = x + colspan - 1;\n                }\n              }\n\n              if (rowspan) {\n                if (y < py) {\n                  py = y;\n                }\n\n                if (y + rowspan > uy) {\n                  uy = y + rowspan - 1;\n                }\n              }\n            }\n          }\n        } // Limits\n\n\n        var borderLeft = null;\n        var borderRight = null;\n        var borderTop = null;\n        var borderBottom = null; // Vertical limits\n\n        for (var j = py; j <= uy; j++) {\n          if (obj.rows[j].style.display != 'none') {\n            if (borderTop == null) {\n              borderTop = j;\n            }\n\n            borderBottom = j;\n          }\n        } // Redefining styles\n\n\n        for (var i = px; i <= ux; i++) {\n          for (var j = py; j <= uy; j++) {\n            if (obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n              obj.records[j][i].classList.add('highlight');\n              obj.highlighted.push(obj.records[j][i]);\n            }\n          } // Horizontal limits\n\n\n          if (obj.options.columns[i].type != 'hidden') {\n            if (borderLeft == null) {\n              borderLeft = i;\n            }\n\n            borderRight = i;\n          }\n        } // Create borders\n\n\n        if (!borderLeft) {\n          borderLeft = 0;\n        }\n\n        if (!borderRight) {\n          borderRight = 0;\n        }\n\n        for (var i = borderLeft; i <= borderRight; i++) {\n          if (obj.options.columns[i].type != 'hidden') {\n            // Top border\n            if (obj.records[borderTop][i]) {\n              obj.records[borderTop][i].classList.add('highlight-top');\n            } // Bottom border\n\n\n            if (obj.records[borderBottom][i]) {\n              obj.records[borderBottom][i].classList.add('highlight-bottom');\n            } // Add selected from headers\n\n\n            obj.headers[i].classList.add('selected');\n          }\n        }\n\n        for (var j = borderTop; j <= borderBottom; j++) {\n          if (obj.rows[j].style.display != 'none') {\n            // Left border\n            obj.records[j][borderLeft].classList.add('highlight-left'); // Right border\n\n            obj.records[j][borderRight].classList.add('highlight-right'); // Add selected from rows\n\n            obj.rows[j].classList.add('selected');\n          }\n        }\n\n        obj.selectedContainer = [borderLeft, borderTop, borderRight, borderBottom];\n      } // Handle events\n\n\n      if (obj.ignoreEvents != true) {\n        if (obj.options.onfocus) {\n          if (typeof obj.options.onfocus == 'function') {\n            if (previousState == 0) {\n              obj.options.onfocus(el);\n            }\n          }\n        }\n\n        if (typeof obj.options.onselection == 'function') {\n          obj.options.onselection(el, borderLeft, borderTop, borderRight, borderBottom, origin);\n        }\n      } // Find corner cell\n\n\n      obj.updateCornerPosition();\n    };\n    /**\n     * Remove copy selection\n     * \n     * @return void\n     */\n\n\n    obj.removeCopySelection = function () {\n      // Remove current selection\n      for (var i = 0; i < obj.selection.length; i++) {\n        obj.selection[i].classList.remove('selection');\n        obj.selection[i].classList.remove('selection-left');\n        obj.selection[i].classList.remove('selection-right');\n        obj.selection[i].classList.remove('selection-top');\n        obj.selection[i].classList.remove('selection-bottom');\n      }\n\n      obj.selection = [];\n    };\n    /**\n     * Update copy selection\n     * \n     * @param int x, y\n     * @return void\n     */\n\n\n    obj.updateCopySelection = function (x3, y3) {\n      // Remove selection\n      obj.removeCopySelection(); // Get elements first and last\n\n      var x1 = obj.selectedContainer[0];\n      var y1 = obj.selectedContainer[1];\n      var x2 = obj.selectedContainer[2];\n      var y2 = obj.selectedContainer[3];\n\n      if (x3 != null && y3 != null) {\n        if (x3 - x2 > 0) {\n          var px = parseInt(x2) + 1;\n          var ux = parseInt(x3);\n        } else {\n          var px = parseInt(x3);\n          var ux = parseInt(x1) - 1;\n        }\n\n        if (y3 - y2 > 0) {\n          var py = parseInt(y2) + 1;\n          var uy = parseInt(y3);\n        } else {\n          var py = parseInt(y3);\n          var uy = parseInt(y1) - 1;\n        }\n\n        if (ux - px < uy - py) {\n          var px = parseInt(x1);\n          var ux = parseInt(x2);\n        } else {\n          var py = parseInt(y1);\n          var uy = parseInt(y2);\n        }\n\n        for (var j = py; j <= uy; j++) {\n          for (var i = px; i <= ux; i++) {\n            if (obj.records[j][i] && obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n              obj.records[j][i].classList.add('selection');\n              obj.records[py][i].classList.add('selection-top');\n              obj.records[uy][i].classList.add('selection-bottom');\n              obj.records[j][px].classList.add('selection-left');\n              obj.records[j][ux].classList.add('selection-right'); // Persist selected elements\n\n              obj.selection.push(obj.records[j][i]);\n            }\n          }\n        }\n      }\n    };\n    /**\n     * Update corner position\n     * \n     * @return void\n     */\n\n\n    obj.updateCornerPosition = function () {\n      // If any selected cells\n      if (!obj.highlighted.length) {\n        obj.corner.style.top = '-2000px';\n        obj.corner.style.left = '-2000px';\n      } else {\n        // Get last cell\n        var last = obj.highlighted[obj.highlighted.length - 1];\n        var contentRect = obj.content.getBoundingClientRect();\n        var x1 = contentRect.left;\n        var y1 = contentRect.top;\n        var lastRect = last.getBoundingClientRect();\n        var x2 = lastRect.left;\n        var y2 = lastRect.top;\n        var w2 = lastRect.width;\n        var h2 = lastRect.height;\n        var x = x2 - x1 + obj.content.scrollLeft + w2 - 4;\n        var y = y2 - y1 + obj.content.scrollTop + h2 - 4; // Place the corner in the correct place\n\n        obj.corner.style.top = y + 'px';\n        obj.corner.style.left = x + 'px';\n      }\n    };\n    /**\n     * Update scroll position based on the selection\n     */\n\n\n    obj.updateScroll = function (direction) {\n      // jExcel Container information\n      var contentRect = obj.content.getBoundingClientRect();\n      var x1 = contentRect.left;\n      var y1 = contentRect.top;\n      var w1 = contentRect.width;\n      var h1 = contentRect.height; // Direction Left or Up\n\n      var reference = obj.records[obj.selectedCell[3]][obj.selectedCell[2]]; // Reference\n\n      var referenceRect = reference.getBoundingClientRect();\n      var x2 = referenceRect.left;\n      var y2 = referenceRect.top;\n      var w2 = referenceRect.width;\n      var h2 = referenceRect.height; // Direction\n\n      if (direction == 0 || direction == 1) {\n        var x = x2 - x1 + obj.content.scrollLeft;\n        var y = y2 - y1 + obj.content.scrollTop - 2;\n      } else {\n        var x = x2 - x1 + obj.content.scrollLeft + w2;\n        var y = y2 - y1 + obj.content.scrollTop + h2;\n      } // Top position check\n\n\n      if (y > obj.content.scrollTop + 30 && y < obj.content.scrollTop + h1) {// In the viewport\n      } else {\n        // Out of viewport\n        if (y < obj.content.scrollTop + 30) {\n          obj.content.scrollTop = y - h2;\n        } else {\n          obj.content.scrollTop = y - (h1 - 2);\n        }\n      } // Left position check - TODO: change that to the bottom border of the element\n\n\n      if (x > obj.content.scrollLeft && x < obj.content.scrollLeft + w1) {// In the viewport\n      } else {\n        // Out of viewport\n        if (x < obj.content.scrollLeft + 30) {\n          obj.content.scrollLeft = x;\n\n          if (obj.content.scrollLeft < 50) {\n            obj.content.scrollLeft = 0;\n          }\n        } else {\n          obj.content.scrollLeft = x - (w1 - 20);\n        }\n      }\n    };\n    /**\n     * Get the column width\n     * \n     * @param int column column number (first column is: 0)\n     * @return int current width\n     */\n\n\n    obj.getWidth = function (column) {\n      if (!column) {\n        // Get all headers\n        var data = [];\n\n        for (var i = 0; i < obj.headers.length; i++) {\n          data.push(obj.options.columns[i].width);\n        }\n      } else {\n        // In case the column is an object\n        if (typeof column == 'object') {\n          column = $(column).getAttribute('data-x');\n        }\n\n        data = obj.colgroup[column].getAttribute('width');\n      }\n\n      return data;\n    };\n    /**\n     * Set the column width\n     * \n     * @param int column number (first column is: 0)\n     * @param int new column width\n     * @param int old column width\n     */\n\n\n    obj.setWidth = function (column, width, oldWidth) {\n      if (width > 0) {\n        // In case the column is an object\n        if (typeof column == 'object') {\n          column = column.getAttribute('data-x');\n        } // Oldwidth\n\n\n        if (!oldWidth) {\n          oldWidth = obj.colgroup[column].getAttribute('width');\n        } // Set width\n\n\n        obj.colgroup[column].setAttribute('width', width);\n        obj.options.columns[column].width = width; // Keeping history of changes\n\n        obj.setHistory({\n          action: 'setWidth',\n          column: column,\n          oldValue: oldWidth,\n          newValue: width\n        }); // On resize column\n\n        if (obj.ignoreEvents != true) {\n          if (typeof obj.options.onresizecolumn == 'function') {\n            obj.options.onresizecolumn(el, column, width, oldWidth);\n          }\n        } // Update corner position\n\n\n        obj.updateCornerPosition();\n      }\n    };\n    /**\n     * Set the row height\n     * \n     * @param row - row number (first row is: 0)\n     * @param height - new row height\n     * @param oldHeight - old row height\n     */\n\n\n    obj.setHeight = function (row, height, oldHeight) {\n      if (height > 0) {\n        // In case the column is an object\n        if (typeof row == 'object') {\n          row = row.getAttribute('data-y');\n        } // Oldwidth\n\n\n        if (!oldHeight) {\n          oldHeight = obj.rows[row].getAttribute('height');\n\n          if (!oldHeight) {\n            var rect = obj.rows[row].getBoundingClientRect();\n            oldHeight = rect.height;\n          }\n        } // Integer\n\n\n        height = parseInt(height); // Set width\n\n        obj.rows[row].style.height = height + 'px'; // Keep options updated\n\n        if (!obj.options.rows[row]) {\n          obj.options.rows[row] = {};\n        }\n\n        obj.options.rows[row].height = height; // Keeping history of changes\n\n        obj.setHistory({\n          action: 'setHeight',\n          row: row,\n          oldValue: oldHeight,\n          newValue: height\n        }); // On resize column\n\n        if (obj.ignoreEvents != true) {\n          if (typeof obj.options.onresizerow == 'function') {\n            obj.options.onresizerow(el, row, height, oldHeight);\n          }\n        } // Update corner position\n\n\n        obj.updateCornerPosition();\n      }\n    };\n    /**\n     * Get the row height\n     * \n     * @param row - row number (first row is: 0)\n     * @return height - current row height\n     */\n\n\n    obj.getHeight = function (row) {\n      if (!row) {\n        // Get height of all rows\n        var data = [];\n\n        for (var j = 0; j < obj.rows.length; j++) {\n          var h = obj.rows[j].style.height;\n\n          if (h) {\n            data[j] = h;\n          }\n        }\n      } else {\n        // In case the row is an object\n        if (typeof row == 'object') {\n          row = $(row).getAttribute('data-y');\n        }\n\n        var data = obj.rows[row].style.height;\n      }\n\n      return data;\n    };\n    /**\n     * Get the column title\n     * \n     * @param column - column number (first column is: 0)\n     * @param title - new column title\n     */\n\n\n    obj.getHeader = function (column) {\n      return obj.headers[column].innerText;\n    };\n    /**\n     * Set the column title\n     * \n     * @param column - column number (first column is: 0)\n     * @param title - new column title\n     */\n\n\n    obj.setHeader = function (column, newValue) {\n      if (obj.headers[column]) {\n        var oldValue = obj.headers[column].innerText;\n\n        if (!newValue) {\n          newValue = prompt(obj.options.text.columnName, oldValue);\n        }\n\n        if (newValue) {\n          obj.headers[column].innerHTML = newValue; // Keep the title property\n\n          obj.headers[column].setAttribute('title', newValue);\n        }\n\n        obj.setHistory({\n          action: 'setHeader',\n          column: column,\n          oldValue: oldValue,\n          newValue: newValue\n        }); // On change\n\n        if (!obj.ignoreEvents) {\n          if (typeof obj.options.onchangeheader == 'function') {\n            obj.options.onchangeheader(el, column, oldValue, newValue);\n          }\n        }\n      }\n    };\n    /**\n     * Get the headers\n     * \n     * @param asArray\n     * @return mixed\n     */\n\n\n    obj.getHeaders = function (asArray) {\n      var title = [];\n\n      for (var i = 0; i < obj.headers.length; i++) {\n        title.push(obj.getHeader(i));\n      }\n\n      return asArray ? title : title.join(obj.options.csvDelimiter);\n    };\n    /**\n     * Get meta information from cell(s)\n     * \n     * @return integer\n     */\n\n\n    obj.getMeta = function (cell, key) {\n      if (!cell) {\n        return obj.options.meta;\n      } else {\n        if (key) {\n          return obj.options.meta[cell] && obj.options.meta[cell][key] ? obj.options.meta[cell][key] : null;\n        } else {\n          return obj.options.meta[cell] ? obj.options.meta[cell] : null;\n        }\n      }\n    };\n    /**\n     * Set meta information to cell(s)\n     * \n     * @return integer\n     */\n\n\n    obj.setMeta = function (o, k, v) {\n      if (!obj.options.meta) {\n        obj.options.meta = {};\n      }\n\n      if (k && v) {\n        // Set data value\n        if (!obj.options.meta[o]) {\n          obj.options.meta[o] = {};\n        }\n\n        obj.options.meta[o][k] = v;\n      } else {\n        // Apply that for all cells\n        var keys = Object.keys(o);\n\n        for (var i = 0; i < keys.length; i++) {\n          if (!obj.options.meta[keys[i]]) {\n            obj.options.meta[keys[i]] = {};\n          }\n\n          var prop = Object.keys(o[keys[i]]);\n\n          for (var j = 0; j < prop.length; j++) {\n            obj.options.meta[keys[i]][prop[j]] = o[keys[i]][prop[j]];\n          }\n        }\n      }\n\n      if (obj.ignoreEvents != true) {\n        if (typeof obj.options.onchangemeta == 'function') {\n          obj.options.onchangemeta(el, o, k, v);\n        }\n      }\n    };\n    /**\n     * Update meta information\n     * \n     * @return integer\n     */\n\n\n    obj.updateMeta = function (affectedCells) {\n      if (obj.options.meta) {\n        var newMeta = {};\n        var keys = Object.keys(obj.options.meta);\n\n        for (var i = 0; i < keys.length; i++) {\n          if (affectedCells[keys[i]]) {\n            newMeta[affectedCells[keys[i]]] = obj.options.meta[keys[i]];\n          } else {\n            newMeta[keys[i]] = obj.options.meta[keys[i]];\n          }\n        } // Update meta information\n\n\n        obj.options.meta = newMeta;\n      }\n    };\n    /**\n     * Get style information from cell(s)\n     * \n     * @return integer\n     */\n\n\n    obj.getStyle = function (cell, key) {\n      // Cell\n      if (!cell) {\n        // Control vars\n        var data = {}; // Column and row length\n\n        var x = obj.options.data[0].length;\n        var y = obj.options.data.length; // Go through the columns to get the data\n\n        for (var j = 0; j < y; j++) {\n          for (var i = 0; i < x; i++) {\n            // Value\n            var v = key ? obj.records[j][i].style[key] : obj.records[j][i].getAttribute('style'); // Any meta data for this column?\n\n            if (v) {\n              // Column name\n              var k = _jexcel.getColumnNameFromId([i, j]); // Value\n\n\n              data[k] = v;\n            }\n          }\n        }\n\n        return data;\n      } else {\n        cell = _jexcel.getIdFromColumnName(cell, true);\n        return key ? obj.records[cell[1]][cell[0]].style[key] : obj.records[cell[1]][cell[0]].getAttribute('style');\n      }\n    }, obj.resetStyle = function (o, ignoreHistoryAndEvents) {\n      var keys = Object.keys(o);\n\n      for (var i = 0; i < keys.length; i++) {\n        // Position\n        var cell = _jexcel.getIdFromColumnName(keys[i], true);\n\n        if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n          obj.records[cell[1]][cell[0]].setAttribute('style', '');\n        }\n      }\n\n      obj.setStyle(o, null, null, null, ignoreHistoryAndEvents);\n    };\n    /**\n     * Set meta information to cell(s)\n     * \n     * @return integer\n     */\n\n    obj.setStyle = function (o, k, v, force, ignoreHistoryAndEvents) {\n      var newValue = {};\n      var oldValue = {}; // Apply style\n\n      var applyStyle = function applyStyle(cellId, key, value) {\n        // Position\n        var cell = _jexcel.getIdFromColumnName(cellId, true);\n\n        if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n          // Current value\n          var currentValue = obj.records[cell[1]][cell[0]].style[key]; // Change layout\n\n          if (currentValue == value && !force) {\n            value = '';\n            obj.records[cell[1]][cell[0]].style[key] = '';\n          } else {\n            obj.records[cell[1]][cell[0]].style[key] = value;\n          } // History\n\n\n          if (!oldValue[cellId]) {\n            oldValue[cellId] = [];\n          }\n\n          if (!newValue[cellId]) {\n            newValue[cellId] = [];\n          }\n\n          oldValue[cellId].push([key + ':' + currentValue]);\n          newValue[cellId].push([key + ':' + value]);\n        }\n      };\n\n      if (k && v) {\n        // Get object from string\n        if (typeof o == 'string') {\n          applyStyle(o, k, v);\n        } else {\n          // Avoid duplications\n          var oneApplication = []; // Apply that for all cells\n\n          for (var i = 0; i < o.length; i++) {\n            var x = o[i].getAttribute('data-x');\n            var y = o[i].getAttribute('data-y');\n\n            var cellName = _jexcel.getColumnNameFromId([x, y]); // This happens when is a merged cell\n\n\n            if (!oneApplication[cellName]) {\n              applyStyle(cellName, k, v);\n              oneApplication[cellName] = true;\n            }\n          }\n        }\n      } else {\n        var keys = Object.keys(o);\n\n        for (var i = 0; i < keys.length; i++) {\n          var style = o[keys[i]];\n\n          if (typeof style == 'string') {\n            style = style.split(';');\n          }\n\n          for (var j = 0; j < style.length; j++) {\n            if (typeof style[j] == 'string') {\n              style[j] = style[j].split(':');\n            } // Apply value\n\n\n            if (style[j][0].trim()) {\n              applyStyle(keys[i], style[j][0].trim(), style[j][1]);\n            }\n          }\n        }\n      }\n\n      var keys = Object.keys(oldValue);\n\n      for (var i = 0; i < keys.length; i++) {\n        oldValue[keys[i]] = oldValue[keys[i]].join(';');\n      }\n\n      var keys = Object.keys(newValue);\n\n      for (var i = 0; i < keys.length; i++) {\n        newValue[keys[i]] = newValue[keys[i]].join(';');\n      }\n\n      if (!ignoreHistoryAndEvents) {\n        // Keeping history of changes\n        obj.setHistory({\n          action: 'setStyle',\n          oldValue: oldValue,\n          newValue: newValue\n        });\n      }\n\n      if (obj.ignoreEvents != true) {\n        if (typeof obj.options.onchangestyle == 'function') {\n          obj.options.onchangestyle(el, o, k, v);\n        }\n      }\n    };\n    /**\n     * Get cell comments, null cell for all\n     */\n\n\n    obj.getComments = function (cell, withAuthor) {\n      if (cell) {\n        if (typeof cell == 'string') {\n          var cell = _jexcel.getIdFromColumnName(cell, true);\n        }\n\n        if (withAuthor) {\n          return [obj.records[cell[1]][cell[0]].getAttribute('title'), obj.records[cell[1]][cell[0]].getAttribute('author')];\n        } else {\n          return obj.records[cell[1]][cell[0]].getAttribute('title') || '';\n        }\n      } else {\n        var data = {};\n\n        for (var j = 0; j < obj.options.data.length; j++) {\n          for (var i = 0; i < obj.options.columns.length; i++) {\n            var comments = obj.records[j][i].getAttribute('title');\n\n            if (comments) {\n              var cell = _jexcel.getColumnNameFromId([i, j]);\n\n              data[cell] = comments;\n            }\n          }\n        }\n\n        return data;\n      }\n    };\n    /**\n     * Set cell comments\n     */\n\n\n    obj.setComments = function (cellId, comments, author) {\n      if (typeof cellId == 'string') {\n        var cell = _jexcel.getIdFromColumnName(cellId, true);\n      } else {\n        var cell = cellId;\n      } // Keep old value\n\n\n      var title = obj.records[cell[1]][cell[0]].getAttribute('title');\n      var author = obj.records[cell[1]][cell[0]].getAttribute('data-author');\n      var oldValue = [title, author]; // Set new values\n\n      obj.records[cell[1]][cell[0]].setAttribute('title', comments ? comments : '');\n      obj.records[cell[1]][cell[0]].setAttribute('data-author', author ? author : ''); // Remove class if there is no comment\n\n      if (comments) {\n        obj.records[cell[1]][cell[0]].classList.add('jexcel_comments');\n      } else {\n        obj.records[cell[1]][cell[0]].classList.remove('jexcel_comments');\n      } // Save history\n\n\n      obj.setHistory({\n        action: 'setComments',\n        column: cellId,\n        newValue: [comments, author],\n        oldValue: oldValue\n      });\n    };\n    /**\n     * Get table config information\n     */\n\n\n    obj.getConfig = function () {\n      var options = obj.options;\n      options.style = obj.getStyle();\n      options.mergeCells = obj.getMerge();\n      options.comments = obj.getComments();\n      return options;\n    };\n    /**\n     * Sort data and reload table\n     */\n\n\n    obj.orderBy = function (column, order) {\n      if (column >= 0) {\n        // Merged cells\n        if (Object.keys(obj.options.mergeCells).length > 0) {\n          if (!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n            return false;\n          } else {\n            // Remove merged cells\n            obj.destroyMerged();\n          }\n        } // Direction\n\n\n        if (order == null) {\n          order = obj.headers[column].classList.contains('arrow-down') ? 1 : 0;\n        } else {\n          order = order ? 1 : 0;\n        } // Filter\n\n\n        Array.prototype.orderBy = function (p, o) {\n          return this.slice(0).sort(function (a, b) {\n            var valueA = a[p] == '' ? '' : Number(a[p]) == a[p] ? Number(a[p]) : a[p].toLowerCase();\n            var valueB = b[p] == '' ? '' : Number(b[p]) == b[p] ? Number(b[p]) : b[p].toLowerCase();\n\n            if (!o) {\n              return valueA == '' && valueB != '' ? 1 : valueA != '' && valueB == '' ? -1 : valueA > valueB ? 1 : valueA < valueB ? -1 : 0;\n            } else {\n              return valueA == '' && valueB != '' ? 1 : valueA != '' && valueB == '' ? -1 : valueA > valueB ? -1 : valueA < valueB ? 1 : 0;\n            }\n          });\n        }; // Test order\n\n\n        var temp = [];\n\n        if (obj.options.columns[column].type == 'calendar' || obj.options.columns[column].type == 'checkbox' || obj.options.columns[column].type == 'radio') {\n          for (var j = 0; j < obj.options.data.length; j++) {\n            temp[j] = [j, obj.options.data[j][column]];\n          }\n        } else {\n          for (var j = 0; j < obj.options.data.length; j++) {\n            temp[j] = [j, obj.records[j][column].innerHTML];\n          }\n        }\n\n        temp = temp.orderBy(1, order); // Save history\n\n        var newValue = [];\n\n        for (var j = 0; j < temp.length; j++) {\n          newValue[j] = temp[j][0];\n        } // Save history\n\n\n        obj.setHistory({\n          action: 'orderBy',\n          rows: newValue,\n          column: column,\n          order: order\n        }); // Update order\n\n        obj.updateOrderArrow(column, order);\n        obj.updateOrder(newValue); // On sort event\n\n        if (obj.ignoreEvents != true) {\n          if (typeof obj.options.onsort == 'function') {\n            obj.options.onsort(el, column, order);\n          }\n        }\n\n        return true;\n      }\n    };\n    /**\n     * Update order arrow\n     */\n\n\n    obj.updateOrderArrow = function (column, order) {\n      // Remove order\n      for (var i = 0; i < obj.headers.length; i++) {\n        obj.headers[i].classList.remove('arrow-up');\n        obj.headers[i].classList.remove('arrow-down');\n      } // No order specified then toggle order\n\n\n      if (order) {\n        obj.headers[column].classList.add('arrow-up');\n      } else {\n        obj.headers[column].classList.add('arrow-down');\n      }\n    };\n    /**\n     * Update rows position\n     */\n\n\n    obj.updateOrder = function (rows) {\n      // History\n      var data = [];\n\n      for (var j = 0; j < rows.length; j++) {\n        data[j] = obj.options.data[rows[j]];\n      }\n\n      obj.options.data = data;\n      var data = [];\n\n      for (var j = 0; j < rows.length; j++) {\n        data[j] = obj.records[rows[j]];\n      }\n\n      obj.records = data;\n      var data = [];\n\n      for (var j = 0; j < rows.length; j++) {\n        data[j] = obj.rows[rows[j]];\n      }\n\n      obj.rows = data; // Update references\n\n      obj.updateTableReferences(); // Redo search\n\n      if (obj.searchInput.value) {\n        obj.search(obj.searchInput.value);\n      } else {\n        // Create page\n        obj.results = null;\n        obj.pageNumber = 0;\n\n        if (obj.options.pagination > 0) {\n          obj.page(0);\n        } else if (obj.options.lazyLoading == true) {\n          obj.loadPage(0);\n        } else {\n          for (var j = 0; j < obj.rows.length; j++) {\n            obj.tbody.appendChild(obj.rows[j]);\n          }\n        }\n      }\n    };\n    /**\n     * Move row\n     * \n     * @return void\n     */\n\n\n    obj.moveRow = function (o, d, ignoreDom) {\n      if (Object.keys(obj.options.mergeCells).length > 0) {\n        if (o > d) {\n          var insertBefore = 1;\n        } else {\n          var insertBefore = 0;\n        }\n\n        if (obj.isRowMerged(o).length || obj.isRowMerged(d, insertBefore).length) {\n          if (!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n            return false;\n          } else {\n            obj.destroyMerged();\n          }\n        }\n      }\n\n      if (obj.options.search == true) {\n        if (obj.results && obj.results.length != obj.rows.length) {\n          if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n            obj.resetSearch();\n          } else {\n            return false;\n          }\n        }\n\n        obj.results = null;\n      }\n\n      if (!ignoreDom) {\n        if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[d]) >= 0) {\n          if (o > d) {\n            obj.tbody.insertBefore(obj.rows[o], obj.rows[d]);\n          } else {\n            obj.tbody.insertBefore(obj.rows[o], obj.rows[d].nextSibling);\n          }\n        } else {\n          obj.tbody.removeChild(obj.rows[o]);\n        }\n      } // Place references in the correct position\n\n\n      obj.rows.splice(d, 0, obj.rows.splice(o, 1)[0]);\n      obj.records.splice(d, 0, obj.records.splice(o, 1)[0]);\n      obj.options.data.splice(d, 0, obj.options.data.splice(o, 1)[0]); // Respect pagination\n\n      if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n        obj.page(obj.pageNumber);\n      } // Keeping history of changes\n\n\n      obj.setHistory({\n        action: 'moveRow',\n        oldValue: o,\n        newValue: d\n      }); // Update table references\n\n      obj.updateTableReferences(); // Events\n\n      if (obj.ignoreEvents != true) {\n        if (typeof obj.options.onmoverow == 'function') {\n          obj.options.onmoverow(el, o, d);\n        }\n      }\n    };\n    /**\n     * Insert a new row\n     * \n     * @param mixed - number of blank lines to be insert or a single array with the data of the new row\n     * @param rowNumber\n     * @param insertBefore\n     * @return void\n     */\n\n\n    obj.insertRow = function (mixed, rowNumber, insertBefore) {\n      // Configuration\n      if (obj.options.allowInsertRow == true) {\n        // Records\n        var records = []; // Data to be insert\n\n        var data = []; // The insert could be lead by number of rows or the array of data\n\n        if (mixed > 0) {\n          var numOfRows = mixed;\n        } else {\n          var numOfRows = 1;\n\n          if (mixed) {\n            data = mixed;\n          }\n        } // Direction\n\n\n        var insertBefore = insertBefore ? true : false; // Current column number\n\n        var lastRow = obj.options.data.length - 1;\n\n        if (rowNumber == undefined || rowNumber >= parseInt(lastRow) || rowNumber < 0) {\n          rowNumber = lastRow;\n        } // Onbeforeinsertrow\n\n\n        if (typeof obj.options.onbeforeinsertrow == 'function') {\n          if (!obj.options.onbeforeinsertrow(el, rowNumber, numOfRows, insertBefore)) {\n            console.log('onbeforeinsertrow returned false');\n            return false;\n          }\n        } // Merged cells\n\n\n        if (Object.keys(obj.options.mergeCells).length > 0) {\n          if (obj.isRowMerged(rowNumber, insertBefore).length) {\n            if (!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n              return false;\n            } else {\n              obj.destroyMerged();\n            }\n          }\n        } // Clear any search\n\n\n        if (obj.options.search == true) {\n          if (obj.results && obj.results.length != obj.rows.length) {\n            if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n              obj.resetSearch();\n            } else {\n              return false;\n            }\n          }\n\n          obj.results = null;\n        } // Insertbefore\n\n\n        var rowIndex = !insertBefore ? rowNumber + 1 : rowNumber; // Keep the current data\n\n        var currentRecords = obj.records.splice(rowIndex);\n        var currentData = obj.options.data.splice(rowIndex);\n        var currentRows = obj.rows.splice(rowIndex); // Adding lines\n\n        var rowRecords = [];\n        var rowData = [];\n        var rowNode = [];\n\n        for (var row = rowIndex; row < numOfRows + rowIndex; row++) {\n          // Push data to the data container\n          obj.options.data[row] = [];\n\n          for (var col = 0; col < obj.options.columns.length; col++) {\n            obj.options.data[row][col] = data[col] ? data[col] : '';\n          } // Create row\n\n\n          var tr = obj.createRow(row, obj.options.data[row]); // Append node\n\n          if (currentRows[0]) {\n            if (Array.prototype.indexOf.call(obj.tbody.children, currentRows[0]) >= 0) {\n              obj.tbody.insertBefore(tr, currentRows[0]);\n            }\n          } else {\n            if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[rowNumber]) >= 0) {\n              obj.tbody.appendChild(tr);\n            }\n          } // Record History\n\n\n          rowRecords.push(obj.records[row]);\n          rowData.push(obj.options.data[row]);\n          rowNode.push(tr);\n        } // Copy the data back to the main data\n\n\n        Array.prototype.push.apply(obj.records, currentRecords);\n        Array.prototype.push.apply(obj.options.data, currentData);\n        Array.prototype.push.apply(obj.rows, currentRows); // Respect pagination\n\n        if (obj.options.pagination > 0) {\n          obj.page(obj.pageNumber);\n        } // Keep history\n\n\n        obj.setHistory({\n          action: 'insertRow',\n          rowNumber: rowNumber,\n          numOfRows: numOfRows,\n          insertBefore: insertBefore,\n          rowRecords: rowRecords,\n          rowData: rowData,\n          rowNode: rowNode\n        }); // Remove table references\n\n        obj.updateTableReferences(); // Events\n\n        if (obj.ignoreEvents != true) {\n          if (typeof obj.options.oninsertrow == 'function') {\n            obj.options.oninsertrow(el, rowNumber, numOfRows, rowRecords, insertBefore);\n          }\n        }\n      }\n    };\n    /**\n     * Delete a row by number\n     * \n     * @param integer rowNumber - row number to be excluded\n     * @param integer numOfRows - number of lines\n     * @return void\n     */\n\n\n    obj.deleteRow = function (rowNumber, numOfRows) {\n      // Global Configuration\n      if (obj.options.allowDeleteRow == true) {\n        if (obj.options.allowDeletingAllRows == true || obj.options.data.length > 1) {\n          // Delete row definitions\n          if (rowNumber == undefined) {\n            var number = obj.getSelectedRows();\n\n            if (!number[0]) {\n              rowNumber = obj.options.data.length - 1;\n              numOfRows = 1;\n            } else {\n              rowNumber = parseInt(number[0].getAttribute('data-y'));\n              numOfRows = number.length;\n            }\n          } // Last column\n\n\n          var lastRow = obj.options.data.length - 1;\n\n          if (rowNumber == undefined || rowNumber > lastRow || rowNumber < 0) {\n            rowNumber = lastRow;\n          }\n\n          if (!numOfRows) {\n            numOfRows = 1;\n          } // Do not delete more than the number of recoreds\n\n\n          if (rowNumber + numOfRows >= obj.options.data.length) {\n            numOfRows = obj.options.data.length - rowNumber;\n          } // Onbeforedeleterow\n\n\n          if (typeof obj.options.onbeforedeleterow == 'function') {\n            if (!obj.options.onbeforedeleterow(el, rowNumber, numOfRows)) {\n              console.log('onbeforedeleterow returned false');\n              return false;\n            }\n          }\n\n          if (parseInt(rowNumber) > -1) {\n            // Merged cells\n            var mergeExists = false;\n\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n              for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n                if (obj.isRowMerged(row, false).length) {\n                  mergeExists = true;\n                }\n              }\n            }\n\n            if (mergeExists) {\n              if (!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                return false;\n              } else {\n                obj.destroyMerged();\n              }\n            } // Clear any search\n\n\n            if (obj.options.search == true) {\n              if (obj.results && obj.results.length != obj.rows.length) {\n                if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                  obj.resetSearch();\n                } else {\n                  return false;\n                }\n              }\n\n              obj.results = null;\n            } // Remove node\n\n\n            for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n              if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[row]) >= 0) {\n                obj.rows[row].className = '';\n                obj.rows[row].parentNode.removeChild(obj.rows[row]);\n              }\n            } // Remove data\n\n\n            var rowRecords = obj.records.splice(rowNumber, numOfRows);\n            var rowData = obj.options.data.splice(rowNumber, numOfRows);\n            var rowNode = obj.rows.splice(rowNumber, numOfRows); // Respect pagination\n\n            if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n              obj.page(obj.pageNumber);\n            } // Remove selection\n\n\n            obj.conditionalSelectionUpdate(1, rowNumber, rowNumber + numOfRows - 1); // Keep history\n\n            obj.setHistory({\n              action: 'deleteRow',\n              rowNumber: rowNumber,\n              numOfRows: numOfRows,\n              insertBefore: 1,\n              rowRecords: rowRecords,\n              rowData: rowData,\n              rowNode: rowNode\n            }); // Remove table references\n\n            obj.updateTableReferences(); // Events\n\n            if (obj.ignoreEvents != true) {\n              if (typeof obj.options.ondeleterow == 'function') {\n                obj.options.ondeleterow(el, rowNumber, numOfRows, rowRecords);\n              }\n            }\n          }\n        } else {\n          console.error('JEXCEL. It is not possible to delete the last row');\n        }\n      }\n    };\n    /**\n     * Move column\n     * \n     * @return void\n     */\n\n\n    obj.moveColumn = function (o, d) {\n      if (Object.keys(obj.options.mergeCells).length > 0) {\n        if (o > d) {\n          var insertBefore = 1;\n        } else {\n          var insertBefore = 0;\n        }\n\n        if (obj.isColMerged(o).length || obj.isColMerged(d, insertBefore).length) {\n          if (!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n            return false;\n          } else {\n            obj.destroyMerged();\n          }\n        }\n      }\n\n      var o = parseInt(o);\n      var d = parseInt(d);\n\n      if (o > d) {\n        obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d]);\n        obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d]);\n\n        for (var j = 0; j < obj.rows.length; j++) {\n          obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d]);\n        }\n      } else {\n        obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d].nextSibling);\n        obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d].nextSibling);\n\n        for (var j = 0; j < obj.rows.length; j++) {\n          obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d].nextSibling);\n        }\n      }\n\n      obj.options.columns.splice(d, 0, obj.options.columns.splice(o, 1)[0]);\n      obj.headers.splice(d, 0, obj.headers.splice(o, 1)[0]);\n      obj.colgroup.splice(d, 0, obj.colgroup.splice(o, 1)[0]);\n\n      for (var j = 0; j < obj.rows.length; j++) {\n        obj.options.data[j].splice(d, 0, obj.options.data[j].splice(o, 1)[0]);\n        obj.records[j].splice(d, 0, obj.records[j].splice(o, 1)[0]);\n      } // Keeping history of changes\n\n\n      obj.setHistory({\n        action: 'moveColumn',\n        oldValue: o,\n        newValue: d\n      }); // Update table references\n\n      obj.updateTableReferences(); // Events\n\n      if (obj.ignoreEvents != true) {\n        if (typeof obj.options.onmovecolumn == 'function') {\n          obj.options.onmovecolumn(el, o, d);\n        }\n      }\n    };\n    /**\n     * Insert a new column\n     * \n     * @param mixed - num of columns to be added or data to be added in one single column\n     * @param int columnNumber - number of columns to be created\n     * @param bool insertBefore\n     * @param object properties - column properties\n     * @return void\n     */\n\n\n    obj.insertColumn = function (mixed, columnNumber, insertBefore, properties) {\n      // Configuration\n      if (obj.options.allowInsertColumn == true) {\n        // Records\n        var records = []; // Data to be insert\n\n        var data = []; // The insert could be lead by number of rows or the array of data\n\n        if (mixed > 0) {\n          var numOfColumns = mixed;\n        } else {\n          var numOfColumns = 1;\n\n          if (mixed) {\n            data = mixed;\n          }\n        } // Direction\n\n\n        var insertBefore = insertBefore ? true : false; // Current column number\n\n        var lastColumn = obj.options.columns.length - 1; // Confirm position\n\n        if (columnNumber == undefined || columnNumber >= parseInt(lastColumn) || columnNumber < 0) {\n          columnNumber = lastColumn;\n        } // Onbeforeinsertcolumn\n\n\n        if (typeof obj.options.onbeforeinsertcolumn == 'function') {\n          if (!obj.options.onbeforeinsertcolumn(el, columnNumber, numOfColumns, insertBefore)) {\n            console.log('onbeforeinsertcolumn returned false');\n            return false;\n          }\n        } // Merged cells\n\n\n        if (Object.keys(obj.options.mergeCells).length > 0) {\n          if (obj.isColMerged(columnNumber, insertBefore).length) {\n            if (!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n              return false;\n            } else {\n              obj.destroyMerged();\n            }\n          }\n        } // Create default properties\n\n\n        if (!properties) {\n          properties = [];\n        }\n\n        for (var i = 0; i < numOfColumns; i++) {\n          if (!properties[i]) {\n            properties[i] = {\n              type: 'text',\n              source: [],\n              options: [],\n              width: obj.options.defaultColWidth,\n              align: obj.options.defaultColAlign\n            };\n          }\n        } // Insert before\n\n\n        var columnIndex = !insertBefore ? columnNumber + 1 : columnNumber;\n        obj.options.columns = _jexcel.injectArray(obj.options.columns, columnIndex, properties); // Open space in the containers\n\n        var currentHeaders = obj.headers.splice(columnIndex);\n        var currentColgroup = obj.colgroup.splice(columnIndex); // History\n\n        var historyHeaders = [];\n        var historyColgroup = [];\n        var historyRecords = [];\n        var historyData = []; // Add new headers\n\n        for (var col = columnIndex; col < numOfColumns + columnIndex; col++) {\n          obj.createCellHeader(col);\n          obj.headerContainer.insertBefore(obj.headers[col], obj.headerContainer.children[col + 1]);\n          obj.colgroupContainer.insertBefore(obj.colgroup[col], obj.colgroupContainer.children[col + 1]);\n          historyHeaders.push(obj.headers[col]);\n          historyColgroup.push(obj.colgroup[col]);\n        } // Adding visual columns\n\n\n        for (var row = 0; row < obj.options.data.length; row++) {\n          // Keep the current data\n          var currentData = obj.options.data[row].splice(columnIndex);\n          var currentRecord = obj.records[row].splice(columnIndex); // History\n\n          historyData[row] = [];\n          historyRecords[row] = [];\n\n          for (var col = columnIndex; col < numOfColumns + columnIndex; col++) {\n            // New value\n            var value = data[row] ? data[row] : '';\n            obj.options.data[row][col] = value; // New cell\n\n            var td = obj.createCell(col, row, obj.options.data[row][col]);\n            obj.records[row][col] = td; // Add cell to the row\n\n            if (obj.rows[row]) {\n              obj.rows[row].insertBefore(td, obj.rows[row].children[col + 1]);\n            } // Record History\n\n\n            historyData[row].push(value);\n            historyRecords[row].push(td);\n          } // Copy the data back to the main data\n\n\n          Array.prototype.push.apply(obj.options.data[row], currentData);\n          Array.prototype.push.apply(obj.records[row], currentRecord);\n        }\n\n        Array.prototype.push.apply(obj.headers, currentHeaders);\n        Array.prototype.push.apply(obj.colgroup, currentColgroup); // Adjust nested headers\n\n        if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n          // Flexible way to handle nestedheaders\n          if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n            for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n              var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length - 1].colspan) + numOfColumns;\n              obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length - 1].colspan = colspan;\n              obj.thead.children[j].children[obj.thead.children[j].children.length - 1].setAttribute('colspan', colspan);\n            }\n          } else {\n            var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + numOfColumns;\n            obj.options.nestedHeaders[0].colspan = colspan;\n            obj.thead.children[0].children[obj.thead.children[0].children.length - 1].setAttribute('colspan', colspan);\n          }\n        } // Keep history\n\n\n        obj.setHistory({\n          action: 'insertColumn',\n          columnNumber: columnNumber,\n          numOfColumns: numOfColumns,\n          insertBefore: insertBefore,\n          columns: properties,\n          headers: historyHeaders,\n          colgroup: historyColgroup,\n          records: historyRecords,\n          data: historyData\n        }); // Remove table references\n\n        obj.updateTableReferences(); // Events\n\n        if (obj.ignoreEvents != true) {\n          if (typeof obj.options.oninsertcolumn == 'function') {\n            obj.options.oninsertcolumn(el, columnNumber, numOfColumns, historyRecords, insertBefore);\n          }\n        }\n      }\n    };\n    /**\n     * Delete a column by number\n     * \n     * @param integer columnNumber - reference column to be excluded\n     * @param integer numOfColumns - number of columns to be excluded from the reference column\n     * @return void\n     */\n\n\n    obj.deleteColumn = function (columnNumber, numOfColumns) {\n      // Global Configuration\n      if (obj.options.allowDeleteColumn == true) {\n        if (obj.headers.length > 1) {\n          // Delete column definitions\n          if (columnNumber == undefined) {\n            var number = obj.getSelectedColumns(true);\n\n            if (!number.length) {\n              // Remove last column\n              columnNumber = obj.headers.length - 1;\n              numOfColumns = 1;\n            } else {\n              // Remove selected\n              columnNumber = parseInt(number[0]);\n              numOfColumns = parseInt(number.length);\n            }\n          } // Lasat column\n\n\n          var lastColumn = obj.options.data[0].length - 1;\n\n          if (columnNumber == undefined || columnNumber > lastColumn || columnNumber < 0) {\n            columnNumber = lastColumn;\n          } // Minimum of columns to be delete is 1\n\n\n          if (!numOfColumns) {\n            numOfColumns = 1;\n          } // Can't delete more than the limit of the table\n\n\n          if (numOfColumns > obj.options.data[0].length - columnNumber) {\n            numOfColumns = obj.options.data[0].length - columnNumber;\n          } // onbeforedeletecolumn\n\n\n          if (typeof obj.options.onbeforedeletecolumn == 'function') {\n            if (!obj.options.onbeforedeletecolumn(el, columnNumber, numOfColumns)) {\n              console.log('onbeforedeletecolumn returned false');\n              return false;\n            }\n          } // Can't remove the last column\n\n\n          if (parseInt(columnNumber) > -1) {\n            // Merged cells\n            var mergeExists = false;\n\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n              for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                if (obj.isColMerged(col, false).length) {\n                  mergeExists = true;\n                }\n              }\n            }\n\n            if (mergeExists) {\n              if (!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                return false;\n              } else {\n                obj.destroyMerged();\n              }\n            } // Delete the column properties\n\n\n            var columns = obj.options.columns.splice(columnNumber, numOfColumns);\n\n            for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n              obj.colgroup[col].className = '';\n              obj.headers[col].className = '';\n              obj.colgroup[col].parentNode.removeChild(obj.colgroup[col]);\n              obj.headers[col].parentNode.removeChild(obj.headers[col]);\n            }\n\n            var historyHeaders = obj.headers.splice(columnNumber, numOfColumns);\n            var historyColgroup = obj.colgroup.splice(columnNumber, numOfColumns);\n            var historyRecords = [];\n            var historyData = [];\n\n            for (var row = 0; row < obj.options.data.length; row++) {\n              for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                obj.records[row][col].className = '';\n                obj.records[row][col].parentNode.removeChild(obj.records[row][col]);\n              }\n            } // Delete headers\n\n\n            for (var row = 0; row < obj.options.data.length; row++) {\n              // History\n              historyData[row] = obj.options.data[row].splice(columnNumber, numOfColumns);\n              historyRecords[row] = obj.records[row].splice(columnNumber, numOfColumns);\n            } // Remove selection\n\n\n            obj.conditionalSelectionUpdate(0, columnNumber, columnNumber + numOfColumns - 1); // Adjust nested headers\n\n            if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n              // Flexible way to handle nestedheaders\n              if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                  var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length - 1].colspan) - numOfColumns;\n                  obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length - 1].colspan = colspan;\n                  obj.thead.children[j].children[obj.thead.children[j].children.length - 1].setAttribute('colspan', colspan);\n                }\n              } else {\n                var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - numOfColumns;\n                obj.options.nestedHeaders[0].colspan = colspan;\n                obj.thead.children[0].children[obj.thead.children[0].children.length - 1].setAttribute('colspan', colspan);\n              }\n            } // Keeping history of changes\n\n\n            obj.setHistory({\n              action: 'deleteColumn',\n              columnNumber: columnNumber,\n              numOfColumns: numOfColumns,\n              insertBefore: 1,\n              columns: columns,\n              headers: historyHeaders,\n              colgroup: historyColgroup,\n              records: historyRecords,\n              data: historyData\n            }); // Update table references\n\n            obj.updateTableReferences(); // Delete\n\n            if (obj.ignoreEvents != true) {\n              if (typeof obj.options.ondeletecolumn == 'function') {\n                obj.options.ondeletecolumn(el, columnNumber, numOfColumns, historyRecords);\n              }\n            }\n          }\n        } else {\n          console.error('JEXCEL. It is not possible to delete the last column');\n        }\n      }\n    };\n    /**\n     * Get seleted rows numbers\n     * \n     * @return array\n     */\n\n\n    obj.getSelectedRows = function (asIds) {\n      var rows = []; // Get all selected rows\n\n      for (var j = 0; j < obj.rows.length; j++) {\n        if (obj.rows[j].classList.contains('selected')) {\n          if (asIds) {\n            rows.push(j);\n          } else {\n            rows.push(obj.rows[j]);\n          }\n        }\n      }\n\n      return rows;\n    },\n    /**\n     * Get seleted column numbers\n     * \n     * @return array\n     */\n    obj.getSelectedColumns = function () {\n      var cols = []; // Get all selected cols\n\n      for (var i = 0; i < obj.headers.length; i++) {\n        if (obj.headers[i].classList.contains('selected')) {\n          cols.push(i);\n        }\n      }\n\n      return cols;\n    };\n    /**\n     * Get highlighted\n     * \n     * @return array\n     */\n\n    obj.getHighlighted = function () {\n      return obj.highlighted;\n    };\n    /**\n     * Update cell references\n     * \n     * @return void\n     */\n\n\n    obj.updateTableReferences = function () {\n      // Update headers\n      for (var i = 0; i < obj.headers.length; i++) {\n        var x = obj.headers[i].getAttribute('data-x');\n\n        if (x != i) {\n          // Update coords\n          obj.headers[i].setAttribute('data-x', i); // Title\n\n          if (!obj.headers[i].getAttribute('title')) {\n            obj.headers[i].innerHTML = _jexcel.getColumnName(i);\n          }\n        }\n      } // Update all rows\n\n\n      for (var j = 0; j < obj.rows.length; j++) {\n        if (obj.rows[j]) {\n          var y = obj.rows[j].getAttribute('data-y');\n\n          if (y != j) {\n            // Update coords\n            obj.rows[j].setAttribute('data-y', j);\n            obj.rows[j].children[0].setAttribute('data-y', j); // Row number\n\n            obj.rows[j].children[0].innerHTML = j + 1;\n          }\n        }\n      } // Regular cells affected by this change\n\n\n      var affectedTokens = [];\n      var mergeCellUpdates = []; // Update cell\n\n      var updatePosition = function updatePosition(x, y, i, j) {\n        if (x != i) {\n          obj.records[j][i].setAttribute('data-x', i);\n        }\n\n        if (y != j) {\n          obj.records[j][i].setAttribute('data-y', j);\n        } // Other updates\n\n\n        if (x != i || y != j) {\n          var columnIdFrom = _jexcel.getColumnNameFromId([x, y]);\n\n          var columnIdTo = _jexcel.getColumnNameFromId([i, j]);\n\n          affectedTokens[columnIdFrom] = columnIdTo;\n        }\n      };\n\n      for (var j = 0; j < obj.records.length; j++) {\n        for (var i = 0; i < obj.records[0].length; i++) {\n          if (obj.records[j][i]) {\n            // Current values\n            var x = obj.records[j][i].getAttribute('data-x');\n            var y = obj.records[j][i].getAttribute('data-y'); // Update column\n\n            if (obj.records[j][i].getAttribute('data-merged')) {\n              var columnIdFrom = _jexcel.getColumnNameFromId([x, y]);\n\n              var columnIdTo = _jexcel.getColumnNameFromId([i, j]);\n\n              if (mergeCellUpdates[columnIdFrom] == null) {\n                if (columnIdFrom == columnIdTo) {\n                  mergeCellUpdates[columnIdFrom] = false;\n                } else {\n                  var totalX = parseInt(i - x);\n                  var totalY = parseInt(j - y);\n                  mergeCellUpdates[columnIdFrom] = [columnIdTo, totalX, totalY];\n                }\n              }\n            } else {\n              updatePosition(x, y, i, j);\n            }\n          }\n        }\n      } // Update merged if applicable\n\n\n      var keys = Object.keys(mergeCellUpdates);\n\n      if (keys.length) {\n        for (var i = 0; i < keys.length; i++) {\n          if (mergeCellUpdates[keys[i]]) {\n            var info = _jexcel.getIdFromColumnName(keys[i], true);\n\n            var x = info[0];\n            var y = info[1];\n            updatePosition(x, y, x + mergeCellUpdates[keys[i]][1], y + mergeCellUpdates[keys[i]][2]);\n            var columnIdFrom = keys[i];\n            var columnIdTo = mergeCellUpdates[keys[i]][0];\n\n            for (var j = 0; j < obj.options.mergeCells[columnIdFrom][2].length; j++) {\n              var x = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-x'));\n              var y = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-y'));\n              obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-x', x + mergeCellUpdates[keys[i]][1]);\n              obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-y', y + mergeCellUpdates[keys[i]][2]);\n            }\n\n            obj.options.mergeCells[columnIdTo] = obj.options.mergeCells[columnIdFrom];\n            delete obj.options.mergeCells[columnIdFrom];\n          }\n        }\n      } // Update formulas\n\n\n      obj.updateFormulas(affectedTokens); // Update meta data\n\n      obj.updateMeta(affectedTokens); // Refresh selection\n\n      obj.refreshSelection(); // Update table with custom configuration if applicable\n\n      obj.updateTable();\n    };\n    /**\n     * Custom settings for the cells\n     */\n\n\n    obj.updateTable = function () {\n      // Check for spare\n      if (obj.options.minSpareRows > 0) {\n        var numBlankRows = 0;\n\n        for (var j = obj.rows.length - 1; j >= 0; j--) {\n          var test = false;\n\n          for (var i = 0; i < obj.headers.length; i++) {\n            if (obj.options.data[j][i]) {\n              test = true;\n            }\n          }\n\n          if (test) {\n            break;\n          } else {\n            numBlankRows++;\n          }\n        }\n\n        if (obj.options.minSpareRows - numBlankRows > 0) {\n          obj.insertRow(obj.options.minSpareRows - numBlankRows);\n        }\n      }\n\n      if (obj.options.minSpareCols > 0) {\n        var numBlankCols = 0;\n\n        for (var i = obj.headers.length - 1; i >= 0; i--) {\n          var test = false;\n\n          for (var j = 0; j < obj.rows.length; j++) {\n            if (obj.options.data[j][i]) {\n              test = true;\n            }\n          }\n\n          if (test) {\n            break;\n          } else {\n            numBlankCols++;\n          }\n        }\n\n        if (obj.options.minSpareCols - numBlankCols > 0) {\n          obj.insertColumn(obj.options.minSpareCols - numBlankCols);\n        }\n      } // Customizations by the developer\n\n\n      if (typeof obj.options.updateTable == 'function') {\n        if (obj.options.detachForUpdates) {\n          el.removeChild(obj.content);\n        }\n\n        for (var j = 0; j < obj.rows.length; j++) {\n          for (var i = 0; i < obj.headers.length; i++) {\n            obj.options.updateTable(el, obj.records[j][i], i, j, obj.options.data[j][i], obj.records[j][i].innerText, _jexcel.getColumnNameFromId([i, j]));\n          }\n        }\n\n        if (obj.options.detachForUpdates) {\n          el.insertBefore(obj.content, obj.pagination);\n        }\n      } // Update corner position\n\n\n      setTimeout(function () {\n        obj.updateCornerPosition();\n      }, 0);\n    };\n    /**\r\n     * Show column\r\n     */\n\n\n    obj.showColumn = function (colNumber) {\n      obj.headers[colNumber].style.display = '';\n      obj.colgroup[colNumber].style.display = '';\n\n      for (var j = 0; j < obj.options.data.length; j++) {\n        obj.records[j][colNumber].style.display = '';\n      }\n    };\n    /**\r\n     * Hide column\r\n     */\n\n\n    obj.hideColumn = function (colNumber) {\n      obj.headers[colNumber].style.display = 'none';\n      obj.colgroup[colNumber].style.display = 'none';\n\n      for (var j = 0; j < obj.options.data.length; j++) {\n        obj.records[j][colNumber].style.display = 'none';\n      }\n    };\n    /**\n     * Show index column\n     */\n\n\n    obj.showIndex = function () {\n      obj.table.classList.remove('jexcel_hidden_index');\n    };\n    /**\n     * Hide index column\n     */\n\n\n    obj.hideIndex = function () {\n      obj.table.classList.add('jexcel_hidden_index');\n    };\n    /**\n     * Update all related cells in the chain\n     */\n\n\n    var chainLoopProtection = [];\n\n    obj.updateFormulaChain = function (x, y, records) {\n      var cellId = _jexcel.getColumnNameFromId([x, y]);\n\n      if (obj.formula[cellId] && obj.formula[cellId].length > 0) {\n        if (chainLoopProtection[cellId]) {\n          obj.records[y][x].innerHTML = '#ERROR';\n          obj.formula[cellId] = '';\n        } else {\n          // Protection\n          chainLoopProtection[cellId] = true;\n\n          for (var i = 0; i < obj.formula[cellId].length; i++) {\n            var cell = _jexcel.getIdFromColumnName(obj.formula[cellId][i], true); // Update cell\n\n\n            var value = '' + obj.options.data[cell[1]][cell[0]];\n\n            if (value.substr(0, 1) == '=') {\n              records.push(obj.updateCell(cell[0], cell[1], value, true));\n            } else {\n              // No longer a formula, remove from the chain\n              Object.keys(obj.formula)[i] = null;\n            }\n\n            obj.updateFormulaChain(cell[0], cell[1], records);\n          }\n        }\n      }\n\n      chainLoopProtection = [];\n    };\n    /**\n     * Update formulas\n     */\n\n\n    obj.updateFormulas = function (referencesToUpdate) {\n      // Update formulas\n      for (var j = 0; j < obj.options.data.length; j++) {\n        for (var i = 0; i < obj.options.data[0].length; i++) {\n          var value = '' + obj.options.data[j][i]; // Is formula\n\n          if (value.substr(0, 1) == '=') {\n            // Replace tokens\n            var newFormula = obj.updateFormula(value, referencesToUpdate);\n\n            if (newFormula != value) {\n              obj.options.data[j][i] = newFormula;\n            }\n          }\n        }\n      } // Update formula chain\n\n\n      var formula = [];\n      var keys = Object.keys(obj.formula);\n\n      for (var j = 0; j < keys.length; j++) {\n        // Current key and values\n        var key = keys[j];\n        var value = obj.formula[key]; // Update key\n\n        if (referencesToUpdate[key]) {\n          key = referencesToUpdate[key];\n        } // Update values\n\n\n        formula[key] = [];\n\n        for (var i = 0; i < value.length; i++) {\n          var letter = value[i];\n\n          if (referencesToUpdate[letter]) {\n            letter = referencesToUpdate[letter];\n          }\n\n          formula[key].push(letter);\n        }\n      }\n\n      obj.formula = formula;\n    };\n    /**\n     * Update formula\n     */\n\n\n    obj.updateFormula = function (formula, referencesToUpdate) {\n      var testLetter = /[A-Z]/;\n      var testNumber = /[0-9]/;\n      var newFormula = '';\n      var letter = null;\n      var number = null;\n      var token = '';\n\n      for (var index = 0; index < formula.length; index++) {\n        if (testLetter.exec(formula[index])) {\n          letter = 1;\n          number = 0;\n          token += formula[index];\n        } else if (testNumber.exec(formula[index])) {\n          number = letter ? 1 : 0;\n          token += formula[index];\n        } else {\n          if (letter && number) {\n            token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n          }\n\n          newFormula += token;\n          newFormula += formula[index];\n          letter = 0;\n          number = 0;\n          token = '';\n        }\n      }\n\n      if (token) {\n        if (letter && number) {\n          token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n        }\n\n        newFormula += token;\n      }\n\n      return newFormula;\n    };\n    /**\n     * Parse formulas\n     */\n\n\n    obj.executeFormula = function (expression, x, y) {\n      var formulaResults = [];\n      var formulaLoopProtection = []; // Execute formula with loop protection\n\n      var execute = function execute(expression, x, y) {\n        // Parent column identification\n        var parentId = _jexcel.getColumnNameFromId([x, y]); // Code protection\n\n\n        if (formulaLoopProtection[parentId]) {\n          console.error('Reference loop detected');\n          return '#ERROR';\n        }\n\n        formulaLoopProtection[parentId] = true; // Convert range tokens\n\n        var tokensUpdate = function tokensUpdate(tokens) {\n          for (var index = 0; index < tokens.length; index++) {\n            var f = [];\n            var token = tokens[index].split(':');\n\n            var e1 = _jexcel.getIdFromColumnName(token[0], true);\n\n            var e2 = _jexcel.getIdFromColumnName(token[1], true);\n\n            if (e1[0] <= e2[0]) {\n              var x1 = e1[0];\n              var x2 = e2[0];\n            } else {\n              var x1 = e2[0];\n              var x2 = e1[0];\n            }\n\n            if (e1[1] <= e2[1]) {\n              var y1 = e1[1];\n              var y2 = e2[1];\n            } else {\n              var y1 = e2[1];\n              var y2 = e1[1];\n            }\n\n            for (var j = y1; j <= y2; j++) {\n              for (var i = x1; i <= x2; i++) {\n                f.push(_jexcel.getColumnNameFromId([i, j]));\n              }\n            }\n\n            expression = expression.replace(tokens[index], f.join(','));\n          }\n        };\n\n        var tokens = expression.match(/([A-Z]+[0-9]+)\\:([A-Z]+[0-9]+)/g);\n\n        if (tokens && tokens.length) {\n          tokensUpdate(tokens);\n        } // String\n\n\n        var evalstring = ''; // Get tokens\n\n        var tokens = expression.match(/([A-Z]+[0-9]+)/g); // Direct self-reference protection\n\n        if (tokens && tokens.indexOf(parentId) > -1) {\n          console.error('Self Reference detected');\n          return '#ERROR';\n        } else {\n          if (tokens) {\n            for (var i = 0; i < tokens.length; i++) {\n              // Keep chain\n              if (!obj.formula[tokens[i]]) {\n                obj.formula[tokens[i]] = [];\n              } // Is already in the register\n\n\n              if (obj.formula[tokens[i]].indexOf(parentId) < 0) {\n                obj.formula[tokens[i]].push(parentId);\n              } // Do not calculate again\n\n\n              if (eval('typeof(' + tokens[i] + ') == \"undefined\"')) {\n                // Coords\n                var position = _jexcel.getIdFromColumnName(tokens[i], 1); // Get value\n\n\n                if (typeof obj.options.data[position[1]] != 'undefined' && typeof obj.options.data[position[1]][position[0]] != 'undefined') {\n                  var value = obj.options.data[position[1]][position[0]];\n                } else {\n                  var value = '';\n                } // Get column data\n\n\n                if (('' + value).substr(0, 1) == '=') {\n                  if (formulaResults[tokens[i]]) {\n                    value = formulaResults[tokens[i]];\n                  } else {\n                    value = execute(value, position[0], position[1]);\n                    formulaResults[tokens[i]] = value;\n                  }\n                } // Type!\n\n\n                if (('' + value).trim() == '') {\n                  // Null\n                  evalstring += \"var \" + tokens[i] + \" = null;\";\n                } else {\n                  if (value == Number(value) && obj.options.autoCasting == true) {\n                    // Number\n                    evalstring += \"var \" + tokens[i] + \" = \" + Number(value) + \";\";\n                  } else {\n                    // Trying any formatted number\n                    var number = obj.parseNumber(value, position[0]);\n\n                    if (obj.options.autoCasting == true && number) {\n                      // Render as number\n                      evalstring += \"var \" + tokens[i] + \" = \" + number + \";\";\n                    } else {\n                      // Render as string\n                      evalstring += \"var \" + tokens[i] + \" = '\" + value + \"';\";\n                    }\n                  }\n                }\n              }\n            }\n          } // Convert formula to javascript\n\n\n          try {\n            evalstring += \"function COLUMN() { return parseInt(x) + 1; }; function ROW() { return parseInt(y) + 1; }; function CELL() { return parentId; };\";\n            var res = eval(evalstring + expression.substr(1));\n          } catch (e) {\n            var res = '#ERROR';\n          }\n\n          return res;\n        }\n      };\n\n      return execute(expression, x, y);\n    };\n    /**\n     * Trying to extract a number from a string\n     */\n\n\n    obj.parseNumber = function (value, columnNumber) {\n      // Decimal point\n      var decimal = columnNumber && obj.options.columns[columnNumber].decimal ? obj.options.columns[columnNumber].decimal : '.'; // Parse both parts of the number\n\n      var number = '' + value;\n      number = number.split(decimal);\n      number[0] = number[0].match(/[+-]?[0-9]/g);\n\n      if (number[0]) {\n        number[0] = number[0].join('');\n      }\n\n      if (number[1]) {\n        number[1] = number[1].match(/[0-9]*/g).join('');\n      } // Is a valid number\n\n\n      if (number[0] && Number(number[0]) >= 0) {\n        if (!number[1]) {\n          var value = Number(number[0] + '.00');\n        } else {\n          var value = Number(number[0] + '.' + number[1]);\n        }\n      } else {\n        var value = null;\n      }\n\n      return value;\n    };\n    /**\n     * Get row number\n     */\n\n\n    obj.row = function (cell) {};\n    /**\n     * Get col number\n     */\n\n\n    obj.col = function (cell) {};\n\n    obj.up = function (shiftKey, ctrlKey) {\n      if (shiftKey) {\n        if (obj.selectedCell[3] > 0) {\n          obj.up.visible(1, ctrlKey ? 0 : 1);\n        }\n      } else {\n        if (obj.selectedCell[1] > 0) {\n          obj.up.visible(0, ctrlKey ? 0 : 1);\n        }\n\n        obj.selectedCell[2] = obj.selectedCell[0];\n        obj.selectedCell[3] = obj.selectedCell[1];\n      } // Update selection\n\n\n      obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]); // Change page\n\n      if (obj.options.lazyLoading == true) {\n        if (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0) {\n          obj.loadPage(0);\n          obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        } else {\n          if (obj.loadValidation()) {\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n          } else {\n            var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n\n            if (obj.selectedCell[1] - item < 30) {\n              obj.loadUp();\n              obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            }\n          }\n        }\n      } else if (obj.options.pagination > 0) {\n        var pageNumber = obj.whichPage(obj.selectedCell[3]);\n\n        if (pageNumber != obj.pageNumber) {\n          obj.page(pageNumber);\n        }\n      }\n\n      obj.updateScroll(1);\n    };\n\n    obj.up.visible = function (group, direction) {\n      if (group == 0) {\n        var x = parseInt(obj.selectedCell[0]);\n        var y = parseInt(obj.selectedCell[1]);\n      } else {\n        var x = parseInt(obj.selectedCell[2]);\n        var y = parseInt(obj.selectedCell[3]);\n      }\n\n      if (direction == 0) {\n        for (var j = 0; j < y; j++) {\n          if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n            y = j;\n            break;\n          }\n        }\n      } else {\n        y = obj.up.get(x, y);\n      }\n\n      if (group == 0) {\n        obj.selectedCell[0] = x;\n        obj.selectedCell[1] = y;\n      } else {\n        obj.selectedCell[2] = x;\n        obj.selectedCell[3] = y;\n      }\n    };\n\n    obj.up.get = function (x, y) {\n      var x = parseInt(x);\n      var y = parseInt(y);\n\n      for (var j = y - 1; j >= 0; j--) {\n        if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n          if (obj.records[j][x].getAttribute('data-merged')) {\n            if (obj.records[j][x] == obj.records[y][x]) {\n              continue;\n            }\n          }\n\n          y = j;\n          break;\n        }\n      }\n\n      return y;\n    };\n\n    obj.down = function (shiftKey, ctrlKey) {\n      if (shiftKey) {\n        if (obj.selectedCell[3] < obj.records.length - 1) {\n          obj.down.visible(1, ctrlKey ? 0 : 1);\n        }\n      } else {\n        if (obj.selectedCell[1] < obj.records.length - 1) {\n          obj.down.visible(0, ctrlKey ? 0 : 1);\n        }\n\n        obj.selectedCell[2] = obj.selectedCell[0];\n        obj.selectedCell[3] = obj.selectedCell[1];\n      }\n\n      obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]); // Change page\n\n      if (obj.options.lazyLoading == true) {\n        if (obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1) {\n          obj.loadPage(-1);\n          obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        } else {\n          if (obj.loadValidation()) {\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n          } else {\n            var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n\n            if (item - obj.selectedCell[3] < 30) {\n              obj.loadDown();\n              obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            }\n          }\n        }\n      } else if (obj.options.pagination > 0) {\n        var pageNumber = obj.whichPage(obj.selectedCell[3]);\n\n        if (pageNumber != obj.pageNumber) {\n          obj.page(pageNumber);\n        }\n      }\n\n      obj.updateScroll(3);\n    };\n\n    obj.down.visible = function (group, direction) {\n      if (group == 0) {\n        var x = parseInt(obj.selectedCell[0]);\n        var y = parseInt(obj.selectedCell[1]);\n      } else {\n        var x = parseInt(obj.selectedCell[2]);\n        var y = parseInt(obj.selectedCell[3]);\n      }\n\n      if (direction == 0) {\n        for (var j = obj.rows.length - 1; j > y; j--) {\n          if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n            y = j;\n            break;\n          }\n        }\n      } else {\n        y = obj.down.get(x, y);\n      }\n\n      if (group == 0) {\n        obj.selectedCell[0] = x;\n        obj.selectedCell[1] = y;\n      } else {\n        obj.selectedCell[2] = x;\n        obj.selectedCell[3] = y;\n      }\n    };\n\n    obj.down.get = function (x, y) {\n      var x = parseInt(x);\n      var y = parseInt(y);\n\n      for (var j = y + 1; j < obj.rows.length; j++) {\n        if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n          if (obj.records[j][x].getAttribute('data-merged')) {\n            if (obj.records[j][x] == obj.records[y][x]) {\n              continue;\n            }\n          }\n\n          y = j;\n          break;\n        }\n      }\n\n      return y;\n    };\n\n    obj.right = function (shiftKey, ctrlKey) {\n      if (shiftKey) {\n        if (obj.selectedCell[2] < obj.headers.length - 1) {\n          obj.right.visible(1, ctrlKey ? 0 : 1);\n        }\n      } else {\n        if (obj.selectedCell[0] < obj.headers.length - 1) {\n          obj.right.visible(0, ctrlKey ? 0 : 1);\n        }\n\n        obj.selectedCell[2] = obj.selectedCell[0];\n        obj.selectedCell[3] = obj.selectedCell[1];\n      }\n\n      obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n      obj.updateScroll(2);\n    };\n\n    obj.right.visible = function (group, direction) {\n      if (group == 0) {\n        var x = parseInt(obj.selectedCell[0]);\n        var y = parseInt(obj.selectedCell[1]);\n      } else {\n        var x = parseInt(obj.selectedCell[2]);\n        var y = parseInt(obj.selectedCell[3]);\n      }\n\n      if (direction == 0) {\n        for (var i = obj.headers.length - 1; i > x; i--) {\n          if (obj.records[y][i].style.display != 'none') {\n            x = i;\n            break;\n          }\n        }\n      } else {\n        x = obj.right.get(x, y);\n      }\n\n      if (group == 0) {\n        obj.selectedCell[0] = x;\n        obj.selectedCell[1] = y;\n      } else {\n        obj.selectedCell[2] = x;\n        obj.selectedCell[3] = y;\n      }\n    };\n\n    obj.right.get = function (x, y) {\n      var x = parseInt(x);\n      var y = parseInt(y);\n\n      for (var i = x + 1; i < obj.headers.length; i++) {\n        if (obj.records[y][i].style.display != 'none') {\n          if (obj.records[y][i].getAttribute('data-merged')) {\n            if (obj.records[y][i] == obj.records[y][x]) {\n              continue;\n            }\n          }\n\n          x = i;\n          break;\n        }\n      }\n\n      return x;\n    };\n\n    obj.left = function (shiftKey, ctrlKey) {\n      if (shiftKey) {\n        if (obj.selectedCell[2] > 0) {\n          obj.left.visible(1, ctrlKey ? 0 : 1);\n        }\n      } else {\n        if (obj.selectedCell[0] > 0) {\n          obj.left.visible(0, ctrlKey ? 0 : 1);\n        }\n\n        obj.selectedCell[2] = obj.selectedCell[0];\n        obj.selectedCell[3] = obj.selectedCell[1];\n      }\n\n      obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n      obj.updateScroll(0);\n    };\n\n    obj.left.visible = function (group, direction) {\n      if (group == 0) {\n        var x = parseInt(obj.selectedCell[0]);\n        var y = parseInt(obj.selectedCell[1]);\n      } else {\n        var x = parseInt(obj.selectedCell[2]);\n        var y = parseInt(obj.selectedCell[3]);\n      }\n\n      if (direction == 0) {\n        for (var i = 0; i < x; i++) {\n          if (obj.records[y][i].style.display != 'none') {\n            x = i;\n            break;\n          }\n        }\n      } else {\n        x = obj.left.get(x, y);\n      }\n\n      if (group == 0) {\n        obj.selectedCell[0] = x;\n        obj.selectedCell[1] = y;\n      } else {\n        obj.selectedCell[2] = x;\n        obj.selectedCell[3] = y;\n      }\n    };\n\n    obj.left.get = function (x, y) {\n      var x = parseInt(x);\n      var y = parseInt(y);\n\n      for (var i = x - 1; i >= 0; i--) {\n        if (obj.records[y][i].style.display != 'none') {\n          if (obj.records[y][i].getAttribute('data-merged')) {\n            if (obj.records[y][i] == obj.records[y][x]) {\n              continue;\n            }\n          }\n\n          x = i;\n          break;\n        }\n      }\n\n      return x;\n    };\n\n    obj.first = function (shiftKey, ctrlKey) {\n      if (shiftKey) {\n        if (ctrlKey) {\n          obj.selectedCell[3] = 0;\n        } else {\n          obj.left.visible(1, 0);\n        }\n      } else {\n        if (ctrlKey) {\n          obj.selectedCell[1] = 0;\n        } else {\n          obj.left.visible(0, 0);\n        }\n\n        obj.selectedCell[2] = obj.selectedCell[0];\n        obj.selectedCell[3] = obj.selectedCell[1];\n      } // Change page\n\n\n      if (obj.options.lazyLoading == true && (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0)) {\n        obj.loadPage(0);\n      } else if (obj.options.pagination > 0) {\n        var pageNumber = obj.whichPage(obj.selectedCell[3]);\n\n        if (pageNumber != obj.pageNumber) {\n          obj.page(pageNumber);\n        }\n      }\n\n      obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n      obj.updateScroll(1);\n    };\n\n    obj.last = function (shiftKey, ctrlKey) {\n      if (shiftKey) {\n        if (ctrlKey) {\n          obj.selectedCell[3] = obj.records.length - 1;\n        } else {\n          obj.right.visible(1, 0);\n        }\n      } else {\n        if (ctrlKey) {\n          obj.selectedCell[1] = obj.records.length - 1;\n        } else {\n          obj.right.visible(0, 0);\n        }\n\n        obj.selectedCell[2] = obj.selectedCell[0];\n        obj.selectedCell[3] = obj.selectedCell[1];\n      } // Change page\n\n\n      if (obj.options.lazyLoading == true && (obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\n        obj.loadPage(-1);\n      } else if (obj.options.pagination > 0) {\n        var pageNumber = obj.whichPage(obj.selectedCell[3]);\n\n        if (pageNumber != obj.pageNumber) {\n          obj.page(pageNumber);\n        }\n      }\n\n      obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n      obj.updateScroll(3);\n    };\n\n    obj.selectAll = function () {\n      if (!obj.selectedCell) {\n        obj.selectedCell = [];\n      }\n\n      obj.selectedCell[0] = 0;\n      obj.selectedCell[1] = 0;\n      obj.selectedCell[2] = obj.headers.length - 1;\n      obj.selectedCell[3] = obj.records.length - 1;\n      obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n    };\n    /**\n     * Go to a page in a lazyLoading\n     */\n\n\n    obj.loadPage = function (pageNumber) {\n      // Search\n      if (obj.options.search == true && obj.results) {\n        var results = obj.results;\n      } else {\n        var results = obj.rows;\n      } // Per page\n\n\n      var quantityPerPage = 100; // pageNumber\n\n      if (pageNumber == null || pageNumber == -1) {\n        // Last page\n        pageNumber = Math.ceil(results.length / quantityPerPage);\n      }\n\n      var startRow = pageNumber * quantityPerPage;\n      var finalRow = pageNumber * quantityPerPage + quantityPerPage;\n\n      if (finalRow > results.length) {\n        finalRow = results.length;\n      }\n\n      startRow = finalRow - 100;\n\n      if (startRow < 0) {\n        startRow = 0;\n      } // Appeding items\n\n\n      for (var j = startRow; j < finalRow; j++) {\n        if (obj.options.search == true && obj.results) {\n          obj.tbody.appendChild(obj.rows[results[j]]);\n        } else {\n          obj.tbody.appendChild(obj.rows[j]);\n        }\n\n        if (obj.tbody.children.length > quantityPerPage) {\n          obj.tbody.removeChild(obj.tbody.firstChild);\n        }\n      }\n    };\n\n    obj.loadUp = function () {\n      // Search\n      if (obj.options.search == true && obj.results) {\n        var results = obj.results;\n      } else {\n        var results = obj.rows;\n      }\n\n      var test = 0;\n\n      if (results.length > 100) {\n        // Get the first element in the page\n        var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n\n        if (obj.options.search == true && obj.results) {\n          item = results.indexOf(item);\n        }\n\n        if (item > 0) {\n          for (var j = 0; j < 30; j++) {\n            item = item - 1;\n\n            if (item > -1) {\n              if (obj.options.search == true && obj.results) {\n                obj.tbody.insertBefore(obj.rows[results[item]], obj.tbody.firstChild);\n              } else {\n                obj.tbody.insertBefore(obj.rows[item], obj.tbody.firstChild);\n              }\n\n              if (obj.tbody.children.length > 100) {\n                obj.tbody.removeChild(obj.tbody.lastChild);\n                test = 1;\n              }\n            }\n          }\n        }\n      }\n\n      return test;\n    };\n\n    obj.loadDown = function () {\n      // Search\n      if (obj.options.search == true && obj.results) {\n        var results = obj.results;\n      } else {\n        var results = obj.rows;\n      }\n\n      var test = 0;\n\n      if (results.length > 100) {\n        // Get the last element in the page\n        var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n\n        if (obj.options.search == true && obj.results) {\n          item = results.indexOf(item);\n        }\n\n        if (item < obj.rows.length - 1) {\n          for (var j = 0; j <= 30; j++) {\n            if (item < results.length) {\n              if (obj.options.search == true && obj.results) {\n                obj.tbody.appendChild(obj.rows[results[item]]);\n              } else {\n                obj.tbody.appendChild(obj.rows[item]);\n              }\n\n              if (obj.tbody.children.length > 100) {\n                obj.tbody.removeChild(obj.tbody.firstChild);\n                test = 1;\n              }\n            }\n\n            item = item + 1;\n          }\n        }\n      }\n\n      return test;\n    };\n\n    obj.loadValidation = function () {\n      if (obj.selectedCell) {\n        var currentPage = parseInt(obj.tbody.firstChild.getAttribute('data-y')) / 100;\n        var selectedPage = parseInt(obj.selectedCell[3] / 100);\n        var totalPages = parseInt(obj.rows.length / 100);\n\n        if (currentPage != selectedPage && selectedPage <= totalPages) {\n          if (!Array.prototype.indexOf.call(obj.tbody.children, obj.rows[obj.selectedCell[3]])) {\n            obj.loadPage(selectedPage);\n            return true;\n          }\n        }\n      }\n\n      return false;\n    };\n    /**\n     * Reset search\n     */\n\n\n    obj.resetSearch = function () {\n      obj.searchInput.value = '';\n      obj.search('');\n      obj.results = null;\n    };\n    /**\n     * Search\n     */\n\n\n    obj.search = function (query) {\n      // Query\n      if (query) {\n        var query = query.toLowerCase();\n      } // Reset selection\n\n\n      obj.resetSelection(); // Total of results\n\n      obj.pageNumber = 0;\n      obj.results = [];\n\n      if (query) {\n        // Search filter\n        var search = function search(item, query, index) {\n          for (var i = 0; i < item.length; i++) {\n            if (('' + item[i]).toLowerCase().search(query) >= 0 || ('' + obj.records[index][i].innerHTML).toLowerCase().search(query) >= 0) {\n              return true;\n            }\n          }\n\n          return false;\n        }; // Result\n\n\n        var addToResult = function addToResult(k) {\n          if (obj.results.indexOf(k) == -1) {\n            obj.results.push(k);\n          }\n        }; // Filter\n\n\n        var data = obj.options.data.filter(function (v, k) {\n          if (search(v, query, k)) {\n            // Merged rows found\n            var rows = obj.isRowMerged(k);\n\n            if (rows.length) {\n              for (var i = 0; i < rows.length; i++) {\n                var row = _jexcel.getIdFromColumnName(rows[i], true);\n\n                for (var j = 0; j < obj.options.mergeCells[rows[i]][1]; j++) {\n                  addToResult(row[1] + j);\n                }\n              }\n            } else {\n              // Normal row found\n              addToResult(k);\n            }\n\n            return true;\n          } else {\n            return false;\n          }\n        });\n      } else {\n        obj.results = null;\n      }\n\n      var total = 0;\n      var index = 0; // Page 1\n\n      if (obj.options.lazyLoading == true) {\n        total = 100;\n      } else if (obj.options.pagination > 0) {\n        total = obj.options.pagination;\n      } else {\n        if (obj.results) {\n          total = obj.results.length;\n        } else {\n          total = obj.rows.length;\n        }\n      } // Reset current nodes\n\n\n      while (obj.tbody.firstChild) {\n        obj.tbody.removeChild(obj.tbody.firstChild);\n      } // Hide all records from the table\n\n\n      for (var j = 0; j < obj.rows.length; j++) {\n        if (!obj.results || obj.results.indexOf(j) > -1) {\n          if (index < total) {\n            obj.tbody.appendChild(obj.rows[j]);\n            index++;\n          }\n\n          obj.rows[j].style.display = '';\n        } else {\n          obj.rows[j].style.display = 'none';\n        }\n      } // Update pagination\n\n\n      if (obj.options.pagination > 0) {\n        obj.updatePagination();\n      }\n\n      return total;\n    };\n    /**\n     * Which page the cell is\n     */\n\n\n    obj.whichPage = function (cell) {\n      // Search\n      if (obj.options.search == true && obj.results) {\n        cell = obj.results.indexOf(cell);\n      }\n\n      return Math.ceil((parseInt(cell) + 1) / parseInt(obj.options.pagination)) - 1;\n    };\n    /**\n     * Go to page\n     */\n\n\n    obj.page = function (pageNumber) {\n      var oldPage = obj.pageNumber; // Search\n\n      if (obj.options.search == true && obj.results) {\n        var results = obj.results;\n      } else {\n        var results = obj.rows;\n      } // Per page\n\n\n      var quantityPerPage = parseInt(obj.options.pagination); // pageNumber\n\n      if (pageNumber == null || pageNumber == -1) {\n        // Last page\n        pageNumber = Math.ceil(results.length / quantityPerPage);\n      } // Page number\n\n\n      obj.pageNumber = pageNumber;\n      var startRow = pageNumber * quantityPerPage;\n      var finalRow = pageNumber * quantityPerPage + quantityPerPage;\n\n      if (finalRow > results.length) {\n        finalRow = results.length;\n      }\n\n      if (startRow < 0) {\n        startRow = 0;\n      } // Reset container\n\n\n      while (obj.tbody.firstChild) {\n        obj.tbody.removeChild(obj.tbody.firstChild);\n      } // Appeding items\n\n\n      for (var j = startRow; j < finalRow; j++) {\n        if (obj.options.search == true && obj.results) {\n          obj.tbody.appendChild(obj.rows[results[j]]);\n        } else {\n          obj.tbody.appendChild(obj.rows[j]);\n        }\n      }\n\n      if (obj.options.pagination > 0) {\n        obj.updatePagination();\n      } // Update corner position\n\n\n      obj.updateCornerPosition();\n\n      if (typeof obj.options.onchangepage == 'function') {\n        obj.options.onchangepage(el, pageNumber, oldPage);\n      }\n    };\n    /**\n     * Update the pagination\n     */\n\n\n    obj.updatePagination = function () {\n      // Reset container\n      obj.pagination.children[0].innerHTML = '';\n      obj.pagination.children[1].innerHTML = ''; // Start pagination\n\n      if (obj.options.pagination) {\n        // Searchable\n        if (obj.options.search == true && obj.results) {\n          var results = obj.results.length;\n        } else {\n          var results = obj.rows.length;\n        }\n\n        if (!results) {\n          // No records found\n          obj.pagination.children[0].innerHTML = obj.options.text.noRecordsFound;\n        } else {\n          // Pagination container\n          var quantyOfPages = Math.ceil(results / obj.options.pagination);\n\n          if (obj.pageNumber < 6) {\n            var startNumber = 1;\n            var finalNumber = quantyOfPages < 10 ? quantyOfPages : 10;\n          } else if (quantyOfPages - obj.pageNumber < 5) {\n            var startNumber = quantyOfPages - 9;\n            var finalNumber = quantyOfPages;\n\n            if (startNumber < 1) {\n              startNumber = 1;\n            }\n          } else {\n            var startNumber = obj.pageNumber - 4;\n            var finalNumber = obj.pageNumber + 5;\n          } // First\n\n\n          if (startNumber > 1) {\n            var paginationItem = document.createElement('div');\n            paginationItem.className = 'jexcel_page';\n            paginationItem.innerHTML = '<';\n            paginationItem.title = 1;\n            obj.pagination.children[1].appendChild(paginationItem);\n          } // Get page links\n\n\n          for (var i = startNumber; i <= finalNumber; i++) {\n            var paginationItem = document.createElement('div');\n            paginationItem.className = 'jexcel_page';\n            paginationItem.innerHTML = i;\n            obj.pagination.children[1].appendChild(paginationItem);\n\n            if (obj.pageNumber == i - 1) {\n              paginationItem.classList.add('jexcel_page_selected');\n            }\n          } // Last\n\n\n          if (finalNumber < quantyOfPages) {\n            var paginationItem = document.createElement('div');\n            paginationItem.className = 'jexcel_page';\n            paginationItem.innerHTML = '>';\n            paginationItem.title = quantyOfPages;\n            obj.pagination.children[1].appendChild(paginationItem);\n          } // Text\n\n\n          var format = function format(_format) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            return _format.replace(/{(\\d+)}/g, function (match, number) {\n              return typeof args[number] != 'undefined' ? args[number] : match;\n            });\n          };\n\n          obj.pagination.children[0].innerHTML = format(obj.options.text.showingPage, obj.pageNumber + 1, quantyOfPages);\n        }\n      }\n    };\n    /**\n     * Download CSV table\n     * \n     * @return null\n     */\n\n\n    obj.download = function (includeHeaders) {\n      if (obj.options.allowExport == false) {\n        console.error('Export not allowed');\n      } else {\n        // Data\n        var data = '';\n\n        if (includeHeaders == true || obj.options.includeHeadersOnDownload == true) {\n          data += obj.getHeaders();\n          data += \"\\r\\n\";\n        } // Get data\n\n\n        data += obj.copy(false, obj.options.csvDelimiter, true); // Download element\n\n        var blob = new Blob([\"\\uFEFF\" + data], {\n          type: 'text/csv;charset=utf-8;'\n        }); // IE Compatibility\n\n        if (window.navigator && window.navigator.msSaveOrOpenBlob) {\n          window.navigator.msSaveOrOpenBlob(blob, options.csvFileName + '.csv');\n        } else {\n          // Download element\n          var pom = document.createElement('a');\n          var url = URL.createObjectURL(blob);\n          pom.href = url;\n          pom.setAttribute('download', obj.options.csvFileName + '.csv');\n          document.body.appendChild(pom);\n          pom.click();\n          pom.parentNode.removeChild(pom);\n        }\n      }\n    };\n    /**\n     * Initializes a new history record for undo/redo\n     * \n     * @return null\n     */\n\n\n    obj.setHistory = function (changes) {\n      if (obj.ignoreHistory != true) {\n        // Increment and get the current history index\n        var index = ++obj.historyIndex; // Slice the array to discard undone changes\n\n        obj.history = obj.history = obj.history.slice(0, index + 1); // Keep history\n\n        obj.history[index] = changes;\n      }\n    };\n    /**\n     * Copy method\n     * \n     * @param bool highlighted - Get only highlighted cells\n     * @param delimiter - \\t default to keep compatibility with excel\n     * @return string value\n     */\n\n\n    obj.copy = function (highlighted, delimiter, returnData) {\n      if (!delimiter) {\n        delimiter = \"\\t\";\n      } // Controls\n\n\n      var col = [];\n      var colLabel = [];\n      var row = [];\n      var rowLabel = [];\n      var x = obj.options.data[0].length;\n      var y = obj.options.data.length;\n      var tmp = ''; // Reset container\n\n      obj.style = []; // Go through the columns to get the data\n\n      for (var j = 0; j < y; j++) {\n        col = [];\n        colLabel = [];\n\n        for (var i = 0; i < x; i++) {\n          // If cell is highlighted\n          if (!highlighted || obj.records[j][i].classList.contains('highlight')) {\n            // Values\n            var value = obj.options.data[j][i];\n\n            if (value.match && (value.match(/,/g) || value.match(/\\n/) || value.match(/\\\"/))) {\n              value = value.replace(new RegExp('\"', 'g'), '\"\"');\n              value = '\"' + value + '\"';\n            }\n\n            col.push(value); // Labels\n\n            if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\n              var label = value;\n            } else {\n              var label = obj.records[j][i].innerHTML;\n\n              if (label.match && (label.match(/,/g) || label.match(/\\n/) || label.match(/\\\"/))) {\n                // Scape double quotes\n                label = label.replace(new RegExp('\"', 'g'), '\"\"');\n                label = '\"' + label + '\"';\n              }\n            }\n\n            colLabel.push(label); // Get style\n\n            tmp = obj.records[j][i].getAttribute('style');\n            obj.style.push(tmp ? tmp : '');\n          }\n        }\n\n        if (col.length) {\n          row.push(col.join(delimiter));\n        }\n\n        if (colLabel.length) {\n          rowLabel.push(colLabel.join(delimiter));\n        }\n      } // Final string\n\n\n      var str = row.join(\"\\r\\n\");\n      var strLabel = rowLabel.join(\"\\r\\n\"); // Create a hidden textarea to copy the values\n\n      if (!returnData) {\n        if (obj.options.copyCompatibility == true) {\n          obj.textarea.value = strLabel;\n        } else {\n          obj.textarea.value = str;\n        }\n\n        obj.textarea.select();\n        document.execCommand(\"copy\");\n      } // Keep data\n\n\n      if (obj.options.copyCompatibility == true) {\n        obj.data = strLabel;\n      } else {\n        obj.data = str;\n      } // Keep non visible information\n\n\n      obj.hashString = obj.hash(obj.data);\n      return obj.data;\n    };\n    /**\n     * jExcel paste method\n     * \n     * @param integer row number\n     * @return string value\n     */\n\n\n    obj.paste = function (x, y, data) {\n      // Paste filter\n      if (typeof obj.options.onbeforepaste == 'function') {\n        var data = obj.options.onbeforepaste(el, data);\n      } // Controls\n\n\n      var hash = obj.hash(data);\n      var style = hash == obj.hashString ? obj.style : null; // Depending on the behavior\n\n      if (obj.options.copyCompatibility == true && hash == obj.hashString) {\n        var data = obj.data;\n      } // Split new line\n\n\n      var data = obj.parseCSV(data, \"\\t\");\n\n      if (x != null && y != null && data) {\n        // Records\n        var i = 0;\n        var j = 0;\n        var records = [];\n        var newStyle = {};\n        var oldStyle = {};\n        var styleIndex = 0; // Index\n\n        var colIndex = parseInt(x);\n        var rowIndex = parseInt(y);\n        var row = null; // Go through the columns to get the data\n\n        while (row = data[j]) {\n          i = 0;\n          colIndex = parseInt(x);\n\n          while (row[i] != null) {\n            // Update and keep history\n            var record = obj.updateCell(colIndex, rowIndex, row[i]); // Keep history\n\n            records.push(record); // Update all formulas in the chain\n\n            obj.updateFormulaChain(colIndex, rowIndex, records); // Style\n\n            if (style && style[styleIndex]) {\n              var columnName = _jexcel.getColumnNameFromId([colIndex, rowIndex]);\n\n              newStyle[columnName] = style[styleIndex];\n              oldStyle[columnName] = obj.getStyle(columnName);\n              obj.records[rowIndex][colIndex].setAttribute('style', style[styleIndex]);\n              styleIndex++;\n            }\n\n            i++;\n\n            if (row[i] != null) {\n              if (colIndex >= obj.headers.length - 1) {\n                obj.insertColumn();\n              }\n\n              colIndex = obj.right.get(colIndex, rowIndex);\n            }\n          }\n\n          j++;\n\n          if (data[j]) {\n            if (rowIndex >= obj.rows.length - 1) {\n              obj.insertRow();\n            }\n\n            rowIndex = obj.down.get(x, rowIndex);\n          }\n        } // Select the new cells\n\n\n        obj.updateSelectionFromCoords(x, y, colIndex, rowIndex); // Update history\n\n        obj.setHistory({\n          action: 'setValue',\n          records: records,\n          selection: obj.selectedCell,\n          newStyle: newStyle,\n          oldStyle: oldStyle\n        }); // Update table\n\n        obj.updateTable(); // Paste event\n\n        if (typeof obj.options.onpaste == 'function') {\n          obj.options.onpaste(el, records);\n        } // On after changes\n\n\n        obj.onafterchanges(el, records);\n      }\n    };\n    /**\n     * Process row\n     */\n\n\n    obj.historyProcessRow = function (type, historyRecord) {\n      var rowIndex = !historyRecord.insertBefore ? historyRecord.rowNumber + 1 : historyRecord.rowNumber;\n\n      if (obj.options.search == true) {\n        if (obj.results && obj.results.length != obj.rows.length) {\n          obj.resetSearch();\n        }\n      } // Remove row\n\n\n      if (type == 1) {\n        var numOfRows = historyRecord.numOfRows; // Remove nodes\n\n        for (var j = rowIndex; j < numOfRows + rowIndex; j++) {\n          obj.rows[j].parentNode.removeChild(obj.rows[j]);\n        } // Remove references\n\n\n        obj.records.splice(rowIndex, numOfRows);\n        obj.options.data.splice(rowIndex, numOfRows);\n        obj.rows.splice(rowIndex, numOfRows);\n        obj.conditionalSelectionUpdate(1, rowIndex, numOfRows + rowIndex - 1);\n      } else {\n        // Insert data\n        obj.records = _jexcel.injectArray(obj.records, rowIndex, historyRecord.rowRecords);\n        obj.options.data = _jexcel.injectArray(obj.options.data, rowIndex, historyRecord.rowData);\n        obj.rows = _jexcel.injectArray(obj.rows, rowIndex, historyRecord.rowNode); // Insert nodes\n\n        var index = 0;\n\n        for (var j = rowIndex; j < historyRecord.numOfRows + rowIndex; j++) {\n          obj.tbody.insertBefore(historyRecord.rowNode[index], obj.tbody.children[j]);\n          index++;\n        }\n      } // Respect pagination\n\n\n      if (obj.options.pagination > 0) {\n        obj.page(obj.pageNumber);\n      }\n\n      obj.updateTableReferences();\n    };\n    /**\n     * Process column\n     */\n\n\n    obj.historyProcessColumn = function (type, historyRecord) {\n      var columnIndex = !historyRecord.insertBefore ? historyRecord.columnNumber + 1 : historyRecord.columnNumber; // Remove column\n\n      if (type == 1) {\n        var numOfColumns = historyRecord.numOfColumns;\n        obj.options.columns.splice(columnIndex, numOfColumns);\n\n        for (var i = columnIndex; i < numOfColumns + columnIndex; i++) {\n          obj.headers[i].parentNode.removeChild(obj.headers[i]);\n          obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]);\n        }\n\n        obj.headers.splice(columnIndex, numOfColumns);\n        obj.colgroup.splice(columnIndex, numOfColumns);\n\n        for (var j = 0; j < historyRecord.data.length; j++) {\n          for (var i = columnIndex; i < numOfColumns + columnIndex; i++) {\n            obj.records[j][i].parentNode.removeChild(obj.records[j][i]);\n          }\n\n          obj.records[j].splice(columnIndex, numOfColumns);\n          obj.options.data[j].splice(columnIndex, numOfColumns);\n        }\n\n        obj.conditionalSelectionUpdate(0, columnIndex, numOfColumns + columnIndex - 1);\n      } else {\n        // Insert data\n        obj.options.columns = _jexcel.injectArray(obj.options.columns, columnIndex, historyRecord.columns);\n        obj.headers = _jexcel.injectArray(obj.headers, columnIndex, historyRecord.headers);\n        obj.colgroup = _jexcel.injectArray(obj.colgroup, columnIndex, historyRecord.colgroup);\n        var index = 0;\n\n        for (var i = columnIndex; i < historyRecord.numOfColumns + columnIndex; i++) {\n          obj.headerContainer.insertBefore(historyRecord.headers[index], obj.headerContainer.children[i + 1]);\n          obj.colgroupContainer.insertBefore(historyRecord.colgroup[index], obj.colgroupContainer.children[i + 1]);\n          index++;\n        }\n\n        for (var j = 0; j < historyRecord.data.length; j++) {\n          obj.options.data[j] = _jexcel.injectArray(obj.options.data[j], columnIndex, historyRecord.data[j]);\n          obj.records[j] = _jexcel.injectArray(obj.records[j], columnIndex, historyRecord.records[j]);\n          var index = 0;\n\n          for (var i = columnIndex; i < historyRecord.numOfColumns + columnIndex; i++) {\n            obj.rows[j].insertBefore(historyRecord.records[j][index], obj.rows[j].children[i + 1]);\n            index++;\n          }\n        }\n      } // Adjust nested headers\n\n\n      if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n        // Flexible way to handle nestedheaders\n        if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n          for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n            if (type == 1) {\n              var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length - 1].colspan) - historyRecord.numOfColumns;\n            } else {\n              var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length - 1].colspan) + historyRecord.numOfColumns;\n            }\n\n            obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length - 1].colspan = colspan;\n            obj.thead.children[j].children[obj.thead.children[j].children.length - 1].setAttribute('colspan', colspan);\n          }\n        } else {\n          if (type == 1) {\n            var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - historyRecord.numOfColumns;\n          } else {\n            var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + historyRecord.numOfColumns;\n          }\n\n          obj.options.nestedHeaders[0].colspan = colspan;\n          obj.thead.children[0].children[obj.thead.children[0].children.length - 1].setAttribute('colspan', colspan);\n        }\n      }\n\n      obj.updateTableReferences();\n    };\n    /**\n     * Undo last action\n     */\n\n\n    obj.undo = function () {\n      // Ignore events and history\n      var ignoreEvents = obj.ignoreEvents ? true : false;\n      var ignoreHistory = obj.ignoreHistory ? true : false;\n      obj.ignoreEvents = true;\n      obj.ignoreHistory = true; // Records\n\n      var records = []; // Update cells\n\n      if (obj.historyIndex >= 0) {\n        // History\n        var historyRecord = obj.history[obj.historyIndex--];\n\n        if (historyRecord.action == 'insertRow') {\n          obj.historyProcessRow(1, historyRecord);\n        } else if (historyRecord.action == 'deleteRow') {\n          obj.historyProcessRow(0, historyRecord);\n        } else if (historyRecord.action == 'insertColumn') {\n          obj.historyProcessColumn(1, historyRecord);\n        } else if (historyRecord.action == 'deleteColumn') {\n          obj.historyProcessColumn(0, historyRecord);\n        } else if (historyRecord.action == 'moveRow') {\n          obj.moveRow(historyRecord.newValue, historyRecord.oldValue);\n        } else if (historyRecord.action == 'moveColumn') {\n          obj.moveColumn(historyRecord.newValue, historyRecord.oldValue);\n        } else if (historyRecord.action == 'setMerge') {\n          obj.removeMerge(historyRecord.column, historyRecord.data);\n        } else if (historyRecord.action == 'setStyle') {\n          obj.setStyle(historyRecord.oldValue, null, null, 1);\n        } else if (historyRecord.action == 'setWidth') {\n          obj.setWidth(historyRecord.column, historyRecord.oldValue);\n        } else if (historyRecord.action == 'setHeight') {\n          obj.setHeight(historyRecord.row, historyRecord.oldValue);\n        } else if (historyRecord.action == 'setHeader') {\n          obj.setHeader(historyRecord.column, historyRecord.oldValue);\n        } else if (historyRecord.action == 'setComments') {\n          obj.setComments(historyRecord.column, historyRecord.oldValue[0], historyRecord.oldValue[1]);\n        } else if (historyRecord.action == 'orderBy') {\n          var rows = [];\n\n          for (var j = 0; j < historyRecord.rows.length; j++) {\n            rows[historyRecord.rows[j]] = j;\n          }\n\n          obj.updateOrderArrow(historyRecord.column, historyRecord.order ? 0 : 1);\n          obj.updateOrder(rows);\n        } else if (historyRecord.action == 'setValue') {\n          // Redo for changes in cells\n          for (var i = 0; i < historyRecord.records.length; i++) {\n            obj.updateCell(historyRecord.records[i].col, historyRecord.records[i].row, historyRecord.records[i].oldValue);\n            obj.updateFormulaChain(historyRecord.records[i].col, historyRecord.records[i].row, records);\n\n            if (historyRecord.oldStyle) {\n              obj.resetStyle(historyRecord.oldStyle, true);\n            }\n          } // Update selection\n\n\n          if (!historyRecord.selection) {\n            historyRecord.selection = [historyRecord.records[0].col, historyRecord.records[0].row];\n          }\n\n          obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]); // Update table\n\n          obj.updateTable();\n        }\n      }\n\n      obj.ignoreEvents = ignoreEvents;\n      obj.ignoreHistory = ignoreHistory;\n\n      if (typeof obj.options.onundo == 'function') {\n        obj.options.onundo(el, historyRecord);\n      }\n    };\n    /**\n     * Redo previously undone action\n     */\n\n\n    obj.redo = function () {\n      // Ignore events and history\n      var ignoreEvents = obj.ignoreEvents ? true : false;\n      var ignoreHistory = obj.ignoreHistory ? true : false;\n      obj.ignoreEvents = true;\n      obj.ignoreHistory = true; // Records\n\n      var records = []; // Update cells\n\n      if (obj.historyIndex < obj.history.length - 1) {\n        // History\n        var historyRecord = obj.history[++obj.historyIndex];\n\n        if (historyRecord.action == 'insertRow') {\n          obj.historyProcessRow(0, historyRecord);\n        } else if (historyRecord.action == 'deleteRow') {\n          obj.historyProcessRow(1, historyRecord);\n        } else if (historyRecord.action == 'insertColumn') {\n          obj.historyProcessColumn(0, historyRecord);\n        } else if (historyRecord.action == 'deleteColumn') {\n          obj.historyProcessColumn(1, historyRecord);\n        } else if (historyRecord.action == 'moveRow') {\n          obj.moveRow(historyRecord.oldValue, historyRecord.newValue);\n        } else if (historyRecord.action == 'moveColumn') {\n          obj.moveColumn(historyRecord.oldValue, historyRecord.newValue);\n        } else if (historyRecord.action == 'setMerge') {\n          obj.setMerge(historyRecord.column, historyRecord.colspan, historyRecord.rowspan, 1);\n        } else if (historyRecord.action == 'setStyle') {\n          obj.setStyle(historyRecord.newValue, null, null, 1);\n        } else if (historyRecord.action == 'setWidth') {\n          obj.setWidth(historyRecord.column, historyRecord.newValue);\n        } else if (historyRecord.action == 'setHeight') {\n          obj.setHeight(historyRecord.row, historyRecord.newValue);\n        } else if (historyRecord.action == 'setHeader') {\n          obj.setHeader(historyRecord.column, historyRecord.newValue);\n        } else if (historyRecord.action == 'setComments') {\n          obj.setComments(historyRecord.column, historyRecord.newValue[0], historyRecord.newValue[1]);\n        } else if (historyRecord.action == 'orderBy') {\n          obj.updateOrderArrow(historyRecord.column, historyRecord.order);\n          obj.updateOrder(historyRecord.rows);\n        } else if (historyRecord.action == 'setValue') {\n          // Redo for changes in cells\n          for (var i = 0; i < historyRecord.records.length; i++) {\n            obj.updateCell(historyRecord.records[i].col, historyRecord.records[i].row, historyRecord.records[i].newValue);\n            obj.updateFormulaChain(historyRecord.records[i].col, historyRecord.records[i].row, records);\n\n            if (historyRecord.newStyle) {\n              obj.resetStyle(historyRecord.newStyle, true);\n            }\n          } // Update selection\n\n\n          if (!historyRecord.selection) {\n            historyRecord.selection = [historyRecord.records[0].col, historyRecord.records[0].row];\n          }\n\n          obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]); // Update table\n\n          obj.updateTable();\n        }\n      }\n\n      obj.ignoreEvents = ignoreEvents;\n      obj.ignoreHistory = ignoreHistory;\n\n      if (typeof obj.options.onredo == 'function') {\n        obj.options.onredo(el, historyRecord);\n      }\n    };\n    /**\n     * Get dropdown value from key\n     */\n\n\n    obj.getDropDownValue = function (column, key) {\n      var value = [];\n\n      if (obj.options.columns[column] && obj.options.columns[column].source) {\n        // Create array from source\n        var combo = [];\n        var source = obj.options.columns[column].source;\n\n        for (var i = 0; i < source.length; i++) {\n          if (typeof source[i] == 'object') {\n            combo[source[i].id] = source[i].name;\n          } else {\n            combo[source[i]] = source[i];\n          }\n        } // Garante single multiple compatibily\n\n\n        var keys = ('' + key).split(';');\n\n        for (var i = 0; i < keys.length; i++) {\n          if (combo[keys[i]]) {\n            value.push(combo[keys[i]]);\n          }\n        }\n      } else {\n        console.error('Invalid column');\n      }\n\n      return value.length > 0 ? value.join('; ') : '';\n    };\n    /**\n     * From starckoverflow contributions\n     */\n\n\n    obj.parseCSV = function (str, delimiter) {\n      // Remove last line break\n      str = str.replace(/\\r?\\n$|\\r$|\\n$/g, \"\"); // Last caracter is the delimiter\n\n      if (str.charCodeAt(str.length - 1) == 9) {\n        str += \"\\0\";\n      } // user-supplied delimeter or default comma\n\n\n      delimiter = delimiter || \",\";\n      var arr = [];\n      var quote = false; // true means we're inside a quoted field\n      // iterate over each character, keep track of current row and column (of the returned array)\n\n      for (var row = 0, col = 0, c = 0; c < str.length; c++) {\n        var cc = str[c],\n            nc = str[c + 1];\n        arr[row] = arr[row] || [];\n        arr[row][col] = arr[row][col] || ''; // If the current character is a quotation mark, and we're inside a quoted field, and the next character is also a quotation mark, add a quotation mark to the current column and skip the next character\n\n        if (cc == '\"' && quote && nc == '\"') {\n          arr[row][col] += cc;\n          ++c;\n          continue;\n        } // If it's just one quotation mark, begin/end quoted field\n\n\n        if (cc == '\"') {\n          quote = !quote;\n          continue;\n        } // If it's a comma and we're not in a quoted field, move on to the next column\n\n\n        if (cc == delimiter && !quote) {\n          ++col;\n          continue;\n        } // If it's a newline (CRLF) and we're not in a quoted field, skip the next character and move on to the next row and move to column 0 of that new row\n\n\n        if (cc == '\\r' && nc == '\\n' && !quote) {\n          ++row;\n          col = 0;\n          ++c;\n          continue;\n        } // If it's a newline (LF or CR) and we're not in a quoted field, move on to the next row and move to column 0 of that new row\n\n\n        if (cc == '\\n' && !quote) {\n          ++row;\n          col = 0;\n          continue;\n        }\n\n        if (cc == '\\r' && !quote) {\n          ++row;\n          col = 0;\n          continue;\n        } // Otherwise, append the current character to the current column\n\n\n        arr[row][col] += cc;\n      }\n\n      return arr;\n    };\n\n    obj.hash = function (str) {\n      var hash = 0,\n          i,\n          chr;\n\n      if (str.length === 0) {\n        return hash;\n      } else {\n        for (i = 0; i < str.length; i++) {\n          chr = str.charCodeAt(i);\n          hash = (hash << 5) - hash + chr;\n          hash |= 0;\n        }\n      }\n\n      return hash;\n    };\n\n    obj.onafterchanges = function (el, records) {\n      if (!obj.ignoreEvents) {\n        // On after changes\n        if (typeof obj.options.onafterchanges == 'function') {\n          obj.options.onafterchanges(el, records);\n        }\n      }\n    };\n\n    obj.destroy = function () {\n      _jexcel.destroy(el);\n    };\n    /**\n     * Initialization method\n     */\n\n\n    obj.init = function () {\n      _jexcel.current = obj; // Build handlers\n\n      if (typeof _jexcel.build == 'function') {\n        _jexcel.build();\n\n        _jexcel.build = null;\n      } // Load the table data based on an CSV file\n\n\n      if (obj.options.csv) {\n        // Loading\n        if (obj.options.loadingSpin == true) {\n          jSuites.loading.show();\n        } // Load CSV file\n\n\n        jSuites.ajax({\n          url: obj.options.csv,\n          method: 'GET',\n          dataType: 'text',\n          success: function success(result) {\n            // Convert data\n            var newData = obj.parseCSV(result, obj.options.csvDelimiter); // Headers\n\n            if (obj.options.csvHeaders == true && newData.length > 0) {\n              var headers = newData.shift();\n\n              for (var i = 0; i < headers.length; i++) {\n                if (!obj.options.columns[i]) {\n                  obj.options.columns[i] = {\n                    type: 'text',\n                    align: obj.options.defaultColAlign,\n                    width: obj.options.defaultColWidth\n                  };\n                } // Precedence over pre-configurated titles\n\n\n                if (typeof obj.options.columns[i].title === 'undefined') {\n                  obj.options.columns[i].title = headers[i];\n                }\n              }\n            } // Data\n\n\n            obj.options.data = newData; // Prepare table\n\n            obj.prepareTable(); // Hide spin\n\n            if (obj.options.loadingSpin == true) {\n              jSuites.loading.hide();\n            }\n          }\n        });\n      } else if (obj.options.url) {\n        // Loading\n        if (obj.options.loadingSpin == true) {\n          jSuites.loading.show();\n        }\n\n        jSuites.ajax({\n          url: obj.options.url,\n          method: 'GET',\n          dataType: 'json',\n          success: function success(result) {\n            // Data\n            obj.options.data = result.data ? result.data : result; // Prepare table\n\n            obj.prepareTable(); // Hide spin\n\n            if (obj.options.loadingSpin == true) {\n              jSuites.loading.hide();\n            }\n          }\n        });\n      } else {\n        // Prepare table\n        obj.prepareTable();\n      }\n    }; // Context menu\n\n\n    if (options && options.contextMenu != null) {\n      obj.options.contextMenu = options.contextMenu;\n    } else {\n      obj.options.contextMenu = function (el, x, y, e) {\n        var items = [];\n\n        if (y == null) {\n          // Insert a new column\n          if (obj.options.allowInsertColumn == true) {\n            items.push({\n              title: obj.options.text.insertANewColumnBefore,\n              onclick: function onclick() {\n                obj.insertColumn(1, parseInt(x), 1);\n              }\n            });\n          }\n\n          if (obj.options.allowInsertColumn == true) {\n            items.push({\n              title: obj.options.text.insertANewColumnAfter,\n              onclick: function onclick() {\n                obj.insertColumn(1, parseInt(x), 0);\n              }\n            });\n          } // Delete a column\n\n\n          if (obj.options.allowDeleteColumn == true) {\n            items.push({\n              title: obj.options.text.deleteSelectedColumns,\n              onclick: function onclick() {\n                obj.deleteColumn(obj.getSelectedColumns().length ? undefined : parseInt(x));\n              }\n            });\n          } // Rename column\n\n\n          if (obj.options.allowRenameColumn == true) {\n            items.push({\n              title: obj.options.text.renameThisColumn,\n              onclick: function onclick() {\n                obj.setHeader(x);\n              }\n            });\n          } // Sorting\n\n\n          if (obj.options.columnSorting == true) {\n            // Line\n            items.push({\n              type: 'line'\n            });\n            items.push({\n              title: obj.options.text.orderAscending,\n              onclick: function onclick() {\n                obj.orderBy(x, 0);\n              }\n            });\n            items.push({\n              title: obj.options.text.orderDescending,\n              onclick: function onclick() {\n                obj.orderBy(x, 1);\n              }\n            });\n          }\n        } else {\n          // Insert new row\n          if (obj.options.allowInsertRow == true) {\n            items.push({\n              title: obj.options.text.insertANewRowBefore,\n              onclick: function onclick() {\n                obj.insertRow(1, parseInt(y), 1);\n              }\n            });\n            items.push({\n              title: obj.options.text.insertANewRowAfter,\n              onclick: function onclick() {\n                obj.insertRow(1, parseInt(y));\n              }\n            });\n          }\n\n          if (obj.options.allowDeleteRow == true) {\n            items.push({\n              title: obj.options.text.deleteSelectedRows,\n              onclick: function onclick() {\n                obj.deleteRow(obj.getSelectedRows().length ? undefined : parseInt(y));\n              }\n            });\n          }\n\n          if (x) {\n            if (obj.options.allowComments == true) {\n              items.push({\n                type: 'line'\n              });\n              var title = obj.records[y][x].getAttribute('title') || '';\n              items.push({\n                title: title ? obj.options.text.editComments : obj.options.text.addComments,\n                onclick: function onclick() {\n                  var comment = prompt(obj.options.text.comments, title);\n\n                  if (comment) {\n                    obj.setComments([x, y], comment);\n                  }\n                }\n              });\n\n              if (title) {\n                items.push({\n                  title: obj.options.text.clearComments,\n                  onclick: function onclick() {\n                    obj.setComments([x, y], '');\n                  }\n                });\n              }\n            }\n          }\n        } // Line\n\n\n        items.push({\n          type: 'line'\n        }); // Copy\n\n        items.push({\n          title: obj.options.text.copy,\n          shortcut: 'Ctrl + C',\n          onclick: function onclick() {\n            obj.copy(true);\n          }\n        }); // Paste\n\n        if (navigator && navigator.clipboard) {\n          items.push({\n            title: obj.options.text.paste,\n            shortcut: 'Ctrl + V',\n            onclick: function onclick() {\n              if (obj.selectedCell) {\n                navigator.clipboard.readText().then(function (text) {\n                  if (text) {\n                    _jexcel.current.paste(obj.selectedCell[0], obj.selectedCell[1], text);\n                  }\n                });\n              }\n            }\n          });\n        } // Save\n\n\n        if (obj.options.allowExport) {\n          items.push({\n            title: obj.options.text.saveAs,\n            shortcut: 'Ctrl + S',\n            onclick: function onclick() {\n              obj.download();\n            }\n          });\n        } // About\n\n\n        if (obj.options.about) {\n          items.push({\n            title: obj.options.text.about,\n            onclick: function onclick() {\n              alert(obj.options.about);\n            }\n          });\n        }\n\n        return items;\n      };\n    }\n\n    obj.scrollControls = function (e) {\n      if (obj.options.lazyLoading == true) {\n        if (_jexcel.timeControlLoading == null) {\n          _jexcel.timeControlLoading = setTimeout(function () {\n            if (obj.content.scrollTop + obj.content.clientHeight >= obj.content.scrollHeight) {\n              if (obj.loadDown()) {\n                if (obj.content.scrollTop + obj.content.clientHeight > obj.content.scrollHeight - 10) {\n                  obj.content.scrollTop = obj.content.scrollTop - obj.content.clientHeight;\n                }\n\n                obj.updateCornerPosition();\n              }\n            } else if (obj.content.scrollTop <= obj.content.clientHeight) {\n              if (obj.loadUp()) {\n                if (obj.content.scrollTop < 10) {\n                  obj.content.scrollTop = obj.content.scrollTop + obj.content.clientHeight;\n                }\n\n                obj.updateCornerPosition();\n              }\n            }\n\n            _jexcel.timeControlLoading = null;\n          }, 100);\n        }\n      } // Close editor\n\n\n      if (obj.options.lazyLoading == true || obj.options.tableOverflow == true) {\n        if (obj.edition && e.target.className.substr(0, 9) != 'jdropdown') {\n          obj.closeEditor(obj.edition[0], true);\n        }\n      }\n    };\n\n    el.addEventListener(\"DOMMouseScroll\", obj.scrollControls);\n    el.addEventListener(\"mousewheel\", obj.scrollControls);\n    el.jexcel = obj;\n    obj.init();\n    return obj;\n  };\n\n  _jexcel.current = null;\n  _jexcel.timeControl = null;\n  _jexcel.timeControlLoading = null;\n\n  _jexcel.destroy = function (element, destroyEventHandlers) {\n    if (element.jexcel) {\n      element.removeEventListener(\"DOMMouseScroll\", element.jexcel.scrollControls);\n      element.removeEventListener(\"mousewheel\", element.jexcel.scrollControls);\n      element.jexcel = null;\n      element.innerHTML = '';\n\n      if (destroyEventHandlers) {\n        document.removeEventListener(\"keydown\", _jexcel.keyDownControls);\n        document.removeEventListener(\"mouseup\", _jexcel.mouseUpControls);\n        document.removeEventListener(\"mousedown\", _jexcel.mouseDownControls);\n        document.removeEventListener(\"mousemove\", _jexcel.mouseMoveControls);\n        document.removeEventListener(\"mouseover\", _jexcel.mouseOverControls);\n        document.removeEventListener(\"dblclick\", _jexcel.doubleClickControls);\n        document.removeEventListener(\"paste\", _jexcel.pasteControls);\n        document.removeEventListener(\"contextmenu\", _jexcel.contextMenuControls);\n        document.removeEventListener(\"touchstart\", _jexcel.touchStartControls);\n        document.removeEventListener(\"touchend\", _jexcel.touchEndControls);\n        document.removeEventListener(\"touchcancel\", _jexcel.touchEndControls);\n        _jexcel = null;\n      }\n    }\n  };\n\n  _jexcel.build = function () {\n    document.addEventListener(\"keydown\", _jexcel.keyDownControls);\n    document.addEventListener(\"mouseup\", _jexcel.mouseUpControls);\n    document.addEventListener(\"mousedown\", _jexcel.mouseDownControls);\n    document.addEventListener(\"mousemove\", _jexcel.mouseMoveControls);\n    document.addEventListener(\"mouseover\", _jexcel.mouseOverControls);\n    document.addEventListener(\"dblclick\", _jexcel.doubleClickControls);\n    document.addEventListener(\"paste\", _jexcel.pasteControls);\n    document.addEventListener(\"contextmenu\", _jexcel.contextMenuControls);\n    document.addEventListener(\"touchstart\", _jexcel.touchStartControls);\n    document.addEventListener(\"touchend\", _jexcel.touchEndControls);\n    document.addEventListener(\"touchcancel\", _jexcel.touchEndControls);\n    document.addEventListener(\"touchmove\", _jexcel.touchEndControls);\n  };\n  /**\n   * Events\n   */\n\n\n  _jexcel.keyDownControls = function (e) {\n    if (_jexcel.current) {\n      if (_jexcel.current.edition) {\n        if (e.which == 27) {\n          // Escape\n          if (_jexcel.current.edition) {\n            // Exit without saving\n            _jexcel.current.closeEditor(_jexcel.current.edition[0], false);\n          }\n\n          e.preventDefault();\n        } else if (e.which == 13) {\n          // Enter\n          if (_jexcel.current.options.columns[_jexcel.current.edition[2]].type == 'calendar') {\n            _jexcel.current.editor[0].children[0].calendar.close(1);\n          } else if (_jexcel.current.options.columns[_jexcel.current.edition[2]].type == 'dropdown' || _jexcel.current.options.columns[_jexcel.current.edition[2]].type == 'autocomplete') {// Do nothing\n          } else {\n            // Alt enter -> do not close editor\n            if ((_jexcel.current.options.wordWrap == true || _jexcel.current.options.columns[_jexcel.current.edition[2]].wordWrap == true || _jexcel.current.options.data[_jexcel.current.edition[3]][_jexcel.current.edition[2]].length > 200) && e.altKey) {\n              // Add new line to the editor\n              var editorTextarea = _jexcel.current.edition[0].children[0];\n              var editorValue = _jexcel.current.edition[0].children[0].value;\n              var editorIndexOf = editorTextarea.selectionStart;\n              editorValue = editorValue.slice(0, editorIndexOf) + \"\\n\" + editorValue.slice(editorIndexOf);\n              editorTextarea.value = editorValue;\n              editorTextarea.focus();\n              editorTextarea.selectionStart = editorIndexOf + 1;\n              editorTextarea.selectionEnd = editorIndexOf + 1;\n            } else {\n              _jexcel.current.edition[0].children[0].blur();\n            }\n          }\n        } else if (e.which == 9) {\n          // Tab\n          if (_jexcel.current.options.columns[_jexcel.current.edition[2]].type == 'calendar') {\n            _jexcel.current.edition[0].children[0].calendar.close(1);\n          } else {\n            _jexcel.current.edition[0].children[0].blur();\n          }\n        }\n      }\n\n      if (!_jexcel.current.edition && _jexcel.current.selectedCell) {\n        // Which key\n        if (e.which == 37) {\n          _jexcel.current.left(e.shiftKey, e.ctrlKey);\n\n          e.preventDefault();\n        } else if (e.which == 39) {\n          _jexcel.current.right(e.shiftKey, e.ctrlKey);\n\n          e.preventDefault();\n        } else if (e.which == 38) {\n          _jexcel.current.up(e.shiftKey, e.ctrlKey);\n\n          e.preventDefault();\n        } else if (e.which == 40) {\n          _jexcel.current.down(e.shiftKey, e.ctrlKey);\n\n          e.preventDefault();\n        } else if (e.which == 36) {\n          _jexcel.current.first(e.shiftKey, e.ctrlKey);\n\n          e.preventDefault();\n        } else if (e.which == 35) {\n          _jexcel.current.last(e.shiftKey, e.ctrlKey);\n\n          e.preventDefault();\n        } else if (e.which == 32) {\n          if (_jexcel.current.options.editable == true) {\n            _jexcel.current.setCheckRadioValue();\n          }\n\n          e.preventDefault();\n        } else if (e.which == 46) {\n          // Delete\n          if (_jexcel.current.options.editable == true) {\n            if (_jexcel.current.selectedRow) {\n              if (_jexcel.current.options.allowDeleteRow == true) {\n                if (confirm(_jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)) {\n                  _jexcel.current.deleteRow();\n                }\n              }\n            } else if (_jexcel.current.selectedHeader) {\n              if (_jexcel.current.options.allowDeleteColumn == true) {\n                if (confirm(_jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)) {\n                  _jexcel.current.deleteColumn();\n                }\n              }\n            } else {\n              // Change value\n              _jexcel.current.setValue(_jexcel.current.highlighted, '');\n            }\n          }\n        } else if (e.which == 13) {\n          // Move cursor\n          if (e.shiftKey) {\n            _jexcel.current.up();\n          } else {\n            if (_jexcel.current.options.allowInsertRow == true) {\n              if (_jexcel.current.options.allowManualInsertRow == true) {\n                if (_jexcel.current.selectedCell[1] == _jexcel.current.options.data.length - 1) {\n                  // New record in case selectedCell in the last row\n                  _jexcel.current.insertRow();\n                }\n              }\n            }\n\n            _jexcel.current.down();\n          }\n\n          e.preventDefault();\n        } else if (e.which == 9) {\n          // Tab\n          if (e.shiftKey) {\n            _jexcel.current.left();\n          } else {\n            if (_jexcel.current.options.allowInsertColumn == true) {\n              if (_jexcel.current.options.allowManualInsertColumn == true) {\n                if (_jexcel.current.selectedCell[0] == _jexcel.current.options.data[0].length - 1) {\n                  // New record in case selectedCell in the last column\n                  _jexcel.current.insertColumn();\n                }\n              }\n            }\n\n            _jexcel.current.right();\n          }\n\n          e.preventDefault();\n        } else {\n          if ((e.ctrlKey || e.metaKey) && !e.shiftKey) {\n            if (e.which == 65) {\n              // Ctrl + A\n              _jexcel.current.selectAll();\n\n              e.preventDefault();\n            } else if (e.which == 83) {\n              // Ctrl + S\n              _jexcel.current.download();\n\n              e.preventDefault();\n            } else if (e.which == 89) {\n              // Ctrl + Y\n              _jexcel.current.redo();\n\n              e.preventDefault();\n            } else if (e.which == 90) {\n              // Ctrl + Z\n              _jexcel.current.undo();\n\n              e.preventDefault();\n            } else if (e.which == 67) {\n              // Ctrl + C\n              _jexcel.current.copy(true);\n\n              e.preventDefault();\n            } else if (e.which == 67) {\n              // Ctrl + C\n              _jexcel.current.copy(true);\n\n              e.preventDefault();\n            } else if (e.which == 88) {\n              // Ctrl + X\n              if (_jexcel.current.options.editable == true) {\n                _jexcel.cutControls();\n              } else {\n                _jexcel.copyControls();\n              }\n\n              e.preventDefault();\n            } else if (e.which == 86) {\n              // Ctrl + V\n              _jexcel.pasteControls();\n            }\n          } else {\n            if (_jexcel.current.selectedCell) {\n              if (_jexcel.current.options.editable == true) {\n                var rowId = _jexcel.current.selectedCell[1];\n                var columnId = _jexcel.current.selectedCell[0]; // If is not readonly\n\n                if (_jexcel.current.options.columns[columnId].type != 'readonly') {\n                  // Characters able to start a edition\n                  if (e.keyCode == 32) {\n                    // Space\n                    if (_jexcel.current.options.columns[columnId].type == 'checkbox' || _jexcel.current.options.columns[columnId].type == 'radio') {\n                      e.preventDefault();\n                    } else {\n                      // Start edition\n                      _jexcel.current.openEditor(_jexcel.current.records[rowId][columnId], true);\n                    }\n                  } else if (e.keyCode == 113) {\n                    // Start edition with current content F2\n                    _jexcel.current.openEditor(_jexcel.current.records[rowId][columnId], false);\n                  } else if (e.keyCode == 8 || e.keyCode >= 48 && e.keyCode <= 57 || e.keyCode >= 96 && e.keyCode <= 111 || e.keyCode == 187 || e.keyCode == 189 || (String.fromCharCode(e.keyCode) == e.key || String.fromCharCode(e.keyCode).toLowerCase() == e.key.toLowerCase()) && _jexcel.validLetter(String.fromCharCode(e.keyCode))) {\n                    // Start edition\n                    _jexcel.current.openEditor(_jexcel.current.records[rowId][columnId], true); // Prevent entries in the calendar\n\n\n                    if (_jexcel.current.options.columns[columnId].type == 'calendar') {\n                      e.preventDefault();\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      } else {\n        if (e.target.classList.contains('jexcel_search')) {\n          if (_jexcel.timeControl) {\n            clearTimeout(_jexcel.timeControl);\n          }\n\n          _jexcel.timeControl = setTimeout(function () {\n            _jexcel.current.search(e.target.value);\n          }, 200);\n        }\n      }\n    }\n  };\n\n  _jexcel.isMouseAction = false;\n\n  _jexcel.mouseDownControls = function (e) {\n    e = e || window.event;\n\n    if (e.buttons) {\n      var mouseButton = e.buttons;\n    } else if (e.button) {\n      var mouseButton = e.button;\n    } else {\n      var mouseButton = e.which;\n    } // Get elements\n\n\n    var jexcelTable = _jexcel.getElement(e.target);\n\n    if (jexcelTable[0]) {\n      if (_jexcel.current != jexcelTable[0].jexcel) {\n        if (_jexcel.current) {\n          _jexcel.current.resetSelection();\n        }\n\n        _jexcel.current = jexcelTable[0].jexcel;\n      }\n    } else {\n      if (_jexcel.current) {\n        _jexcel.current.resetSelection(true);\n\n        _jexcel.current = null;\n      }\n    }\n\n    if (_jexcel.current && mouseButton == 1) {\n      if (e.target.classList.contains('jexcel_selectall')) {\n        if (_jexcel.current) {\n          _jexcel.current.selectAll();\n        }\n      } else if (e.target.classList.contains('jexcel_corner')) {\n        if (_jexcel.current.options.editable == true) {\n          _jexcel.current.selectedCorner = true;\n        }\n      } else {\n        // Header found\n        if (jexcelTable[1] == 1) {\n          var columnId = e.target.getAttribute('data-x');\n\n          if (columnId) {\n            // Update cursor\n            var info = e.target.getBoundingClientRect();\n\n            if (_jexcel.current.options.columnResize == true && info.width - e.offsetX < 6) {\n              // Resize helper\n              _jexcel.current.resizing = {\n                mousePosition: e.pageX,\n                column: columnId,\n                width: info.width\n              }; // Border indication\n\n              _jexcel.current.headers[columnId].classList.add('resizing');\n\n              for (var j = 0; j < _jexcel.current.records.length; j++) {\n                if (_jexcel.current.records[j][columnId]) {\n                  _jexcel.current.records[j][columnId].classList.add('resizing');\n                }\n              }\n            } else if (_jexcel.current.options.columnDrag == true && info.height - e.offsetY < 6) {\n              if (_jexcel.current.isColMerged(columnId).length) {\n                console.error('JEXCEL: This column is part of a merged cell.');\n              } else {\n                // Reset selection\n                _jexcel.current.resetSelection(); // Drag helper\n\n\n                _jexcel.current.dragging = {\n                  element: e.target,\n                  column: columnId,\n                  destination: columnId\n                }; // Border indication\n\n                _jexcel.current.headers[columnId].classList.add('dragging');\n\n                for (var j = 0; j < _jexcel.current.records.length; j++) {\n                  if (_jexcel.current.records[j][columnId]) {\n                    _jexcel.current.records[j][columnId].classList.add('dragging');\n                  }\n                }\n              }\n            } else {\n              if (_jexcel.current.selectedHeader && (e.shiftKey || e.ctrlKey)) {\n                var o = _jexcel.current.selectedHeader;\n                var d = columnId;\n              } else {\n                // Press to rename\n                if (_jexcel.current.selectedHeader == columnId && _jexcel.current.options.allowRenameColumn == true) {\n                  _jexcel.timeControl = setTimeout(function () {\n                    _jexcel.current.setHeader(columnId);\n                  }, 800);\n                } // Keep track of which header was selected first\n\n\n                _jexcel.current.selectedHeader = columnId; // Update selection single column\n\n                var o = columnId;\n                var d = columnId;\n              } // Update selection\n\n\n              _jexcel.current.updateSelectionFromCoords(o, 0, d, _jexcel.current.options.data.length - 1);\n            }\n          } else {\n            if (e.target.parentNode.classList.contains('jexcel_nested')) {\n              if (e.target.getAttribute('data-column')) {\n                var column = e.target.getAttribute('data-column').split(',');\n                var c1 = parseInt(column[0]);\n                var c2 = parseInt(column[column.length - 1]);\n              } else {\n                var c1 = 0;\n                var c2 = _jexcel.current.options.columns.length - 1;\n              }\n\n              _jexcel.current.updateSelectionFromCoords(c1, 0, c2, _jexcel.current.options.data.length - 1);\n            }\n          }\n        } else {\n          _jexcel.current.selectedHeader = false;\n        } // Body found\n\n\n        if (jexcelTable[1] == 2) {\n          var rowId = e.target.getAttribute('data-y');\n\n          if (e.target.classList.contains('jexcel_row')) {\n            var info = e.target.getBoundingClientRect();\n\n            if (_jexcel.current.options.rowResize == true && info.height - e.offsetY < 6) {\n              // Resize helper\n              _jexcel.current.resizing = {\n                element: e.target.parentNode,\n                mousePosition: e.pageY,\n                row: rowId,\n                height: info.height\n              }; // Border indication\n\n              e.target.parentNode.classList.add('resizing');\n            } else if (_jexcel.current.options.rowDrag == true && info.width - e.offsetX < 6) {\n              if (_jexcel.current.isRowMerged(rowId).length) {\n                console.error('JEXCEL: This row is part of a merged cell');\n              } else if (_jexcel.current.options.search == true && _jexcel.current.results) {\n                console.error('JEXCEL: Please clear your search before perform this action');\n              } else {\n                // Reset selection\n                _jexcel.current.resetSelection(); // Drag helper\n\n\n                _jexcel.current.dragging = {\n                  element: e.target.parentNode,\n                  row: rowId,\n                  destination: rowId\n                }; // Border indication\n\n                e.target.parentNode.classList.add('dragging');\n              }\n            } else {\n              if (_jexcel.current.selectedRow && (e.shiftKey || e.ctrlKey)) {\n                var o = _jexcel.current.selectedRow;\n                var d = rowId;\n              } else {\n                // Keep track of which header was selected first\n                _jexcel.current.selectedRow = rowId; // Update selection single column\n\n                var o = rowId;\n                var d = rowId;\n              } // Update selection\n\n\n              _jexcel.current.updateSelectionFromCoords(0, o, _jexcel.current.options.data[0].length - 1, d);\n            }\n          } else {\n            // Jclose\n            if (e.target.classList.contains('jclose') && e.target.clientWidth - e.offsetX < 50 && e.offsetY < 50) {\n              _jexcel.current.closeEditor(_jexcel.current.edition[0], true);\n            } else {\n              var getCellCoords = function getCellCoords(element) {\n                var x = element.getAttribute('data-x');\n                var y = element.getAttribute('data-y');\n\n                if (x && y) {\n                  return [x, y];\n                } else {\n                  if (element.parentNode) {\n                    return getCellCoords(element.parentNode);\n                  }\n                }\n              };\n\n              var position = getCellCoords(e.target);\n\n              if (position) {\n                var columnId = position[0];\n                var rowId = position[1]; // Close edition\n\n                if (_jexcel.current.edition) {\n                  if (_jexcel.current.edition[2] != columnId || _jexcel.current.edition[3] != rowId) {\n                    _jexcel.current.closeEditor(_jexcel.current.edition[0], true);\n                  }\n                }\n\n                if (!_jexcel.current.edition) {\n                  // Update cell selection\n                  if (e.shiftKey) {\n                    _jexcel.current.updateSelectionFromCoords(_jexcel.current.selectedCell[0], _jexcel.current.selectedCell[1], columnId, rowId);\n                  } else {\n                    _jexcel.current.updateSelectionFromCoords(columnId, rowId);\n                  }\n                } // No full row selected\n\n\n                _jexcel.current.selectedHeader = null;\n                _jexcel.current.selectedRow = null;\n              }\n            }\n          }\n        } else {\n          _jexcel.current.selectedRow = false;\n        } // Pagination\n\n\n        if (e.target.classList.contains('jexcel_page')) {\n          if (e.target.innerText == '<') {\n            _jexcel.current.page(0);\n          } else if (e.target.innerText == '>') {\n            _jexcel.current.page(e.target.getAttribute('title') - 1);\n          } else {\n            _jexcel.current.page(e.target.innerText - 1);\n          }\n        }\n      }\n\n      if (_jexcel.current.edition) {\n        _jexcel.isMouseAction = false;\n      } else {\n        _jexcel.isMouseAction = true;\n      }\n    } else {\n      _jexcel.isMouseAction = false;\n    }\n  };\n\n  _jexcel.mouseUpControls = function (e) {\n    if (_jexcel.current) {\n      // Update cell size\n      if (_jexcel.current.resizing) {\n        // Columns to be updated\n        if (_jexcel.current.resizing.column) {\n          // Remove Class\n          _jexcel.current.headers[_jexcel.current.resizing.column].classList.remove('resizing');\n\n          var newWidth = _jexcel.current.colgroup[_jexcel.current.resizing.column].getAttribute('width');\n\n          _jexcel.current.setWidth(_jexcel.current.resizing.column, newWidth, _jexcel.current.resizing.width); // Remove border\n\n\n          _jexcel.current.headers[_jexcel.current.resizing.column].classList.remove('resizing');\n\n          for (var j = 0; j < _jexcel.current.records.length; j++) {\n            if (_jexcel.current.records[j][_jexcel.current.resizing.column]) {\n              _jexcel.current.records[j][_jexcel.current.resizing.column].classList.remove('resizing');\n            }\n          }\n        } else {\n          // Remove Class\n          _jexcel.current.rows[_jexcel.current.resizing.row].children[0].classList.remove('resizing');\n\n          var newHeight = _jexcel.current.rows[_jexcel.current.resizing.row].getAttribute('height');\n\n          _jexcel.current.setHeight(_jexcel.current.resizing.row, newHeight, _jexcel.current.resizing.height); // Remove border\n\n\n          _jexcel.current.resizing.element.classList.remove('resizing');\n        } // Reset resizing helper\n\n\n        _jexcel.current.resizing = null;\n      } else if (_jexcel.current.dragging) {\n        // Reset dragging helper\n        if (_jexcel.current.dragging) {\n          if (_jexcel.current.dragging.column) {\n            // Target\n            var columnId = e.target.getAttribute('data-x'); // Remove move style\n\n            _jexcel.current.headers[_jexcel.current.dragging.column].classList.remove('dragging');\n\n            for (var j = 0; j < _jexcel.current.rows.length; j++) {\n              if (_jexcel.current.records[j][_jexcel.current.dragging.column]) {\n                _jexcel.current.records[j][_jexcel.current.dragging.column].classList.remove('dragging');\n              }\n            }\n\n            for (var i = 0; i < _jexcel.current.headers.length; i++) {\n              _jexcel.current.headers[i].classList.remove('dragging-left');\n\n              _jexcel.current.headers[i].classList.remove('dragging-right');\n            } // Update position\n\n\n            if (columnId) {\n              if (_jexcel.current.dragging.column != _jexcel.current.dragging.destination) {\n                _jexcel.current.moveColumn(_jexcel.current.dragging.column, _jexcel.current.dragging.destination);\n              }\n            }\n          } else {\n            var position = Array.prototype.indexOf.call(_jexcel.current.dragging.element.parentNode.children, _jexcel.current.dragging.element);\n\n            if (_jexcel.current.dragging.row != position) {\n              _jexcel.current.moveRow(_jexcel.current.dragging.row, position, true);\n            }\n\n            _jexcel.current.dragging.element.classList.remove('dragging');\n          }\n\n          _jexcel.current.dragging = null;\n        }\n      } else {\n        // Close any corner selection\n        if (_jexcel.current.selectedCorner) {\n          _jexcel.current.selectedCorner = false; // Data to be copied\n\n          if (_jexcel.current.selection.length > 0) {\n            // Copy data\n            _jexcel.current.copyData(_jexcel.current.selection[0], _jexcel.current.selection[_jexcel.current.selection.length - 1]); // Remove selection\n\n\n            _jexcel.current.removeCopySelection();\n          }\n        }\n      }\n    } // Clear any time control\n\n\n    if (_jexcel.timeControl) {\n      clearTimeout(_jexcel.timeControl);\n      _jexcel.timeControl = null;\n    } // Mouse up\n\n\n    _jexcel.isMouseAction = false;\n  }; // Mouse move controls\n\n\n  _jexcel.mouseMoveControls = function (e) {\n    e = e || window.event;\n\n    if (e.buttons) {\n      var mouseButton = e.buttons;\n    } else if (e.button) {\n      var mouseButton = e.button;\n    } else {\n      var mouseButton = e.which;\n    }\n\n    if (!mouseButton) {\n      _jexcel.isMouseAction = false;\n    }\n\n    if (_jexcel.current) {\n      if (_jexcel.isMouseAction == true) {\n        // Resizing is ongoing\n        if (_jexcel.current.resizing) {\n          if (_jexcel.current.resizing.column) {\n            var width = e.pageX - _jexcel.current.resizing.mousePosition;\n\n            if (_jexcel.current.resizing.width + width > 0) {\n              var tempWidth = _jexcel.current.resizing.width + width;\n\n              _jexcel.current.colgroup[_jexcel.current.resizing.column].setAttribute('width', tempWidth);\n\n              _jexcel.current.updateCornerPosition();\n            }\n          } else {\n            var height = e.pageY - _jexcel.current.resizing.mousePosition;\n\n            if (_jexcel.current.resizing.height + height > 0) {\n              var tempHeight = _jexcel.current.resizing.height + height;\n\n              _jexcel.current.rows[_jexcel.current.resizing.row].setAttribute('height', tempHeight);\n\n              _jexcel.current.updateCornerPosition();\n            }\n          }\n        }\n      } else {\n        var x = e.target.getAttribute('data-x');\n        var y = e.target.getAttribute('data-y');\n        var rect = e.target.getBoundingClientRect();\n\n        if (_jexcel.current.cursor) {\n          _jexcel.current.cursor.style.cursor = '';\n          _jexcel.current.cursor = null;\n        }\n\n        if (e.target.parentNode.parentNode && e.target.parentNode.parentNode.className) {\n          if (e.target.parentNode.parentNode.classList.contains('resizable')) {\n            if (e.target && x && !y && rect.width - (e.clientX - rect.left) < 6) {\n              _jexcel.current.cursor = e.target;\n              _jexcel.current.cursor.style.cursor = 'col-resize';\n            } else if (e.target && !x && y && rect.height - (e.clientY - rect.top) < 6) {\n              _jexcel.current.cursor = e.target;\n              _jexcel.current.cursor.style.cursor = 'row-resize';\n            }\n          }\n\n          if (e.target.parentNode.parentNode.classList.contains('draggable')) {\n            if (e.target && !x && y && rect.width - (e.clientX - rect.left) < 6) {\n              _jexcel.current.cursor = e.target;\n              _jexcel.current.cursor.style.cursor = 'move';\n            } else if (e.target && x && !y && rect.height - (e.clientY - rect.top) < 6) {\n              _jexcel.current.cursor = e.target;\n              _jexcel.current.cursor.style.cursor = 'move';\n            }\n          }\n        }\n      }\n    }\n  };\n\n  _jexcel.mouseOverControls = function (e) {\n    e = e || window.event;\n\n    if (e.buttons) {\n      var mouseButton = e.buttons;\n    } else if (e.button) {\n      var mouseButton = e.button;\n    } else {\n      var mouseButton = e.which;\n    }\n\n    if (!mouseButton) {\n      _jexcel.isMouseAction = false;\n    }\n\n    if (_jexcel.current && _jexcel.isMouseAction == true) {\n      // Get elements\n      var jexcelTable = _jexcel.getElement(e.target);\n\n      if (jexcelTable[0]) {\n        // Avoid cross reference\n        if (_jexcel.current != jexcelTable[0].jexcel) {\n          if (_jexcel.current) {\n            return false;\n          }\n        }\n\n        var columnId = e.target.getAttribute('data-x');\n        var rowId = e.target.getAttribute('data-y');\n\n        if (_jexcel.current.dragging) {\n          if (_jexcel.current.dragging.column) {\n            if (columnId) {\n              if (_jexcel.current.isColMerged(columnId).length) {\n                console.error('JEXCEL: This column is part of a merged cell.');\n              } else {\n                for (var i = 0; i < _jexcel.current.headers.length; i++) {\n                  _jexcel.current.headers[i].classList.remove('dragging-left');\n\n                  _jexcel.current.headers[i].classList.remove('dragging-right');\n                }\n\n                if (_jexcel.current.dragging.column == columnId) {\n                  _jexcel.current.dragging.destination = parseInt(columnId);\n                } else {\n                  if (e.target.clientWidth / 2 > e.offsetX) {\n                    if (_jexcel.current.dragging.column < columnId) {\n                      _jexcel.current.dragging.destination = parseInt(columnId) - 1;\n                    } else {\n                      _jexcel.current.dragging.destination = parseInt(columnId);\n                    }\n\n                    _jexcel.current.headers[columnId].classList.add('dragging-left');\n                  } else {\n                    if (_jexcel.current.dragging.column < columnId) {\n                      _jexcel.current.dragging.destination = parseInt(columnId);\n                    } else {\n                      _jexcel.current.dragging.destination = parseInt(columnId) + 1;\n                    }\n\n                    _jexcel.current.headers[columnId].classList.add('dragging-right');\n                  }\n                }\n              }\n            }\n          } else {\n            if (rowId) {\n              if (_jexcel.current.isRowMerged(rowId).length) {\n                console.error('JEXCEL: This row is part of a merged cell.');\n              } else {\n                var target = e.target.clientHeight / 2 > e.offsetY ? e.target.parentNode.nextSibling : e.target.parentNode;\n                e.target.parentNode.parentNode.insertBefore(_jexcel.current.dragging.element, target);\n              }\n            }\n          }\n        } else if (_jexcel.current.resizing) {} else {\n          // Header found\n          if (jexcelTable[1] == 1) {\n            if (_jexcel.current.selectedHeader) {\n              var columnId = e.target.getAttribute('data-x');\n              var o = _jexcel.current.selectedHeader;\n              var d = columnId; // Update selection\n\n              _jexcel.current.updateSelectionFromCoords(o, 0, d, _jexcel.current.options.data.length - 1);\n            }\n          } // Body found\n\n\n          if (jexcelTable[1] == 2) {\n            if (e.target.classList.contains('jexcel_row')) {\n              if (_jexcel.current.selectedRow) {\n                var o = _jexcel.current.selectedRow;\n                var d = rowId; // Update selection\n\n                _jexcel.current.updateSelectionFromCoords(0, o, _jexcel.current.options.data[0].length - 1, d);\n              }\n            } else {\n              // Do not select edtion is in progress\n              if (!_jexcel.current.edition) {\n                if (columnId && rowId) {\n                  if (_jexcel.current.selectedCorner) {\n                    _jexcel.current.updateCopySelection(columnId, rowId);\n                  } else {\n                    if (_jexcel.current.selectedCell) {\n                      _jexcel.current.updateSelectionFromCoords(_jexcel.current.selectedCell[0], _jexcel.current.selectedCell[1], columnId, rowId);\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    } // Clear any time control\n\n\n    if (_jexcel.timeControl) {\n      clearTimeout(_jexcel.timeControl);\n      _jexcel.timeControl = null;\n    }\n  };\n  /**\n   * Double click event handler: controls the double click in the corner, cell edition or column re-ordering.\n   */\n\n\n  _jexcel.doubleClickControls = function (e) {\n    // Jexcel is selected\n    if (_jexcel.current) {\n      // Corner action\n      if (e.target.classList.contains('jexcel_corner')) {\n        // Any selected cells\n        if (_jexcel.current.highlighted.length > 0) {\n          // Copy from this\n          var x1 = _jexcel.current.highlighted[0].getAttribute('data-x');\n\n          var y1 = parseInt(_jexcel.current.highlighted[_jexcel.current.highlighted.length - 1].getAttribute('data-y')) + 1; // Until this\n\n          var x2 = _jexcel.current.highlighted[_jexcel.current.highlighted.length - 1].getAttribute('data-x');\n\n          var y2 = _jexcel.current.records.length - 1; // Execute copy\n\n          _jexcel.current.copyData(_jexcel.current.records[y1][x1], _jexcel.current.records[y2][x2]);\n        }\n      } else {\n        // Get table\n        var jexcelTable = _jexcel.getElement(e.target); // Double click over header\n\n\n        if (jexcelTable[1] == 1 && _jexcel.current.options.columnSorting == true) {\n          // Check valid column header coords\n          var columnId = e.target.getAttribute('data-x');\n\n          if (columnId) {\n            _jexcel.current.orderBy(columnId);\n          }\n        } // Double click over body\n\n\n        if (jexcelTable[1] == 2 && _jexcel.current.options.editable == true) {\n          if (!_jexcel.current.edition) {\n            var getCellCoords = function getCellCoords(element) {\n              if (element.parentNode) {\n                var x = element.getAttribute('data-x');\n                var y = element.getAttribute('data-y');\n\n                if (x && y) {\n                  return element;\n                } else {\n                  return getCellCoords(element.parentNode);\n                }\n              }\n            };\n\n            var cell = getCellCoords(e.target);\n\n            if (cell && cell.classList.contains('highlight')) {\n              _jexcel.current.openEditor(cell);\n            }\n          }\n        }\n      }\n    }\n  };\n\n  _jexcel.copyControls = function (e) {\n    if (_jexcel.current && _jexcel.copyControls.enabled) {\n      if (!_jexcel.current.edition) {\n        _jexcel.current.copy(true);\n      }\n    }\n  };\n\n  _jexcel.cutControls = function (e) {\n    if (_jexcel.current) {\n      if (!_jexcel.current.edition) {\n        _jexcel.current.copy(true);\n\n        if (_jexcel.current.options.editable == true) {\n          _jexcel.current.setValue(_jexcel.current.highlighted, '');\n        }\n      }\n    }\n  };\n\n  _jexcel.pasteControls = function (e) {\n    if (_jexcel.current && _jexcel.current.selectedCell) {\n      if (!_jexcel.current.edition) {\n        if (_jexcel.current.options.editable == true) {\n          if (e && e.clipboardData) {\n            _jexcel.current.paste(_jexcel.current.selectedCell[0], _jexcel.current.selectedCell[1], e.clipboardData.getData('text'));\n\n            e.preventDefault();\n          } else if (window.clipboardData) {\n            _jexcel.current.paste(_jexcel.current.selectedCell[0], _jexcel.current.selectedCell[1], window.clipboardData.getData('text'));\n          }\n        }\n      }\n    }\n  };\n\n  _jexcel.contextMenuControls = function (e) {\n    e = e || window.event;\n\n    if (\"buttons\" in e) {\n      var mouseButton = e.buttons;\n    } else {\n      var mouseButton = e.which || e.button;\n    }\n\n    if (_jexcel.current) {\n      if (_jexcel.current.edition) {\n        e.preventDefault();\n      } else if (_jexcel.current.options.contextMenu) {\n        _jexcel.current.contextMenu.contextmenu.close();\n\n        if (_jexcel.current) {\n          var x = e.target.getAttribute('data-x');\n          var y = e.target.getAttribute('data-y');\n\n          if (x || y) {\n            // Table found\n            var items = _jexcel.current.options.contextMenu(_jexcel.current, x, y, e); // The id is depending on header and body\n\n\n            _jexcel.current.contextMenu.contextmenu.open(e, items); // Avoid the real one\n\n\n            e.preventDefault();\n          }\n        }\n      }\n    }\n  };\n\n  _jexcel.touchStartControls = function (e) {\n    var jexcelTable = _jexcel.getElement(e.target);\n\n    if (jexcelTable[0]) {\n      if (_jexcel.current != jexcelTable[0].jexcel) {\n        if (_jexcel.current) {\n          _jexcel.current.resetSelection();\n        }\n\n        _jexcel.current = jexcelTable[0].jexcel;\n      }\n    } else {\n      if (_jexcel.current) {\n        _jexcel.current.resetSelection();\n\n        _jexcel.current = null;\n      }\n    }\n\n    if (_jexcel.current) {\n      if (!_jexcel.current.edition) {\n        var columnId = e.target.getAttribute('data-x');\n        var rowId = e.target.getAttribute('data-y');\n\n        if (columnId && rowId) {\n          _jexcel.current.updateSelectionFromCoords(columnId, rowId);\n\n          _jexcel.timeControl = setTimeout(function () {\n            // Keep temporary reference to the element\n            if (_jexcel.current.options.columns[columnId].type == 'color') {\n              _jexcel.tmpElement = null;\n            } else {\n              _jexcel.tmpElement = e.target;\n            }\n\n            _jexcel.current.openEditor(e.target, false, e);\n          }, 500);\n        }\n      }\n    }\n  };\n\n  _jexcel.touchEndControls = function (e) {\n    // Clear any time control\n    if (_jexcel.timeControl) {\n      clearTimeout(_jexcel.timeControl);\n      _jexcel.timeControl = null; // Element\n\n      if (_jexcel.tmpElement && _jexcel.tmpElement.children[0].tagName == 'INPUT') {\n        _jexcel.tmpElement.children[0].focus();\n      }\n\n      _jexcel.tmpElement = null;\n    }\n  };\n  /**\r\n   * Jexcel extensions\r\n   */\n\n\n  _jexcel.createTabs = function (tabs, result) {\n    // Create tab container\n    tabs.innerHTML = '';\n    tabs.classList.add('jexcel_tabs');\n    var spreadsheet = [];\n    var link = [];\n\n    for (var i = 0; i < result.length; i++) {\n      // Spreadsheet container\n      spreadsheet[i] = document.createElement('div');\n      spreadsheet[i].classList.add('jexcel_tab'); // Tab link\n\n      link[i] = document.createElement('div');\n      link[i].classList.add('jexcel_tab_link');\n      link[i].setAttribute('data-spreadsheet', i);\n      link[i].innerHTML = result[i].sheetName;\n\n      link[i].onclick = function () {\n        for (var j = 0; j < spreadsheet.length; j++) {\n          spreadsheet[j].style.display = 'none';\n          link[j].classList.remove('selected');\n        }\n\n        var i = this.getAttribute('data-spreadsheet');\n        spreadsheet[i].style.display = 'block';\n        link[i].classList.add('selected');\n      };\n\n      tabs.appendChild(link[i]);\n    } // Append spreadsheet\n\n\n    for (var i = 0; i < spreadsheet.length - 1; i++) {\n      tabs.appendChild(spreadsheet[i]);\n\n      _jexcel(spreadsheet[i], result[i]);\n    } // First tab\n\n\n    spreadsheet[0].style.display = 'block';\n    link[0].classList.add('selected');\n  };\n\n  _jexcel.fromSpreadsheet = function (file, __callback) {\n    var convert = function convert(workbook) {\n      var spreadsheets = [];\n      workbook.SheetNames.forEach(function (sheetName) {\n        var spreadsheet = {};\n        spreadsheet.rows = [];\n        spreadsheet.columns = [];\n        spreadsheet.data = [];\n        spreadsheet.style = {};\n        spreadsheet.sheetName = sheetName; // Column widths\n\n        var temp = workbook.Sheets[sheetName]['!cols'];\n\n        if (temp && temp.length) {\n          for (var i = 0; i < temp.length; i++) {\n            spreadsheet.columns[i] = {};\n\n            if (temp[i] && temp[i].wpx) {\n              spreadsheet.columns[i].width = temp[i].wpx + 'px';\n            }\n          }\n        } // Rows heights\n\n\n        var temp = workbook.Sheets[sheetName]['!rows'];\n\n        if (temp && temp.length) {\n          for (var i = 0; i < temp.length; i++) {\n            if (temp[i] && temp[i].hpx) {\n              spreadsheet.rows[i] = {};\n              spreadsheet.rows[i].height = temp[i].hpx + 'px';\n            }\n          }\n        } // Merge cells\n\n\n        var temp = workbook.Sheets[sheetName]['!merges'];\n\n        if (temp && temp.length > 0) {\n          spreadsheet.mergeCells = [];\n\n          for (var i = 0; i < temp.length; i++) {\n            var x1 = temp[i].s.c;\n            var y1 = temp[i].s.r;\n            var x2 = temp[i].e.c;\n            var y2 = temp[i].e.r;\n\n            var key = _jexcel.getColumnNameFromId([x1, y1]);\n\n            spreadsheet.mergeCells[key] = [x2 - x1 + 1, y2 - y1 + 1];\n          }\n        } // Data container\n\n\n        var max_x = 0;\n        var max_y = 0;\n        var temp = Object.keys(workbook.Sheets[sheetName]);\n\n        for (var i = 0; i < temp.length; i++) {\n          if (temp[i].substr(0, 1) != '!') {\n            var cell = workbook.Sheets[sheetName][temp[i]];\n\n            var info = _jexcel.getIdFromColumnName(temp[i], true);\n\n            if (!spreadsheet.data[info[1]]) {\n              spreadsheet.data[info[1]] = [];\n            }\n\n            spreadsheet.data[info[1]][info[0]] = cell.f ? '=' + cell.f : cell.w;\n\n            if (max_x < info[0]) {\n              max_x = info[0];\n            }\n\n            if (max_y < info[1]) {\n              max_y = info[1];\n            } // Style\n\n\n            if (cell.style && Object.keys(cell.style).length > 0) {\n              spreadsheet.style[temp[i]] = cell.style;\n            }\n\n            if (cell.s && cell.s.fgColor) {\n              if (spreadsheet.style[temp[i]]) {\n                spreadsheet.style[temp[i]] += ';';\n              }\n\n              spreadsheet.style[temp[i]] += 'background-color:#' + cell.s.fgColor.rgb;\n            }\n          }\n        }\n\n        var numColumns = spreadsheet.columns;\n\n        for (var j = 0; j <= max_y; j++) {\n          for (var i = 0; i <= max_x; i++) {\n            if (!spreadsheet.data[j]) {\n              spreadsheet.data[j] = [];\n            }\n\n            if (!spreadsheet.data[j][i]) {\n              if (numColumns < i) {\n                spreadsheet.data[j][i] = '';\n              }\n            }\n          }\n        }\n\n        spreadsheets.push(spreadsheet);\n      });\n      return spreadsheets;\n    };\n\n    var oReq;\n    oReq = new XMLHttpRequest();\n    oReq.open(\"GET\", file, true);\n\n    if (typeof Uint8Array !== 'undefined') {\n      oReq.responseType = \"arraybuffer\";\n\n      oReq.onload = function (e) {\n        var arraybuffer = oReq.response;\n        var data = new Uint8Array(arraybuffer);\n        var wb = XLSX.read(data, {\n          type: \"array\",\n          cellFormula: true,\n          cellStyles: true\n        });\n\n        __callback(convert(wb));\n      };\n    } else {\n      oReq.setRequestHeader(\"Accept-Charset\", \"x-user-defined\");\n\n      oReq.onreadystatechange = function () {\n        if (oReq.readyState == 4 && oReq.status == 200) {\n          var ff = convertResponseBodyToText(oReq.responseBody);\n          var wb = XLSX.read(ff, {\n            type: \"binary\",\n            cellFormula: true,\n            cellStyles: true\n          });\n\n          __callback(convert(wb));\n        }\n      };\n    }\n\n    oReq.send();\n  };\n  /**\r\n   * Valid international letter\r\n   */\n\n\n  _jexcel.validLetter = function (text) {\n    var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC-\\u0400-\\u04FF']+)/g;\n    return text.match(regex) ? 1 : 0;\n  };\n  /**\r\n   * Helper injectArray\r\n   */\n\n\n  _jexcel.injectArray = function (o, idx, arr) {\n    return o.slice(0, idx).concat(arr).concat(o.slice(idx));\n  };\n  /**\r\n   * Get letter based on a number\r\n   * \r\n   * @param integer i\r\n   * @return string letter\r\n   */\n\n\n  _jexcel.getColumnName = function (i) {\n    var letter = '';\n\n    if (i > 701) {\n      letter += String.fromCharCode(64 + parseInt(i / 676));\n      letter += String.fromCharCode(64 + parseInt(i % 676 / 26));\n    } else if (i > 25) {\n      letter += String.fromCharCode(64 + parseInt(i / 26));\n    }\n\n    letter += String.fromCharCode(65 + i % 26);\n    return letter;\n  };\n  /**\r\n   * Convert excel like column to jexcel id\r\n   * \r\n   * @param string id\r\n   * @return string id\r\n   */\n\n\n  _jexcel.getIdFromColumnName = function (id, arr) {\n    // Get the letters\n    var t = /^[a-zA-Z]+/.exec(id);\n\n    if (t) {\n      // Base 26 calculation\n      var code = 0;\n\n      for (var i = 0; i < t[0].length; i++) {\n        code += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, t[0].length - 1 - i);\n      }\n\n      code--; // Make sure jexcel starts on zero\n\n      if (code < 0) {\n        code = 0;\n      } // Number\n\n\n      var number = parseInt(/[0-9]+$/.exec(id));\n\n      if (number > 0) {\n        number--;\n      }\n\n      if (arr == true) {\n        id = [code, number];\n      } else {\n        id = code + '-' + number;\n      }\n    }\n\n    return id;\n  };\n  /**\r\n   * Convert jexcel id to excel like column name\r\n   * \r\n   * @param string id\r\n   * @return string id\r\n   */\n\n\n  _jexcel.getColumnNameFromId = function (cellId) {\n    if (!Array.isArray(cellId)) {\n      cellId = cellId.split('-');\n    }\n\n    return _jexcel.getColumnName(parseInt(cellId[0])) + (parseInt(cellId[1]) + 1);\n  };\n  /**\r\n   * Verify element inside jexcel table\r\n   * \r\n   * @param string id\r\n   * @return string id\r\n   */\n\n\n  _jexcel.getElement = function (element) {\n    var jexcelSection = 0;\n    var jexcelElement = 0;\n\n    function path(element) {\n      if (element.className) {\n        if (element.classList.contains('jexcel_container')) {\n          jexcelElement = element;\n        }\n      }\n\n      if (element.tagName == 'THEAD') {\n        jexcelSection = 1;\n      } else if (element.tagName == 'TBODY') {\n        jexcelSection = 2;\n      }\n\n      if (element.parentNode) {\n        path(element.parentNode);\n      }\n    }\n\n    path(element);\n    return [jexcelElement, jexcelSection];\n  };\n\n  _jexcel.doubleDigitFormat = function (v) {\n    v = '' + v;\n\n    if (v.length == 1) {\n      v = '0' + v;\n    }\n\n    return v;\n  };\n  /**\r\n   * Jquery Support\r\n   */\n\n\n  if (typeof jQuery != 'undefined') {\n    (function ($) {\n      $.fn.jexcel = function (method) {\n        var spreadsheetContainer = $(this).get(0);\n\n        if (!spreadsheetContainer.jexcel) {\n          return _jexcel($(this).get(0), arguments[0]);\n        } else {\n          return spreadsheetContainer.jexcel[method].apply(this, Array.prototype.slice.call(arguments, 1));\n        }\n      };\n    })(jQuery);\n  } // Based on sutoiku work (https://github.com/sutoiku)\n\n\n  var error = function () {\n    var exports = {};\n    exports.nil = new Error('#NULL!');\n    exports.div0 = new Error('#DIV/0!');\n    exports.value = new Error('#VALUE!');\n    exports.ref = new Error('#REF!');\n    exports.name = new Error('#NAME?');\n    exports.num = new Error('#NUM!');\n    exports.na = new Error('#N/A');\n    exports.error = new Error('#ERROR!');\n    exports.data = new Error('#GETTING_DATA');\n    return exports;\n  }();\n\n  var utils = function () {\n    var exports = {};\n\n    exports.flattenShallow = function (array) {\n      if (!array || !array.reduce) {\n        return array;\n      }\n\n      return array.reduce(function (a, b) {\n        var aIsArray = Array.isArray(a);\n        var bIsArray = Array.isArray(b);\n\n        if (aIsArray && bIsArray) {\n          return a.concat(b);\n        }\n\n        if (aIsArray) {\n          a.push(b);\n          return a;\n        }\n\n        if (bIsArray) {\n          return [a].concat(b);\n        }\n\n        return [a, b];\n      });\n    };\n\n    exports.isFlat = function (array) {\n      if (!array) {\n        return false;\n      }\n\n      for (var i = 0; i < array.length; ++i) {\n        if (Array.isArray(array[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    };\n\n    exports.flatten = function () {\n      var result = exports.argsToArray.apply(null, arguments);\n\n      while (!exports.isFlat(result)) {\n        result = exports.flattenShallow(result);\n      }\n\n      return result;\n    };\n\n    exports.argsToArray = function (args) {\n      var result = [];\n      exports.arrayEach(args, function (value) {\n        result.push(value);\n      });\n      return result;\n    };\n\n    exports.numbers = function () {\n      var possibleNumbers = this.flatten.apply(null, arguments);\n      return possibleNumbers.filter(function (el) {\n        return typeof el === 'number';\n      });\n    };\n\n    exports.cleanFloat = function (number) {\n      var power = 1e14;\n      return Math.round(number * power) / power;\n    };\n\n    exports.parseBool = function (bool) {\n      if (typeof bool === 'boolean') {\n        return bool;\n      }\n\n      if (bool instanceof Error) {\n        return bool;\n      }\n\n      if (typeof bool === 'number') {\n        return bool !== 0;\n      }\n\n      if (typeof bool === 'string') {\n        var up = bool.toUpperCase();\n\n        if (up === 'TRUE') {\n          return true;\n        }\n\n        if (up === 'FALSE') {\n          return false;\n        }\n      }\n\n      if (bool instanceof Date && !isNaN(bool)) {\n        return true;\n      }\n\n      return error.value;\n    };\n\n    exports.parseNumber = function (string) {\n      if (string === undefined || string === '') {\n        return error.value;\n      }\n\n      if (!isNaN(string)) {\n        return parseFloat(string);\n      }\n\n      return error.value;\n    };\n\n    exports.parseNumberArray = function (arr) {\n      var len;\n\n      if (!arr || (len = arr.length) === 0) {\n        return error.value;\n      }\n\n      var parsed;\n\n      while (len--) {\n        parsed = exports.parseNumber(arr[len]);\n\n        if (parsed === error.value) {\n          return parsed;\n        }\n\n        arr[len] = parsed;\n      }\n\n      return arr;\n    };\n\n    exports.parseMatrix = function (matrix) {\n      var n;\n\n      if (!matrix || (n = matrix.length) === 0) {\n        return error.value;\n      }\n\n      var pnarr;\n\n      for (var i = 0; i < matrix.length; i++) {\n        pnarr = exports.parseNumberArray(matrix[i]);\n        matrix[i] = pnarr;\n\n        if (pnarr instanceof Error) {\n          return pnarr;\n        }\n      }\n\n      return matrix;\n    };\n\n    var d1900 = new Date(Date.UTC(1900, 0, 1));\n\n    exports.parseDate = function (date) {\n      if (!isNaN(date)) {\n        if (date instanceof Date) {\n          return new Date(date);\n        }\n\n        var d = parseInt(date, 10);\n\n        if (d < 0) {\n          return error.num;\n        }\n\n        if (d <= 60) {\n          return new Date(d1900.getTime() + (d - 1) * 86400000);\n        }\n\n        return new Date(d1900.getTime() + (d - 2) * 86400000);\n      }\n\n      if (typeof date === 'string') {\n        date = new Date(date);\n\n        if (!isNaN(date)) {\n          return date;\n        }\n      }\n\n      return error.value;\n    };\n\n    exports.parseDateArray = function (arr) {\n      var len = arr.length;\n      var parsed;\n\n      while (len--) {\n        parsed = this.parseDate(arr[len]);\n\n        if (parsed === error.value) {\n          return parsed;\n        }\n\n        arr[len] = parsed;\n      }\n\n      return arr;\n    };\n\n    exports.anyIsError = function () {\n      var n = arguments.length;\n\n      while (n--) {\n        if (arguments[n] instanceof Error) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    exports.arrayValuesToNumbers = function (arr) {\n      var n = arr.length;\n      var el;\n\n      while (n--) {\n        el = arr[n];\n\n        if (typeof el === 'number') {\n          continue;\n        }\n\n        if (el === true) {\n          arr[n] = 1;\n          continue;\n        }\n\n        if (el === false) {\n          arr[n] = 0;\n          continue;\n        }\n\n        if (typeof el === 'string') {\n          var number = this.parseNumber(el);\n\n          if (number instanceof Error) {\n            arr[n] = 0;\n          } else {\n            arr[n] = number;\n          }\n        }\n      }\n\n      return arr;\n    };\n\n    exports.rest = function (array, idx) {\n      idx = idx || 1;\n\n      if (!array || typeof array.slice !== 'function') {\n        return array;\n      }\n\n      return array.slice(idx);\n    };\n\n    exports.initial = function (array, idx) {\n      idx = idx || 1;\n\n      if (!array || typeof array.slice !== 'function') {\n        return array;\n      }\n\n      return array.slice(0, array.length - idx);\n    };\n\n    exports.arrayEach = function (array, iteratee) {\n      var index = -1,\n          length = array.length;\n\n      while (++index < length) {\n        if (iteratee(array[index], index, array) === false) {\n          break;\n        }\n      }\n\n      return array;\n    };\n\n    exports.transpose = function (matrix) {\n      if (!matrix) {\n        return error.value;\n      }\n\n      return matrix[0].map(function (col, i) {\n        return matrix.map(function (row) {\n          return row[i];\n        });\n      });\n    };\n\n    return exports;\n  }();\n\n  _jexcel.methods = {};\n\n  _jexcel.methods.datetime = function () {\n    var exports = {};\n    var d1900 = new Date(1900, 0, 1);\n    var WEEK_STARTS = [undefined, 0, 1, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, 1, 2, 3, 4, 5, 6, 0];\n    var WEEK_TYPES = [[], [1, 2, 3, 4, 5, 6, 7], [7, 1, 2, 3, 4, 5, 6], [6, 0, 1, 2, 3, 4, 5], [], [], [], [], [], [], [], [7, 1, 2, 3, 4, 5, 6], [6, 7, 1, 2, 3, 4, 5], [5, 6, 7, 1, 2, 3, 4], [4, 5, 6, 7, 1, 2, 3], [3, 4, 5, 6, 7, 1, 2], [2, 3, 4, 5, 6, 7, 1], [1, 2, 3, 4, 5, 6, 7]];\n    var WEEKEND_TYPES = [[], [6, 0], [0, 1], [1, 2], [2, 3], [3, 4], [4, 5], [5, 6], undefined, undefined, undefined, [0, 0], [1, 1], [2, 2], [3, 3], [4, 4], [5, 5], [6, 6]];\n\n    exports.DATE = function (year, month, day) {\n      year = utils.parseNumber(year);\n      month = utils.parseNumber(month);\n      day = utils.parseNumber(day);\n\n      if (utils.anyIsError(year, month, day)) {\n        return error.value;\n      }\n\n      if (year < 0 || month < 0 || day < 0) {\n        return error.num;\n      }\n\n      var date = new Date(year, month - 1, day);\n      return date;\n    };\n\n    exports.DATEVALUE = function (date_text) {\n      if (typeof date_text !== 'string') {\n        return error.value;\n      }\n\n      var date = Date.parse(date_text);\n\n      if (isNaN(date)) {\n        return error.value;\n      }\n\n      if (date <= -2203891200000) {\n        return (date - d1900) / 86400000 + 1;\n      }\n\n      return (date - d1900) / 86400000 + 2;\n    };\n\n    exports.DAY = function (serial_number) {\n      var date = utils.parseDate(serial_number);\n\n      if (date instanceof Error) {\n        return date;\n      }\n\n      return date.getDate();\n    };\n\n    exports.DAYS = function (end_date, start_date) {\n      end_date = utils.parseDate(end_date);\n      start_date = utils.parseDate(start_date);\n\n      if (end_date instanceof Error) {\n        return end_date;\n      }\n\n      if (start_date instanceof Error) {\n        return start_date;\n      }\n\n      return serial(end_date) - serial(start_date);\n    };\n\n    exports.DAYS360 = function (start_date, end_date, method) {};\n\n    exports.EDATE = function (start_date, months) {\n      start_date = utils.parseDate(start_date);\n\n      if (start_date instanceof Error) {\n        return start_date;\n      }\n\n      if (isNaN(months)) {\n        return error.value;\n      }\n\n      months = parseInt(months, 10);\n      start_date.setMonth(start_date.getMonth() + months);\n      return serial(start_date);\n    };\n\n    exports.EOMONTH = function (start_date, months) {\n      start_date = utils.parseDate(start_date);\n\n      if (start_date instanceof Error) {\n        return start_date;\n      }\n\n      if (isNaN(months)) {\n        return error.value;\n      }\n\n      months = parseInt(months, 10);\n      return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\n    };\n\n    exports.HOUR = function (serial_number) {\n      serial_number = utils.parseDate(serial_number);\n\n      if (serial_number instanceof Error) {\n        return serial_number;\n      }\n\n      return serial_number.getHours();\n    };\n\n    exports.INTERVAL = function (second) {\n      if (typeof second !== 'number' && typeof second !== 'string') {\n        return error.value;\n      } else {\n        second = parseInt(second, 10);\n      }\n\n      var year = Math.floor(second / 946080000);\n      second = second % 946080000;\n      var month = Math.floor(second / 2592000);\n      second = second % 2592000;\n      var day = Math.floor(second / 86400);\n      second = second % 86400;\n      var hour = Math.floor(second / 3600);\n      second = second % 3600;\n      var min = Math.floor(second / 60);\n      second = second % 60;\n      var sec = second;\n      year = year > 0 ? year + 'Y' : '';\n      month = month > 0 ? month + 'M' : '';\n      day = day > 0 ? day + 'D' : '';\n      hour = hour > 0 ? hour + 'H' : '';\n      min = min > 0 ? min + 'M' : '';\n      sec = sec > 0 ? sec + 'S' : '';\n      return 'P' + year + month + day + 'T' + hour + min + sec;\n    };\n\n    exports.ISOWEEKNUM = function (date) {\n      date = utils.parseDate(date);\n\n      if (date instanceof Error) {\n        return date;\n      }\n\n      date.setHours(0, 0, 0);\n      date.setDate(date.getDate() + 4 - (date.getDay() || 7));\n      var yearStart = new Date(date.getFullYear(), 0, 1);\n      return Math.ceil(((date - yearStart) / 86400000 + 1) / 7);\n    };\n\n    exports.MINUTE = function (serial_number) {\n      serial_number = utils.parseDate(serial_number);\n\n      if (serial_number instanceof Error) {\n        return serial_number;\n      }\n\n      return serial_number.getMinutes();\n    };\n\n    exports.MONTH = function (serial_number) {\n      serial_number = utils.parseDate(serial_number);\n\n      if (serial_number instanceof Error) {\n        return serial_number;\n      }\n\n      return serial_number.getMonth() + 1;\n    };\n\n    exports.NETWORKDAYS = function (start_date, end_date, holidays) {};\n\n    exports.NETWORKDAYS.INTL = function (start_date, end_date, weekend, holidays) {};\n\n    exports.NOW = function () {\n      return new Date();\n    };\n\n    exports.SECOND = function (serial_number) {\n      serial_number = utils.parseDate(serial_number);\n\n      if (serial_number instanceof Error) {\n        return serial_number;\n      }\n\n      return serial_number.getSeconds();\n    };\n\n    exports.TIME = function (hour, minute, second) {\n      hour = utils.parseNumber(hour);\n      minute = utils.parseNumber(minute);\n      second = utils.parseNumber(second);\n\n      if (utils.anyIsError(hour, minute, second)) {\n        return error.value;\n      }\n\n      if (hour < 0 || minute < 0 || second < 0) {\n        return error.num;\n      }\n\n      return (3600 * hour + 60 * minute + second) / 86400;\n    };\n\n    exports.TIMEVALUE = function (time_text) {\n      time_text = utils.parseDate(time_text);\n\n      if (time_text instanceof Error) {\n        return time_text;\n      }\n\n      return (3600 * time_text.getHours() + 60 * time_text.getMinutes() + time_text.getSeconds()) / 86400;\n    };\n\n    exports.TODAY = function () {\n      return new Date();\n    };\n\n    exports.WEEKDAY = function (serial_number, return_type) {\n      serial_number = utils.parseDate(serial_number);\n\n      if (serial_number instanceof Error) {\n        return serial_number;\n      }\n\n      if (return_type === undefined) {\n        return_type = 1;\n      }\n\n      var day = serial_number.getDay();\n      return WEEK_TYPES[return_type][day];\n    };\n\n    exports.WEEKNUM = function (serial_number, return_type) {};\n\n    exports.WORKDAY = function (start_date, days, holidays) {};\n\n    exports.WORKDAY.INTL = function (start_date, days, weekend, holidays) {};\n\n    exports.YEAR = function (serial_number) {\n      serial_number = utils.parseDate(serial_number);\n\n      if (serial_number instanceof Error) {\n        return serial_number;\n      }\n\n      return serial_number.getFullYear();\n    };\n\n    function isLeapYear(year) {\n      return new Date(year, 1, 29).getMonth() === 1;\n    }\n\n    exports.YEARFRAC = function (start_date, end_date, basis) {};\n\n    function serial(date) {\n      var addOn = date > -2203891200000 ? 2 : 1;\n      return (date - d1900) / 86400000 + addOn;\n    }\n\n    return exports;\n  }();\n\n  _jexcel.methods.database = function () {\n    var exports = {};\n\n    function compact(array) {\n      if (!array) {\n        return array;\n      }\n\n      var result = [];\n\n      for (var i = 0; i < array.length; ++i) {\n        if (!array[i]) {\n          continue;\n        }\n\n        result.push(array[i]);\n      }\n\n      return result;\n    }\n\n    exports.FINDFIELD = function (database, title) {\n      var index = null;\n\n      for (var i = 0; i < database.length; i++) {\n        if (database[i][0] === title) {\n          index = i;\n          break;\n        }\n      } // Return error if the input field title is incorrect\n\n\n      if (index == null) {\n        return error.value;\n      }\n\n      return index;\n    };\n\n    function findResultIndex(database, criterias) {\n      var matches = {};\n\n      for (var i = 1; i < database[0].length; ++i) {\n        matches[i] = true;\n      }\n\n      var maxCriteriaLength = criterias[0].length;\n\n      for (i = 1; i < criterias.length; ++i) {\n        if (criterias[i].length > maxCriteriaLength) {\n          maxCriteriaLength = criterias[i].length;\n        }\n      }\n\n      for (var k = 1; k < database.length; ++k) {\n        for (var l = 1; l < database[k].length; ++l) {\n          var currentCriteriaResult = false;\n          var hasMatchingCriteria = false;\n\n          for (var j = 0; j < criterias.length; ++j) {\n            var criteria = criterias[j];\n\n            if (criteria.length < maxCriteriaLength) {\n              continue;\n            }\n\n            var criteriaField = criteria[0];\n\n            if (database[k][0] !== criteriaField) {\n              continue;\n            }\n\n            hasMatchingCriteria = true;\n\n            for (var p = 1; p < criteria.length; ++p) {\n              currentCriteriaResult = currentCriteriaResult || eval(database[k][l] + criteria[p]); // jshint\n              // ignore:line\n            }\n          }\n\n          if (hasMatchingCriteria) {\n            matches[l] = matches[l] && currentCriteriaResult;\n          }\n        }\n      }\n\n      var result = [];\n\n      for (var n = 0; n < database[0].length; ++n) {\n        if (matches[n]) {\n          result.push(n - 1);\n        }\n      }\n\n      return result;\n    } // Database functions\n\n\n    exports.DAVERAGE = function (database, field, criteria) {\n      // Return error if field is not a number and not a string\n      if (isNaN(field) && typeof field !== \"string\") {\n        return error.value;\n      }\n\n      var resultIndexes = findResultIndex(database, criteria);\n      var targetFields = [];\n\n      if (typeof field === \"string\") {\n        var index = exports.FINDFIELD(database, field);\n        targetFields = utils.rest(database[index]);\n      } else {\n        targetFields = utils.rest(database[field]);\n      }\n\n      var sum = 0;\n\n      for (var i = 0; i < resultIndexes.length; i++) {\n        sum += targetFields[resultIndexes[i]];\n      }\n\n      return resultIndexes.length === 0 ? error.div0 : sum / resultIndexes.length;\n    };\n\n    exports.DCOUNT = function (database, field, criteria) {};\n\n    exports.DCOUNTA = function (database, field, criteria) {};\n\n    exports.DGET = function (database, field, criteria) {\n      // Return error if field is not a number and not a string\n      if (isNaN(field) && typeof field !== \"string\") {\n        return error.value;\n      }\n\n      var resultIndexes = findResultIndex(database, criteria);\n      var targetFields = [];\n\n      if (typeof field === \"string\") {\n        var index = exports.FINDFIELD(database, field);\n        targetFields = utils.rest(database[index]);\n      } else {\n        targetFields = utils.rest(database[field]);\n      } // Return error if no record meets the criteria\n\n\n      if (resultIndexes.length === 0) {\n        return error.value;\n      } // Returns the #NUM! error value because more than one record meets the\n      // criteria\n\n\n      if (resultIndexes.length > 1) {\n        return error.num;\n      }\n\n      return targetFields[resultIndexes[0]];\n    };\n\n    exports.DMAX = function (database, field, criteria) {\n      // Return error if field is not a number and not a string\n      if (isNaN(field) && typeof field !== \"string\") {\n        return error.value;\n      }\n\n      var resultIndexes = findResultIndex(database, criteria);\n      var targetFields = [];\n\n      if (typeof field === \"string\") {\n        var index = exports.FINDFIELD(database, field);\n        targetFields = utils.rest(database[index]);\n      } else {\n        targetFields = utils.rest(database[field]);\n      }\n\n      var maxValue = targetFields[resultIndexes[0]];\n\n      for (var i = 1; i < resultIndexes.length; i++) {\n        if (maxValue < targetFields[resultIndexes[i]]) {\n          maxValue = targetFields[resultIndexes[i]];\n        }\n      }\n\n      return maxValue;\n    };\n\n    exports.DMIN = function (database, field, criteria) {\n      // Return error if field is not a number and not a string\n      if (isNaN(field) && typeof field !== \"string\") {\n        return error.value;\n      }\n\n      var resultIndexes = findResultIndex(database, criteria);\n      var targetFields = [];\n\n      if (typeof field === \"string\") {\n        var index = exports.FINDFIELD(database, field);\n        targetFields = utils.rest(database[index]);\n      } else {\n        targetFields = utils.rest(database[field]);\n      }\n\n      var minValue = targetFields[resultIndexes[0]];\n\n      for (var i = 1; i < resultIndexes.length; i++) {\n        if (minValue > targetFields[resultIndexes[i]]) {\n          minValue = targetFields[resultIndexes[i]];\n        }\n      }\n\n      return minValue;\n    };\n\n    exports.DPRODUCT = function (database, field, criteria) {\n      // Return error if field is not a number and not a string\n      if (isNaN(field) && typeof field !== \"string\") {\n        return error.value;\n      }\n\n      var resultIndexes = findResultIndex(database, criteria);\n      var targetFields = [];\n\n      if (typeof field === \"string\") {\n        var index = exports.FINDFIELD(database, field);\n        targetFields = utils.rest(database[index]);\n      } else {\n        targetFields = utils.rest(database[field]);\n      }\n\n      var targetValues = [];\n\n      for (var i = 0; i < resultIndexes.length; i++) {\n        targetValues[i] = targetFields[resultIndexes[i]];\n      }\n\n      targetValues = compact(targetValues);\n      var result = 1;\n\n      for (i = 0; i < targetValues.length; i++) {\n        result *= targetValues[i];\n      }\n\n      return result;\n    };\n\n    exports.DSTDEV = function (database, field, criteria) {};\n\n    exports.DSTDEVP = function (database, field, criteria) {};\n\n    exports.DSUM = function (database, field, criteria) {};\n\n    exports.DVAR = function (database, field, criteria) {};\n\n    exports.DVARP = function (database, field, criteria) {};\n\n    exports.MATCH = function (lookupValue, lookupArray, matchType) {\n      if (!lookupValue && !lookupArray) {\n        return error.na;\n      }\n\n      if (arguments.length === 2) {\n        matchType = 1;\n      }\n\n      if (!(lookupArray instanceof Array)) {\n        return error.na;\n      }\n\n      if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\n        return error.na;\n      }\n\n      var index;\n      var indexValue;\n\n      for (var idx = 0; idx < lookupArray.length; idx++) {\n        if (matchType === 1) {\n          if (lookupArray[idx] === lookupValue) {\n            return idx + 1;\n          } else if (lookupArray[idx] < lookupValue) {\n            if (!indexValue) {\n              index = idx + 1;\n              indexValue = lookupArray[idx];\n            } else if (lookupArray[idx] > indexValue) {\n              index = idx + 1;\n              indexValue = lookupArray[idx];\n            }\n          }\n        } else if (matchType === 0) {\n          if (typeof lookupValue === 'string') {\n            lookupValue = lookupValue.replace(/\\?/g, '.');\n\n            if (lookupArray[idx].toLowerCase().match(lookupValue.toLowerCase())) {\n              return idx + 1;\n            }\n          } else {\n            if (lookupArray[idx] === lookupValue) {\n              return idx + 1;\n            }\n          }\n        } else if (matchType === -1) {\n          if (lookupArray[idx] === lookupValue) {\n            return idx + 1;\n          } else if (lookupArray[idx] > lookupValue) {\n            if (!indexValue) {\n              index = idx + 1;\n              indexValue = lookupArray[idx];\n            } else if (lookupArray[idx] < indexValue) {\n              index = idx + 1;\n              indexValue = lookupArray[idx];\n            }\n          }\n        }\n      }\n\n      return index ? index : error.na;\n    };\n\n    return exports;\n  }();\n\n  _jexcel.methods.engineering = function () {\n    var exports = {};\n\n    function isValidBinaryNumber(number) {\n      return /^[01]{1,10}$/.test(number);\n    }\n\n    exports.BESSELI = function (x, n) {};\n\n    exports.BESSELJ = function (x, n) {};\n\n    exports.BESSELK = function (x, n) {};\n\n    exports.BESSELY = function (x, n) {};\n\n    exports.BIN2DEC = function (number) {\n      // Return error if number is not binary or contains more than 10\n      // characters (10 digits)\n      if (!isValidBinaryNumber(number)) {\n        return error.num;\n      } // Convert binary number to decimal\n\n\n      var result = parseInt(number, 2); // Handle negative numbers\n\n      var stringified = number.toString();\n\n      if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n        return parseInt(stringified.substring(1), 2) - 512;\n      } else {\n        return result;\n      }\n    };\n\n    exports.BIN2HEX = function (number, places) {\n      // Return error if number is not binary or contains more than 10\n      // characters (10 digits)\n      if (!isValidBinaryNumber(number)) {\n        return error.num;\n      } // Ignore places and return a 10-character hexadecimal number if number\n      // is negative\n\n\n      var stringified = number.toString();\n\n      if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n        return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\n      } // Convert binary number to hexadecimal\n\n\n      var result = parseInt(number, 2).toString(16); // Return hexadecimal number using the minimum number of characters\n      // necessary if places is undefined\n\n      if (places === undefined) {\n        return result;\n      } else {\n        // Return error if places is nonnumeric\n        if (isNaN(places)) {\n          return error.value;\n        } // Return error if places is negative\n\n\n        if (places < 0) {\n          return error.num;\n        } // Truncate places in case it is not an integer\n\n\n        places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using\n        // Underscore.string)\n\n        return places >= result.length ? REPT('0', places - result.length) + result : error.num;\n      }\n    };\n\n    exports.BIN2OCT = function (number, places) {\n      // Return error if number is not binary or contains more than 10\n      // characters (10 digits)\n      if (!isValidBinaryNumber(number)) {\n        return error.num;\n      } // Ignore places and return a 10-character octal number if number is\n      // negative\n\n\n      var stringified = number.toString();\n\n      if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n        return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\n      } // Convert binary number to octal\n\n\n      var result = parseInt(number, 2).toString(8); // Return octal number using the minimum number of characters necessary\n      // if places is undefined\n\n      if (places === undefined) {\n        return result;\n      } else {\n        // Return error if places is nonnumeric\n        if (isNaN(places)) {\n          return error.value;\n        } // Return error if places is negative\n\n\n        if (places < 0) {\n          return error.num;\n        } // Truncate places in case it is not an integer\n\n\n        places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using\n        // Underscore.string)\n\n        return places >= result.length ? REPT('0', places - result.length) + result : error.num;\n      }\n    };\n\n    exports.BITAND = function (number1, number2) {\n      // Return error if either number is a non-numeric value\n      number1 = utils.parseNumber(number1);\n      number2 = utils.parseNumber(number2);\n\n      if (utils.anyIsError(number1, number2)) {\n        return error.value;\n      } // Return error if either number is less than 0\n\n\n      if (number1 < 0 || number2 < 0) {\n        return error.num;\n      } // Return error if either number is a non-integer\n\n\n      if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n        return error.num;\n      } // Return error if either number is greater than (2^48)-1\n\n\n      if (number1 > 281474976710655 || number2 > 281474976710655) {\n        return error.num;\n      } // Return bitwise AND of two numbers\n\n\n      return number1 & number2;\n    };\n\n    exports.BITLSHIFT = function (number, shift) {\n      number = utils.parseNumber(number);\n      shift = utils.parseNumber(shift);\n\n      if (utils.anyIsError(number, shift)) {\n        return error.value;\n      } // Return error if number is less than 0\n\n\n      if (number < 0) {\n        return error.num;\n      } // Return error if number is a non-integer\n\n\n      if (Math.floor(number) !== number) {\n        return error.num;\n      } // Return error if number is greater than (2^48)-1\n\n\n      if (number > 281474976710655) {\n        return error.num;\n      } // Return error if the absolute value of shift is greater than 53\n\n\n      if (Math.abs(shift) > 53) {\n        return error.num;\n      } // Return number shifted by shift bits to the left or to the right if\n      // shift is negative\n\n\n      return shift >= 0 ? number << shift : number >> -shift;\n    };\n\n    exports.BITOR = function (number1, number2) {\n      number1 = utils.parseNumber(number1);\n      number2 = utils.parseNumber(number2);\n\n      if (utils.anyIsError(number1, number2)) {\n        return error.value;\n      } // Return error if either number is less than 0\n\n\n      if (number1 < 0 || number2 < 0) {\n        return error.num;\n      } // Return error if either number is a non-integer\n\n\n      if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n        return error.num;\n      } // Return error if either number is greater than (2^48)-1\n\n\n      if (number1 > 281474976710655 || number2 > 281474976710655) {\n        return error.num;\n      } // Return bitwise OR of two numbers\n\n\n      return number1 | number2;\n    };\n\n    exports.BITRSHIFT = function (number, shift) {\n      number = utils.parseNumber(number);\n      shift = utils.parseNumber(shift);\n\n      if (utils.anyIsError(number, shift)) {\n        return error.value;\n      } // Return error if number is less than 0\n\n\n      if (number < 0) {\n        return error.num;\n      } // Return error if number is a non-integer\n\n\n      if (Math.floor(number) !== number) {\n        return error.num;\n      } // Return error if number is greater than (2^48)-1\n\n\n      if (number > 281474976710655) {\n        return error.num;\n      } // Return error if the absolute value of shift is greater than 53\n\n\n      if (Math.abs(shift) > 53) {\n        return error.num;\n      } // Return number shifted by shift bits to the right or to the left if\n      // shift is negative\n\n\n      return shift >= 0 ? number >> shift : number << -shift;\n    };\n\n    exports.BITXOR = function (number1, number2) {\n      number1 = utils.parseNumber(number1);\n      number2 = utils.parseNumber(number2);\n\n      if (utils.anyIsError(number1, number2)) {\n        return error.value;\n      } // Return error if either number is less than 0\n\n\n      if (number1 < 0 || number2 < 0) {\n        return error.num;\n      } // Return error if either number is a non-integer\n\n\n      if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n        return error.num;\n      } // Return error if either number is greater than (2^48)-1\n\n\n      if (number1 > 281474976710655 || number2 > 281474976710655) {\n        return error.num;\n      } // Return bitwise XOR of two numbers\n\n\n      return number1 ^ number2;\n    };\n\n    exports.COMPLEX = function (real, imaginary, suffix) {\n      real = utils.parseNumber(real);\n      imaginary = utils.parseNumber(imaginary);\n\n      if (utils.anyIsError(real, imaginary)) {\n        return real;\n      } // Set suffix\n\n\n      suffix = suffix === undefined ? 'i' : suffix; // Return error if suffix is neither \"i\" nor \"j\"\n\n      if (suffix !== 'i' && suffix !== 'j') {\n        return error.value;\n      } // Return complex number\n\n\n      if (real === 0 && imaginary === 0) {\n        return 0;\n      } else if (real === 0) {\n        return imaginary === 1 ? suffix : imaginary.toString() + suffix;\n      } else if (imaginary === 0) {\n        return real.toString();\n      } else {\n        var sign = imaginary > 0 ? '+' : '';\n        return real.toString() + sign + (imaginary === 1 ? suffix : imaginary.toString() + suffix);\n      }\n    };\n\n    exports.CONVERT = function (number, from_unit, to_unit) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      } // List of units supported by CONVERT and units defined by the\n      // International System of Units\n      // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion\n      // ratio]\n\n\n      var units = [[\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34], [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19], [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18], [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11], [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31], [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17], [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333], [\"ampere\", \"A\", null, \"electric_current\", true, false, 1], [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1], [\"ngstrm\", \"\", [\"ang\"], \"length\", false, true, 1e-10], [\"are\", \"ar\", null, \"area\", false, true, 100], [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11], [\"bar\", \"bar\", null, \"pressure\", false, false, 100000], [\"barn\", \"b\", null, \"area\", false, false, 1e-28], [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1], [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1], [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262], [\"byte\", \"byte\", null, \"information\", false, true, 8], [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1], [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1], [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1], [\"cubic ngstrm\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30], [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592], [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064], [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47], [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1], [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058], [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208], [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8], [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984], [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365], [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27], [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400], [\"degree\", \"\", null, \"angle\", false, false, 0.0174532925199433], [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556], [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001], [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141], [\"ell\", \"ell\", null, \"length\", false, true, 1.143], [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7], [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1], [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625], [\"foot\", \"ft\", null, \"length\", false, true, 0.3048], [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314], [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01], [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784], [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1], [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989], [\"gram\", \"g\", null, \"mass\", false, true, 0.001], [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1], [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592], [\"hectare\", \"ha\", null, \"area\", false, true, 10000], [\"henry\", \"H\", null, \"inductance\", true, false, 1], [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1], [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227], [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538], [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600], [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609], [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345], [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225], [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909], [\"inch\", \"in\", null, \"length\", false, true, 0.0254], [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224], [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868], [\"joule\", \"J\", null, \"energy\", true, true, 1], [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1], [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1], [\"kilogram\", \"kg\", null, \"mass\", true, true, 1], [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444], [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800], [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001], [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1], [\"lux\", \"lx\", null, \"illuminance\", true, false, 1], [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18], [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368], [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778], [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1], [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1], [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900], [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1], [\"metre\", \"m\", null, \"length\", true, true, 1], [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704], [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322], [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722], [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60], [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005], [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1], [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500], [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34], [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31], [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458], [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21], [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1852], [\"newton\", \"N\", null, \"force\", true, true, 1], [\"rsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477], [\"ohm\", \"\", null, \"electric_resistance\", true, false, 1], [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125], [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1], [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1], [\"pferdestrke\", \"PS\", null, \"power\", false, true, 735.49875], [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001], [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778], [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333], [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1], [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665], [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605], [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237], [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946], [\"radian\", \"rad\", null, \"angle\", true, false, 1], [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536], [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1], [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237], [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1], [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1], [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294], [\"square ngstrm\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20], [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304], [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516], [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31], [\"square meter\", \"m?\", null, \"area\", true, true, 1], [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336], [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904], [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111], [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736], [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344], [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1], [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001], [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001], [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318], [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868], [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892], [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1], [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184], [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474], [\"tonne\", \"t\", null, \"mass\", false, false, 1000], [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125], [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907], [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295], [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473], [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219], [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261], [\"volt\", \"V\", null, \"voltage\", true, false, 1], [\"watt\", \"W\", null, \"power\", true, true, 1], [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600], [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1], [\"yard\", \"yd\", null, \"length\", false, true, 0.9144], [\"year\", \"yr\", null, \"time\", false, true, 31557600]]; // Binary prefixes\n      // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived\n      // from]\n\n      var binary_prefixes = {\n        Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\n        Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\n        Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\n        Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\n        Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\n        Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\n        Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\n        ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\n      }; // Unit prefixes\n      // [Name, Multiplier, Abbreviation]\n\n      var unit_prefixes = {\n        Y: [\"yotta\", 1e+24, \"Y\"],\n        Z: [\"zetta\", 1e+21, \"Z\"],\n        E: [\"exa\", 1e+18, \"E\"],\n        P: [\"peta\", 1e+15, \"P\"],\n        T: [\"tera\", 1e+12, \"T\"],\n        G: [\"giga\", 1e+09, \"G\"],\n        M: [\"mega\", 1e+06, \"M\"],\n        k: [\"kilo\", 1e+03, \"k\"],\n        h: [\"hecto\", 1e+02, \"h\"],\n        e: [\"dekao\", 1e+01, \"e\"],\n        d: [\"deci\", 1e-01, \"d\"],\n        c: [\"centi\", 1e-02, \"c\"],\n        m: [\"milli\", 1e-03, \"m\"],\n        u: [\"micro\", 1e-06, \"u\"],\n        n: [\"nano\", 1e-09, \"n\"],\n        p: [\"pico\", 1e-12, \"p\"],\n        f: [\"femto\", 1e-15, \"f\"],\n        a: [\"atto\", 1e-18, \"a\"],\n        z: [\"zepto\", 1e-21, \"z\"],\n        y: [\"yocto\", 1e-24, \"y\"]\n      }; // Initialize units and multipliers\n\n      var from = null;\n      var to = null;\n      var base_from_unit = from_unit;\n      var base_to_unit = to_unit;\n      var from_multiplier = 1;\n      var to_multiplier = 1;\n      var alt; // Lookup from and to units\n\n      for (var i = 0; i < units.length; i++) {\n        alt = units[i][2] === null ? [] : units[i][2];\n\n        if (units[i][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\n          from = units[i];\n        }\n\n        if (units[i][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\n          to = units[i];\n        }\n      } // Lookup from prefix\n\n\n      if (from === null) {\n        var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\n        var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)]; // Handle dekao unit prefix (only unit prefix with two characters)\n\n        if (from_unit.substring(0, 2) === 'da') {\n          from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n        } // Handle binary prefixes first (so that 'Yi' is processed before\n        // 'Y')\n\n\n        if (from_binary_prefix) {\n          from_multiplier = from_binary_prefix[2];\n          base_from_unit = from_unit.substring(2);\n        } else if (from_unit_prefix) {\n          from_multiplier = from_unit_prefix[1];\n          base_from_unit = from_unit.substring(from_unit_prefix[2].length);\n        } // Lookup from unit\n\n\n        for (var j = 0; j < units.length; j++) {\n          alt = units[j][2] === null ? [] : units[j][2];\n\n          if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\n            from = units[j];\n          }\n        }\n      } // Lookup to prefix\n\n\n      if (to === null) {\n        var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\n        var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)]; // Handle dekao unit prefix (only unit prefix with two characters)\n\n        if (to_unit.substring(0, 2) === 'da') {\n          to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n        } // Handle binary prefixes first (so that 'Yi' is processed before\n        // 'Y')\n\n\n        if (to_binary_prefix) {\n          to_multiplier = to_binary_prefix[2];\n          base_to_unit = to_unit.substring(2);\n        } else if (to_unit_prefix) {\n          to_multiplier = to_unit_prefix[1];\n          base_to_unit = to_unit.substring(to_unit_prefix[2].length);\n        } // Lookup to unit\n\n\n        for (var k = 0; k < units.length; k++) {\n          alt = units[k][2] === null ? [] : units[k][2];\n\n          if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\n            to = units[k];\n          }\n        }\n      } // Return error if a unit does not exist\n\n\n      if (from === null || to === null) {\n        return error.na;\n      } // Return error if units represent different quantities\n\n\n      if (from[3] !== to[3]) {\n        return error.na;\n      } // Return converted number\n\n\n      return number * from[6] * from_multiplier / (to[6] * to_multiplier);\n    };\n\n    exports.DEC2BIN = function (number, places) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      } // Return error if number is not decimal, is lower than -512, or is\n      // greater than 511\n\n\n      if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\n        return error.num;\n      } // Ignore places and return a 10-character binary number if number is\n      // negative\n\n\n      if (number < 0) {\n        return '1' + REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\n      } // Convert decimal number to binary\n\n\n      var result = parseInt(number, 10).toString(2); // Return binary number using the minimum number of characters necessary\n      // if places is undefined\n\n      if (typeof places === 'undefined') {\n        return result;\n      } else {\n        // Return error if places is nonnumeric\n        if (isNaN(places)) {\n          return error.value;\n        } // Return error if places is negative\n\n\n        if (places < 0) {\n          return error.num;\n        } // Truncate places in case it is not an integer\n\n\n        places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using\n        // Underscore.string)\n\n        return places >= result.length ? REPT('0', places - result.length) + result : error.num;\n      }\n    };\n\n    exports.DEC2HEX = function (number, places) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      } // Return error if number is not decimal, is lower than -549755813888,\n      // or is greater than 549755813887\n\n\n      if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\n        return error.num;\n      } // Ignore places and return a 10-character hexadecimal number if number\n      // is negative\n\n\n      if (number < 0) {\n        return (1099511627776 + number).toString(16);\n      } // Convert decimal number to hexadecimal\n\n\n      var result = parseInt(number, 10).toString(16); // Return hexadecimal number using the minimum number of characters\n      // necessary if places is undefined\n\n      if (typeof places === 'undefined') {\n        return result;\n      } else {\n        // Return error if places is nonnumeric\n        if (isNaN(places)) {\n          return error.value;\n        } // Return error if places is negative\n\n\n        if (places < 0) {\n          return error.num;\n        } // Truncate places in case it is not an integer\n\n\n        places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using\n        // Underscore.string)\n\n        return places >= result.length ? REPT('0', places - result.length) + result : error.num;\n      }\n    };\n\n    exports.DEC2OCT = function (number, places) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      } // Return error if number is not decimal, is lower than -549755813888,\n      // or is greater than 549755813887\n\n\n      if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\n        return error.num;\n      } // Ignore places and return a 10-character octal number if number is\n      // negative\n\n\n      if (number < 0) {\n        return (1073741824 + number).toString(8);\n      } // Convert decimal number to octal\n\n\n      var result = parseInt(number, 10).toString(8); // Return octal number using the minimum number of characters necessary\n      // if places is undefined\n\n      if (typeof places === 'undefined') {\n        return result;\n      } else {\n        // Return error if places is nonnumeric\n        if (isNaN(places)) {\n          return error.value;\n        } // Return error if places is negative\n\n\n        if (places < 0) {\n          return error.num;\n        } // Truncate places in case it is not an integer\n\n\n        places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using\n        // Underscore.string)\n\n        return places >= result.length ? REPT('0', places - result.length) + result : error.num;\n      }\n    };\n\n    exports.DELTA = function (number1, number2) {\n      // Set number2 to zero if undefined\n      number2 = number2 === undefined ? 0 : number2;\n      number1 = utils.parseNumber(number1);\n      number2 = utils.parseNumber(number2);\n\n      if (utils.anyIsError(number1, number2)) {\n        return error.value;\n      } // Return delta\n\n\n      return number1 === number2 ? 1 : 0;\n    };\n\n    exports.ERF = function (lower_bound, upper_bound) {};\n\n    exports.ERF.PRECISE = function () {};\n\n    exports.ERFC = function (x) {};\n\n    exports.ERFC.PRECISE = function () {};\n\n    exports.GESTEP = function (number, step) {\n      step = step || 0;\n      number = utils.parseNumber(number);\n\n      if (utils.anyIsError(step, number)) {\n        return number;\n      } // Return delta\n\n\n      return number >= step ? 1 : 0;\n    };\n\n    exports.HEX2BIN = function (number, places) {\n      // Return error if number is not hexadecimal or contains more than ten\n      // characters (10 digits)\n      if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n        return error.num;\n      } // Check if number is negative\n\n\n      var negative = number.length === 10 && number.substring(0, 1).toLowerCase() === 'f' ? true : false; // Convert hexadecimal number to decimal\n\n      var decimal = negative ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16); // Return error if number is lower than -512 or greater than 511\n\n      if (decimal < -512 || decimal > 511) {\n        return error.num;\n      } // Ignore places and return a 10-character binary number if number is\n      // negative\n\n\n      if (negative) {\n        return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n      } // Convert decimal number to binary\n\n\n      var result = decimal.toString(2); // Return binary number using the minimum number of characters necessary\n      // if places is undefined\n\n      if (places === undefined) {\n        return result;\n      } else {\n        // Return error if places is nonnumeric\n        if (isNaN(places)) {\n          return error.value;\n        } // Return error if places is negative\n\n\n        if (places < 0) {\n          return error.num;\n        } // Truncate places in case it is not an integer\n\n\n        places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using\n        // Underscore.string)\n\n        return places >= result.length ? REPT('0', places - result.length) + result : error.num;\n      }\n    };\n\n    exports.HEX2DEC = function (number) {\n      // Return error if number is not hexadecimal or contains more than ten\n      // characters (10 digits)\n      if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n        return error.num;\n      } // Convert hexadecimal number to decimal\n\n\n      var decimal = parseInt(number, 16); // Return decimal number\n\n      return decimal >= 549755813888 ? decimal - 1099511627776 : decimal;\n    };\n\n    exports.HEX2OCT = function (number, places) {\n      // Return error if number is not hexadecimal or contains more than ten\n      // characters (10 digits)\n      if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n        return error.num;\n      } // Convert hexadecimal number to decimal\n\n\n      var decimal = parseInt(number, 16); // Return error if number is positive and greater than 0x1fffffff\n      // (536870911)\n\n      if (decimal > 536870911 && decimal < 1098974756864) {\n        return error.num;\n      } // Ignore places and return a 10-character octal number if number is\n      // negative\n\n\n      if (decimal >= 1098974756864) {\n        return (decimal - 1098437885952).toString(8);\n      } // Convert decimal number to octal\n\n\n      var result = decimal.toString(8); // Return octal number using the minimum number of characters necessary\n      // if places is undefined\n\n      if (places === undefined) {\n        return result;\n      } else {\n        // Return error if places is nonnumeric\n        if (isNaN(places)) {\n          return error.value;\n        } // Return error if places is negative\n\n\n        if (places < 0) {\n          return error.num;\n        } // Truncate places in case it is not an integer\n\n\n        places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using\n        // Underscore.string)\n\n        return places >= result.length ? REPT('0', places - result.length) + result : error.num;\n      }\n    };\n\n    exports.IMABS = function (inumber) {\n      // Lookup real and imaginary coefficients using exports.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber); // Return error if either coefficient is not a number\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Return absolute value of complex number\n\n\n      return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n    };\n\n    exports.IMAGINARY = function (inumber) {\n      if (inumber === undefined || inumber === true || inumber === false) {\n        return error.value;\n      } // Return 0 if inumber is equal to 0\n\n\n      if (inumber === 0 || inumber === '0') {\n        return 0;\n      } // Handle special cases\n\n\n      if (['i', 'j'].indexOf(inumber) >= 0) {\n        return 1;\n      } // Normalize imaginary coefficient\n\n\n      inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j'); // Lookup sign\n\n      var plus = inumber.indexOf('+');\n      var minus = inumber.indexOf('-');\n\n      if (plus === 0) {\n        plus = inumber.indexOf('+', 1);\n      }\n\n      if (minus === 0) {\n        minus = inumber.indexOf('-', 1);\n      } // Lookup imaginary unit\n\n\n      var last = inumber.substring(inumber.length - 1, inumber.length);\n      var unit = last === 'i' || last === 'j';\n\n      if (plus >= 0 || minus >= 0) {\n        // Return error if imaginary unit is neither i nor j\n        if (!unit) {\n          return error.num;\n        } // Return imaginary coefficient of complex number\n\n\n        if (plus >= 0) {\n          return isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1)) ? error.num : Number(inumber.substring(plus + 1, inumber.length - 1));\n        } else {\n          return isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1)) ? error.num : -Number(inumber.substring(minus + 1, inumber.length - 1));\n        }\n      } else {\n        if (unit) {\n          return isNaN(inumber.substring(0, inumber.length - 1)) ? error.num : inumber.substring(0, inumber.length - 1);\n        } else {\n          return isNaN(inumber) ? error.num : 0;\n        }\n      }\n    };\n\n    exports.IMARGUMENT = function (inumber) {\n      // Lookup real and imaginary coefficients using exports.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber); // Return error if either coefficient is not a number\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Return error if inumber is equal to zero\n\n\n      if (x === 0 && y === 0) {\n        return error.div0;\n      } // Return PI/2 if x is equal to zero and y is positive\n\n\n      if (x === 0 && y > 0) {\n        return Math.PI / 2;\n      } // Return -PI/2 if x is equal to zero and y is negative\n\n\n      if (x === 0 && y < 0) {\n        return -Math.PI / 2;\n      } // Return zero if x is negative and y is equal to zero\n\n\n      if (y === 0 && x > 0) {\n        return 0;\n      } // Return zero if x is negative and y is equal to zero\n\n\n      if (y === 0 && x < 0) {\n        return -Math.PI;\n      } // Return argument of complex number\n\n\n      if (x > 0) {\n        return Math.atan(y / x);\n      } else if (x < 0 && y >= 0) {\n        return Math.atan(y / x) + Math.PI;\n      } else {\n        return Math.atan(y / x) - Math.PI;\n      }\n    };\n\n    exports.IMCONJUGATE = function (inumber) {\n      // Lookup real and imaginary coefficients using exports.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Return conjugate of complex number\n\n      return y !== 0 ? exports.COMPLEX(x, -y, unit) : inumber;\n    };\n\n    exports.IMCOS = function (inumber) {\n      // Lookup real and imaginary coefficients using exports.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Return cosine of complex number\n\n      return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n    };\n\n    exports.IMCOSH = function (inumber) {\n      // Lookup real and imaginary coefficients using exports.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Return hyperbolic cosine of complex number\n\n      return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\n    };\n\n    exports.IMCOT = function (inumber) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Return cotangent of complex number\n\n\n      return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\n    };\n\n    exports.IMDIV = function (inumber1, inumber2) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var a = exports.IMREAL(inumber1);\n      var b = exports.IMAGINARY(inumber1);\n      var c = exports.IMREAL(inumber2);\n      var d = exports.IMAGINARY(inumber2);\n\n      if (utils.anyIsError(a, b, c, d)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit1 = inumber1.substring(inumber1.length - 1);\n      var unit2 = inumber2.substring(inumber2.length - 1);\n      var unit = 'i';\n\n      if (unit1 === 'j') {\n        unit = 'j';\n      } else if (unit2 === 'j') {\n        unit = 'j';\n      } // Return error if inumber2 is null\n\n\n      if (c === 0 && d === 0) {\n        return error.num;\n      } // Return exponential of complex number\n\n\n      var den = c * c + d * d;\n      return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\n    };\n\n    exports.IMEXP = function (inumber) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Return exponential of complex number\n\n      var e = Math.exp(x);\n      return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\n    };\n\n    exports.IMLN = function (inumber) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Return exponential of complex number\n\n      return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\n    };\n\n    exports.IMLOG10 = function (inumber) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Return exponential of complex number\n\n      return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\n    };\n\n    exports.IMLOG2 = function (inumber) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Return exponential of complex number\n\n      return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\n    };\n\n    exports.IMPOWER = function (inumber, number) {\n      number = utils.parseNumber(number);\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(number, x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Calculate power of modulus\n\n      var p = Math.pow(exports.IMABS(inumber), number); // Calculate argument\n\n      var t = exports.IMARGUMENT(inumber); // Return exponential of complex number\n\n      return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\n    };\n\n    exports.IMPRODUCT = function () {\n      // Initialize result\n      var result = arguments[0]; // Loop on all numbers\n\n      for (var i = 1; i < arguments.length; i++) {\n        // Lookup coefficients of two complex numbers\n        var a = exports.IMREAL(result);\n        var b = exports.IMAGINARY(result);\n        var c = exports.IMREAL(arguments[i]);\n        var d = exports.IMAGINARY(arguments[i]);\n\n        if (utils.anyIsError(a, b, c, d)) {\n          return error.value;\n        } // Complute product of two complex numbers\n\n\n        result = exports.COMPLEX(a * c - b * d, a * d + b * c);\n      } // Return product of complex numbers\n\n\n      return result;\n    };\n\n    exports.IMREAL = function (inumber) {\n      if (inumber === undefined || inumber === true || inumber === false) {\n        return error.value;\n      } // Return 0 if inumber is equal to 0\n\n\n      if (inumber === 0 || inumber === '0') {\n        return 0;\n      } // Handle special cases\n\n\n      if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\n        return 0;\n      } // Lookup sign\n\n\n      var plus = inumber.indexOf('+');\n      var minus = inumber.indexOf('-');\n\n      if (plus === 0) {\n        plus = inumber.indexOf('+', 1);\n      }\n\n      if (minus === 0) {\n        minus = inumber.indexOf('-', 1);\n      } // Lookup imaginary unit\n\n\n      var last = inumber.substring(inumber.length - 1, inumber.length);\n      var unit = last === 'i' || last === 'j';\n\n      if (plus >= 0 || minus >= 0) {\n        // Return error if imaginary unit is neither i nor j\n        if (!unit) {\n          return error.num;\n        } // Return real coefficient of complex number\n\n\n        if (plus >= 0) {\n          return isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1)) ? error.num : Number(inumber.substring(0, plus));\n        } else {\n          return isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1)) ? error.num : Number(inumber.substring(0, minus));\n        }\n      } else {\n        if (unit) {\n          return isNaN(inumber.substring(0, inumber.length - 1)) ? error.num : 0;\n        } else {\n          return isNaN(inumber) ? error.num : inumber;\n        }\n      }\n    };\n\n    exports.IMSEC = function (inumber) {\n      // Return error if inumber is a logical value\n      if (inumber === true || inumber === false) {\n        return error.value;\n      } // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n\n\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Return secant of complex number\n\n\n      return exports.IMDIV('1', exports.IMCOS(inumber));\n    };\n\n    exports.IMSECH = function (inumber) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Return hyperbolic secant of complex number\n\n\n      return exports.IMDIV('1', exports.IMCOSH(inumber));\n    };\n\n    exports.IMSIN = function (inumber) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Return sine of complex number\n\n      return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n    };\n\n    exports.IMSINH = function (inumber) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Return hyperbolic sine of complex number\n\n      return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\n    };\n\n    exports.IMSQRT = function (inumber) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit = inumber.substring(inumber.length - 1);\n      unit = unit === 'i' || unit === 'j' ? unit : 'i'; // Calculate power of modulus\n\n      var s = Math.sqrt(exports.IMABS(inumber)); // Calculate argument\n\n      var t = exports.IMARGUMENT(inumber); // Return exponential of complex number\n\n      return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\n    };\n\n    exports.IMCSC = function (inumber) {\n      // Return error if inumber is a logical value\n      if (inumber === true || inumber === false) {\n        return error.value;\n      } // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n\n\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber); // Return error if either coefficient is not a number\n\n      if (utils.anyIsError(x, y)) {\n        return error.num;\n      } // Return cosecant of complex number\n\n\n      return exports.IMDIV('1', exports.IMSIN(inumber));\n    };\n\n    exports.IMCSCH = function (inumber) {\n      // Return error if inumber is a logical value\n      if (inumber === true || inumber === false) {\n        return error.value;\n      } // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n\n\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber); // Return error if either coefficient is not a number\n\n      if (utils.anyIsError(x, y)) {\n        return error.num;\n      } // Return hyperbolic cosecant of complex number\n\n\n      return exports.IMDIV('1', exports.IMSINH(inumber));\n    };\n\n    exports.IMSUB = function (inumber1, inumber2) {\n      // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n      var a = this.IMREAL(inumber1);\n      var b = this.IMAGINARY(inumber1);\n      var c = this.IMREAL(inumber2);\n      var d = this.IMAGINARY(inumber2);\n\n      if (utils.anyIsError(a, b, c, d)) {\n        return error.value;\n      } // Lookup imaginary unit\n\n\n      var unit1 = inumber1.substring(inumber1.length - 1);\n      var unit2 = inumber2.substring(inumber2.length - 1);\n      var unit = 'i';\n\n      if (unit1 === 'j') {\n        unit = 'j';\n      } else if (unit2 === 'j') {\n        unit = 'j';\n      } // Return _ of two complex numbers\n\n\n      return this.COMPLEX(a - c, b - d, unit);\n    };\n\n    exports.IMSUM = function () {\n      var args = utils.flatten(arguments); // Initialize result\n\n      var result = args[0]; // Loop on all numbers\n\n      for (var i = 1; i < args.length; i++) {\n        // Lookup coefficients of two complex numbers\n        var a = this.IMREAL(result);\n        var b = this.IMAGINARY(result);\n        var c = this.IMREAL(args[i]);\n        var d = this.IMAGINARY(args[i]);\n\n        if (utils.anyIsError(a, b, c, d)) {\n          return error.value;\n        } // Complute product of two complex numbers\n\n\n        result = this.COMPLEX(a + c, b + d);\n      } // Return sum of complex numbers\n\n\n      return result;\n    };\n\n    exports.IMTAN = function (inumber) {\n      // Return error if inumber is a logical value\n      if (inumber === true || inumber === false) {\n        return error.value;\n      } // Lookup real and imaginary coefficients using Formula.js\n      // [http://formulajs.org]\n\n\n      var x = exports.IMREAL(inumber);\n      var y = exports.IMAGINARY(inumber);\n\n      if (utils.anyIsError(x, y)) {\n        return error.value;\n      } // Return tangent of complex number\n\n\n      return this.IMDIV(this.IMSIN(inumber), this.IMCOS(inumber));\n    };\n\n    exports.OCT2BIN = function (number, places) {\n      // Return error if number is not hexadecimal or contains more than ten\n      // characters (10 digits)\n      if (!/^[0-7]{1,10}$/.test(number)) {\n        return error.num;\n      } // Check if number is negative\n\n\n      var negative = number.length === 10 && number.substring(0, 1) === '7' ? true : false; // Convert octal number to decimal\n\n      var decimal = negative ? parseInt(number, 8) - 1073741824 : parseInt(number, 8); // Return error if number is lower than -512 or greater than 511\n\n      if (decimal < -512 || decimal > 511) {\n        return error.num;\n      } // Ignore places and return a 10-character binary number if number is\n      // negative\n\n\n      if (negative) {\n        return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n      } // Convert decimal number to binary\n\n\n      var result = decimal.toString(2); // Return binary number using the minimum number of characters necessary\n      // if places is undefined\n\n      if (typeof places === 'undefined') {\n        return result;\n      } else {\n        // Return error if places is nonnumeric\n        if (isNaN(places)) {\n          return error.value;\n        } // Return error if places is negative\n\n\n        if (places < 0) {\n          return error.num;\n        } // Truncate places in case it is not an integer\n\n\n        places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using\n        // Underscore.string)\n\n        return places >= result.length ? REPT('0', places - result.length) + result : error.num;\n      }\n    };\n\n    exports.OCT2DEC = function (number) {\n      // Return error if number is not octal or contains more than ten\n      // characters (10 digits)\n      if (!/^[0-7]{1,10}$/.test(number)) {\n        return error.num;\n      } // Convert octal number to decimal\n\n\n      var decimal = parseInt(number, 8); // Return decimal number\n\n      return decimal >= 536870912 ? decimal - 1073741824 : decimal;\n    };\n\n    exports.OCT2HEX = function (number, places) {\n      // Return error if number is not octal or contains more than ten\n      // characters (10 digits)\n      if (!/^[0-7]{1,10}$/.test(number)) {\n        return error.num;\n      } // Convert octal number to decimal\n\n\n      var decimal = parseInt(number, 8); // Ignore places and return a 10-character octal number if number is\n      // negative\n\n      if (decimal >= 536870912) {\n        return 'ff' + (decimal + 3221225472).toString(16);\n      } // Convert decimal number to hexadecimal\n\n\n      var result = decimal.toString(16); // Return hexadecimal number using the minimum number of characters\n      // necessary if places is undefined\n\n      if (places === undefined) {\n        return result;\n      } else {\n        // Return error if places is nonnumeric\n        if (isNaN(places)) {\n          return error.value;\n        } // Return error if places is negative\n\n\n        if (places < 0) {\n          return error.num;\n        } // Truncate places in case it is not an integer\n\n\n        places = Math.floor(places); // Pad return value with leading 0s (zeros) if necessary (using\n        // Underscore.string)\n\n        return places >= result.length ? REPT('0', places - result.length) + result : error.num;\n      }\n    };\n\n    return exports;\n  }();\n\n  _jexcel.methods.financial = function () {\n    var exports = {};\n\n    function validDate(d) {\n      return d && d.getTime && !isNaN(d.getTime());\n    }\n\n    function ensureDate(d) {\n      return d instanceof Date ? d : new Date(d);\n    }\n\n    exports.ACCRINT = function (issue, first, settlement, rate, par, frequency, basis) {\n      // Return error if either date is invalid\n      issue = ensureDate(issue);\n      first = ensureDate(first);\n      settlement = ensureDate(settlement);\n\n      if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\n        return '#VALUE!';\n      } // Return error if either rate or par are lower than or equal to zero\n\n\n      if (rate <= 0 || par <= 0) {\n        return '#NUM!';\n      } // Return error if frequency is neither 1, 2, or 4\n\n\n      if ([1, 2, 4].indexOf(frequency) === -1) {\n        return '#NUM!';\n      } // Return error if basis is neither 0, 1, 2, 3, or 4\n\n\n      if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\n        return '#NUM!';\n      } // Return error if settlement is before or equal to issue\n\n\n      if (settlement <= issue) {\n        return '#NUM!';\n      } // Set default values\n\n\n      par = par || 0;\n      basis = basis || 0; // Compute accrued interest\n\n      return par * rate * YEARFRAC(issue, settlement, basis);\n    };\n\n    exports.ACCRINTM = null;\n    exports.AMORDEGRC = null;\n    exports.AMORLINC = null;\n    exports.COUPDAYBS = null;\n    exports.COUPDAYS = null;\n    exports.COUPDAYSNC = null;\n    exports.COUPNCD = null;\n    exports.COUPNUM = null;\n    exports.COUPPCD = null;\n\n    exports.CUMIPMT = function (rate, periods, value, start, end, type) {\n      // Credits: algorithm inspired by Apache OpenOffice\n      // Credits: Hannes Stiebitzhofer for the translations of function and\n      // variable names\n      // Requires exports.FV() and exports.PMT() from exports.js\n      // [http://stoic.com/exports/]\n      rate = utils.parseNumber(rate);\n      periods = utils.parseNumber(periods);\n      value = utils.parseNumber(value);\n\n      if (utils.anyIsError(rate, periods, value)) {\n        return error.value;\n      } // Return error if either rate, periods, or value are lower than or\n      // equal to zero\n\n\n      if (rate <= 0 || periods <= 0 || value <= 0) {\n        return error.num;\n      } // Return error if start < 1, end < 1, or start > end\n\n\n      if (start < 1 || end < 1 || start > end) {\n        return error.num;\n      } // Return error if type is neither 0 nor 1\n\n\n      if (type !== 0 && type !== 1) {\n        return error.num;\n      } // Compute cumulative interest\n\n\n      var payment = exports.PMT(rate, periods, value, 0, type);\n      var interest = 0;\n\n      if (start === 1) {\n        if (type === 0) {\n          interest = -value;\n          start++;\n        }\n      }\n\n      for (var i = start; i <= end; i++) {\n        if (type === 1) {\n          interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\n        } else {\n          interest += exports.FV(rate, i - 1, payment, value, 0);\n        }\n      }\n\n      interest *= rate; // Return cumulative interest\n\n      return interest;\n    };\n\n    exports.CUMPRINC = function (rate, periods, value, start, end, type) {\n      // Credits: algorithm inspired by Apache OpenOffice\n      // Credits: Hannes Stiebitzhofer for the translations of function and\n      // variable names\n      rate = utils.parseNumber(rate);\n      periods = utils.parseNumber(periods);\n      value = utils.parseNumber(value);\n\n      if (utils.anyIsError(rate, periods, value)) {\n        return error.value;\n      } // Return error if either rate, periods, or value are lower than or\n      // equal to zero\n\n\n      if (rate <= 0 || periods <= 0 || value <= 0) {\n        return error.num;\n      } // Return error if start < 1, end < 1, or start > end\n\n\n      if (start < 1 || end < 1 || start > end) {\n        return error.num;\n      } // Return error if type is neither 0 nor 1\n\n\n      if (type !== 0 && type !== 1) {\n        return error.num;\n      } // Compute cumulative principal\n\n\n      var payment = exports.PMT(rate, periods, value, 0, type);\n      var principal = 0;\n\n      if (start === 1) {\n        if (type === 0) {\n          principal = payment + value * rate;\n        } else {\n          principal = payment;\n        }\n\n        start++;\n      }\n\n      for (var i = start; i <= end; i++) {\n        if (type > 0) {\n          principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\n        } else {\n          principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\n        }\n      } // Return cumulative principal\n\n\n      return principal;\n    };\n\n    exports.DB = function (cost, salvage, life, period, month) {\n      // Initialize month\n      month = month === undefined ? 12 : month;\n      cost = utils.parseNumber(cost);\n      salvage = utils.parseNumber(salvage);\n      life = utils.parseNumber(life);\n      period = utils.parseNumber(period);\n      month = utils.parseNumber(month);\n\n      if (utils.anyIsError(cost, salvage, life, period, month)) {\n        return error.value;\n      } // Return error if any of the parameters is negative\n\n\n      if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\n        return error.num;\n      } // Return error if month is not an integer between 1 and 12\n\n\n      if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\n        return error.num;\n      } // Return error if period is greater than life\n\n\n      if (period > life) {\n        return error.num;\n      } // Return 0 (zero) if salvage is greater than or equal to cost\n\n\n      if (salvage >= cost) {\n        return 0;\n      } // Rate is rounded to three decimals places\n\n\n      var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3); // Compute initial depreciation\n\n      var initial = cost * rate * month / 12; // Compute total depreciation\n\n      var total = initial;\n      var current = 0;\n      var ceiling = period === life ? life - 1 : period;\n\n      for (var i = 2; i <= ceiling; i++) {\n        current = (cost - total) * rate;\n        total += current;\n      } // Depreciation for the first and last periods are special cases\n\n\n      if (period === 1) {\n        // First period\n        return initial;\n      } else if (period === life) {\n        // Last period\n        return (cost - total) * rate;\n      } else {\n        return current;\n      }\n    };\n\n    exports.DDB = function (cost, salvage, life, period, factor) {\n      // Initialize factor\n      factor = factor === undefined ? 2 : factor;\n      cost = utils.parseNumber(cost);\n      salvage = utils.parseNumber(salvage);\n      life = utils.parseNumber(life);\n      period = utils.parseNumber(period);\n      factor = utils.parseNumber(factor);\n\n      if (utils.anyIsError(cost, salvage, life, period, factor)) {\n        return error.value;\n      } // Return error if any of the parameters is negative or if factor is\n      // null\n\n\n      if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\n        return error.num;\n      } // Return error if period is greater than life\n\n\n      if (period > life) {\n        return error.num;\n      } // Return 0 (zero) if salvage is greater than or equal to cost\n\n\n      if (salvage >= cost) {\n        return 0;\n      } // Compute depreciation\n\n\n      var total = 0;\n      var current = 0;\n\n      for (var i = 1; i <= period; i++) {\n        current = Math.min((cost - total) * (factor / life), cost - salvage - total);\n        total += current;\n      } // Return depreciation\n\n\n      return current;\n    };\n\n    exports.DISC = null;\n\n    exports.DOLLARDE = function (dollar, fraction) {\n      // Credits: algorithm inspired by Apache OpenOffice\n      dollar = utils.parseNumber(dollar);\n      fraction = utils.parseNumber(fraction);\n\n      if (utils.anyIsError(dollar, fraction)) {\n        return error.value;\n      } // Return error if fraction is negative\n\n\n      if (fraction < 0) {\n        return error.num;\n      } // Return error if fraction is greater than or equal to 0 and less than\n      // 1\n\n\n      if (fraction >= 0 && fraction < 1) {\n        return error.div0;\n      } // Truncate fraction if it is not an integer\n\n\n      fraction = parseInt(fraction, 10); // Compute integer part\n\n      var result = parseInt(dollar, 10); // Add decimal part\n\n      result += dollar % 1 * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction; // Round result\n\n      var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\n      result = Math.round(result * power) / power; // Return converted dollar price\n\n      return result;\n    };\n\n    exports.DOLLARFR = function (dollar, fraction) {\n      // Credits: algorithm inspired by Apache OpenOffice\n      dollar = utils.parseNumber(dollar);\n      fraction = utils.parseNumber(fraction);\n\n      if (utils.anyIsError(dollar, fraction)) {\n        return error.value;\n      } // Return error if fraction is negative\n\n\n      if (fraction < 0) {\n        return error.num;\n      } // Return error if fraction is greater than or equal to 0 and less than\n      // 1\n\n\n      if (fraction >= 0 && fraction < 1) {\n        return error.div0;\n      } // Truncate fraction if it is not an integer\n\n\n      fraction = parseInt(fraction, 10); // Compute integer part\n\n      var result = parseInt(dollar, 10); // Add decimal part\n\n      result += dollar % 1 * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction; // Return converted dollar price\n\n      return result;\n    };\n\n    exports.DURATION = null;\n\n    exports.EFFECT = function (rate, periods) {\n      rate = utils.parseNumber(rate);\n      periods = utils.parseNumber(periods);\n\n      if (utils.anyIsError(rate, periods)) {\n        return error.value;\n      } // Return error if rate <=0 or periods < 1\n\n\n      if (rate <= 0 || periods < 1) {\n        return error.num;\n      } // Truncate periods if it is not an integer\n\n\n      periods = parseInt(periods, 10); // Return effective annual interest rate\n\n      return Math.pow(1 + rate / periods, periods) - 1;\n    };\n\n    exports.FV = function (rate, periods, payment, value, type) {\n      // Credits: algorithm inspired by Apache OpenOffice\n      value = value || 0;\n      type = type || 0;\n      rate = utils.parseNumber(rate);\n      periods = utils.parseNumber(periods);\n      payment = utils.parseNumber(payment);\n      value = utils.parseNumber(value);\n      type = utils.parseNumber(type);\n\n      if (utils.anyIsError(rate, periods, payment, value, type)) {\n        return error.value;\n      } // Return future value\n\n\n      var result;\n\n      if (rate === 0) {\n        result = value + payment * periods;\n      } else {\n        var term = Math.pow(1 + rate, periods);\n\n        if (type === 1) {\n          result = value * term + payment * (1 + rate) * (term - 1) / rate;\n        } else {\n          result = value * term + payment * (term - 1) / rate;\n        }\n      }\n\n      return -result;\n    };\n\n    exports.FVSCHEDULE = function (principal, schedule) {\n      principal = utils.parseNumber(principal);\n      schedule = utils.parseNumberArray(utils.flatten(schedule));\n\n      if (utils.anyIsError(principal, schedule)) {\n        return error.value;\n      }\n\n      var n = schedule.length;\n      var future = principal; // Apply all interests in schedule\n\n      for (var i = 0; i < n; i++) {\n        // Apply scheduled interest\n        future *= 1 + schedule[i];\n      } // Return future value\n\n\n      return future;\n    };\n\n    exports.INTRATE = null;\n\n    exports.IPMT = function (rate, period, periods, present, future, type) {\n      // Credits: algorithm inspired by Apache OpenOffice\n      future = future || 0;\n      type = type || 0;\n      rate = utils.parseNumber(rate);\n      period = utils.parseNumber(period);\n      periods = utils.parseNumber(periods);\n      present = utils.parseNumber(present);\n      future = utils.parseNumber(future);\n      type = utils.parseNumber(type);\n\n      if (utils.anyIsError(rate, period, periods, present, future, type)) {\n        return error.value;\n      } // Compute payment\n\n\n      var payment = exports.PMT(rate, periods, present, future, type); // Compute interest\n\n      var interest;\n\n      if (period === 1) {\n        if (type === 1) {\n          interest = 0;\n        } else {\n          interest = -present;\n        }\n      } else {\n        if (type === 1) {\n          interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\n        } else {\n          interest = exports.FV(rate, period - 1, payment, present, 0);\n        }\n      } // Return interest\n\n\n      return interest * rate;\n    };\n\n    exports.IRR = function (values, guess) {\n      // Credits: algorithm inspired by Apache OpenOffice\n      guess = guess || 0;\n      values = utils.parseNumberArray(utils.flatten(values));\n      guess = utils.parseNumber(guess);\n\n      if (utils.anyIsError(values, guess)) {\n        return error.value;\n      } // Calculates the resulting amount\n\n\n      var irrResult = function irrResult(values, dates, rate) {\n        var r = rate + 1;\n        var result = values[0];\n\n        for (var i = 1; i < values.length; i++) {\n          result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\n        }\n\n        return result;\n      }; // Calculates the first derivation\n\n\n      var irrResultDeriv = function irrResultDeriv(values, dates, rate) {\n        var r = rate + 1;\n        var result = 0;\n\n        for (var i = 1; i < values.length; i++) {\n          var frac = (dates[i] - dates[0]) / 365;\n          result -= frac * values[i] / Math.pow(r, frac + 1);\n        }\n\n        return result;\n      }; // Initialize dates and check that values contains at least one positive\n      // value and one negative value\n\n\n      var dates = [];\n      var positive = false;\n      var negative = false;\n\n      for (var i = 0; i < values.length; i++) {\n        dates[i] = i === 0 ? 0 : dates[i - 1] + 365;\n\n        if (values[i] > 0) {\n          positive = true;\n        }\n\n        if (values[i] < 0) {\n          negative = true;\n        }\n      } // Return error if values does not contain at least one positive value\n      // and one negative value\n\n\n      if (!positive || !negative) {\n        return error.num;\n      } // Initialize guess and resultRate\n\n\n      guess = guess === undefined ? 0.1 : guess;\n      var resultRate = guess; // Set maximum epsilon for end of iteration\n\n      var epsMax = 1e-10; // Implement Newton's method\n\n      var newRate, epsRate, resultValue;\n      var contLoop = true;\n\n      do {\n        resultValue = irrResult(values, dates, resultRate);\n        newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n        epsRate = Math.abs(newRate - resultRate);\n        resultRate = newRate;\n        contLoop = epsRate > epsMax && Math.abs(resultValue) > epsMax;\n      } while (contLoop); // Return internal rate of return\n\n\n      return resultRate;\n    };\n\n    exports.ISPMT = function (rate, period, periods, value) {\n      rate = utils.parseNumber(rate);\n      period = utils.parseNumber(period);\n      periods = utils.parseNumber(periods);\n      value = utils.parseNumber(value);\n\n      if (utils.anyIsError(rate, period, periods, value)) {\n        return error.value;\n      } // Return interest\n\n\n      return value * rate * (period / periods - 1);\n    };\n\n    exports.MDURATION = null;\n\n    exports.MIRR = function (values, finance_rate, reinvest_rate) {\n      values = utils.parseNumberArray(utils.flatten(values));\n      finance_rate = utils.parseNumber(finance_rate);\n      reinvest_rate = utils.parseNumber(reinvest_rate);\n\n      if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\n        return error.value;\n      } // Initialize number of values\n\n\n      var n = values.length; // Lookup payments (negative values) and incomes (positive values)\n\n      var payments = [];\n      var incomes = [];\n\n      for (var i = 0; i < n; i++) {\n        if (values[i] < 0) {\n          payments.push(values[i]);\n        } else {\n          incomes.push(values[i]);\n        }\n      } // Return modified internal rate of return\n\n\n      var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\n      var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\n      return Math.pow(num / den, 1 / (n - 1)) - 1;\n    };\n\n    exports.NOMINAL = function (rate, periods) {\n      rate = utils.parseNumber(rate);\n      periods = utils.parseNumber(periods);\n\n      if (utils.anyIsError(rate, periods)) {\n        return error.value;\n      } // Return error if rate <=0 or periods < 1\n\n\n      if (rate <= 0 || periods < 1) {\n        return error.num;\n      } // Truncate periods if it is not an integer\n\n\n      periods = parseInt(periods, 10); // Return nominal annual interest rate\n\n      return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\n    };\n\n    exports.NPER = function (rate, payment, present, future, type) {\n      type = type === undefined ? 0 : type;\n      future = future === undefined ? 0 : future;\n      rate = utils.parseNumber(rate);\n      payment = utils.parseNumber(payment);\n      present = utils.parseNumber(present);\n      future = utils.parseNumber(future);\n      type = utils.parseNumber(type);\n\n      if (utils.anyIsError(rate, payment, present, future, type)) {\n        return error.value;\n      } // Return number of periods\n\n\n      var num = payment * (1 + rate * type) - future * rate;\n      var den = present * rate + payment * (1 + rate * type);\n      return Math.log(num / den) / Math.log(1 + rate);\n    };\n\n    exports.NPV = function () {\n      var args = utils.parseNumberArray(utils.flatten(arguments));\n\n      if (args instanceof Error) {\n        return args;\n      } // Lookup rate\n\n\n      var rate = args[0]; // Initialize net present value\n\n      var value = 0; // Loop on all values\n\n      for (var j = 1; j < args.length; j++) {\n        value += args[j] / Math.pow(1 + rate, j);\n      } // Return net present value\n\n\n      return value;\n    };\n\n    exports.ODDFPRICE = null;\n    exports.ODDFYIELD = null;\n    exports.ODDLPRICE = null;\n    exports.ODDLYIELD = null;\n\n    exports.PDURATION = function (rate, present, future) {\n      rate = utils.parseNumber(rate);\n      present = utils.parseNumber(present);\n      future = utils.parseNumber(future);\n\n      if (utils.anyIsError(rate, present, future)) {\n        return error.value;\n      } // Return error if rate <=0\n\n\n      if (rate <= 0) {\n        return error.num;\n      } // Return number of periods\n\n\n      return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\n    };\n\n    exports.PMT = function (rate, periods, present, future, type) {\n      // Credits: algorithm inspired by Apache OpenOffice\n      future = future || 0;\n      type = type || 0;\n      rate = utils.parseNumber(rate);\n      periods = utils.parseNumber(periods);\n      present = utils.parseNumber(present);\n      future = utils.parseNumber(future);\n      type = utils.parseNumber(type);\n\n      if (utils.anyIsError(rate, periods, present, future, type)) {\n        return error.value;\n      } // Return payment\n\n\n      var result;\n\n      if (rate === 0) {\n        result = (present + future) / periods;\n      } else {\n        var term = Math.pow(1 + rate, periods);\n\n        if (type === 1) {\n          result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\n        } else {\n          result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\n        }\n      }\n\n      return -result;\n    };\n\n    exports.PPMT = function (rate, period, periods, present, future, type) {\n      future = future || 0;\n      type = type || 0;\n      rate = utils.parseNumber(rate);\n      periods = utils.parseNumber(periods);\n      present = utils.parseNumber(present);\n      future = utils.parseNumber(future);\n      type = utils.parseNumber(type);\n\n      if (utils.anyIsError(rate, periods, present, future, type)) {\n        return error.value;\n      }\n\n      return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\n    };\n\n    exports.PRICE = null;\n    exports.PRICEDISC = null;\n    exports.PRICEMAT = null;\n\n    exports.PV = function (rate, periods, payment, future, type) {\n      future = future || 0;\n      type = type || 0;\n      rate = utils.parseNumber(rate);\n      periods = utils.parseNumber(periods);\n      payment = utils.parseNumber(payment);\n      future = utils.parseNumber(future);\n      type = utils.parseNumber(type);\n\n      if (utils.anyIsError(rate, periods, payment, future, type)) {\n        return error.value;\n      } // Return present value\n\n\n      if (rate === 0) {\n        return -payment * periods - future;\n      } else {\n        return ((1 - Math.pow(1 + rate, periods)) / rate * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\n      }\n    };\n\n    exports.RATE = function (periods, payment, present, future, type, guess) {\n      // Credits: rabugento\n      guess = guess === undefined ? 0.01 : guess;\n      future = future === undefined ? 0 : future;\n      type = type === undefined ? 0 : type;\n      periods = utils.parseNumber(periods);\n      payment = utils.parseNumber(payment);\n      present = utils.parseNumber(present);\n      future = utils.parseNumber(future);\n      type = utils.parseNumber(type);\n      guess = utils.parseNumber(guess);\n\n      if (utils.anyIsError(periods, payment, present, future, type, guess)) {\n        return error.value;\n      } // Set maximum epsilon for end of iteration\n\n\n      var epsMax = 1e-6; // Set maximum number of iterations\n\n      var iterMax = 100;\n      var iter = 0;\n      var close = false;\n      var rate = guess;\n\n      while (iter < iterMax && !close) {\n        var t1 = Math.pow(rate + 1, periods);\n        var t2 = Math.pow(rate + 1, periods - 1);\n        var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\n        var f2 = periods * t2 * present - payment * (t1 - 1) * (rate * type + 1) / Math.pow(rate, 2);\n        var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\n        var newRate = rate - f1 / (f2 + f3);\n        if (Math.abs(newRate - rate) < epsMax) close = true;\n        iter++;\n        rate = newRate;\n      }\n\n      if (!close) return Number.NaN + rate;\n      return rate;\n    }; // TODO\n\n\n    exports.RECEIVED = null;\n\n    exports.RRI = function (periods, present, future) {\n      periods = utils.parseNumber(periods);\n      present = utils.parseNumber(present);\n      future = utils.parseNumber(future);\n\n      if (utils.anyIsError(periods, present, future)) {\n        return error.value;\n      } // Return error if periods or present is equal to 0 (zero)\n\n\n      if (periods === 0 || present === 0) {\n        return error.num;\n      } // Return equivalent interest rate\n\n\n      return Math.pow(future / present, 1 / periods) - 1;\n    };\n\n    exports.SLN = function (cost, salvage, life) {\n      cost = utils.parseNumber(cost);\n      salvage = utils.parseNumber(salvage);\n      life = utils.parseNumber(life);\n\n      if (utils.anyIsError(cost, salvage, life)) {\n        return error.value;\n      } // Return error if life equal to 0 (zero)\n\n\n      if (life === 0) {\n        return error.num;\n      } // Return straight-line depreciation\n\n\n      return (cost - salvage) / life;\n    };\n\n    exports.SYD = function (cost, salvage, life, period) {\n      // Return error if any of the parameters is not a number\n      cost = utils.parseNumber(cost);\n      salvage = utils.parseNumber(salvage);\n      life = utils.parseNumber(life);\n      period = utils.parseNumber(period);\n\n      if (utils.anyIsError(cost, salvage, life, period)) {\n        return error.value;\n      } // Return error if life equal to 0 (zero)\n\n\n      if (life === 0) {\n        return error.num;\n      } // Return error if period is lower than 1 or greater than life\n\n\n      if (period < 1 || period > life) {\n        return error.num;\n      } // Truncate period if it is not an integer\n\n\n      period = parseInt(period, 10); // Return straight-line depreciation\n\n      return (cost - salvage) * (life - period + 1) * 2 / (life * (life + 1));\n    };\n\n    exports.TBILLEQ = function (settlement, maturity, discount) {\n      settlement = utils.parseDate(settlement);\n      maturity = utils.parseDate(maturity);\n      discount = utils.parseNumber(discount);\n\n      if (utils.anyIsError(settlement, maturity, discount)) {\n        return error.value;\n      } // Return error if discount is lower than or equal to zero\n\n\n      if (discount <= 0) {\n        return error.num;\n      } // Return error if settlement is greater than maturity\n\n\n      if (settlement > maturity) {\n        return error.num;\n      } // Return error if maturity is more than one year after settlement\n\n\n      if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n        return error.num;\n      } // Return bond-equivalent yield\n\n\n      return 365 * discount / (360 - discount * DAYS360(settlement, maturity, false));\n    };\n\n    exports.TBILLPRICE = function (settlement, maturity, discount) {\n      settlement = utils.parseDate(settlement);\n      maturity = utils.parseDate(maturity);\n      discount = utils.parseNumber(discount);\n\n      if (utils.anyIsError(settlement, maturity, discount)) {\n        return error.value;\n      } // Return error if discount is lower than or equal to zero\n\n\n      if (discount <= 0) {\n        return error.num;\n      } // Return error if settlement is greater than maturity\n\n\n      if (settlement > maturity) {\n        return error.num;\n      } // Return error if maturity is more than one year after settlement\n\n\n      if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n        return error.num;\n      } // Return bond-equivalent yield\n\n\n      return 100 * (1 - discount * DAYS360(settlement, maturity, false) / 360);\n    };\n\n    exports.TBILLYIELD = function (settlement, maturity, price) {\n      settlement = utils.parseDate(settlement);\n      maturity = utils.parseDate(maturity);\n      price = utils.parseNumber(price);\n\n      if (utils.anyIsError(settlement, maturity, price)) {\n        return error.value;\n      } // Return error if price is lower than or equal to zero\n\n\n      if (price <= 0) {\n        return error.num;\n      } // Return error if settlement is greater than maturity\n\n\n      if (settlement > maturity) {\n        return error.num;\n      } // Return error if maturity is more than one year after settlement\n\n\n      if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n        return error.num;\n      } // Return bond-equivalent yield\n\n\n      return (100 - price) * 360 / (price * DAYS360(settlement, maturity, false));\n    };\n\n    exports.VDB = null;\n\n    exports.XIRR = function (values, dates, guess) {\n      // Credits: algorithm inspired by Apache OpenOffice\n      values = utils.parseNumberArray(utils.flatten(values));\n      dates = utils.parseDateArray(utils.flatten(dates));\n      guess = utils.parseNumber(guess);\n\n      if (utils.anyIsError(values, dates, guess)) {\n        return error.value;\n      } // Calculates the resulting amount\n\n\n      var irrResult = function irrResult(values, dates, rate) {\n        var r = rate + 1;\n        var result = values[0];\n\n        for (var i = 1; i < values.length; i++) {\n          result += values[i] / Math.pow(r, DAYS(dates[i], dates[0]) / 365);\n        }\n\n        return result;\n      }; // Calculates the first derivation\n\n\n      var irrResultDeriv = function irrResultDeriv(values, dates, rate) {\n        var r = rate + 1;\n        var result = 0;\n\n        for (var i = 1; i < values.length; i++) {\n          var frac = DAYS(dates[i], dates[0]) / 365;\n          result -= frac * values[i] / Math.pow(r, frac + 1);\n        }\n\n        return result;\n      }; // Check that values contains at least one positive value and one\n      // negative value\n\n\n      var positive = false;\n      var negative = false;\n\n      for (var i = 0; i < values.length; i++) {\n        if (values[i] > 0) {\n          positive = true;\n        }\n\n        if (values[i] < 0) {\n          negative = true;\n        }\n      } // Return error if values does not contain at least one positive value\n      // and one negative value\n\n\n      if (!positive || !negative) {\n        return error.num;\n      } // Initialize guess and resultRate\n\n\n      guess = guess || 0.1;\n      var resultRate = guess; // Set maximum epsilon for end of iteration\n\n      var epsMax = 1e-10; // Implement Newton's method\n\n      var newRate, epsRate, resultValue;\n      var contLoop = true;\n\n      do {\n        resultValue = irrResult(values, dates, resultRate);\n        newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n        epsRate = Math.abs(newRate - resultRate);\n        resultRate = newRate;\n        contLoop = epsRate > epsMax && Math.abs(resultValue) > epsMax;\n      } while (contLoop); // Return internal rate of return\n\n\n      return resultRate;\n    };\n\n    exports.XNPV = function (rate, values, dates) {\n      rate = utils.parseNumber(rate);\n      values = utils.parseNumberArray(utils.flatten(values));\n      dates = utils.parseDateArray(utils.flatten(dates));\n\n      if (utils.anyIsError(rate, values, dates)) {\n        return error.value;\n      }\n\n      var result = 0;\n\n      for (var i = 0; i < values.length; i++) {\n        result += values[i] / Math.pow(1 + rate, DAYS(dates[i], dates[0]) / 365);\n      }\n\n      return result;\n    };\n\n    exports.YIELD = null;\n    exports.YIELDDISC = null;\n    exports.YIELDMAT = null;\n    return exports;\n  }();\n\n  _jexcel.methods.information = function () {\n    var exports = {};\n    exports.CELL = null;\n    exports.ERROR = {};\n\n    exports.ERROR.TYPE = function (error_val) {\n      switch (error_val) {\n        case error.nil:\n          return 1;\n\n        case error.div0:\n          return 2;\n\n        case error.value:\n          return 3;\n\n        case error.ref:\n          return 4;\n\n        case error.name:\n          return 5;\n\n        case error.num:\n          return 6;\n\n        case error.na:\n          return 7;\n\n        case error.data:\n          return 8;\n      }\n\n      return error.na;\n    };\n\n    exports.INFO = null;\n\n    exports.ISBLANK = function (value) {\n      return value === null;\n    };\n\n    exports.ISBINARY = function (number) {\n      return /^[01]{1,10}$/.test(number);\n    };\n\n    exports.ISERR = function (value) {\n      return [error.value, error.ref, error.div0, error.num, error.name, error.nil].indexOf(value) >= 0 || typeof value === 'number' && (isNaN(value) || !isFinite(value));\n    };\n\n    exports.ISERROR = function (value) {\n      return exports.ISERR(value) || value === error.na;\n    };\n\n    exports.ISEVEN = function (number) {\n      return Math.floor(Math.abs(number)) & 1 ? false : true;\n    }; // TODO\n\n\n    exports.ISFORMULA = null;\n\n    exports.ISLOGICAL = function (value) {\n      return value === true || value === false;\n    };\n\n    exports.ISNA = function (value) {\n      return value === error.na;\n    };\n\n    exports.ISNONTEXT = function (value) {\n      return typeof value !== 'string';\n    };\n\n    exports.ISNUMBER = function (value) {\n      return typeof value === 'number' && !isNaN(value) && isFinite(value);\n    };\n\n    exports.ISODD = function (number) {\n      return Math.floor(Math.abs(number)) & 1 ? true : false;\n    };\n\n    exports.ISREF = null;\n\n    exports.ISTEXT = function (value) {\n      return typeof value === 'string';\n    };\n\n    exports.N = function (value) {\n      if (this.ISNUMBER(value)) {\n        return value;\n      }\n\n      if (value instanceof Date) {\n        return value.getTime();\n      }\n\n      if (value === true) {\n        return 1;\n      }\n\n      if (value === false) {\n        return 0;\n      }\n\n      if (this.ISERROR(value)) {\n        return value;\n      }\n\n      return 0;\n    };\n\n    exports.NA = function () {\n      return error.na;\n    };\n\n    exports.SHEET = null;\n    exports.SHEETS = null;\n\n    exports.TYPE = function (value) {\n      if (this.ISNUMBER(value)) {\n        return 1;\n      }\n\n      if (this.ISTEXT(value)) {\n        return 2;\n      }\n\n      if (this.ISLOGICAL(value)) {\n        return 4;\n      }\n\n      if (this.ISERROR(value)) {\n        return 16;\n      }\n\n      if (Array.isArray(value)) {\n        return 64;\n      }\n    };\n\n    return exports;\n  }();\n\n  _jexcel.methods.logical = function () {\n    var exports = {};\n\n    exports.AND = function () {\n      var args = utils.flatten(arguments);\n      var result = true;\n\n      for (var i = 0; i < args.length; i++) {\n        if (!args[i]) {\n          result = false;\n        }\n      }\n\n      return result;\n    };\n\n    exports.CHOOSE = function () {\n      if (arguments.length < 2) {\n        return error.na;\n      }\n\n      var index = arguments[0];\n\n      if (index < 1 || index > 254) {\n        return error.value;\n      }\n\n      if (arguments.length < index + 1) {\n        return error.value;\n      }\n\n      return arguments[index];\n    };\n\n    exports.FALSE = function () {\n      return false;\n    };\n\n    exports.IF = function (test, then_value, otherwise_value) {\n      return test ? then_value : otherwise_value;\n    };\n\n    exports.IFERROR = function (value, valueIfError) {\n      if (ISERROR(value)) {\n        return valueIfError;\n      }\n\n      return value;\n    };\n\n    exports.IFNA = function (value, value_if_na) {\n      return value === error.na ? value_if_na : value;\n    };\n\n    exports.NOT = function (logical) {\n      return !logical;\n    };\n\n    exports.OR = function () {\n      var args = utils.flatten(arguments);\n      var result = false;\n\n      for (var i = 0; i < args.length; i++) {\n        if (args[i]) {\n          result = true;\n        }\n      }\n\n      return result;\n    };\n\n    exports.TRUE = function () {\n      return true;\n    };\n\n    exports.XOR = function () {\n      var args = utils.flatten(arguments);\n      var result = 0;\n\n      for (var i = 0; i < args.length; i++) {\n        if (args[i]) {\n          result++;\n        }\n      }\n\n      return Math.floor(Math.abs(result)) & 1 ? true : false;\n    };\n\n    exports.SWITCH = function () {\n      var result;\n\n      if (arguments.length > 0) {\n        var targetValue = arguments[0];\n        var argc = arguments.length - 1;\n        var switchCount = Math.floor(argc / 2);\n        var switchSatisfied = false;\n        var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\n\n        if (switchCount) {\n          for (var index = 0; index < switchCount; index++) {\n            if (targetValue === arguments[index * 2 + 1]) {\n              result = arguments[index * 2 + 2];\n              switchSatisfied = true;\n              break;\n            }\n          }\n        }\n\n        if (!switchSatisfied && defaultClause) {\n          result = defaultClause;\n        }\n      }\n\n      return result;\n    };\n\n    return exports;\n  }();\n\n  _jexcel.methods.math = function () {\n    var exports = {};\n\n    exports.ABS = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.abs(utils.parseNumber(number));\n    };\n\n    exports.ACOS = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.acos(number);\n    };\n\n    exports.ACOSH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.log(number + Math.sqrt(number * number - 1));\n    };\n\n    exports.ACOT = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.atan(1 / number);\n    };\n\n    exports.ACOTH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return 0.5 * Math.log((number + 1) / (number - 1));\n    };\n\n    exports.AGGREGATE = null;\n\n    exports.ARABIC = function (text) {\n      // Credits: Rafa? Kukawski\n      if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\n        return error.value;\n      }\n\n      var r = 0;\n      text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function (i) {\n        r += {\n          M: 1000,\n          CM: 900,\n          D: 500,\n          CD: 400,\n          C: 100,\n          XC: 90,\n          L: 50,\n          XL: 40,\n          X: 10,\n          IX: 9,\n          V: 5,\n          IV: 4,\n          I: 1\n        }[i];\n      });\n      return r;\n    };\n\n    exports.ASIN = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.asin(number);\n    };\n\n    exports.ASINH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.log(number + Math.sqrt(number * number + 1));\n    };\n\n    exports.ATAN = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.atan(number);\n    };\n\n    exports.ATAN2 = function (number_x, number_y) {\n      number_x = utils.parseNumber(number_x);\n      number_y = utils.parseNumber(number_y);\n\n      if (utils.anyIsError(number_x, number_y)) {\n        return error.value;\n      }\n\n      return Math.atan2(number_x, number_y);\n    };\n\n    exports.ATANH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.log((1 + number) / (1 - number)) / 2;\n    };\n\n    exports.BASE = function (number, radix, min_length) {\n      min_length = min_length || 0;\n      number = utils.parseNumber(number);\n      radix = utils.parseNumber(radix);\n      min_length = utils.parseNumber(min_length);\n\n      if (utils.anyIsError(number, radix, min_length)) {\n        return error.value;\n      }\n\n      min_length = min_length === undefined ? 0 : min_length;\n      var result = number.toString(radix);\n      return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\n    };\n\n    exports.CEILING = function (number, significance, mode) {\n      significance = significance === undefined ? 1 : significance;\n      mode = mode === undefined ? 0 : mode;\n      number = utils.parseNumber(number);\n      significance = utils.parseNumber(significance);\n      mode = utils.parseNumber(mode);\n\n      if (utils.anyIsError(number, significance, mode)) {\n        return error.value;\n      }\n\n      if (significance === 0) {\n        return 0;\n      }\n\n      significance = Math.abs(significance);\n\n      if (number >= 0) {\n        return Math.ceil(number / significance) * significance;\n      } else {\n        if (mode === 0) {\n          return -1 * Math.floor(Math.abs(number) / significance) * significance;\n        } else {\n          return -1 * Math.ceil(Math.abs(number) / significance) * significance;\n        }\n      }\n    };\n\n    exports.CEILING.MATH = exports.CEILING;\n    exports.CEILING.PRECISE = exports.CEILING;\n\n    exports.COMBIN = function (number, number_chosen) {\n      number = utils.parseNumber(number);\n      number_chosen = utils.parseNumber(number_chosen);\n\n      if (utils.anyIsError(number, number_chosen)) {\n        return error.value;\n      }\n\n      return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\n    };\n\n    exports.COMBINA = function (number, number_chosen) {\n      number = utils.parseNumber(number);\n      number_chosen = utils.parseNumber(number_chosen);\n\n      if (utils.anyIsError(number, number_chosen)) {\n        return error.value;\n      }\n\n      return number === 0 && number_chosen === 0 ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\n    };\n\n    exports.COS = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.cos(number);\n    };\n\n    exports.COSH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return (Math.exp(number) + Math.exp(-number)) / 2;\n    };\n\n    exports.COT = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return 1 / Math.tan(number);\n    };\n\n    exports.COTH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      var e2 = Math.exp(2 * number);\n      return (e2 + 1) / (e2 - 1);\n    };\n\n    exports.CSC = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return 1 / Math.sin(number);\n    };\n\n    exports.CSCH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return 2 / (Math.exp(number) - Math.exp(-number));\n    };\n\n    exports.DECIMAL = function (number, radix) {\n      if (arguments.length < 1) {\n        return error.value;\n      }\n\n      return parseInt(number, radix);\n    };\n\n    exports.DEGREES = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return number * 180 / Math.PI;\n    };\n\n    exports.EVEN = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return exports.CEILING(number, -2, -1);\n    };\n\n    exports.EXP = Math.exp;\n    var MEMOIZED_FACT = [];\n\n    exports.FACT = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      var n = Math.floor(number);\n\n      if (n === 0 || n === 1) {\n        return 1;\n      } else if (MEMOIZED_FACT[n] > 0) {\n        return MEMOIZED_FACT[n];\n      } else {\n        MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\n        return MEMOIZED_FACT[n];\n      }\n    };\n\n    exports.FACTDOUBLE = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      var n = Math.floor(number);\n\n      if (n <= 0) {\n        return 1;\n      } else {\n        return n * exports.FACTDOUBLE(n - 2);\n      }\n    };\n\n    exports.FLOOR = function (number, significance, mode) {\n      significance = significance === undefined ? 1 : significance;\n      mode = mode === undefined ? 0 : mode;\n      number = utils.parseNumber(number);\n      significance = utils.parseNumber(significance);\n      mode = utils.parseNumber(mode);\n\n      if (utils.anyIsError(number, significance, mode)) {\n        return error.value;\n      }\n\n      if (significance === 0) {\n        return 0;\n      }\n\n      significance = Math.abs(significance);\n\n      if (number >= 0) {\n        return Math.floor(number / significance) * significance;\n      } else {\n        if (mode === 0) {\n          return -1 * Math.ceil(Math.abs(number) / significance) * significance;\n        } else {\n          return -1 * Math.floor(Math.abs(number) / significance) * significance;\n        }\n      }\n    };\n\n    exports.FLOOR.MATH = exports.FLOOR;\n    exports.GCD = null;\n\n    exports.INT = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.floor(number);\n    };\n\n    exports.LCM = function () {\n      // Credits: Jonas Raoni Soares Silva\n      var o = utils.parseNumberArray(utils.flatten(arguments));\n\n      if (o instanceof Error) {\n        return o;\n      }\n\n      for (var i, j, n, d, r = 1; (n = o.pop()) !== undefined;) {\n        while (n > 1) {\n          if (n % 2) {\n            for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {//empty\n            }\n\n            d = i <= j ? i : n;\n          } else {\n            d = 2;\n          }\n\n          for (n /= d, r *= d, i = o.length; i; o[--i] % d === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {//empty\n          }\n        }\n      }\n\n      return r;\n    };\n\n    exports.LN = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.log(number);\n    };\n\n    exports.LOG = function (number, base) {\n      number = utils.parseNumber(number);\n      base = base === undefined ? 10 : utils.parseNumber(base);\n\n      if (utils.anyIsError(number, base)) {\n        return error.value;\n      }\n\n      return Math.log(number) / Math.log(base);\n    };\n\n    exports.LOG10 = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.log(number) / Math.log(10);\n    };\n\n    exports.MDETERM = null;\n    exports.MINVERSE = null;\n    exports.MMULT = null;\n\n    exports.MOD = function (dividend, divisor) {\n      dividend = utils.parseNumber(dividend);\n      divisor = utils.parseNumber(divisor);\n\n      if (utils.anyIsError(dividend, divisor)) {\n        return error.value;\n      }\n\n      if (divisor === 0) {\n        return error.div0;\n      }\n\n      var modulus = Math.abs(dividend % divisor);\n      return divisor > 0 ? modulus : -modulus;\n    };\n\n    exports.MROUND = function (number, multiple) {\n      number = utils.parseNumber(number);\n      multiple = utils.parseNumber(multiple);\n\n      if (utils.anyIsError(number, multiple)) {\n        return error.value;\n      }\n\n      if (number * multiple < 0) {\n        return error.num;\n      }\n\n      return Math.round(number / multiple) * multiple;\n    };\n\n    exports.MULTINOMIAL = function () {\n      var args = utils.parseNumberArray(utils.flatten(arguments));\n\n      if (args instanceof Error) {\n        return args;\n      }\n\n      var sum = 0;\n      var divisor = 1;\n\n      for (var i = 0; i < args.length; i++) {\n        sum += args[i];\n        divisor *= exports.FACT(args[i]);\n      }\n\n      return exports.FACT(sum) / divisor;\n    };\n\n    exports.MUNIT = null;\n\n    exports.ODD = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      var temp = Math.ceil(Math.abs(number));\n      temp = temp & 1 ? temp : temp + 1;\n      return number > 0 ? temp : -temp;\n    };\n\n    exports.PI = function () {\n      return Math.PI;\n    };\n\n    exports.POWER = function (number, power) {\n      number = utils.parseNumber(number);\n      power = utils.parseNumber(power);\n\n      if (utils.anyIsError(number, power)) {\n        return error.value;\n      }\n\n      var result = Math.pow(number, power);\n\n      if (isNaN(result)) {\n        return error.num;\n      }\n\n      return result;\n    };\n\n    exports.PRODUCT = function () {\n      var args = utils.parseNumberArray(utils.flatten(arguments));\n\n      if (args instanceof Error) {\n        return args;\n      }\n\n      var result = 1;\n\n      for (var i = 0; i < args.length; i++) {\n        result *= args[i];\n      }\n\n      return result;\n    };\n\n    exports.QUOTIENT = function (numerator, denominator) {\n      numerator = utils.parseNumber(numerator);\n      denominator = utils.parseNumber(denominator);\n\n      if (utils.anyIsError(numerator, denominator)) {\n        return error.value;\n      }\n\n      return parseInt(numerator / denominator, 10);\n    };\n\n    exports.RADIANS = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return number * Math.PI / 180;\n    };\n\n    exports.RAND = function () {\n      return Math.random();\n    };\n\n    exports.RANDBETWEEN = function (bottom, top) {\n      bottom = utils.parseNumber(bottom);\n      top = utils.parseNumber(top);\n\n      if (utils.anyIsError(bottom, top)) {\n        return error.value;\n      } // Creative Commons Attribution 3.0 License\n      // Copyright (c) 2012 eqcode\n\n\n      return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\n    };\n\n    exports.ROMAN = null;\n\n    exports.ROUND = function (number, digits) {\n      number = utils.parseNumber(number);\n      digits = utils.parseNumber(digits);\n\n      if (utils.anyIsError(number, digits)) {\n        return error.value;\n      }\n\n      return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n    };\n\n    exports.ROUNDDOWN = function (number, digits) {\n      number = utils.parseNumber(number);\n      digits = utils.parseNumber(digits);\n\n      if (utils.anyIsError(number, digits)) {\n        return error.value;\n      }\n\n      var sign = number > 0 ? 1 : -1;\n      return sign * Math.floor(Math.abs(number) * Math.pow(10, digits)) / Math.pow(10, digits);\n    };\n\n    exports.ROUNDUP = function (number, digits) {\n      number = utils.parseNumber(number);\n      digits = utils.parseNumber(digits);\n\n      if (utils.anyIsError(number, digits)) {\n        return error.value;\n      }\n\n      var sign = number > 0 ? 1 : -1;\n      return sign * Math.ceil(Math.abs(number) * Math.pow(10, digits)) / Math.pow(10, digits);\n    };\n\n    exports.SEC = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return 1 / Math.cos(number);\n    };\n\n    exports.SECH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return 2 / (Math.exp(number) + Math.exp(-number));\n    };\n\n    exports.SERIESSUM = function (x, n, m, coefficients) {\n      x = utils.parseNumber(x);\n      n = utils.parseNumber(n);\n      m = utils.parseNumber(m);\n      coefficients = utils.parseNumberArray(coefficients);\n\n      if (utils.anyIsError(x, n, m, coefficients)) {\n        return error.value;\n      }\n\n      var result = coefficients[0] * Math.pow(x, n);\n\n      for (var i = 1; i < coefficients.length; i++) {\n        result += coefficients[i] * Math.pow(x, n + i * m);\n      }\n\n      return result;\n    };\n\n    exports.SIGN = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      if (number < 0) {\n        return -1;\n      } else if (number === 0) {\n        return 0;\n      } else {\n        return 1;\n      }\n    };\n\n    exports.SIN = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.sin(number);\n    };\n\n    exports.SINH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return (Math.exp(number) - Math.exp(-number)) / 2;\n    };\n\n    exports.SQRT = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      if (number < 0) {\n        return error.num;\n      }\n\n      return Math.sqrt(number);\n    };\n\n    exports.SQRTPI = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.sqrt(number * Math.PI);\n    };\n\n    exports.SUBTOTAL = null;\n\n    exports.ADD = function (num1, num2) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      num1 = utils.parseNumber(num1);\n      num2 = utils.parseNumber(num2);\n\n      if (utils.anyIsError(num1, num2)) {\n        return error.value;\n      }\n\n      return num1 + num2;\n    };\n\n    exports.MINUS = function (num1, num2) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      num1 = utils.parseNumber(num1);\n      num2 = utils.parseNumber(num2);\n\n      if (utils.anyIsError(num1, num2)) {\n        return error.value;\n      }\n\n      return num1 - num2;\n    };\n\n    exports.DIVIDE = function (dividend, divisor) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      dividend = utils.parseNumber(dividend);\n      divisor = utils.parseNumber(divisor);\n\n      if (utils.anyIsError(dividend, divisor)) {\n        return error.value;\n      }\n\n      if (divisor === 0) {\n        return error.div0;\n      }\n\n      return dividend / divisor;\n    };\n\n    exports.MULTIPLY = function (factor1, factor2) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      factor1 = utils.parseNumber(factor1);\n      factor2 = utils.parseNumber(factor2);\n\n      if (utils.anyIsError(factor1, factor2)) {\n        return error.value;\n      }\n\n      return factor1 * factor2;\n    };\n\n    exports.GTE = function (num1, num2) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      num1 = utils.parseNumber(num1);\n      num2 = utils.parseNumber(num2);\n\n      if (utils.anyIsError(num1, num2)) {\n        return error.error;\n      }\n\n      return num1 >= num2;\n    };\n\n    exports.LT = function (num1, num2) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      num1 = utils.parseNumber(num1);\n      num2 = utils.parseNumber(num2);\n\n      if (utils.anyIsError(num1, num2)) {\n        return error.error;\n      }\n\n      return num1 < num2;\n    };\n\n    exports.LTE = function (num1, num2) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      num1 = utils.parseNumber(num1);\n      num2 = utils.parseNumber(num2);\n\n      if (utils.anyIsError(num1, num2)) {\n        return error.error;\n      }\n\n      return num1 <= num2;\n    };\n\n    exports.EQ = function (value1, value2) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      return value1 === value2;\n    };\n\n    exports.NE = function (value1, value2) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      return value1 !== value2;\n    };\n\n    exports.POW = function (base, exponent) {\n      if (arguments.length !== 2) {\n        return error.na;\n      }\n\n      base = utils.parseNumber(base);\n      exponent = utils.parseNumber(exponent);\n\n      if (utils.anyIsError(base, exponent)) {\n        return error.error;\n      }\n\n      return exports.POWER(base, exponent);\n    };\n\n    exports.SUM = function () {\n      var result = 0;\n      var argsKeys = Object.keys(arguments);\n\n      for (var i = 0; i < argsKeys.length; ++i) {\n        var elt = arguments[argsKeys[i]];\n\n        if (typeof elt === 'number') {\n          result += elt;\n        } else if (typeof elt === 'string') {\n          var parsed = parseFloat(elt);\n          !isNaN(parsed) && (result += parsed);\n        } else if (Array.isArray(elt)) {\n          result += exports.SUM.apply(null, elt);\n        }\n      }\n\n      return result;\n    };\n\n    exports.SUMIF = function (range, criteria) {\n      range = utils.parseNumberArray(utils.flatten(range));\n\n      if (range instanceof Error) {\n        return range;\n      }\n\n      var result = 0;\n\n      for (var i = 0; i < range.length; i++) {\n        result += eval(range[i] + criteria) ? range[i] : 0; // jshint ignore:line\n      }\n\n      return result;\n    };\n\n    exports.SUMIFS = function () {\n      var args = utils.argsToArray(arguments);\n      var range = utils.parseNumberArray(utils.flatten(args.shift()));\n\n      if (range instanceof Error) {\n        return range;\n      }\n\n      var criteria = args;\n      var n_range_elements = range.length;\n      var n_criterias = criteria.length;\n      var result = 0;\n\n      for (var i = 0; i < n_range_elements; i++) {\n        var el = range[i];\n        var condition = '';\n\n        for (var c = 0; c < n_criterias; c++) {\n          condition += el + criteria[c];\n\n          if (c !== n_criterias - 1) {\n            condition += '&&';\n          }\n        }\n\n        if (eval(condition)) {\n          // jshint ignore:line\n          result += el;\n        }\n      }\n\n      return result;\n    };\n\n    exports.SUMPRODUCT = null;\n\n    exports.SUMSQ = function () {\n      var numbers = utils.parseNumberArray(utils.flatten(arguments));\n\n      if (numbers instanceof Error) {\n        return numbers;\n      }\n\n      var result = 0;\n      var length = numbers.length;\n\n      for (var i = 0; i < length; i++) {\n        result += ISNUMBER(numbers[i]) ? numbers[i] * numbers[i] : 0;\n      }\n\n      return result;\n    };\n\n    exports.SUMX2MY2 = function (array_x, array_y) {\n      array_x = utils.parseNumberArray(utils.flatten(array_x));\n      array_y = utils.parseNumberArray(utils.flatten(array_y));\n\n      if (utils.anyIsError(array_x, array_y)) {\n        return error.value;\n      }\n\n      var result = 0;\n\n      for (var i = 0; i < array_x.length; i++) {\n        result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\n      }\n\n      return result;\n    };\n\n    exports.SUMX2PY2 = function (array_x, array_y) {\n      array_x = utils.parseNumberArray(utils.flatten(array_x));\n      array_y = utils.parseNumberArray(utils.flatten(array_y));\n\n      if (utils.anyIsError(array_x, array_y)) {\n        return error.value;\n      }\n\n      var result = 0;\n      array_x = utils.parseNumberArray(utils.flatten(array_x));\n      array_y = utils.parseNumberArray(utils.flatten(array_y));\n\n      for (var i = 0; i < array_x.length; i++) {\n        result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\n      }\n\n      return result;\n    };\n\n    exports.SUMXMY2 = function (array_x, array_y) {\n      array_x = utils.parseNumberArray(utils.flatten(array_x));\n      array_y = utils.parseNumberArray(utils.flatten(array_y));\n\n      if (utils.anyIsError(array_x, array_y)) {\n        return error.value;\n      }\n\n      var result = 0;\n      array_x = utils.flatten(array_x);\n      array_y = utils.flatten(array_y);\n\n      for (var i = 0; i < array_x.length; i++) {\n        result += Math.pow(array_x[i] - array_y[i], 2);\n      }\n\n      return result;\n    };\n\n    exports.TAN = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return Math.tan(number);\n    };\n\n    exports.TANH = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      var e2 = Math.exp(2 * number);\n      return (e2 - 1) / (e2 + 1);\n    };\n\n    exports.TRUNC = function (number, digits) {\n      digits = digits === undefined ? 0 : digits;\n      number = utils.parseNumber(number);\n      digits = utils.parseNumber(digits);\n\n      if (utils.anyIsError(number, digits)) {\n        return error.value;\n      }\n\n      var sign = number > 0 ? 1 : -1;\n      return sign * Math.floor(Math.abs(number) * Math.pow(10, digits)) / Math.pow(10, digits);\n    };\n\n    return exports;\n  }();\n\n  _jexcel.methods.misc = function () {\n    var exports = {};\n\n    exports.UNIQUE = function () {\n      var result = [];\n\n      for (var i = 0; i < arguments.length; ++i) {\n        var hasElement = false;\n        var element = arguments[i]; // Check if we've already seen this element.\n\n        for (var j = 0; j < result.length; ++j) {\n          hasElement = result[j] === element;\n\n          if (hasElement) {\n            break;\n          }\n        } // If we did not find it, add it to the result.\n\n\n        if (!hasElement) {\n          result.push(element);\n        }\n      }\n\n      return result;\n    };\n\n    exports.FLATTEN = utils.flatten;\n\n    exports.ARGS2ARRAY = function () {\n      return Array.prototype.slice.call(arguments, 0);\n    };\n\n    exports.REFERENCE = function (context, reference) {\n      try {\n        var path = reference.split('.');\n        var result = context;\n\n        for (var i = 0; i < path.length; ++i) {\n          var step = path[i];\n\n          if (step[step.length - 1] === ']') {\n            var opening = step.indexOf('[');\n            var index = step.substring(opening + 1, step.length - 1);\n            result = result[step.substring(0, opening)][index];\n          } else {\n            result = result[step];\n          }\n        }\n\n        return result;\n      } catch (error) {}\n    };\n\n    exports.JOIN = function (array, separator) {\n      return array.join(separator);\n    };\n\n    exports.NUMBERS = function () {\n      var possibleNumbers = utils.flatten(arguments);\n      return possibleNumbers.filter(function (el) {\n        return typeof el === 'number';\n      });\n    };\n\n    exports.NUMERAL = null;\n    return exports;\n  }();\n\n  _jexcel.methods.text = function () {\n    var exports = {};\n    exports.ASC = null;\n    exports.BAHTTEXT = null;\n\n    exports.CHAR = function (number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return String.fromCharCode(number);\n    };\n\n    exports.CLEAN = function (text) {\n      text = text || '';\n      var re = /[\\0-\\x1F]/g;\n      return text.replace(re, \"\");\n    };\n\n    exports.CODE = function (text) {\n      text = text || '';\n      return text.charCodeAt(0);\n    };\n\n    exports.CONCATENATE = function () {\n      var args = utils.flatten(arguments);\n      var trueFound = 0;\n\n      while ((trueFound = args.indexOf(true)) > -1) {\n        args[trueFound] = 'TRUE';\n      }\n\n      var falseFound = 0;\n\n      while ((falseFound = args.indexOf(false)) > -1) {\n        args[falseFound] = 'FALSE';\n      }\n\n      return args.join('');\n    };\n\n    exports.DBCS = null;\n    exports.DOLLAR = null;\n\n    exports.EXACT = function (text1, text2) {\n      return text1 === text2;\n    };\n\n    exports.FIND = function (find_text, within_text, position) {\n      position = position === undefined ? 0 : position;\n      return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\n    };\n\n    exports.FIXED = null;\n\n    exports.HTML2TEXT = function (value) {\n      var result = '';\n\n      if (value) {\n        if (value instanceof Array) {\n          value.forEach(function (line) {\n            if (result !== '') {\n              result += '\\n';\n            }\n\n            result += line.replace(/<(?:.|\\n)*?>/gm, '');\n          });\n        } else {\n          result = value.replace(/<(?:.|\\n)*?>/gm, '');\n        }\n      }\n\n      return result;\n    };\n\n    exports.LEFT = function (text, number) {\n      number = number === undefined ? 1 : number;\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error || typeof text !== 'string') {\n        return error.value;\n      }\n\n      return text ? text.substring(0, number) : null;\n    };\n\n    exports.LEN = function (text) {\n      if (arguments.length === 0) {\n        return error.error;\n      }\n\n      if (typeof text === 'string') {\n        return text ? text.length : 0;\n      }\n\n      if (text.length) {\n        return text.length;\n      }\n\n      return error.value;\n    };\n\n    exports.LOWER = function (text) {\n      if (typeof text !== 'string') {\n        return error.value;\n      }\n\n      return text ? text.toLowerCase() : text;\n    };\n\n    exports.MID = function (text, start, number) {\n      start = utils.parseNumber(start);\n      number = utils.parseNumber(number);\n\n      if (utils.anyIsError(start, number) || typeof text !== 'string') {\n        return number;\n      }\n\n      var begin = start - 1;\n      var end = begin + number;\n      return text.substring(begin, end);\n    };\n\n    exports.NUMBERVALUE = null;\n    exports.PRONETIC = null;\n\n    exports.PROPER = function (text) {\n      if (text === undefined || text.length === 0) {\n        return error.value;\n      }\n\n      if (text === true) {\n        text = 'TRUE';\n      }\n\n      if (text === false) {\n        text = 'FALSE';\n      }\n\n      if (isNaN(text) && typeof text === 'number') {\n        return error.value;\n      }\n\n      if (typeof text === 'number') {\n        text = '' + text;\n      }\n\n      return text.replace(/\\w\\S*/g, function (txt) {\n        return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n      });\n    };\n\n    exports.REGEXEXTRACT = function (text, regular_expression) {\n      var match = text.match(new RegExp(regular_expression));\n      return match ? match[match.length > 1 ? match.length - 1 : 0] : null;\n    };\n\n    exports.REGEXMATCH = function (text, regular_expression, full) {\n      var match = text.match(new RegExp(regular_expression));\n      return full ? match : !!match;\n    };\n\n    exports.REGEXREPLACE = function (text, regular_expression, replacement) {\n      return text.replace(new RegExp(regular_expression), replacement);\n    };\n\n    exports.REPLACE = function (text, position, length, new_text) {\n      position = utils.parseNumber(position);\n      length = utils.parseNumber(length);\n\n      if (utils.anyIsError(position, length) || typeof text !== 'string' || typeof new_text !== 'string') {\n        return error.value;\n      }\n\n      return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\n    };\n\n    exports.REPT = function (text, number) {\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return new Array(number + 1).join(text);\n    };\n\n    exports.RIGHT = function (text, number) {\n      number = number === undefined ? 1 : number;\n      number = utils.parseNumber(number);\n\n      if (number instanceof Error) {\n        return number;\n      }\n\n      return text ? text.substring(text.length - number) : null;\n    };\n\n    exports.SEARCH = function (find_text, within_text, position) {\n      var foundAt;\n\n      if (typeof find_text !== 'string' || typeof within_text !== 'string') {\n        return error.value;\n      }\n\n      position = position === undefined ? 0 : position;\n      foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1) + 1;\n      return foundAt === 0 ? error.value : foundAt;\n    };\n\n    exports.SPLIT = function (text, separator) {\n      return text.split(separator);\n    };\n\n    exports.SUBSTITUTE = function (text, old_text, new_text, occurrence) {\n      if (!text || !old_text || !new_text) {\n        return text;\n      } else if (occurrence === undefined) {\n        return text.replace(new RegExp(old_text, 'g'), new_text);\n      } else {\n        var index = 0;\n        var i = 0;\n\n        while (text.indexOf(old_text, index) > 0) {\n          index = text.indexOf(old_text, index + 1);\n          i++;\n\n          if (i === occurrence) {\n            return text.substring(0, index) + new_text + text.substring(index + old_text.length);\n          }\n        }\n      }\n    };\n\n    exports.T = function (value) {\n      return typeof value === \"string\" ? value : '';\n    };\n\n    exports.TEXT = null;\n\n    exports.TRIM = function (text) {\n      if (typeof text !== 'string') {\n        return error.value;\n      }\n\n      return text.replace(/ +/g, ' ').trim();\n    };\n\n    exports.UNICHAR = exports.CHAR;\n    exports.UNICODE = exports.CODE;\n\n    exports.UPPER = function (text) {\n      if (typeof text !== 'string') {\n        return error.value;\n      }\n\n      return text.toUpperCase();\n    };\n\n    exports.VALUE = null;\n    return exports;\n  }();\n\n  _jexcel.methods.stats = function () {\n    var exports = {};\n    var SQRT2PI = 2.5066282746310002;\n    exports.AVEDEV = null;\n\n    exports.AVERAGE = function () {\n      var range = utils.numbers(utils.flatten(arguments));\n      var n = range.length;\n      var sum = 0;\n      var count = 0;\n\n      for (var i = 0; i < n; i++) {\n        sum += range[i];\n        count += 1;\n      }\n\n      return sum / count;\n    };\n\n    exports.AVERAGEA = function () {\n      var range = utils.flatten(arguments);\n      var n = range.length;\n      var sum = 0;\n      var count = 0;\n\n      for (var i = 0; i < n; i++) {\n        var el = range[i];\n\n        if (typeof el === 'number') {\n          sum += el;\n        }\n\n        if (el === true) {\n          sum++;\n        }\n\n        if (el !== null) {\n          count++;\n        }\n      }\n\n      return sum / count;\n    };\n\n    exports.AVERAGEIF = function (range, criteria, average_range) {\n      average_range = average_range || range;\n      range = utils.flatten(range);\n      average_range = utils.parseNumberArray(utils.flatten(average_range));\n\n      if (average_range instanceof Error) {\n        return average_range;\n      }\n\n      var average_count = 0;\n      var result = 0;\n\n      for (var i = 0; i < range.length; i++) {\n        if (eval(range[i] + criteria)) {\n          // jshint ignore:line\n          result += average_range[i];\n          average_count++;\n        }\n      }\n\n      return result / average_count;\n    };\n\n    exports.AVERAGEIFS = null;\n\n    exports.COUNT = function () {\n      return utils.numbers(utils.flatten(arguments)).length;\n    };\n\n    exports.COUNTA = function () {\n      var range = utils.flatten(arguments);\n      return range.length - exports.COUNTBLANK(range);\n    };\n\n    exports.COUNTIN = function (range, value) {\n      var result = 0;\n\n      for (var i = 0; i < range.length; i++) {\n        if (range[i] === value) {\n          result++;\n        }\n      }\n\n      return result;\n    };\n\n    exports.COUNTBLANK = function () {\n      var range = utils.flatten(arguments);\n      var blanks = 0;\n      var element;\n\n      for (var i = 0; i < range.length; i++) {\n        element = range[i];\n\n        if (element === null || element === '') {\n          blanks++;\n        }\n      }\n\n      return blanks;\n    };\n\n    exports.COUNTIF = function (range, criteria) {\n      range = utils.flatten(range);\n\n      if (!/[<>=!]/.test(criteria)) {\n        criteria = '==\"' + criteria + '\"';\n      }\n\n      var matches = 0;\n\n      for (var i = 0; i < range.length; i++) {\n        if (typeof range[i] !== 'string') {\n          if (eval(range[i] + criteria)) {\n            // jshint ignore:line\n            matches++;\n          }\n        } else {\n          if (eval('\"' + range[i] + '\"' + criteria)) {\n            // jshint ignore:line\n            matches++;\n          }\n        }\n      }\n\n      return matches;\n    };\n\n    exports.COUNTIFS = function () {\n      var args = utils.argsToArray(arguments);\n      var results = new Array(utils.flatten(args[0]).length);\n\n      for (var i = 0; i < results.length; i++) {\n        results[i] = true;\n      }\n\n      for (i = 0; i < args.length; i += 2) {\n        var range = utils.flatten(args[i]);\n        var criteria = args[i + 1];\n\n        if (!/[<>=!]/.test(criteria)) {\n          criteria = '==\"' + criteria + '\"';\n        }\n\n        for (var j = 0; j < range.length; j++) {\n          if (typeof range[j] !== 'string') {\n            results[j] = results[j] && eval(range[j] + criteria); // jshint ignore:line\n          } else {\n            results[j] = results[j] && eval('\"' + range[j] + '\"' + criteria); // jshint ignore:line\n          }\n        }\n      }\n\n      var result = 0;\n\n      for (i = 0; i < results.length; i++) {\n        if (results[i]) {\n          result++;\n        }\n      }\n\n      return result;\n    };\n\n    exports.COUNTUNIQUE = function () {\n      return UNIQUE.apply(null, utils.flatten(arguments)).length;\n    };\n\n    exports.FISHER = function (x) {\n      x = utils.parseNumber(x);\n\n      if (x instanceof Error) {\n        return x;\n      }\n\n      return Math.log((1 + x) / (1 - x)) / 2;\n    };\n\n    exports.FISHERINV = function (y) {\n      y = utils.parseNumber(y);\n\n      if (y instanceof Error) {\n        return y;\n      }\n\n      var e2y = Math.exp(2 * y);\n      return (e2y - 1) / (e2y + 1);\n    };\n\n    exports.FREQUENCY = function (data, bins) {\n      data = utils.parseNumberArray(utils.flatten(data));\n      bins = utils.parseNumberArray(utils.flatten(bins));\n\n      if (utils.anyIsError(data, bins)) {\n        return error.value;\n      }\n\n      var n = data.length;\n      var b = bins.length;\n      var r = [];\n\n      for (var i = 0; i <= b; i++) {\n        r[i] = 0;\n\n        for (var j = 0; j < n; j++) {\n          if (i === 0) {\n            if (data[j] <= bins[0]) {\n              r[0] += 1;\n            }\n          } else if (i < b) {\n            if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\n              r[i] += 1;\n            }\n          } else if (i === b) {\n            if (data[j] > bins[b - 1]) {\n              r[b] += 1;\n            }\n          }\n        }\n      }\n\n      return r;\n    };\n\n    exports.LARGE = function (range, k) {\n      range = utils.parseNumberArray(utils.flatten(range));\n      k = utils.parseNumber(k);\n\n      if (utils.anyIsError(range, k)) {\n        return range;\n      }\n\n      return range.sort(function (a, b) {\n        return b - a;\n      })[k - 1];\n    };\n\n    exports.MAX = function () {\n      var range = utils.numbers(utils.flatten(arguments));\n      return range.length === 0 ? 0 : Math.max.apply(Math, range);\n    };\n\n    exports.MAXA = function () {\n      var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n      return range.length === 0 ? 0 : Math.max.apply(Math, range);\n    };\n\n    exports.MIN = function () {\n      var range = utils.numbers(utils.flatten(arguments));\n      return range.length === 0 ? 0 : Math.min.apply(Math, range);\n    };\n\n    exports.MINA = function () {\n      var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n      return range.length === 0 ? 0 : Math.min.apply(Math, range);\n    };\n\n    exports.MODE = {};\n\n    exports.MODE.MULT = function () {\n      // Credits: Ronan\n      var range = utils.parseNumberArray(utils.flatten(arguments));\n\n      if (range instanceof Error) {\n        return range;\n      }\n\n      var n = range.length;\n      var count = {};\n      var maxItems = [];\n      var max = 0;\n      var currentItem;\n\n      for (var i = 0; i < n; i++) {\n        currentItem = range[i];\n        count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\n\n        if (count[currentItem] > max) {\n          max = count[currentItem];\n          maxItems = [];\n        }\n\n        if (count[currentItem] === max) {\n          maxItems[maxItems.length] = currentItem;\n        }\n      }\n\n      return maxItems;\n    };\n\n    exports.MODE.SNGL = function () {\n      var range = utils.parseNumberArray(utils.flatten(arguments));\n\n      if (range instanceof Error) {\n        return range;\n      }\n\n      return exports.MODE.MULT(range).sort(function (a, b) {\n        return a - b;\n      })[0];\n    };\n\n    exports.PERCENTILE = {};\n\n    exports.PERCENTILE.EXC = function (array, k) {\n      array = utils.parseNumberArray(utils.flatten(array));\n      k = utils.parseNumber(k);\n\n      if (utils.anyIsError(array, k)) {\n        return error.value;\n      }\n\n      array = array.sort(function (a, b) {\n        {\n          return a - b;\n        }\n      });\n      var n = array.length;\n\n      if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\n        return error.num;\n      }\n\n      var l = k * (n + 1) - 1;\n      var fl = Math.floor(l);\n      return utils.cleanFloat(l === fl ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n    };\n\n    exports.PERCENTILE.INC = function (array, k) {\n      array = utils.parseNumberArray(utils.flatten(array));\n      k = utils.parseNumber(k);\n\n      if (utils.anyIsError(array, k)) {\n        return error.value;\n      }\n\n      array = array.sort(function (a, b) {\n        return a - b;\n      });\n      var n = array.length;\n      var l = k * (n - 1);\n      var fl = Math.floor(l);\n      return utils.cleanFloat(l === fl ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n    };\n\n    exports.PERCENTRANK = {};\n\n    exports.PERCENTRANK.EXC = function (array, x, significance) {\n      significance = significance === undefined ? 3 : significance;\n      array = utils.parseNumberArray(utils.flatten(array));\n      x = utils.parseNumber(x);\n      significance = utils.parseNumber(significance);\n\n      if (utils.anyIsError(array, x, significance)) {\n        return error.value;\n      }\n\n      array = array.sort(function (a, b) {\n        return a - b;\n      });\n      var uniques = UNIQUE.apply(null, array);\n      var n = array.length;\n      var m = uniques.length;\n      var power = Math.pow(10, significance);\n      var result = 0;\n      var match = false;\n      var i = 0;\n\n      while (!match && i < m) {\n        if (x === uniques[i]) {\n          result = (array.indexOf(uniques[i]) + 1) / (n + 1);\n          match = true;\n        } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n          result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\n          match = true;\n        }\n\n        i++;\n      }\n\n      return Math.floor(result * power) / power;\n    };\n\n    exports.PERCENTRANK.INC = function (array, x, significance) {\n      significance = significance === undefined ? 3 : significance;\n      array = utils.parseNumberArray(utils.flatten(array));\n      x = utils.parseNumber(x);\n      significance = utils.parseNumber(significance);\n\n      if (utils.anyIsError(array, x, significance)) {\n        return error.value;\n      }\n\n      array = array.sort(function (a, b) {\n        return a - b;\n      });\n      var uniques = UNIQUE.apply(null, array);\n      var n = array.length;\n      var m = uniques.length;\n      var power = Math.pow(10, significance);\n      var result = 0;\n      var match = false;\n      var i = 0;\n\n      while (!match && i < m) {\n        if (x === uniques[i]) {\n          result = array.indexOf(uniques[i]) / (n - 1);\n          match = true;\n        } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n          result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\n          match = true;\n        }\n\n        i++;\n      }\n\n      return Math.floor(result * power) / power;\n    };\n\n    exports.PERMUT = function (number, number_chosen) {\n      number = utils.parseNumber(number);\n      number_chosen = utils.parseNumber(number_chosen);\n\n      if (utils.anyIsError(number, number_chosen)) {\n        return error.value;\n      }\n\n      return FACT(number) / FACT(number - number_chosen);\n    };\n\n    exports.PERMUTATIONA = function (number, number_chosen) {\n      number = utils.parseNumber(number);\n      number_chosen = utils.parseNumber(number_chosen);\n\n      if (utils.anyIsError(number, number_chosen)) {\n        return error.value;\n      }\n\n      return Math.pow(number, number_chosen);\n    };\n\n    exports.PHI = function (x) {\n      x = utils.parseNumber(x);\n\n      if (x instanceof Error) {\n        return error.value;\n      }\n\n      return Math.exp(-0.5 * x * x) / SQRT2PI;\n    };\n\n    exports.PROB = function (range, probability, lower, upper) {\n      if (lower === undefined) {\n        return 0;\n      }\n\n      upper = upper === undefined ? lower : upper;\n      range = utils.parseNumberArray(utils.flatten(range));\n      probability = utils.parseNumberArray(utils.flatten(probability));\n      lower = utils.parseNumber(lower);\n      upper = utils.parseNumber(upper);\n\n      if (utils.anyIsError(range, probability, lower, upper)) {\n        return error.value;\n      }\n\n      if (lower === upper) {\n        return range.indexOf(lower) >= 0 ? probability[range.indexOf(lower)] : 0;\n      }\n\n      var sorted = range.sort(function (a, b) {\n        return a - b;\n      });\n      var n = sorted.length;\n      var result = 0;\n\n      for (var i = 0; i < n; i++) {\n        if (sorted[i] >= lower && sorted[i] <= upper) {\n          result += probability[range.indexOf(sorted[i])];\n        }\n      }\n\n      return result;\n    };\n\n    exports.QUARTILE = {};\n\n    exports.QUARTILE.EXC = function (range, quart) {\n      range = utils.parseNumberArray(utils.flatten(range));\n      quart = utils.parseNumber(quart);\n\n      if (utils.anyIsError(range, quart)) {\n        return error.value;\n      }\n\n      switch (quart) {\n        case 1:\n          return exports.PERCENTILE.EXC(range, 0.25);\n\n        case 2:\n          return exports.PERCENTILE.EXC(range, 0.5);\n\n        case 3:\n          return exports.PERCENTILE.EXC(range, 0.75);\n\n        default:\n          return error.num;\n      }\n    };\n\n    exports.QUARTILE.INC = function (range, quart) {\n      range = utils.parseNumberArray(utils.flatten(range));\n      quart = utils.parseNumber(quart);\n\n      if (utils.anyIsError(range, quart)) {\n        return error.value;\n      }\n\n      switch (quart) {\n        case 1:\n          return exports.PERCENTILE.INC(range, 0.25);\n\n        case 2:\n          return exports.PERCENTILE.INC(range, 0.5);\n\n        case 3:\n          return exports.PERCENTILE.INC(range, 0.75);\n\n        default:\n          return error.num;\n      }\n    };\n\n    exports.RANK = {};\n\n    exports.RANK.AVG = function (number, range, order) {\n      number = utils.parseNumber(number);\n      range = utils.parseNumberArray(utils.flatten(range));\n\n      if (utils.anyIsError(number, range)) {\n        return error.value;\n      }\n\n      range = utils.flatten(range);\n      order = order || false;\n      var sort = order ? function (a, b) {\n        return a - b;\n      } : function (a, b) {\n        return b - a;\n      };\n      range = range.sort(sort);\n      var length = range.length;\n      var count = 0;\n\n      for (var i = 0; i < length; i++) {\n        if (range[i] === number) {\n          count++;\n        }\n      }\n\n      return count > 1 ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\n    };\n\n    exports.RANK.EQ = function (number, range, order) {\n      number = utils.parseNumber(number);\n      range = utils.parseNumberArray(utils.flatten(range));\n\n      if (utils.anyIsError(number, range)) {\n        return error.value;\n      }\n\n      order = order || false;\n      var sort = order ? function (a, b) {\n        return a - b;\n      } : function (a, b) {\n        return b - a;\n      };\n      range = range.sort(sort);\n      return range.indexOf(number) + 1;\n    };\n\n    exports.RSQ = function (data_x, data_y) {\n      // no need to flatten here, PEARSON will take care of that\n      data_x = utils.parseNumberArray(utils.flatten(data_x));\n      data_y = utils.parseNumberArray(utils.flatten(data_y));\n\n      if (utils.anyIsError(data_x, data_y)) {\n        return error.value;\n      }\n\n      return Math.pow(exports.PEARSON(data_x, data_y), 2);\n    };\n\n    exports.SMALL = function (range, k) {\n      range = utils.parseNumberArray(utils.flatten(range));\n      k = utils.parseNumber(k);\n\n      if (utils.anyIsError(range, k)) {\n        return range;\n      }\n\n      return range.sort(function (a, b) {\n        return a - b;\n      })[k - 1];\n    };\n\n    exports.STANDARDIZE = function (x, mean, sd) {\n      x = utils.parseNumber(x);\n      mean = utils.parseNumber(mean);\n      sd = utils.parseNumber(sd);\n\n      if (utils.anyIsError(x, mean, sd)) {\n        return error.value;\n      }\n\n      return (x - mean) / sd;\n    };\n\n    exports.STDEV = {};\n\n    exports.STDEV.P = function () {\n      var v = exports.VAR.P.apply(this, arguments);\n      return Math.sqrt(v);\n    };\n\n    exports.STDEV.S = function () {\n      var v = exports.VAR.S.apply(this, arguments);\n      return Math.sqrt(v);\n    };\n\n    exports.STDEVA = function () {\n      var v = exports.VARA.apply(this, arguments);\n      return Math.sqrt(v);\n    };\n\n    exports.STDEVPA = function () {\n      var v = exports.VARPA.apply(this, arguments);\n      return Math.sqrt(v);\n    };\n\n    exports.VAR = {};\n\n    exports.VAR.P = function () {\n      var range = utils.numbers(utils.flatten(arguments));\n      var n = range.length;\n      var sigma = 0;\n      var mean = exports.AVERAGE(range);\n\n      for (var i = 0; i < n; i++) {\n        sigma += Math.pow(range[i] - mean, 2);\n      }\n\n      return sigma / n;\n    };\n\n    exports.VAR.S = function () {\n      var range = utils.numbers(utils.flatten(arguments));\n      var n = range.length;\n      var sigma = 0;\n      var mean = exports.AVERAGE(range);\n\n      for (var i = 0; i < n; i++) {\n        sigma += Math.pow(range[i] - mean, 2);\n      }\n\n      return sigma / (n - 1);\n    };\n\n    exports.VARA = function () {\n      var range = utils.flatten(arguments);\n      var n = range.length;\n      var sigma = 0;\n      var count = 0;\n      var mean = exports.AVERAGEA(range);\n\n      for (var i = 0; i < n; i++) {\n        var el = range[i];\n\n        if (typeof el === 'number') {\n          sigma += Math.pow(el - mean, 2);\n        } else if (el === true) {\n          sigma += Math.pow(1 - mean, 2);\n        } else {\n          sigma += Math.pow(0 - mean, 2);\n        }\n\n        if (el !== null) {\n          count++;\n        }\n      }\n\n      return sigma / (count - 1);\n    };\n\n    exports.VARPA = function () {\n      var range = utils.flatten(arguments);\n      var n = range.length;\n      var sigma = 0;\n      var count = 0;\n      var mean = exports.AVERAGEA(range);\n\n      for (var i = 0; i < n; i++) {\n        var el = range[i];\n\n        if (typeof el === 'number') {\n          sigma += Math.pow(el - mean, 2);\n        } else if (el === true) {\n          sigma += Math.pow(1 - mean, 2);\n        } else {\n          sigma += Math.pow(0 - mean, 2);\n        }\n\n        if (el !== null) {\n          count++;\n        }\n      }\n\n      return sigma / count;\n    };\n\n    exports.WEIBULL = {};\n\n    exports.WEIBULL.DIST = function (x, alpha, beta, cumulative) {\n      x = utils.parseNumber(x);\n      alpha = utils.parseNumber(alpha);\n      beta = utils.parseNumber(beta);\n\n      if (utils.anyIsError(x, alpha, beta)) {\n        return error.value;\n      }\n\n      return cumulative ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\n    };\n\n    exports.Z = {};\n\n    exports.Z.TEST = function (range, x, sd) {\n      range = utils.parseNumberArray(utils.flatten(range));\n      x = utils.parseNumber(x);\n\n      if (utils.anyIsError(range, x)) {\n        return error.value;\n      }\n\n      sd = sd || exports.STDEV.S(range);\n      var n = range.length;\n      return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\n    };\n\n    return exports;\n  }();\n\n  for (var i = 0; i < Object.keys(_jexcel.methods).length; i++) {\n    var methods = _jexcel.methods[Object.keys(_jexcel.methods)[i]];\n\n    for (var j = 0; j < Object.keys(methods).length; j++) {\n      if (typeof methods[Object.keys(methods)[j]] == 'function') {\n        window[Object.keys(methods)[j]] = methods[Object.keys(methods)[j]];\n      } else {\n        window[Object.keys(methods)[j]] = function () {\n          return Object.keys(methods)[j] + 'Not implemented';\n        };\n      }\n    }\n  }\n\n  return _jexcel;\n});","map":{"version":3,"sources":["/home/altius/fasp-core-ui/node_modules/jexcel/dist/jexcel.js"],"names":["jSuites","require","global","factory","exports","module","define","amd","jexcel","el","options","obj","Element","HTMLDocument","console","error","defaults","url","data","copyCompatibility","rows","columns","colHeaders","colWidths","colAlignments","nestedHeaders","defaultColWidth","defaultColAlign","minSpareRows","minSpareCols","minDimensions","allowExport","includeHeadersOnDownload","columnSorting","columnDrag","columnResize","rowResize","rowDrag","editable","allowInsertRow","allowManualInsertRow","allowInsertColumn","allowManualInsertColumn","allowDeleteRow","allowDeletingAllRows","allowDeleteColumn","allowRenameColumn","allowComments","wordWrap","imageOptions","csv","csvFileName","csvHeaders","csvDelimiter","selectionCopy","mergeCells","toolbar","search","pagination","paginationOptions","fullscreen","lazyLoading","loadingSpin","tableOverflow","tableHeight","tableWidth","meta","style","parseFormulas","autoIncrement","autoCasting","onundo","onredo","onload","onchange","onbeforechange","onafterchanges","onbeforeinsertrow","oninsertrow","onbeforeinsertcolumn","oninsertcolumn","onbeforedeleterow","ondeleterow","onbeforedeletecolumn","ondeletecolumn","onmoverow","onmovecolumn","onresizerow","onresizecolumn","onsort","onselection","onpaste","onbeforepaste","onmerge","onfocus","onblur","onchangeheader","oneditionstart","oneditionend","onchangestyle","onchangemeta","onchangepage","updateTable","detachForUpdates","text","noRecordsFound","showingPage","show","entries","columnName","insertANewColumnBefore","insertANewColumnAfter","deleteSelectedColumns","renameThisColumn","orderAscending","orderDescending","insertANewRowBefore","insertANewRowAfter","deleteSelectedRows","editComments","addComments","comments","clearComments","copy","paste","saveAs","about","areYouSureToDeleteTheSelectedRows","areYouSureToDeleteTheSelectedColumns","thisActionWillDestroyAnyExistingMergedCellsAreYouSure","thisActionWillClearYourSearchResultsAreYouSure","thereIsAConflictWithAnotherMergedCell","invalidMergeProperties","cellAlreadyMerged","noCellsSelected","property","hasOwnProperty","textKey","corner","contextMenu","textarea","ads","content","table","thead","tbody","results","searchInput","pageNumber","headerContainer","colgroupContainer","headers","records","history","formula","colgroup","selection","highlighted","selectedCell","selectedContainer","cursor","historyIndex","ignoreEvents","ignoreHistory","edition","hashString","resizing","dragging","activate","classList","add","remove","prepareTable","size","length","keys","Object","multiple","i","type","name","source","editor","allowEmpty","title","width","align","push","ajax","index","method","dataType","success","complete","createTable","format","document","createElement","searchContainer","searchText","createTextNode","appendChild","resetSelection","paginationUpdateContainer","paginationDropdown","parseInt","value","page","temp","innerHTML","filter","tempCol","setAttribute","j","createNestedHeader","createCellHeader","className","display","id","tabIndex","contextmenu","onclick","close","sessionStorage","getItem","setItem","img","src","span","container","paginationInfo","paginationPages","createToolbar","maxHeight","setData","setStyle","refresh","loading","result","hide","JSON","parse","row","size_i","size_j","min_i","min_j","max_i","max_j","undefined","startNumber","finalNumber","quantityPerPage","tr","createRow","updatePagination","num","setMerge","getData","dataOnly","dataset","px","py","x","y","contains","getJson","getRowData","rowNumber","setRowData","getColumnNameFromId","setValue","getColumnData","columnNumber","setColumnData","colNumber","height","td","createCell","element","checked","readOnly","formatted","calendar","extractDateFromString","getDateString","getDropDownValue","render","color","backgroundColor","substr","executeFormula","mask","decimal","run","colAlign","textAlign","whiteSpace","overflow","colWidth","getColumnName","nestedInformation","headerIndex","colspan","numberOfColumns","column","join","toolbarItem","k","v","tooltip","getAttribute","toolbarDropdownOption","open","o","cellName","rowspan","ignoreHistoryAndEvents","test","alert","x1","y1","x2","y2","cell","getIdFromColumnName","cells","updateCell","updateSelection","setHistory","action","getMerge","mergedCells","removeMerge","keepOptions","removeAttribute","info","destroyMerged","isColMerged","insertBefore","cols","isRowMerged","openEditor","empty","e","createEditor","getBoundingClientRect","minHeight","children","autocomplete","opened","split","position","onclose","closeEditor","dropdown","focus","div","image","rect","rectContent","window","innerHeight","bottom","top","save","tagName","getCell","getCellFromCoords","getLabel","getLabelFromCoords","getValue","processedValue","getValueFromCoords","force","columnId","updateFormulaChain","setValueFromCoords","setCheckRadioValue","record","col","val","newValue","oldValue","copyData","d","h","breakControl","posx","posy","tokens","match","affectedTokens","token","updateFormula","Number","date","Date","setDate","getDate","getFullYear","doubleDigitFormat","getMonth","refreshSelection","updateSelectionFromCoords","conditionalSelectionUpdate","blur","previousStatus","ux","uy","left","el1","el2","origin","updated","previousState","borderLeft","borderRight","borderTop","borderBottom","updateCornerPosition","removeCopySelection","updateCopySelection","x3","y3","last","contentRect","lastRect","w2","h2","scrollLeft","scrollTop","updateScroll","direction","w1","h1","reference","referenceRect","getWidth","$","setWidth","oldWidth","setHeight","oldHeight","getHeight","getHeader","innerText","setHeader","prompt","getHeaders","asArray","getMeta","key","setMeta","prop","updateMeta","affectedCells","newMeta","getStyle","resetStyle","applyStyle","cellId","currentValue","oneApplication","trim","getComments","withAuthor","setComments","author","getConfig","orderBy","order","confirm","Array","prototype","p","slice","sort","a","b","valueA","toLowerCase","valueB","updateOrderArrow","updateOrder","updateTableReferences","loadPage","moveRow","ignoreDom","resetSearch","indexOf","call","nextSibling","removeChild","splice","insertRow","mixed","numOfRows","lastRow","log","rowIndex","currentRecords","currentData","currentRows","rowRecords","rowData","rowNode","apply","deleteRow","number","getSelectedRows","mergeExists","parentNode","moveColumn","insertColumn","properties","numOfColumns","lastColumn","columnIndex","injectArray","currentHeaders","currentColgroup","historyHeaders","historyColgroup","historyRecords","historyData","currentRecord","deleteColumn","getSelectedColumns","asIds","getHighlighted","mergeCellUpdates","updatePosition","columnIdFrom","columnIdTo","totalX","totalY","updateFormulas","numBlankRows","numBlankCols","setTimeout","showColumn","hideColumn","showIndex","hideIndex","chainLoopProtection","referencesToUpdate","newFormula","letter","testLetter","testNumber","exec","expression","formulaResults","formulaLoopProtection","execute","parentId","tokensUpdate","f","e1","e2","replace","evalstring","eval","parseNumber","res","up","shiftKey","ctrlKey","visible","loadValidation","item","firstChild","loadUp","whichPage","group","get","down","lastChild","loadDown","right","first","selectAll","Math","ceil","startRow","finalRow","currentPage","selectedPage","totalPages","query","addToResult","total","oldPage","quantyOfPages","paginationItem","args","arguments","download","includeHeaders","blob","Blob","navigator","msSaveOrOpenBlob","pom","URL","createObjectURL","href","body","click","changes","delimiter","returnData","colLabel","rowLabel","tmp","RegExp","label","str","strLabel","select","execCommand","hash","parseCSV","newStyle","oldStyle","styleIndex","colIndex","historyProcessRow","historyRecord","historyProcessColumn","undo","redo","combo","charCodeAt","arr","quote","c","cc","nc","chr","destroy","init","current","build","newData","shift","items","comment","shortcut","clipboard","readText","then","scrollControls","timeControlLoading","clientHeight","scrollHeight","target","addEventListener","timeControl","destroyEventHandlers","removeEventListener","keyDownControls","mouseUpControls","mouseDownControls","mouseMoveControls","mouseOverControls","doubleClickControls","pasteControls","contextMenuControls","touchStartControls","touchEndControls","which","preventDefault","altKey","editorTextarea","editorValue","editorIndexOf","selectionStart","selectionEnd","selectedRow","selectedHeader","metaKey","cutControls","copyControls","rowId","keyCode","String","fromCharCode","validLetter","clearTimeout","isMouseAction","event","buttons","mouseButton","button","jexcelTable","getElement","selectedCorner","offsetX","mousePosition","pageX","offsetY","destination","c1","c2","pageY","clientWidth","getCellCoords","newWidth","newHeight","tempWidth","tempHeight","clientX","clientY","enabled","clipboardData","tmpElement","createTabs","tabs","spreadsheet","link","sheetName","fromSpreadsheet","file","__callback","convert","workbook","spreadsheets","SheetNames","forEach","Sheets","wpx","hpx","s","r","max_x","max_y","w","fgColor","rgb","numColumns","oReq","XMLHttpRequest","Uint8Array","responseType","arraybuffer","response","wb","XLSX","read","cellFormula","cellStyles","setRequestHeader","onreadystatechange","readyState","status","ff","convertResponseBodyToText","responseBody","send","regex","idx","concat","t","code","pow","isArray","jexcelSection","jexcelElement","path","jQuery","fn","spreadsheetContainer","nil","Error","div0","ref","na","utils","flattenShallow","array","reduce","aIsArray","bIsArray","isFlat","flatten","argsToArray","arrayEach","numbers","possibleNumbers","cleanFloat","power","round","parseBool","bool","toUpperCase","isNaN","string","parseFloat","parseNumberArray","len","parsed","parseMatrix","matrix","n","pnarr","d1900","UTC","parseDate","getTime","parseDateArray","anyIsError","arrayValuesToNumbers","rest","initial","iteratee","transpose","map","methods","datetime","WEEK_STARTS","WEEK_TYPES","WEEKEND_TYPES","DATE","year","month","day","DATEVALUE","date_text","DAY","serial_number","DAYS","end_date","start_date","serial","DAYS360","EDATE","months","setMonth","EOMONTH","HOUR","getHours","INTERVAL","second","floor","hour","min","sec","ISOWEEKNUM","setHours","getDay","yearStart","MINUTE","getMinutes","MONTH","NETWORKDAYS","holidays","INTL","weekend","NOW","SECOND","getSeconds","TIME","minute","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","WORKDAY","days","YEAR","isLeapYear","YEARFRAC","basis","addOn","database","compact","FINDFIELD","findResultIndex","criterias","matches","maxCriteriaLength","l","currentCriteriaResult","hasMatchingCriteria","criteria","criteriaField","DAVERAGE","field","resultIndexes","targetFields","sum","DCOUNT","DCOUNTA","DGET","DMAX","maxValue","DMIN","minValue","DPRODUCT","targetValues","DSTDEV","DSTDEVP","DSUM","DVAR","DVARP","MATCH","lookupValue","lookupArray","matchType","indexValue","engineering","isValidBinaryNumber","BESSELI","BESSELJ","BESSELK","BESSELY","BIN2DEC","stringified","toString","substring","BIN2HEX","places","REPT","BIN2OCT","BITAND","number1","number2","BITLSHIFT","abs","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","units","binary_prefixes","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki","unit_prefixes","Y","Z","E","P","T","G","M","m","u","z","from","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","alt","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","ERF","lower_bound","upper_bound","PRECISE","ERFC","GESTEP","step","HEX2BIN","negative","HEX2DEC","HEX2OCT","IMABS","inumber","IMREAL","IMAGINARY","sqrt","plus","minus","unit","IMARGUMENT","PI","atan","IMCONJUGATE","IMCOS","cos","exp","sin","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","den","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","financial","validDate","ensureDate","ACCRINT","issue","settlement","rate","par","frequency","ACCRINTM","AMORDEGRC","AMORLINC","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPNCD","COUPNUM","COUPPCD","CUMIPMT","periods","start","end","payment","PMT","interest","FV","CUMPRINC","principal","DB","cost","salvage","life","period","toFixed","ceiling","DDB","factor","DISC","DOLLARDE","dollar","fraction","LN10","LN2","DOLLARFR","DURATION","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","IPMT","present","IRR","values","guess","irrResult","dates","irrResultDeriv","frac","positive","resultRate","epsMax","newRate","epsRate","resultValue","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","PRICEDISC","PRICEMAT","PV","RATE","iterMax","iter","t1","t2","f1","f2","f3","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","maturity","discount","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","information","CELL","ERROR","TYPE","error_val","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISERROR","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISNUMBER","ISODD","ISREF","ISTEXT","N","NA","SHEET","SHEETS","logical","AND","CHOOSE","FALSE","IF","then_value","otherwise_value","IFERROR","valueIfError","IFNA","value_if_na","NOT","OR","TRUE","XOR","SWITCH","targetValue","argc","switchCount","switchSatisfied","defaultClause","math","ABS","ACOS","acos","ACOSH","ACOT","ACOTH","AGGREGATE","ARABIC","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","ASIN","asin","ASINH","ATAN","ATAN2","number_x","number_y","atan2","ATANH","BASE","radix","min_length","max","CEILING","significance","mode","MATH","COMBIN","number_chosen","FACT","COMBINA","COS","COSH","COT","tan","COTH","CSC","CSCH","DECIMAL","DEGREES","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","FLOOR","GCD","INT","LCM","pop","LN","LOG","base","LOG10","MDETERM","MINVERSE","MMULT","MOD","dividend","divisor","modulus","MROUND","MULTINOMIAL","MUNIT","ODD","POWER","PRODUCT","QUOTIENT","numerator","denominator","RADIANS","RAND","random","RANDBETWEEN","ROMAN","ROUND","digits","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","ADD","num1","num2","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","EQ","value1","value2","NE","POW","exponent","SUM","argsKeys","elt","SUMIF","range","SUMIFS","n_range_elements","n_criterias","condition","SUMPRODUCT","SUMSQ","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","misc","UNIQUE","hasElement","FLATTEN","ARGS2ARRAY","REFERENCE","context","opening","JOIN","separator","NUMBERS","NUMERAL","ASC","BAHTTEXT","CHAR","CLEAN","re","CODE","CONCATENATE","trueFound","falseFound","DBCS","DOLLAR","EXACT","text1","text2","FIND","find_text","within_text","FIXED","HTML2TEXT","line","LEFT","LEN","LOWER","MID","begin","NUMBERVALUE","PRONETIC","PROPER","txt","charAt","REGEXEXTRACT","regular_expression","REGEXMATCH","full","REGEXREPLACE","replacement","REPLACE","new_text","RIGHT","SEARCH","foundAt","SPLIT","SUBSTITUTE","old_text","occurrence","TEXT","TRIM","UNICHAR","UNICODE","UPPER","VALUE","stats","SQRT2PI","AVEDEV","AVERAGE","count","AVERAGEA","AVERAGEIF","average_range","average_count","AVERAGEIFS","COUNT","COUNTA","COUNTBLANK","COUNTIN","blanks","COUNTIF","COUNTIFS","COUNTUNIQUE","FISHER","FISHERINV","e2y","FREQUENCY","bins","LARGE","MAX","MAXA","MIN","MINA","MODE","MULT","maxItems","currentItem","SNGL","PERCENTILE","EXC","fl","INC","PERCENTRANK","uniques","PERMUT","PERMUTATIONA","PHI","PROB","probability","lower","upper","sorted","QUARTILE","quart","RANK","AVG","RSQ","data_x","data_y","PEARSON","SMALL","STANDARDIZE","mean","sd","STDEV","VAR","S","STDEVA","VARA","STDEVPA","VARPA","sigma","WEIBULL","DIST","alpha","beta","cumulative","TEST","NORM"],"mappings":"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","sourcesContent":["\r\n/**\r\n * jExcel v3.9.1\r\n *\r\n * Author: Paul Hodel <paul.hodel@gmail.com>\r\n * Website: https://bossanova.uk/jexcel/\r\n * Description: Create amazing web based spreadsheets.\r\n *\r\n * This software is distribute under MIT License\r\n */\r\n\r\n if (! jSuites && typeof(require) === 'function') {\r\n    var jSuites = require('jsuites');\r\n    require('jsuites/dist/jsuites.css');\r\n}\r\n\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jexcel = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\n// Jexcel core object\n\nvar jexcel = (function(el, options) {\n    // Create jexcel object\n    var obj = {};\n    obj.options = {};\n\n    if (! (el instanceof Element || el instanceof HTMLDocument)) {\r\n        console.error('JEXCEL: el is not a valid DOM element');\r\n        return false;\r\n    }\r\n\n    // Loading default configuration\n    var defaults = {\n        // External data\n        url:null,\n        // Data\n        data:null,\n        // Copy behavior\n        copyCompatibility:false,\n        // Rows and columns definitions\n        rows:[],\n        columns:[],\n        // Deprected legacy options\n        colHeaders:[],\n        colWidths:[],\n        colAlignments:[],\n        nestedHeaders:null,\n        // Column width that is used by default\n        defaultColWidth:50,\n        defaultColAlign:'center',\n        // Spare rows and columns\n        minSpareRows:0,\n        minSpareCols:0,\n        // Minimal table dimensions\n        minDimensions:[0,0],\n        // Allow Export\n        allowExport:true,\r\n        // @type {boolean} - Include the header titles on download\n        includeHeadersOnDownload:false,\n        // Allow column sorting\n        columnSorting:true,\n        // Allow column dragging\n        columnDrag:false,\n        // Allow column resizing\n        columnResize:true,\n        // Allow row resizing\n        rowResize:false,\n        // Allow row dragging\n        rowDrag:true,\n        // Allow table edition\n        editable:true,\n        // Allow new rows\n        allowInsertRow:true,\n        // Allow new rows\n        allowManualInsertRow:true,\n        // Allow new columns\n        allowInsertColumn:true,\n        // Allow new rows\n        allowManualInsertColumn:true,\n        // Allow row delete\n        allowDeleteRow:true,\n        // Allow deleting of all rows\n        allowDeletingAllRows:false,\n        // Allow column delete\n        allowDeleteColumn:true,\n        // Allow rename column\n        allowRenameColumn:true,\n        // Allow comments\n        allowComments:false,\n        // Global wrap\n        wordWrap:false,\n        // Image options\n        imageOptions: null,\n        // CSV source\n        csv:null,\n        // Filename\n        csvFileName:'jexcel',\n        // Consider first line as header\n        csvHeaders:true,\n        // Delimiters\n        csvDelimiter:',',\n        // Disable corner selection\n        selectionCopy:true,\n        // Merged cells\n        mergeCells:{},\n        // Create toolbar\n        toolbar:null,\n        // Allow search\n        search:false,\n        // Create pagination\n        pagination:false,\n        paginationOptions:null,\n        // Full screen\n        fullscreen:false,\n        // Lazy loading\n        lazyLoading:false,\n        loadingSpin:false,\n        // Table overflow\n        tableOverflow:false,\n        tableHeight:'300px',\n        tableWidth:null,\n        // Meta\n        meta: null,\n        // Style\n        style:null,\n        // Execute formulas\n        parseFormulas:true,\n        autoIncrement:true,\n        autoCasting:true,\n        // Event handles\n        onundo:null,\n        onredo:null,\n        onload:null,\n        onchange:null,\n        onbeforechange:null,\n        onafterchanges:null,\n        onbeforeinsertrow: null,\n        oninsertrow:null,\n        onbeforeinsertcolumn: null,\n        oninsertcolumn:null,\n        onbeforedeleterow:null,\n        ondeleterow:null,\n        onbeforedeletecolumn:null,\n        ondeletecolumn:null,\n        onmoverow:null,\n        onmovecolumn:null,\n        onresizerow:null,\n        onresizecolumn:null,\n        onsort:null,\n        onselection:null,\n        onpaste:null,\n        onbeforepaste:null,\n        onmerge:null,\n        onfocus:null,\n        onblur:null,\n        onchangeheader:null,\n        oneditionstart:null,\n        oneditionend:null,\n        onchangestyle:null,\n        onchangemeta:null,\n        onchangepage:null,\n        // Customize any cell behavior\n        updateTable:null,\n        // Detach the HTML table when calling updateTable\r\n        detachForUpdates: false,\n        // Texts\n        text:{\n            noRecordsFound: 'No records found',\n            showingPage: 'Showing page {0} of {1} entries',\n            show: 'Show ',\n            search: 'Search',\n            entries: ' entries',\n            columnName: 'Column name',\n            insertANewColumnBefore: 'Insert a new column before',\n            insertANewColumnAfter: 'Insert a new column after',\n            deleteSelectedColumns: 'Delete selected columns',\n            renameThisColumn: 'Rename this column',\n            orderAscending: 'Order ascending',\n            orderDescending: 'Order descending',\n            insertANewRowBefore: 'Insert a new row before',\n            insertANewRowAfter: 'Insert a new row after',\n            deleteSelectedRows: 'Delete selected rows',\n            editComments: 'Edit comments',\n            addComments: 'Add comments',\n            comments: 'Comments',\n            clearComments: 'Clear comments',\n            copy: 'Copy...',\n            paste: 'Paste...',\n            saveAs: 'Save as...',\n            about: 'About',\n            areYouSureToDeleteTheSelectedRows: 'Are you sure to delete the selected rows?',\n            areYouSureToDeleteTheSelectedColumns: 'Are you sure to delete the selected columns?',\n            thisActionWillDestroyAnyExistingMergedCellsAreYouSure: 'This action will destroy any existing merged cells. Are you sure?',\n            thisActionWillClearYourSearchResultsAreYouSure: 'This action will clear your search results. Are you sure?',\n            thereIsAConflictWithAnotherMergedCell: 'There is a conflict with another merged cell',\n            invalidMergeProperties: 'Invalid merged properties',\n            cellAlreadyMerged: 'Cell already merged',\n            noCellsSelected: 'No cells selected',\n        },\n        // About message\n        about:\"jExcel CE Spreadsheet\\nVersion 3.9.1\\nAuthor: Paul Hodel <paul.hodel@gmail.com>\\nWebsite: https://bossanova.uk/jexcel/v3\",\n    };\n\n    // Loading initial configuration from user\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            if (property === 'text') {\r\n                obj.options[property] = defaults[property];\r\n                for (var textKey in options[property]) {\r\n                    if (options[property].hasOwnProperty(textKey)){\r\n                        obj.options[property][textKey] = options[property][textKey];\r\n                    }\r\n                }\r\n            } else {\r\n                obj.options[property] = options[property];\n            }\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Global elements\n    obj.el = el;\n    obj.corner = null;\n    obj.contextMenu = null;\n    obj.textarea = null;\n    obj.ads = null;\n    obj.content = null;\n    obj.table = null;\n    obj.thead = null;\n    obj.tbody = null;\n    obj.rows = [];\n    obj.results = null;\n    obj.searchInput = null;\n    obj.toolbar = null;\n    obj.pagination = null;\n    obj.pageNumber = null;\n    obj.headerContainer = null;\n    obj.colgroupContainer = null;\n\n    // Containers\n    obj.headers = [];\n    obj.records = [];\n    obj.history = [];\n    obj.formula = [];\n    obj.colgroup = [];\n    obj.selection = [];\n    obj.highlighted  = [];\n    obj.selectedCell = null;\n    obj.selectedContainer = null;\n    obj.style = [];\n    obj.data = null;\n\n    // Internal controllers\n    obj.cursor = null;\n    obj.historyIndex = -1;\n    obj.ignoreEvents = false;\n    obj.ignoreHistory = false;\n    obj.edition = null;\n    obj.hashString = null;\n    obj.resizing = null;\n    obj.dragging = null;\n\n    // Lazy loading\n    if (obj.options.lazyLoading == true && (obj.options.tableOverflow == false && obj.options.fullscreen == false)) {\n        console.error('JEXCEL: The lazyloading only works when tableOverflow = yes or fullscreen = yes');\n        obj.options.lazyLoading = false;\n    }\n    \n    /**\n     * Activate/Disable fullscreen \n     * use programmatically : table.fullscreen(); or table.fullscreen(true); or table.fullscreen(false);\n     * @Param {boolean} activate\n     */\n    obj.fullscreen = function(activate) {\n        // If activate not defined, get reverse options.fullscreen\n        if (activate == null) {\n            activate = ! obj.options.fullscreen;\n        }\n\n        // If change\n        if (obj.options.fullscreen != activate) {\n            obj.options.fullscreen = activate;\n\n            // Test LazyLoading conflict\n            if (activate == true) {\n                el.classList.add('fullscreen');\n            } else {\n                el.classList.remove('fullscreen');\n            }\n        } \n    }\n\n    /**\n     * Prepare the jexcel table\n     * \n     * @Param config\n     */\n    obj.prepareTable = function() {\n        // Loading initial data from remote sources\n        var results = [];\n\n        // Number of columns\n        var size = obj.options.columns.length;\n\n        if (obj.options.data && typeof(obj.options.data[0]) !== 'undefined') {\n            // Data keys\n            var keys = Object.keys(obj.options.data[0]);\n\n            if (keys.length > size) {\n                size = keys.length;\n            }\n        }\n\n        // Minimal dimensions\n        if (obj.options.minDimensions[0] > size) {\n            size = obj.options.minDimensions[0];\n        }\n\n        // Requests\n        var multiple = [];\n\n        // Preparations\n        for (var i = 0; i < size; i++) {\n            // Deprected options. You should use only columns\n            if (! obj.options.colHeaders[i]) {\n                obj.options.colHeaders[i] = '';\n            }\n            if (! obj.options.colWidths[i]) {\n                obj.options.colWidths[i] = obj.options.defaultColWidth;\n            }\n            if (! obj.options.colAlignments[i]) {\n                obj.options.colAlignments[i] = obj.options.defaultColAlign;\n            }\n\n            // Default column description\n            if (! obj.options.columns[i]) {\n                obj.options.columns[i] = { type:'text' };\n            } else if (! obj.options.columns[i].type) {\n                obj.options.columns[i].type = 'text';\n            }\n            if (! obj.options.columns[i].name) {\n                obj.options.columns[i].name = keys && keys[i] ? keys[i] : i;\n            }\n            if (! obj.options.columns[i].source) {\n                obj.options.columns[i].source = [];\n            }\n            if (! obj.options.columns[i].options) {\n                obj.options.columns[i].options = [];\n            }\n            if (! obj.options.columns[i].editor) {\n                obj.options.columns[i].editor = null;\n            }\n            if (! obj.options.columns[i].allowEmpty) {\n                obj.options.columns[i].allowEmpty = false;\n            }\n            if (! obj.options.columns[i].title) {\n                obj.options.columns[i].title = obj.options.colHeaders[i] ? obj.options.colHeaders[i] : '';\n            }\n            if (! obj.options.columns[i].width) {\n                obj.options.columns[i].width = obj.options.colWidths[i] ? obj.options.colWidths[i] : obj.options.defaultColWidth;\n            }\n            if (! obj.options.columns[i].align) {\n                obj.options.columns[i].align = obj.options.colAlignments[i] ? obj.options.colAlignments[i] : 'center';\n            }\n\n            // Pre-load initial source for json autocomplete\n            if (obj.options.columns[i].type == 'autocomplete' || obj.options.columns[i].type == 'dropdown') {\n                // if remote content\n                if (obj.options.columns[i].url) {\n                    multiple.push(jSuites.ajax({\n                        url: obj.options.columns[i].url,\n                        index: i,\n                        method: 'GET',\n                        dataType: 'json',\n                        multiple: multiple,\n                        success: function(data) {\n                            var source = [];\n                            for (var i = 0; i < data.length; i++) {\n                                obj.options.columns[this.index].source.push(data[i]);\n                            }\n                        },\n                        complete: function() {\n                            obj.createTable();\n                        }\n                    }));\n                }\n            } else if (obj.options.columns[i].type == 'calendar') {\n                // Default format for date columns\n                if (! obj.options.columns[i].options.format) {\n                    obj.options.columns[i].options.format = 'DD/MM/YYYY';\n                }\n            }\n        }\n\n        // On complete\n        if (! multiple.length) {\n            obj.createTable();\n        }\n    }\n\n    obj.createTable = function() {\n        // Elements\n        obj.table = document.createElement('table');\n        obj.thead = document.createElement('thead');\n        obj.tbody = document.createElement('tbody');\n\n        // Create headers controllers\n        obj.headers = [];\n        obj.colgroup = [];\n\n        // Create table container\n        obj.content = document.createElement('div');\n        obj.content.classList.add('jexcel_content');\n\n        // Create toolbar object\n        obj.toolbar = document.createElement('div');\n        obj.toolbar.classList.add('jexcel_toolbar');\n\n        // Search\n        var searchContainer = document.createElement('div');\n        var searchText = document.createTextNode((obj.options.text.search) + ': ');\n        obj.searchInput = document.createElement('input');\n        obj.searchInput.classList.add('jexcel_search');\n        searchContainer.appendChild(searchText);\n        searchContainer.appendChild(obj.searchInput);\n        obj.searchInput.onfocus = function() {\n            obj.resetSelection();\n        }\n\n        // Pagination select option\n        var paginationUpdateContainer = document.createElement('div');\n\n        if (obj.options.pagination > 0 && obj.options.paginationOptions && obj.options.paginationOptions.length > 0) {\n            obj.paginationDropdown = document.createElement('select');\n            obj.paginationDropdown.classList.add('jexcel_pagination_dropdown');\n            obj.paginationDropdown.onchange = function() {\n                obj.options.pagination = parseInt(this.value);\n                obj.page(0);\n            }\n\n            for (var i = 0; i < obj.options.paginationOptions.length; i++) {\n                var temp = document.createElement('option');\n                temp.value = obj.options.paginationOptions[i];\n                temp.innerHTML = obj.options.paginationOptions[i];\n                obj.paginationDropdown.appendChild(temp);\n            }\n\n            paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.show));\n            paginationUpdateContainer.appendChild(obj.paginationDropdown);\n            paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.entries));\n        }\n\n        // Filter and pagination container\n        obj.filter = document.createElement('div');\n        obj.filter.classList.add('jexcel_filter');\n        obj.filter.appendChild(paginationUpdateContainer);\n        obj.filter.appendChild(searchContainer);\n\n        // Colsgroup\n        obj.colgroupContainer = document.createElement('colgroup');\n        var tempCol = document.createElement('col');\n        tempCol.setAttribute('width', '50');\n        obj.colgroupContainer.appendChild(tempCol);\n\n        // Nested\n        if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n            // Flexible way to handle nestedheaders\n            if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                    obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[j]));\n                }\n            } else {\n                obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));\n            }\n        }\n\n        // Row\n        obj.headerContainer = document.createElement('tr');\n        var tempCol = document.createElement('td');\n        tempCol.classList.add('jexcel_selectall');\n        obj.headerContainer.appendChild(tempCol);\n\n        for (var i = 0; i < obj.options.columns.length; i++) {\n            // Create header\n            obj.createCellHeader(i);\n            // Append cell to the container\n            obj.headerContainer.appendChild(obj.headers[i]);\n            obj.colgroupContainer.appendChild(obj.colgroup[i]);\n        }\n\n        obj.thead.appendChild(obj.headerContainer);\n\n        // Content table\n        obj.table = document.createElement('table');\n        obj.table.classList.add('jexcel');\n        obj.table.setAttribute('cellpadding', '0');\n        obj.table.setAttribute('cellspacing', '0');\n        obj.table.setAttribute('unselectable', 'yes');\n        obj.table.setAttribute('onselectstart', 'return false');\n        obj.table.appendChild(obj.colgroupContainer);\n        obj.table.appendChild(obj.thead);\n        obj.table.appendChild(obj.tbody);\n\n        // Spreadsheet corner\n        obj.corner = document.createElement('div');\n        obj.corner.className = 'jexcel_corner';\n        obj.corner.setAttribute('unselectable', 'on');\n        obj.corner.setAttribute('onselectstart', 'return false');\n\n        if (obj.options.selectionCopy == false) {\n            obj.corner.style.display = 'none';\n        }\n\n        // Textarea helper\n        obj.textarea = document.createElement('textarea');\n        obj.textarea.className = 'jexcel_textarea';\n        obj.textarea.id = 'jexcel_textarea';\n        obj.textarea.tabIndex = '-1';\r\n\n        // Contextmenu container\n        obj.contextMenu = document.createElement('div');\n        obj.contextMenu.className = 'jexcel_contextmenu';\n\n        // Create element\n        jSuites.contextmenu(obj.contextMenu, {\n            onclick:function() {\n                obj.contextMenu.contextmenu.close(false);\n            }\n        });\n\n        // Powered by jExcel\r\n        var ads = document.createElement('a');\r\n        ads.setAttribute('href', 'https://bossanova.uk/jexcel/');\r\n        obj.ads = document.createElement('div');\r\n        obj.ads.className = 'jexcel_about';\r\n        if (typeof(sessionStorage) !== \"undefined\" && ! sessionStorage.getItem('jexcel')) {\r\n            sessionStorage.setItem('jexcel', true);\r\n            var img = document.createElement('img');\r\n            img.src = '//bossanova.uk/jexcel/logo.png';\r\n            ads.appendChild(img);\r\n        }\r\n        var span = document.createElement('span');\r\n        span.innerHTML = 'Jexcel spreadsheet';\r\n        ads.appendChild(span);\r\n        obj.ads.appendChild(ads);\n\n        // Create table container TODO: frozen columns\n        var container = document.createElement('div');\n        container.classList.add('jexcel_table');\n\n        // Pagination\n        obj.pagination = document.createElement('div');\n        obj.pagination.classList.add('jexcel_pagination');\n        var paginationInfo = document.createElement('div');\n        var paginationPages = document.createElement('div');\n        obj.pagination.appendChild(paginationInfo);\n        obj.pagination.appendChild(paginationPages);\n\n        // Hide pagination if not in use\r\n        if (! obj.options.pagination) {\r\n            obj.pagination.style.display = 'none';\r\n        }\r\n\n        // Append containers to the table\n        if (obj.options.search == true) {\n            el.appendChild(obj.filter);\n        }\n\n        // Elements\n        obj.content.appendChild(obj.table);\n        obj.content.appendChild(obj.corner);\n        obj.content.appendChild(obj.textarea);\n\n        el.appendChild(obj.toolbar);\n        el.appendChild(obj.content);\n        el.appendChild(obj.pagination);\n        el.appendChild(obj.contextMenu);\n        el.appendChild(obj.ads);\n        el.classList.add('jexcel_container');\n\n        // Create toolbar\n        if (obj.options.toolbar && obj.options.toolbar.length) {\n            obj.createToolbar();\n        }\n\n        // Fullscreen\n        if (obj.options.fullscreen == true) {\n            el.classList.add('fullscreen');\n        } else {\n            // Overflow\n            if (obj.options.tableOverflow == true) {\n                if (obj.options.tableHeight) {\n                    obj.content.style['overflow-y'] = 'auto';\n                    obj.content.style.maxHeight = obj.options.tableHeight;\n                }\n                if (obj.options.tableWidth) {\n                    obj.content.style['overflow-x'] = 'auto';\n                    obj.content.style.width = obj.options.tableWidth;\n                }\n            }\n        }\n\n        // With toolbars\n        if (obj.options.tableOverflow != true && obj.options.toolbar) {\n            el.classList.add('with-toolbar');\n        }\n\n        // Actions\n        if (obj.options.columnDrag == true) {\n            obj.thead.classList.add('draggable');\n        }\n        if (obj.options.columnResize == true) {\n            obj.thead.classList.add('resizable');\n        }\n        if (obj.options.rowDrag == true) {\n            obj.tbody.classList.add('draggable');\n        }\n        if (obj.options.rowResize == true) {\n            obj.tbody.classList.add('resizable');\n        }\n\n        // Load data\n        obj.setData();\n\n        // Style\n        if (obj.options.style) {\n            obj.setStyle(obj.options.style, null, null, 1, 1);\n        }\n    }\n\r\n    /**\r\n     * Refresh the data\r\n     * \r\n     * @return void\r\n     */\r\n    obj.refresh = function() {\r\n        if (obj.options.url) {\r\n            // Loading\r\n            if (obj.options.loadingSpin == true) {\r\n                jSuites.loading.show();\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Data\r\n                    obj.options.data = (result.data) ? result.data : result;\r\n                    // Prepare table\r\n                    obj.setData();\r\n                    // Hide spin\r\n                    if (obj.options.loadingSpin == true) {\r\n                        jSuites.loading.hide();\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            obj.setData();\r\n        }\r\n    }\r\n\n    /**\n     * Set data\n     * \n     * @param array data In case no data is sent, default is reloaded\n     * @return void\n     */\n    obj.setData = function(data) {\n        // Update data\n        if (data) {\n            if (typeof(data) == 'string') {\n                data = JSON.parse(data);\n            }\n\n            obj.options.data = data;\n        }\n\n        // Data\n        if (! obj.options.data) {\n            obj.options.data = [];\n        }\n\n        // Prepare data\n        if (obj.options.data) {\n            var data = [];\n            for (var j = 0; j < obj.options.data.length; j++) {\n                var row = [];\n                for (var i = 0; i < obj.options.columns.length; i++) {\n                    row[i] = obj.options.data[j][obj.options.columns[i].name];\n                }\n                data.push(row);\n            }\n\n            obj.options.data = data;\n        }\n\n        // Adjust minimal dimensions\n        var j = 0;\n        var i = 0;\n        var size_i = obj.options.columns.length;\n        var size_j = obj.options.data.length;\n        var min_i = obj.options.minDimensions[0];\n        var min_j = obj.options.minDimensions[1];\n        var max_i = min_i > size_i ? min_i : size_i;\n        var max_j = min_j > size_j ? min_j : size_j;\n\n        for (j = 0; j < max_j; j++) {\n            for (i = 0; i < max_i; i++) {\n                if (obj.options.data[j] == undefined) {\n                    obj.options.data[j] = [];\n                }\n\n                if (obj.options.data[j][i] == undefined) {\n                    obj.options.data[j][i] = '';\n                }\n            }\n        }\n\n        // Reset containers\n        obj.rows = [];\n        obj.results = null;\n        obj.records = [];\n        obj.history = [];\n\n        // Reset internal controllers\n        obj.historyIndex = -1;\n\n        // Reset data\n        obj.tbody.innerHTML = '';\n\n        // Lazy loading\n        if (obj.options.lazyLoading == true) {\n            // Load only 100 records\n            var startNumber = 0\n            var finalNumber = obj.options.data.length < 100 ? obj.options.data.length : 100;\n\n            if (obj.options.pagination) {\n                obj.options.pagination = false;\n                console.error('JEXCEL: Pagination will be disable due the lazyLoading');\n            }\n        } else if (obj.options.pagination) {\n            // Pagination\n            if (! obj.pageNumber) {\n                obj.pageNumber = 0;\n            }\n            var quantityPerPage = obj.options.pagination;\n            startNumber = (obj.options.pagination * obj.pageNumber);\n            finalNumber = (obj.options.pagination * obj.pageNumber) + obj.options.pagination;\n\n            if (obj.options.data.length < finalNumber) {\n                finalNumber = obj.options.data.length;\n            }\n        } else {\n            var startNumber = 0;\n            var finalNumber = obj.options.data.length;\n        }\n\n        // Append nodes to the HTML\n        for (j = 0; j < obj.options.data.length; j++) {\n            // Create row\n            var tr = obj.createRow(j, obj.options.data[j]);\n            // Append line to the table\n            if (j >= startNumber && j < finalNumber) {\n                obj.tbody.appendChild(tr);\n            }\n        }\n\n        if (obj.options.lazyLoading == true) {\n            // Do not create pagination with lazyloading activated\n        } else if (obj.options.pagination) {\n            obj.updatePagination();\n        }\n\n        // Merge cells\n        if (obj.options.mergeCells) {\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                var num = obj.options.mergeCells[keys[i]];\n                obj.setMerge(keys[i], num[0], num[1], 1);\n            }\n        }\n\n        // Updata table with custom configurations if applicable\n        obj.updateTable();\n\n        // Onload\n        if (! obj.ignoreEvents) {\n            if (typeof(obj.options.onload) == 'function') {\n                obj.options.onload(el, obj);\n            }\n        }\n    }\n\n    /**\n     * Get the whole table data\n     * \n     * @param bool get highlighted cells only\n     * @return array data\n     */\n        obj.getData = function(highlighted, dataOnly) {\n        // Control vars\n        var dataset = [];\n        var px = 0;\n        var py = 0;\n\n        // Data type\r\n        var dataType = dataOnly == true || obj.options.copyCompatibility == false ? true : false;\r\n\n        // Column and row length\n        var x = obj.options.columns.length\n        var y = obj.options.data.length\n\n        // Go through the columns to get the data\n        for (var j = 0; j < y; j++) {\n            px = 0;\n            for (var i = 0; i < x; i++) {\n                // Cell selected or fullset\n                if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                    // Get value\n                    if (! dataset[py]) {\n                        dataset[py] = [];\n                    }\n                    if (! dataType) {\n                        dataset[py][px] = obj.records[j][i].innerHTML;\n                    } else {\n                        dataset[py][px] = obj.options.data[j][i];\n                    }\n                    px++;\n                }\n            }\n            if (px > 0) {\n                py++;\n            }\n       }\n\n       return dataset;\n    }\n\n    /**\n     * Get the whole table data\n     * \n     * @param integer row number\n     * @return string value\n     */\n    obj.getJson = function(highlighted) {\n        // Control vars\n        var data = [];\n\n        // Column and row length\n        var x = obj.options.columns.length\n        var y = obj.options.data.length\n\n        // Go through the columns to get the data\n        for (var j = 0; j < y; j++) {\n            var row = null;\n            for (var i = 0; i < x; i++) {\n                if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                    if (row == null) {\n                        row = {};\n                    }\n                    row[obj.options.columns[i].name] = obj.options.data[j][i];\n                }\n            }\n\n            if (row != null) {\n                data.push(row);\n            }\n       }\n\n       return data;\n    }\n\n    /**\n     * Get a row data by rowNumber\n     */\n    obj.getRowData = function(rowNumber) {\n        return obj.options.data[rowNumber];\n    }\n\n    /**\n     * Set a row data by rowNumber\n     */\n    obj.setRowData = function(rowNumber, data) {\n        for (var i = 0; i < obj.headers.length; i++) {\n            // Update cell\n            var columnName = jexcel.getColumnNameFromId([ i, rowNumber ]);\n            // Set value\n            if (data[i] != null) {\n                obj.setValue(columnName, data[i]);\n            }\n        }\n    }\n\n    /**\n     * Get a column data by columnNumber\n     */\n    obj.getColumnData = function(columnNumber) {\n        var dataset = [];\n        // Go through the rows to get the data\n        for (var j = 0; j < obj.options.data.length; j++) {\n            dataset.push(obj.options.data[j][columnNumber]);\n        }\n        return dataset;\n    }\n\n    /**\n     * Set a column data by colNumber\n     */\n    obj.setColumnData = function(colNumber, data) {\n        for (var j = 0; j < obj.rows.length; j++) {\n            // Update cell\n            var columnName = jexcel.getColumnNameFromId([ colNumber, j ]);\n            // Set value\n            if (data[j] != null) {\n                obj.setValue(columnName, data[j]);\n            }\n        }\n    }\n\n    /**\n     * Create row\n     */\n    obj.createRow = function(j, data) {\n        // Create container\n        if (! obj.records[j]) {\n            obj.records[j] = [];\n        }\n        // Default data\n        if (! data) {\n            var data = obj.options.data[j];\n        }\n        // New line of data to be append in the table\n        obj.rows[j] = document.createElement('tr');\n        obj.rows[j].setAttribute('data-y', j);\n        // Definitions\n        if (obj.options.rows[j]) {\n            if (obj.options.rows[j].height) {\n                obj.rows[j].style.height = obj.options.rows[j].height;\n            }\n        }\n        // Row number label\n        var td = document.createElement('td');\n        td.innerHTML = parseInt(j + 1);\n        td.setAttribute('data-y', j);\n        td.className = 'jexcel_row';\n        obj.rows[j].appendChild(td);\n\n        // Data columns\n        for (i = 0; i < obj.options.columns.length; i++) {\n            // New column of data to be append in the line\n            obj.records[j][i] = obj.createCell(i, j, data[i]);\n            // Add column to the row\n            obj.rows[j].appendChild(obj.records[j][i]);\n        }\n\n        // Add row to the table body\n        return obj.rows[j];\n    }\n\n    /**\n     * Create cell\n     */\n    obj.createCell = function(i, j, value) {\n        // Create cell and properties\n        var td = document.createElement('td');\n        td.setAttribute('data-x', i);\n        td.setAttribute('data-y', j);\n        // Hidden column\n        if (obj.options.columns[i].type == 'hidden') {\n            td.style.display = 'none';\n            td.innerHTML = value;\n        } else if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\n            // Create input\n            var element = document.createElement('input');\n            element.type = obj.options.columns[i].type;\n            element.name = 'c' + i;\n            element.checked = (value == 1 || value == true || value == 'true') ? true : false;\n            element.onclick = function() {\n                obj.setValue(td, this.checked);\n            }\n\n            if (obj.options.columns[i].readOnly == true) {\n                element.setAttribute('disabled', 'disabled');\n            }\n\n            // Append to the table\n            td.appendChild(element);\n            // Make sure the values are correct\n            obj.options.data[j][i] = element.checked;\n        } else if (obj.options.columns[i].type == 'calendar') {\n            // Try formatted date\n            var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[i].options.format);\n            // Create calendar cell\n            td.innerHTML = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[i].options.format);\n        } else if (obj.options.columns[i].type == 'dropdown' || obj.options.columns[i].type == 'autocomplete') {\n            // Create dropdown cell\n            td.classList.add('jexcel_dropdown');\n            td.innerHTML = obj.getDropDownValue(i, value);\n        } else if (obj.options.columns[i].type == 'color') {\n            if (obj.options.columns[i].render == 'square') {\n                var color = document.createElement('div');\n                color.className = 'color';\n                color.style.backgroundColor = value;\n                td.appendChild(color);\n            } else {\n                td.style.color = value;\n                td.innerHTML = value;\n            }\n        } else if (obj.options.columns[i].type == 'image') {\n            if (value && value.substr(0, 10) == 'data:image') {\n                var img = document.createElement('img');\n                img.src = value;\n                td.appendChild(img);\n            }\n        } else {\n            if ((''+value).substr(0,1) == '=' && obj.options.parseFormulas == true) {\n                value = obj.executeFormula(value, i, j)\n            }\n            if (obj.options.columns[i].mask) {\n                var decimal = obj.options.columns[i].decimal || '.';\n                value = '' + jSuites.mask.run(value, obj.options.columns[i].mask, decimal);\n            }\n\n            td.innerHTML = value;\n        }\n\n        // Readonly\n        if (obj.options.columns[i].readOnly == true) {\n            td.className = 'readonly';\n        }\n\n        // Text align\n        var colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\n        td.style.textAlign = colAlign;\n\n        // Wrap option\n        if (obj.options.columns[i].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[i].wordWrap == true || td.innerHTML.length > 200)) {\n            td.style.whiteSpace = 'pre-wrap';\n        }\n\n        // Overflow\n        if (i > 0) {\n            if (value || td.innerHTML) {\n                obj.records[j][i-1].style.overflow = 'hidden';\n            } else {\n                if (i == obj.options.columns.length - 1) {\n                    td.style.overflow = 'hidden';\n                }\n            }\n        }\n\n        return td;\n    }\n\n    obj.createCellHeader = function(colNumber) {\n        // Create col global control\n        var colWidth = obj.options.columns[colNumber].width ? obj.options.columns[colNumber].width : obj.options.defaultColWidth;\n        var colAlign = obj.options.columns[colNumber].align ? obj.options.columns[colNumber].align : obj.options.defaultColAlign;\n\n        // Create header cell\n        obj.headers[colNumber] = document.createElement('td');\n        obj.headers[colNumber].innerHTML = obj.options.columns[colNumber].title ? obj.options.columns[colNumber].title : jexcel.getColumnName(colNumber);\n        obj.headers[colNumber].setAttribute('data-x', colNumber);\n        obj.headers[colNumber].style.textAlign = colAlign;\n        if (obj.options.columns[colNumber].title) {\n            obj.headers[colNumber].setAttribute('title', obj.options.columns[colNumber].title);\n        }\n\n        // Width control\n        obj.colgroup[colNumber] = document.createElement('col');\n        obj.colgroup[colNumber].setAttribute('width', colWidth);\n\n        // Hidden column\n        if (obj.options.columns[colNumber].type == 'hidden') {\n            obj.headers[colNumber].style.display = 'none';\n            obj.colgroup[colNumber].style.display = 'none';\n        }\n    }\n\n    obj.createNestedHeader = function(nestedInformation) {\n        var tr = document.createElement('tr');\n        tr.classList.add('jexcel_nested');\n        var td = document.createElement('td');\n        tr.appendChild(td);\n\n        var headerIndex = 0;\n        for (var i = 0; i < nestedInformation.length; i++) {\n            // Default values\n            if (! nestedInformation[i].colspan) {\n                nestedInformation[i].colspan = 1;\n            }\n            if (! nestedInformation[i].align) {\n                nestedInformation[i].align = 'center';\n            }\n            if (! nestedInformation[i].title) {\n                nestedInformation[i].title = '';\n            }\n\n            // Number of columns\n            var numberOfColumns = nestedInformation[i].colspan;\n\n            // Classes container\n            var column = [];\n            // Header classes for this cell\n            for (var x = 0; x < numberOfColumns; x++) {\n                if (obj.options.columns[headerIndex] && obj.options.columns[headerIndex].type == 'hidden') {\n                    numberOfColumns++;\n                }\n                column.push(headerIndex);\n                headerIndex++;\n            }\n\n            // Created the nested cell\n            var td = document.createElement('td');\n            td.setAttribute('data-column', column.join(','));\n            td.setAttribute('colspan', nestedInformation[i].colspan);\n            td.setAttribute('align', nestedInformation[i].align);\n            td.innerHTML = nestedInformation[i].title;\n            tr.appendChild(td);\n        }\n\n        return tr;\n    }\n\n    /**\n     * Create toolbar\n     */\n    obj.createToolbar = function(toolbar) {\n        if (toolbar) {\n            obj.options.toolbar = toolbar;\n        } else {\n            var toolbar = obj.options.toolbar;\n        }\n\n        for (var i = 0; i < toolbar.length; i++) {\n            if (toolbar[i].type == 'i') {\n                var toolbarItem = document.createElement('i');\n                toolbarItem.classList.add('jexcel_toolbar_item');\n                toolbarItem.classList.add('material-icons');\n                toolbarItem.setAttribute('data-k', toolbar[i].k);\n                toolbarItem.setAttribute('data-v', toolbar[i].v);\n                // Tooltip\n                if (toolbar[i].tooltip) {\n                    toolbarItem.setAttribute('title', toolbar[i].tooltip);\n                }\n                // Handle click\n                if (toolbar[i].onclick && typeof(toolbar[i].onclick)) {\n                    toolbarItem.onclick = toolbar[i].onclick;\n                } else {\n                    toolbarItem.onclick = function() {\n                        var k = this.getAttribute('data-k');\n                        var v = this.getAttribute('data-v');\n                        obj.setStyle(obj.highlighted, k, v);\n                    }\n                }\n                // Append element\n                toolbarItem.innerHTML = toolbar[i].content;\n                obj.toolbar.appendChild(toolbarItem);\n            } else if (toolbar[i].type == 'select') {\n               var toolbarItem = document.createElement('select');\n               toolbarItem.classList.add('jexcel_toolbar_item');\n               toolbarItem.setAttribute('data-k', toolbar[i].k);\n               // Tooltip\n               if (toolbar[i].tooltip) {\n                   toolbarItem.setAttribute('title', toolbar[i].tooltip);\n               }\n               // Handle onchange\n               if (toolbar[i].onchange && typeof(toolbar[i].onchange)) {\n                   toolbarItem.onchange = toolbar[i].onchange;\n               } else {\n                   toolbarItem.onchange = function() {\n                       var k = this.getAttribute('data-k');\n                       obj.setStyle(obj.highlighted, k, this.value);\n                   }\n               }\n               // Add options to the dropdown\n               for(var j = 0; j < toolbar[i].v.length; j++) {\n                    var toolbarDropdownOption = document.createElement('option');\n                    toolbarDropdownOption.value = toolbar[i].v[j];\n                    toolbarDropdownOption.innerHTML = toolbar[i].v[j];\n                    toolbarItem.appendChild(toolbarDropdownOption);\n               }\n               obj.toolbar.appendChild(toolbarItem);\n            } else if (toolbar[i].type == 'color') {\n                 var toolbarItem = document.createElement('i');\n                 toolbarItem.classList.add('jexcel_toolbar_item');\n                 toolbarItem.classList.add('material-icons');\n                 toolbarItem.setAttribute('data-k', toolbar[i].k);\n                 toolbarItem.setAttribute('data-v', '');\n                 // Tooltip\n                 if (toolbar[i].tooltip) {\n                     toolbarItem.setAttribute('title', toolbar[i].tooltip);\n                 }\n                 obj.toolbar.appendChild(toolbarItem);\n                 toolbarItem.onclick = function() {\n                     this.color.open();\n                 }\n                 toolbarItem.innerHTML = toolbar[i].content;\n                 jSuites.color(toolbarItem, {\n                     onchange:function(o, v) {\n                         var k = o.getAttribute('data-k');\n                         obj.setStyle(obj.highlighted, k, v);\n                     }\n                 });\n            }\n        }\n    }\n\n    /**\n     * Merge cells\n     * @param cellName\n     * @param colspan\n     * @param rowspan\n     * @param ignoreHistoryAndEvents\n     */\n    obj.setMerge = function(cellName, colspan, rowspan, ignoreHistoryAndEvents) {\n        var test = false;\n\n        if (! cellName) {\n            if (! obj.highlighted.length) {\n                alert(obj.options.text.noCellsSelected);\n                return null;\n            } else {\n                var x1 = parseInt(obj.highlighted[0].getAttribute('data-x'));\n                var y1 = parseInt(obj.highlighted[0].getAttribute('data-y'));\n                var x2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-x'));\n                var y2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-y'));\n                var cellName = jexcel.getColumnNameFromId([ x1, y1 ]);\n                var colspan = (x2 - x1) + 1;\n                var rowspan = (y2 - y1) + 1;\n            }\n        }\n\n        var cell = jexcel.getIdFromColumnName(cellName, true);\n\n        if (obj.options.mergeCells[cellName]) {\n            if (obj.records[cell[1]][cell[0]].getAttribute('data-merged')) {\n                test = obj.options.text.cellAlreadyMerged;\n            }\n        } else if ((! colspan || colspan < 2) && (! rowspan || rowspan < 2)) {\n            test = obj.options.text.invalidMergeProperties;\n        } else {\n            var cells = [];\n            for (var j = cell[1]; j < cell[1] + rowspan; j++) {\n                for (var i = cell[0]; i < cell[0] + colspan; i++) {\n                    var columnName = jexcel.getColumnNameFromId([i, j]);\n                    if (obj.records[j][i].getAttribute('data-merged')) {\n                        test = obj.options.text.thereIsAConflictWithAnotherMergedCell;\n                    }\n                }\n            }\n        }\n\n        if (test) {\n            alert(test);\n        } else {\n            // Add property\n            if (colspan > 1) {\n                obj.records[cell[1]][cell[0]].setAttribute('colspan', colspan);\n            } else {\n                colspan = 1;\n            }\n            if (rowspan > 1) {\n                obj.records[cell[1]][cell[0]].setAttribute('rowspan', rowspan);\n            } else {\n                rowspan = 1;\n            }\n            // Keep links to the existing nodes\n            obj.options.mergeCells[cellName] = [ colspan, rowspan, [] ];\n            // Mark cell as merged\n            obj.records[cell[1]][cell[0]].setAttribute('data-merged', 'true');\n            // Overflow\n            obj.records[cell[1]][cell[0]].style.overflow = 'hidden';\n            // History data\n            var data = [];\n            // Adjust the nodes\n            for (var y = cell[1]; y < cell[1] + rowspan; y++) {\n                for (var x = cell[0]; x < cell[0] + colspan; x++) {\n                    if (! (cell[0] == x && cell[1] == y)) {\n                        data.push(obj.options.data[y][x]);\n                        obj.updateCell(x, y, '', true);\n                        obj.options.mergeCells[cellName][2].push(obj.records[y][x]);\n                        obj.records[y][x].style.display = 'none';\n                        obj.records[y][x] = obj.records[cell[1]][cell[0]];\n                    }\n                }\n            }\n            // In the initialization is not necessary keep the history\n            obj.updateSelection(obj.records[cell[1]][cell[0]]);\n\n            if (! ignoreHistoryAndEvents) {\n                obj.setHistory({\n                    action:'setMerge',\n                    column:cellName,\n                    colspan:colspan,\n                    rowspan:rowspan,\n                    data:data,\n                });\n\n                if (typeof(obj.options.onmerge) == 'function') {\n                    obj.options.onmerge(el, cellName, colspan, rowspan);\n                }\n            }\n        }\n    }\n\n    /**\n     * Merge cells\n     * @param cellName\n     * @param colspan\n     * @param rowspan\n     * @param ignoreHistoryAndEvents\n     */\n    obj.getMerge = function(cellName) {\n        var data = {};\n        if (cellName) {\n            if (obj.options.mergeCells[cellName]) {\n                data = [ obj.options.mergeCells[cellName][0], obj.options.mergeCells[cellName][1] ];\n            } else {\n                data = null;\n            }\n        } else {\n            if (obj.options.mergeCells) {\n                var mergedCells = obj.options.mergeCells;\n                var keys = Object.keys(obj.options.mergeCells);\n                for (var i = 0; i < keys.length; i++) {\n                    data[keys[i]] = [ obj.options.mergeCells[keys[i]][0], obj.options.mergeCells[keys[i]][1] ];\n                }\n            }\n        }\n\n        return data;\n    }\n\n    /**\n     * Remove merge by cellname\n     * @param cellName\n     */\n    obj.removeMerge = function(cellName, data, keepOptions) {\n        if (obj.options.mergeCells[cellName]) {\n            var cell = jexcel.getIdFromColumnName(cellName, true);\n            obj.records[cell[1]][cell[0]].removeAttribute('colspan');\n            obj.records[cell[1]][cell[0]].removeAttribute('rowspan');\n            obj.records[cell[1]][cell[0]].removeAttribute('data-merged');\n            var info = obj.options.mergeCells[cellName];\n\n            var index = 0;\n            for (var j = 0; j < info[1]; j++) {\n                for (var i = 0; i < info[0]; i++) {\n                    if (j > 0 || i > 0) {\n                        obj.records[cell[1]+j][cell[0]+i] = info[2][index];\n                        obj.records[cell[1]+j][cell[0]+i].style.display = '';\n                        // Recover data\n                        if (data && data[index]) {\n                            obj.updateCell(cell[0]+i, cell[1]+j, data[index]);\n                        }\n                        index++;\n                    }\n                }\n            }\n\n            // Update selection\n            obj.updateSelection(obj.records[cell[1]][cell[0]], obj.records[cell[1]+j-1][cell[0]+i-1]);\n\n            if (! keepOptions) {\n                delete(obj.options.mergeCells[cellName]);\n            }\n        }\n    }\n\n    /**\n     * Remove all merged cells\n     */\n    obj.destroyMerged = function(keepOptions) {\n        // Remove any merged cells\n        if (obj.options.mergeCells) {\n            var mergedCells = obj.options.mergeCells;\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                obj.removeMerge(keys[i], null, keepOptions);\n            }\n        }\n    }\n\n    /**\n     * Is column merged\n     */\n    obj.isColMerged = function(x, insertBefore) {\n        var cols = [];\n        // Remove any merged cells\n        if (obj.options.mergeCells) {\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                var info = jexcel.getIdFromColumnName(keys[i], true);\n                var colspan = obj.options.mergeCells[keys[i]][0];\n                var x1 = info[0];\n                var x2 = info[0] + (colspan > 1 ? colspan - 1 : 0);\n\n                if (insertBefore == null) {\n                    if ((x1 <= x && x2 >= x)) {\n                        cols.push(keys[i]);\n                    }\n                } else {\n                    if (insertBefore) {\n                        if ((x1 < x && x2 >= x)) {\n                            cols.push(keys[i]);\n                        }\n                    } else {\n                        if ((x1 <= x && x2 > x)) {\n                            cols.push(keys[i]);\n                        }\n                    }\n                }\n            }\n        }\n\n        return cols;\n    }\n\n    /**\n     * Is rows merged\n     */\n    obj.isRowMerged = function(y, insertBefore) {\n        var rows = [];\n        // Remove any merged cells\n        if (obj.options.mergeCells) {\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                var info = jexcel.getIdFromColumnName(keys[i], true);\n                var rowspan = obj.options.mergeCells[keys[i]][1];\n                var y1 = info[1];\n                var y2 = info[1] + (rowspan > 1 ? rowspan - 1 : 0);\n\n                if (insertBefore == null) {\n                    if ((y1 <= y && y2 >= y)) {\n                        rows.push(keys[i]);\n                    }\n                } else {\n                    if (insertBefore) {\n                        if ((y1 < y && y2 >= y)) {\n                            rows.push(keys[i]);\n                        }\n                    } else {\n                        if ((y1 <= y && y2 > y)) {\n                            rows.push(keys[i]);\n                        }\n                    }\n                }\n            }\n        }\n\n        return rows;\n    }\n\n    /**\n     * Open the editor\n     * \n     * @param object cell\n     * @return void\n     */\n    obj.openEditor = function(cell, empty, e) {\n        // Get cell position\n        var y = cell.getAttribute('data-y');\n        var x = cell.getAttribute('data-x');\n\n        // On edition start\n        if (! obj.ignoreEvents) {\n            if (typeof(obj.options.oneditionstart) == 'function') {\n                obj.options.oneditionstart(el, cell, x, y);\n            }\n        }\n\n        // Overflow\n        if (x > 0) {\n            obj.records[y][x-1].style.overflow = 'hidden';\n        }\n\n        // Create editor\n        var createEditor = function(type) {\n            // Cell information\n            var info = cell.getBoundingClientRect();\n\n            // Create dropdown\n            var editor = document.createElement(type);\n            editor.style.width = (info.width) + 'px';\n            editor.style.height = (info.height - 2) + 'px';\n            editor.style.minHeight = (info.height - 2) + 'px';\n\n            // Edit cell\n            cell.classList.add('editor');\n            cell.innerHTML = '';\n            cell.appendChild(editor);\n\n            return editor;\n        }\n\n        // Readonly\n        if (cell.classList.contains('readonly') == true) {\n            // Do nothing\n        } else {\n            // Holder\n            obj.edition = [ obj.records[y][x], obj.records[y][x].innerHTML, x, y ];\n\n            // If there is a custom editor for it\n            if (obj.options.columns[x].editor) {\n                // Custom editors\n                obj.options.columns[x].editor.openEditor(cell, el, empty, e);\n            } else {\n                // Native functions\n                if (obj.options.columns[x].type == 'hidden') {\n                    // Do nothing\n                } else if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                    // Get value\n                    var value = cell.children[0].checked ? false : true;\n                    // Toogle value\n                    obj.setValue(cell, value);\n                    // Do not keep edition open\n                    obj.edition = null;\n                } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    // Get current value\n                    var value = obj.options.data[y][x];\n\n                    // Create dropdown\n                    if (typeof(obj.options.columns[x].filter) == 'function') {\n                        var source = obj.options.columns[x].filter(el, cell, x, y, obj.options.columns[x].source);\n                    } else {\n                        var source = obj.options.columns[x].source;\n                    }\n\n                    // Create editor\n                    var editor = createEditor('div');\n                    var options = {\n                        data: source,\n                        multiple: obj.options.columns[x].multiple ? true : false,\n                        autocomplete: obj.options.columns[x].autocomplete || obj.options.columns[x].type == 'autocomplete' ? true : false,\n                        opened:true,\n                        value: obj.options.columns[x].multiple ? value.split(';') : value,\n                        width:'100%',\n                        height:editor.style.minHeight,\n                        position: (obj.options.tableOverflow == true || obj.options.fullscreen == true) ? true : false,\n                        onclose:function() {\n                            obj.closeEditor(cell, true);\n                        }\n                    };\n                    if (obj.options.columns[x].options && obj.options.columns[x].options.type) {\n                        options.type = obj.options.columns[x].options.type;\n                    }\n                    jSuites.dropdown(editor, options);\n                } else if (obj.options.columns[x].type == 'calendar' || obj.options.columns[x].type == 'color') {\n                    // Value\n                    var value = obj.options.data[y][x];\n                    // Create editor\n                    var editor = createEditor('input');\n                    editor.value = value;\n\n                    if (obj.options.tableOverflow == true || obj.options.fullscreen == true) {\n                        obj.options.columns[x].options.position = true;\n                    }\n                    obj.options.columns[x].options.value = obj.options.data[y][x];\n                    obj.options.columns[x].options.opened = true;\n                    obj.options.columns[x].options.onclose = function(el, value) {\n                        obj.closeEditor(cell, true);\n                    }\n                    // Current value\n                    if (obj.options.columns[x].type == 'color') {\n                        jSuites.color(editor, obj.options.columns[x].options);\n                    } else {\n                        var calendar = jSuites.calendar(editor, obj.options.columns[x].options);\n                        calendar.setValue(value);\n                    }\n                    // Focus on editor\n                    editor.focus();\n                } else if (obj.options.columns[x].type == 'image') {\n                    // Value\n                    var img = cell.children[0];\n                    // Create editor\n                    var editor = createEditor('div');\n                    editor.style.position = 'relative';\n                    var div = document.createElement('div');\n                    div.classList.add('jclose');\n                    if (img && img.src) {\n                        div.appendChild(img);\n                    }\n                    editor.appendChild(div);\n                    jSuites.image(div, obj.options.imageOptions);\n                    const rect = cell.getBoundingClientRect();\n                    const rectContent = div.getBoundingClientRect();\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\n                        div.style.top = (rect.top - (rectContent.height + 2)) + 'px';\n                    } else {\n                        div.style.top = (rect.top) + 'px';\n                    }\n                } else {\n                    // Value\n                    var value = empty == true ? '' : obj.options.data[y][x];\n\n                    // Basic editor\n                    if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true)) {\n                        var editor = createEditor('textarea');\n                    } else {\n                        var editor = createEditor('input');\n                        // Mask\n                        if (obj.options.columns[x].mask) {\n                            editor.setAttribute('data-mask', obj.options.columns[x].mask);\n                        }\n                    }\n\n                    editor.value = value;\n                    editor.onblur = function() {\n                        obj.closeEditor(cell, true);\n                    };\n                    editor.focus();\n                }\n            }\n        }\n    }\n\n    /**\n     * Close the editor and save the information\n     * \n     * @param object cell\n     * @param boolean save\n     * @return void\n     */\n    obj.closeEditor = function(cell, save) {\n        var x = parseInt(cell.getAttribute('data-x'));\n        var y = parseInt(cell.getAttribute('data-y'));\n\n        // Get cell properties\n        if (save == true) {\n            // If custom editor\n            if (obj.options.columns[x].editor) {\n                // Custom editor\n                var value = obj.options.columns[x].editor.closeEditor(cell, save);\n            } else {\n                // Native functions\n                if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio' || obj.options.columns[x].type == 'hidden') {\n                    // Do nothing\n                } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    var value = cell.children[0].dropdown.close(true);\n                } else if (obj.options.columns[x].type == 'calendar') {\n                    var value = cell.children[0].calendar.close(true);\n                } else if (obj.options.columns[x].type == 'color') {\n                    var value = cell.children[1].color.close(true);\n                } else if (obj.options.columns[x].type == 'image') {\n                    var img = cell.children[0].children[0].children[0];\n                    var value = img && img.tagName == 'IMG' ? img.src : '';\n                } else if (obj.options.columns[x].type == 'numeric') {\n                    var value = cell.children[0].value;\n                    if (value.substr(0,1) != '=') {\n                        if (value == '') {\n                            value = obj.options.columns[x].allowEmpty ? '' : 0;\n                        }\n                    }\n                    cell.children[0].onblur = null;\n                } else {\n                    var value = cell.children[0].value;\n                    cell.children[0].onblur = null;\n                }\n            }\n\n            // Ignore changes if the value is the same\n            if (obj.options.data[y][x] == value) {\n                cell.innerHTML = obj.edition[1];\n            } else {\n                obj.setValue(cell, value);\n            }\n        } else {\n            if (obj.options.columns[x].editor) {\n                // Custom editor\n                obj.options.columns[x].editor.closeEditor(cell, save);\n            } else {\n                if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    cell.children[0].dropdown.close(true);\n                } else if (obj.options.columns[x].type == 'calendar') {\n                    cell.children[0].calendar.close(true);\n                } else if (obj.options.columns[x].type == 'color') {\n                    cell.children[1].color.close(true);\n                } else {\n                    cell.children[0].onblur = null;\n                }\n            }\n\n            // Restore value\n            cell.innerHTML = obj.edition && obj.edition[1] ? obj.edition[1] : '';\n        }\n\n        // On edition end\n        if (! obj.ignoreEvents) {\n            if (typeof(obj.options.oneditionend) == 'function') {\n                obj.options.oneditionend(el, cell, x, y, value, save);\n            }\n        }\n\n        // Remove editor class\n        cell.classList.remove('editor');\n\n        // Finish edition\n        obj.edition = null;\n    }\n\n    /**\n     * Get the cell object\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getCell = function(cell) {\n        // Convert in case name is excel liked ex. A10, BB92\n        cell = jexcel.getIdFromColumnName(cell, true);\n        var x = cell[0];\n        var y = cell[1];\n\n        return obj.records[y][x];\n    }\n\n    /**\n     * Get the cell object from coords\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getCellFromCoords = function(x, y) {\n        return obj.records[y][x];\n    }\n\n    /**\n     * Get label\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getLabel = function(cell) {\n        // Convert in case name is excel liked ex. A10, BB92\n        cell = jexcel.getIdFromColumnName(cell, true);\n        var x = cell[0];\n        var y = cell[1];\n\n        return obj.records[y][x].innerHTML;\n    }\n\n    /**\n     * Get labelfrom coords\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getLabelFromCoords = function(x, y) {\n        return obj.records[y][x].innerHTML;\n    }\n\n    /**\n     * Get the value from a cell\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getValue = function(cell, processedValue) {\n        if (typeof(cell) == 'object') {\n            var x = cell.getAttribute('data-x');\n            var y = cell.getAttribute('data-y');\n        } else {\n            cell = jexcel.getIdFromColumnName(cell, true);\n            var x = cell[0];\n            var y = cell[1];\n        }\n\n        var value = null;\n\n        if (x != null && y != null) {\n            if (obj.records[y] && obj.records[y][x] && (processedValue || obj.options.copyCompatibility == true)) {\n                value = obj.records[y][x].innerHTML;\n            } else {\n                if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n                    value = obj.options.data[y][x];\n                }\n            }\n        }\n\n        return value;\n    }\n\n    /**\n     * Get the value from a coords\n     * \n     * @param int x\n     * @param int y\n     * @return string value\n     */\n    obj.getValueFromCoords = function(x, y, processedValue) {\n        var value = null;\n\n        if (x != null && y != null) {\n            if ((obj.records[y] && obj.records[y][x]) && processedValue || obj.options.copyCompatibility == true) {\n                value = obj.records[y][x].innerHTML;\n            } else {\n                if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n                    value = obj.options.data[y][x];\n                }\n            }\n        }\n\n        return value;\n    }\n\n    /**\n     * Set a cell value\n     * \n     * @param mixed cell destination cell\n     * @param string value value\n     * @return void\n     */\n    obj.setValue = function(cell, value, force) {\n        var records = [];\n\n        if (typeof(cell) == 'string') {\n            var columnId = jexcel.getIdFromColumnName(cell, true);\n            var x = columnId[0];\n            var y = columnId[1];\n\n            // Update cell\n            records.push(obj.updateCell(x, y, value, force));\n\n            // Update all formulas in the chain\n            obj.updateFormulaChain(x, y, records);\n        } else {\n            var x = null;\n            var y = null;\n            if (cell && cell.getAttribute) {\n                var x = cell.getAttribute('data-x');\n                var y = cell.getAttribute('data-y');\n            }\n\n            // Update cell\n            if (x != null && y != null) {\n                records.push(obj.updateCell(x, y, value, force));\n\n                // Update all formulas in the chain\n                obj.updateFormulaChain(x, y, records);\n            } else {\n                var keys = Object.keys(cell);\n                if (keys.length > 0) {\n                    for (var i = 0; i < keys.length; i++) {\n                        if (typeof(cell[i]) == 'string') {\n                            var columnId = jexcel.getIdFromColumnName(cell[i], true);\n                            var x = columnId[0];\n                            var y = columnId[1];\n                        } else {\n                            var x = cell[i].getAttribute('data-x');\n                            var y = cell[i].getAttribute('data-y');\n                        }\n\n                         // Update cell\n                        if (x != null && y != null) {\n                            records.push(obj.updateCell(x, y, value, force));\n\n                            // Update all formulas in the chain\n                            obj.updateFormulaChain(x, y, records);\n                        }\n                    }\n                }\n            }\n        }\n\n        // Update history\n        obj.setHistory({\n            action:'setValue',\n            records:records,\n            selection:obj.selectedCell,\n        });\n\n        // Update table with custom configurations if applicable\n        obj.updateTable();\n\n        // On after changes\n        obj.onafterchanges(el, records);\n    }\n\n    /**\n     * Set a cell value based on coordinates\n     * \n     * @param int x destination cell\n     * @param int y destination cell\n     * @param string value\n     * @return void\n     */\n    obj.setValueFromCoords = function(x, y, value, force) {\n        var records = [];\n        records.push(obj.updateCell(x, y, value, force));\n\n        // Update all formulas in the chain\n        obj.updateFormulaChain(x, y, records);\n\n        // Update history\n        obj.setHistory({\n            action:'setValue',\n            records:records,\n            selection:obj.selectedCell,\n        });\n\n        // Update table with custom configurations if applicable\n        obj.updateTable();\n\n        // On after changes\n        obj.onafterchanges(el, records);\n    }\n\n    /**\n     * Toogle\n     */\n    obj.setCheckRadioValue = function() {\n        var records = [];\n        var keys = Object.keys(obj.highlighted);\n        for (var i = 0; i < keys.length; i++) {\n            var x = obj.highlighted[i].getAttribute('data-x');\n            var y = obj.highlighted[i].getAttribute('data-y');\n\n            if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                // Update cell\n                records.push(obj.updateCell(x, y, ! obj.options.data[y][x]));\n            }\n        }\n\n        if (records.length) {\n            // Update history\n            obj.setHistory({\n                action:'setValue',\n                records:records,\n                selection:obj.selectedCell,\n            });\n\n            // On after changes\n            obj.onafterchanges(el, records);\n        }\n    }\n\n    /**\n     * Update cell content\n     * \n     * @param object cell\n     * @return void\n     */\n    obj.updateCell = function(x, y, value, force) {\n        // Changing value depending on the column type\n        if (obj.records[y][x].classList.contains('readonly') == true && ! force) {\n            // Do nothing\r\n            var record = {\r\n                x: x,\r\n                y: y,\r\n                col: x,\r\n                row: y\r\n            }\n        } else {\n            // On change\n            if (! obj.ignoreEvents) {\n                if (typeof(obj.options.onbeforechange) == 'function') {\n                    // Overwrite a value\n                    var val = obj.options.onbeforechange(el, obj.records[y][x], x, y, value);\n\n                    // If you return something this will overwrite the value\n                    if (val != undefined) {\n                        value = val;\n                    }\n                }\n            }\n\n            // History format\n            var record = {\n                x: x,\r\n                y: y,\n                col: x,\n                row: y,\n                newValue: value,\n                oldValue: obj.options.data[y][x],\n            }\n\n            if (obj.options.columns[x].editor) {\n                // Update data and cell\n                obj.options.data[y][x] = value;\n                obj.options.columns[x].editor.setValue(obj.records[y][x], value, force);\n            } else {\n                // Native functions\n                if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                    // Unchecked all options\n                    if (obj.options.columns[x].type == 'radio') {\n                        for (var j = 0; j < obj.options.data.length; j++) {\n                            obj.options.data[j][x] = false;\n                        }\n                    }\n\n                    // Update data and cell\n                    obj.records[y][x].children[0].checked = (value == 1 || value == true || value == 'true' || value == 'TRUE') ? true : false;\n                    obj.options.data[y][x] = obj.records[y][x].children[0].checked;\n                } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                    obj.records[y][x].innerHTML = obj.getDropDownValue(x, value);\n                } else if (obj.options.columns[x].type == 'calendar') {\n                    // Update calendar\n                    var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[x].options.format);\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                    obj.records[y][x].innerHTML = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[x].options.format);\n                } else if (obj.options.columns[x].type == 'color') {\n                    // Update color\n                    obj.options.data[y][x] = value;\n                    // Render\n                    if (obj.options.columns[x].render == 'square') {\n                        var color = document.createElement('div');\n                        color.className = 'color';\n                        color.style.backgroundColor = value;\n                        obj.records[y][x].innerHTML = '';\n                        obj.records[y][x].appendChild(color);\n                    } else {\n                    obj.records[y][x].style.color = value;\n                        obj.records[y][x].innerHTML = value;\n                    }\n                } else if (obj.options.columns[x].type == 'image') {\n                    value = ''+value;\n                    obj.options.data[y][x] = value;\n                    obj.records[y][x].innerHTML = '';\n                    if (value && value.substr(0, 10) == 'data:image') {\n                        var img = document.createElement('img');\n                        img.src = value;\n                        obj.records[y][x].appendChild(img);\n                    }\n                } else {\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                    // Label\n                    if (('' + value).substr(0,1) == '='  && obj.options.parseFormulas == true) {\n                        value = obj.executeFormula(value, x, y);\n                    }\n                    if (obj.options.columns[x].mask) {\n                        var decimal = obj.options.columns[x].decimal || '.';\n                        value = '' + jSuites.mask.run(value, obj.options.columns[x].mask, decimal);\n                    }\n                    obj.records[y][x].innerHTML = value;\n\n                    // Handle big text inside a cell\n                    if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true || obj.records[y][x].innerHTML.length > 200)) {\n                        obj.records[y][x].style.whiteSpace = 'pre-wrap';\n                    } else {\n                        obj.records[y][x].style.whiteSpace = '';\n                    }\n                }\n            }\n\n            // Overflow\n            if (x > 0) {\n                if (value) {\n                    obj.records[y][x-1].style.overflow = 'hidden';\n                } else {\n                    obj.records[y][x-1].style.overflow = '';\n                }\n            }\n\n            // On change\n            if (! obj.ignoreEvents) {\n                if (typeof(obj.options.onchange) == 'function') {\n                    obj.options.onchange(el, (obj.records[y] && obj.records[y][x] ? obj.records[y][x] : null), x, y, value, record.oldValue);\n                }\n            }\n        }\n\n        return record;\n    }\n\n    /**\n     * Helper function to copy data using the corner icon\n     */\n    obj.copyData = function(o, d) {\n        // Get data from all selected cells\n        var data = obj.getData(true, true);\n\n        // Selected cells\r\n        var h = obj.selectedContainer;\n\n        // Cells\n        var x1 = parseInt(o.getAttribute('data-x'));\n        var y1 = parseInt(o.getAttribute('data-y'));\n        var x2 = parseInt(d.getAttribute('data-x'));\n        var y2 = parseInt(d.getAttribute('data-y'));\n\n        // Records\n        var records = [];\n        var breakControl = false;\n\n        if (h[0] == x1) {\r\n            // Vertical copy\r\n            if (y1 < h[1]) {\r\n                var rowNumber = y1 - h[1];\r\n            } else {\r\n                var rowNumber = 1;\r\n            }\r\n            var colNumber = 0;\r\n        } else {\r\n            if (x1 < h[0]) {\r\n                var colNumber = x1 - h[0];\r\n            } else {\r\n                var colNumber = 1;\r\n            }\r\n            var rowNumber = 0;\r\n        }\r\n\n        // Copy data procedure\n        var posx = 0;\n        var posy = 0;\n\n        for (var j = y1; j <= y2; j++) {\n            // Skip hidden rows\n            if (obj.rows[j] && obj.rows[j].style.display == 'none') {\n                continue;\n            }\n\n            // Controls\n            if (data[posy] == undefined) {\n                posy = 0;\n            }\n            posx = 0;\n\n            // Data columns\n            if (h[0] != x1) {\r\n                if (x1 < h[0]) {\r\n                    var colNumber = x1 - h[0];\r\n                } else {\r\n                    var colNumber = 1;\r\n                }\r\n            }\n            // Data columns\n            for (var i = x1; i <= x2; i++) {\n                // Update non-readonly\n                if (obj.records[j][i] && ! obj.records[j][i].classList.contains('readonly') && obj.records[j][i].style.display != 'none' && breakControl == false) {\n                    // Stop if contains value\n                    if (! obj.selection.length) {\n                        if (obj.options.data[j][i] != '') {\n                            breakControl = true;\n                            continue;\n                        }\n                    }\n\n                    // Column\n                    if (data[posy] == undefined) {\n                        posx = 0;\n                    } else if (data[posy][posx] == undefined) {\n                        posx = 0;\n                    }\r\n\r\n                    // Value\r\n                    var value = data[posy][posx];\n\n                        if (value && ! data[1] && obj.options.autoIncrement == true) {\n                        if (obj.options.columns[i].type == 'text' || obj.options.columns[i].type == 'number') {\n                            if ((''+value).substr(0,1) == '=') {\n                                var tokens = value.match(/([A-Z]+[0-9]+)/g);\n\n                                if (tokens) {\n                                    var affectedTokens = [];\n                                    for (var index = 0; index < tokens.length; index++) {\n                                        var position = jexcel.getIdFromColumnName(tokens[index], 1);\n                                        position[0] += colNumber;\r\n                                        position[1] += rowNumber;\r\n                                        if (position[1] < 0) {\r\n                                            position[1] = 0;\r\n                                        }\n                                        var token = jexcel.getColumnNameFromId([position[0], position[1]]);\n\n                                        if (token != tokens[index]) {\n                                            affectedTokens[tokens[index]] = token;\n                                        }\n                                    }\n                                    // Update formula\n                                    if (affectedTokens) {\n                                        value = obj.updateFormula(value, affectedTokens)\n                                    }\n                                }\n                            } else {\n                                if (value == Number(value)) {\n                                    value = Number(value) + rowNumber;\n                                }\n                            }\n                        } else if (obj.options.columns[i].type == 'calendar') {\n                            var date = new Date(value);\n                            date.setDate(date.getDate() + rowNumber);\n                            value = date.getFullYear() + '-' + jexcel.doubleDigitFormat(parseInt(date.getMonth() + 1)) + '-' + jexcel.doubleDigitFormat(date.getDate()) + ' ' + '00:00:00';\n                        }\n                    }\n\n                    records.push(obj.updateCell(i, j, value));\n\n                    // Update all formulas in the chain\n                    obj.updateFormulaChain(i, j, records);\n                }\n                posx++;\n                if (h[0] != x1) {\r\n                    colNumber++;\r\n                }\n            }\n            posy++;\n            rowNumber++;\n        }\n\n        // Update history\n        obj.setHistory({\n            action:'setValue',\n            records:records,\n            selection:obj.selectedCell,\n        });\n\n        // Update table with custom configuration if applicable\n        obj.updateTable();\n\n        // On after changes\n        obj.onafterchanges(el, records);\n    }\n\n    /**\n     * Refresh current selection\n     */\n    obj.refreshSelection = function() {\n        if (obj.selectedCell) {\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        }\n    }\n\n    /**\n     * Move coords to A1 in case ovelaps with an excluded cell\n     */\n    obj.conditionalSelectionUpdate = function(type, o, d) {\n        if (type == 1) {\n            if (obj.selectedCell && ((o >= obj.selectedCell[1] && o <= obj.selectedCell[3]) || (d >= obj.selectedCell[1] && d <= obj.selectedCell[3]))) {\n                obj.resetSelection();\n                return;\n            }\n        } else {\n            if (obj.selectedCell && ((o >= obj.selectedCell[0] && o <= obj.selectedCell[2]) || (d >= obj.selectedCell[0] && d <= obj.selectedCell[2]))) {\n                obj.resetSelection();\n                return;\n            }\n        }\n    }\n\n    /**\n     * Clear table selection\n     */\n    obj.resetSelection = function(blur) {\n        // Remove style\n        if (! obj.highlighted.length) {\n            var previousStatus = 0;\n        } else {\n            var previousStatus = 1;\n\n            for (var i = 0; i < obj.highlighted.length; i++) {\n                obj.highlighted[i].classList.remove('highlight');\n                obj.highlighted[i].classList.remove('highlight-left');\n                obj.highlighted[i].classList.remove('highlight-right');\n                obj.highlighted[i].classList.remove('highlight-top');\n                obj.highlighted[i].classList.remove('highlight-bottom');\n                obj.highlighted[i].classList.remove('highlight-selected');\n\n                var px = parseInt(obj.highlighted[i].getAttribute('data-x'));\n                var py = parseInt(obj.highlighted[i].getAttribute('data-y'));\n\n                // Check for merged cells\n                if (obj.highlighted[i].getAttribute('data-merged')) {\n                    var colspan = parseInt(obj.highlighted[i].getAttribute('colspan'));\n                    var rowspan = parseInt(obj.highlighted[i].getAttribute('rowspan'));\n                    var ux = colspan > 0 ? px + (colspan - 1) : px;\n                    var uy = rowspan > 0 ? py + (rowspan - 1): py;\n                } else {\n                    var ux = px;\n                    var uy = py;\n                }\n\n                // Remove selected from headers\n                for (var j = px; j <= ux; j++) {\n                    if (obj.headers[j]) {\n                        obj.headers[j].classList.remove('selected');\n                    }\n                }\n\n                // Remove selected from rows\n                for (var j = py; j <= uy; j++) {\n                    if (obj.rows[j]) {\n                        obj.rows[j].classList.remove('selected');\n                    }\n                }\n            }\n        }\n\n        // Reset highlighed cells\n        obj.highlighted = [];\n\n        // Reset\n        obj.selectedCell = null;\n\n        // Hide corner\n        obj.corner.style.top = '-2000px';\n        obj.corner.style.left = '-2000px';\n\n        if (obj.ignoreEvents != true && blur == true) {\n            if (obj.options.onblur) {\n                if (typeof(obj.options.onblur) == 'function') {\n                    if (previousStatus == 1) {\n                        obj.options.onblur(el);\n                    }\n                }\n            }\n        }\n\n        return previousStatus;\n    }\n\n    /**\n     * Update selection based on two cells\n     */\n    obj.updateSelection = function(el1, el2, origin) {\n        var x1 = el1.getAttribute('data-x');\n        var y1 = el1.getAttribute('data-y');\n        if (el2) {\n            var x2 = el2.getAttribute('data-x');\n            var y2 = el2.getAttribute('data-y');\n        } else {\n            var x2 = x1;\n            var y2 = y1;\n        }\n\n        obj.updateSelectionFromCoords(x1, y1, x2, y2, origin);\n    }\n\n    /**\n     * Update selection from coords\n     */\n    obj.updateSelectionFromCoords = function(x1, y1, x2, y2, origin) {\n        // Reset Selection\n        var updated = null;\n        var previousState = obj.resetSelection();\n\n        // Same element\n        if (x2 == null) {\n            x2 = x1;\n        }\n        if (y2 == null) {\n            y2 = y1;\n        }\n\n        // Selection must be within the existing data\n        if (x1 >= obj.headers.length) {\n            x1 = obj.headers.length - 1;\n        }\n        if (y1 >= obj.rows.length) {\n            y1 = obj.rows.length - 1;\n        }\n        if (x2 >= obj.headers.length) {\n            x2 = obj.headers.length - 1;\n        }\n        if (y2 >= obj.rows.length) {\n            y2 = obj.rows.length - 1;\n        }\n\n        // Keep selected cell\n        obj.selectedCell = [x1, y1, x2, y2];\n\n        // Select cells\n        if (x1 != null) {\n            // Add selected cell\n            if (obj.records[y1][x1]) {\n                obj.records[y1][x1].classList.add('highlight-selected');\n            }\n\n            // Origin & Destination\n            if (parseInt(x1) < parseInt(x2)) {\n                var px = parseInt(x1);\n                var ux = parseInt(x2);\n            } else {\n                var px = parseInt(x2);\n                var ux = parseInt(x1);\n            }\n\n            if (parseInt(y1) < parseInt(y2)) {\n                var py = parseInt(y1);\n                var uy = parseInt(y2);\n            } else {\n                var py = parseInt(y2);\n                var uy = parseInt(y1);\n            }\n\n            // Verify merged columns\n            for (var i = px; i <= ux; i++) {\n                for (var j = py; j <= uy; j++) {\n                    if (obj.records[j][i] && obj.records[j][i].getAttribute('data-merged')) {\n                        var x = parseInt(obj.records[j][i].getAttribute('data-x'));\n                        var y = parseInt(obj.records[j][i].getAttribute('data-y'));\n                        var colspan = parseInt(obj.records[j][i].getAttribute('colspan'));\n                        var rowspan = parseInt(obj.records[j][i].getAttribute('rowspan'));\n\n                        if (colspan > 1) {\n                            if (x < px) {\n                                px = x;\n                            }\n                            if (x + colspan > ux) {\n                                ux = x + colspan - 1;\n                            }\n                        }\n\n                        if (rowspan) {\n                            if (y < py) {\n                                py = y;\n\n                            }\n                            if (y + rowspan > uy) {\n                                uy = y + rowspan - 1;\n                            }\n                        }\n                    }\n                }\n            }\n\n            // Limits\n            var borderLeft = null;\n            var borderRight = null;\n            var borderTop = null;\n            var borderBottom = null;\n\n            // Vertical limits\n            for (var j = py; j <= uy; j++) {\n                if (obj.rows[j].style.display != 'none') {\n                    if (borderTop == null) {\n                        borderTop = j;\n                    }\n                    borderBottom = j;\n                }\n            }\n\n            // Redefining styles\n            for (var i = px; i <= ux; i++) {\n                for (var j = py; j <= uy; j++) {\n                    if (obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n                        obj.records[j][i].classList.add('highlight');\n                        obj.highlighted.push(obj.records[j][i]);\n                    }\n                }\n\n                // Horizontal limits\n                if (obj.options.columns[i].type != 'hidden') {\n                    if (borderLeft == null) {\n                        borderLeft = i;\n                    }\n                    borderRight = i;\n                }\n            }\n\n            // Create borders\n            if (! borderLeft) {\n                borderLeft = 0;\n            }\n            if (! borderRight) {\n                borderRight = 0;\n            }\n            for (var i = borderLeft; i <= borderRight; i++) {\n                if (obj.options.columns[i].type != 'hidden') {\n                    // Top border\n                    if (obj.records[borderTop][i]) {\n                        obj.records[borderTop][i].classList.add('highlight-top');\n                    }\n                    // Bottom border\n                    if (obj.records[borderBottom][i]) {\n                        obj.records[borderBottom][i].classList.add('highlight-bottom');\n                    }\n                    // Add selected from headers\n                    obj.headers[i].classList.add('selected');\n                }\n            }\n\n            for (var j = borderTop; j <= borderBottom; j++) {\n                if (obj.rows[j].style.display != 'none') {\n                    // Left border\n                    obj.records[j][borderLeft].classList.add('highlight-left');\n                    // Right border\n                    obj.records[j][borderRight].classList.add('highlight-right');\n                    // Add selected from rows\n                    obj.rows[j].classList.add('selected');\n                }\n            }\n\n            obj.selectedContainer = [ borderLeft, borderTop, borderRight, borderBottom ];\n        }\n\n        // Handle events\n        if (obj.ignoreEvents != true) {\n            if (obj.options.onfocus) {\n                if (typeof(obj.options.onfocus) == 'function') {\n                    if (previousState == 0) {\n                        obj.options.onfocus(el);\n                    }\n                }\n            }\n\n            if (typeof(obj.options.onselection) == 'function') {\n                obj.options.onselection(el, borderLeft, borderTop, borderRight, borderBottom, origin);\n            }\n        }\n\n        // Find corner cell\n        obj.updateCornerPosition();\n    }\n\n    /**\n     * Remove copy selection\n     * \n     * @return void\n     */\n    obj.removeCopySelection = function() {\n        // Remove current selection\n        for (var i = 0; i < obj.selection.length; i++) {\n            obj.selection[i].classList.remove('selection');\n            obj.selection[i].classList.remove('selection-left');\n            obj.selection[i].classList.remove('selection-right');\n            obj.selection[i].classList.remove('selection-top');\n            obj.selection[i].classList.remove('selection-bottom');\n        }\n\n        obj.selection = [];\n    }\n\n    /**\n     * Update copy selection\n     * \n     * @param int x, y\n     * @return void\n     */\n    obj.updateCopySelection = function(x3, y3) {\n        // Remove selection\n        obj.removeCopySelection();\n\n        // Get elements first and last\n        var x1 = obj.selectedContainer[0];\n        var y1 = obj.selectedContainer[1];\n        var x2 = obj.selectedContainer[2];\n        var y2 = obj.selectedContainer[3];\n\n        if (x3 != null && y3 != null) {\n            if (x3 - x2 > 0) {\n                var px = parseInt(x2) + 1;\n                var ux = parseInt(x3);\n            } else {\n                var px = parseInt(x3);\n                var ux = parseInt(x1) - 1;\n            }\n\n            if (y3 - y2 > 0) {\n                var py = parseInt(y2) + 1;\n                var uy = parseInt(y3);\n            } else {\n                var py = parseInt(y3);\n                var uy = parseInt(y1) - 1;\n            }\n\n            if (ux - px < uy - py) {\n                var px = parseInt(x1);\n                var ux = parseInt(x2);\n            } else {\n                var py = parseInt(y1);\n                var uy = parseInt(y2);\n            }\n\n            for (var j = py; j <= uy; j++) {\n                for (var i = px; i <= ux; i++) {\n                    if (obj.records[j][i] && obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n                        obj.records[j][i].classList.add('selection');\n                        obj.records[py][i].classList.add('selection-top');\n                        obj.records[uy][i].classList.add('selection-bottom');\n                        obj.records[j][px].classList.add('selection-left');\n                        obj.records[j][ux].classList.add('selection-right');\n\n                        // Persist selected elements\n                        obj.selection.push(obj.records[j][i]);\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Update corner position\n     * \n     * @return void\n     */\n    obj.updateCornerPosition = function() {\n        // If any selected cells\n        if (! obj.highlighted.length) {\n            obj.corner.style.top = '-2000px';\n            obj.corner.style.left = '-2000px';\n        } else {\n            // Get last cell\n            var last = obj.highlighted[obj.highlighted.length-1];\n\r\n            const contentRect = obj.content.getBoundingClientRect();\r\n            var x1 = contentRect.left;\r\n            var y1 = contentRect.top;\r\n\r\n            const lastRect = last.getBoundingClientRect();\r\n            var x2 = lastRect.left;\r\n            var y2 = lastRect.top;\r\n            var w2 = lastRect.width;\r\n            var h2 = lastRect.height;\r\n\n            var x = (x2 - x1) + obj.content.scrollLeft + w2 - 4;\n            var y = (y2 - y1) + obj.content.scrollTop + h2 - 4;\n\n            // Place the corner in the correct place\n            obj.corner.style.top = y + 'px';\n            obj.corner.style.left = x + 'px';\n        }\n    }\n\n    /**\n     * Update scroll position based on the selection\n     */\n    obj.updateScroll = function(direction) {\n        // jExcel Container information\n        const contentRect = obj.content.getBoundingClientRect();\r\n        var x1 = contentRect.left;\r\n        var y1 = contentRect.top;\r\n        var w1 = contentRect.width;\r\n        var h1 = contentRect.height;\r\n\n        // Direction Left or Up\n        var reference = obj.records[obj.selectedCell[3]][obj.selectedCell[2]];\n\n            // Reference\r\n        const referenceRect = reference.getBoundingClientRect();\r\n        var x2 = referenceRect.left;\r\n        var y2 = referenceRect.top;\r\n        var w2 = referenceRect.width;\r\n        var h2 = referenceRect.height;\n\n        // Direction\n        if (direction == 0 || direction == 1) {\n            var x = (x2 - x1) + obj.content.scrollLeft;\n            var y = (y2 - y1) + obj.content.scrollTop - 2;\n        } else {\n            var x = (x2 - x1) + obj.content.scrollLeft + w2;\n            var y = (y2 - y1) + obj.content.scrollTop + h2;\n        }\n\n        // Top position check\n        if (y > (obj.content.scrollTop + 30) && y < (obj.content.scrollTop + h1)) {\n            // In the viewport\n        } else {\n            // Out of viewport\n            if (y < obj.content.scrollTop + 30) {\n                obj.content.scrollTop = y - h2;\n            } else {\n                obj.content.scrollTop = y - (h1 - 2);\n            }\n        }\n\n        // Left position check - TODO: change that to the bottom border of the element\n        if (x > (obj.content.scrollLeft) && x < (obj.content.scrollLeft + w1)) {\n            // In the viewport\n        } else {\n            // Out of viewport\n            if (x < obj.content.scrollLeft + 30) {\n                obj.content.scrollLeft = x;\n                if (obj.content.scrollLeft < 50) {\n                    obj.content.scrollLeft = 0;\n                }\n            } else {\n                obj.content.scrollLeft = x - (w1 - 20);\n            }\n        }\n    }\n\n    /**\n     * Get the column width\n     * \n     * @param int column column number (first column is: 0)\n     * @return int current width\n     */\n    obj.getWidth = function(column) {\n        if (! column) {\n            // Get all headers\n            var data = [];\n            for (var i = 0; i < obj.headers.length; i++) {\n                data.push(obj.options.columns[i].width);\n            }\n        } else {\n            // In case the column is an object\n            if (typeof(column) == 'object') {\n                column = $(column).getAttribute('data-x');\n            }\n\n            data = obj.colgroup[column].getAttribute('width')\n        }\n\n        return data;\n    }\n\n    /**\n     * Set the column width\n     * \n     * @param int column number (first column is: 0)\n     * @param int new column width\n     * @param int old column width\n     */\n    obj.setWidth = function (column, width, oldWidth) {\n        if (width > 0) {\n            // In case the column is an object\n            if (typeof(column) == 'object') {\n                column = column.getAttribute('data-x');\n            }\n\n            // Oldwidth\n            if (! oldWidth) {\n                oldWidth = obj.colgroup[column].getAttribute('width');\n            }\n\n            // Set width\n            obj.colgroup[column].setAttribute('width', width);\n            obj.options.columns[column].width = width;\n\n            // Keeping history of changes\n            obj.setHistory({\n                action:'setWidth',\n                column:column,\n                oldValue:oldWidth,\n                newValue:width,\n            });\n\n            // On resize column\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.onresizecolumn) == 'function') {\n                    obj.options.onresizecolumn(el, column, width, oldWidth);\n                }\n            }\n\n            // Update corner position\n            obj.updateCornerPosition();\n        }\n    }\n\n    /**\n     * Set the row height\n     * \n     * @param row - row number (first row is: 0)\n     * @param height - new row height\n     * @param oldHeight - old row height\n     */\n    obj.setHeight = function (row, height, oldHeight) {\n        if (height > 0) {\n            // In case the column is an object\n            if (typeof(row) == 'object') {\n                row = row.getAttribute('data-y');\n            }\n\n            // Oldwidth\n            if (! oldHeight) {\n                oldHeight = obj.rows[row].getAttribute('height');\r\n\r\n                if (! oldHeight) {\r\n                    var rect = obj.rows[row].getBoundingClientRect();\r\n                    oldHeight = rect.height;\r\n                }\n            }\n\n            // Integer\r\n            height = parseInt(height);\r\n\n            // Set width\n            obj.rows[row].style.height = height + 'px';\n\n            // Keep options updated\n            if (! obj.options.rows[row]) {\n                obj.options.rows[row] = {};\n            }\n            obj.options.rows[row].height = height;\n\n            // Keeping history of changes\n            obj.setHistory({\n                action:'setHeight',\n                row:row,\n                oldValue:oldHeight,\n                newValue:height,\n            });\n\n            // On resize column\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.onresizerow) == 'function') {\n                    obj.options.onresizerow(el, row, height, oldHeight);\n                }\n            }\n\n            // Update corner position\n            obj.updateCornerPosition();\n        }\n    }\n\n    /**\n     * Get the row height\n     * \n     * @param row - row number (first row is: 0)\n     * @return height - current row height\n     */\n    obj.getHeight = function(row) {\n        if (! row) {\n            // Get height of all rows\n            var data = [];\n            for (var j = 0; j < obj.rows.length; j++) {\n                var h = obj.rows[j].style.height;\n                if (h) {\n                    data[j] = h;\n                }\n            }\n        } else {\n            // In case the row is an object\n            if (typeof(row) == 'object') {\n                row = $(row).getAttribute('data-y');\n            }\n\n            var data = obj.rows[row].style.height;\n        }\n\n        return data;\n    }\n\n    /**\n     * Get the column title\n     * \n     * @param column - column number (first column is: 0)\n     * @param title - new column title\n     */\n    obj.getHeader = function(column) {\n        return obj.headers[column].innerText;\n    }\n\n    /**\n     * Set the column title\n     * \n     * @param column - column number (first column is: 0)\n     * @param title - new column title\n     */\n    obj.setHeader = function(column, newValue) {\n        if (obj.headers[column]) {\n            var oldValue = obj.headers[column].innerText;\n\n            if (! newValue) {\n                newValue = prompt(obj.options.text.columnName, oldValue)\n            }\n\n            if (newValue) {\n                obj.headers[column].innerHTML = newValue;\n                // Keep the title property\r\n                obj.headers[column].setAttribute('title', newValue);\n            }\n\n            obj.setHistory({\n                action: 'setHeader',\n                column: column,\n                oldValue: oldValue,\n                newValue: newValue\n            });\n\n            // On change\n            if (! obj.ignoreEvents) {\n                if (typeof(obj.options.onchangeheader) == 'function') {\n                    obj.options.onchangeheader(el, column, oldValue, newValue);\n                }\n            }\n        }\n    }\n\n    /**\n     * Get the headers\n     * \n     * @param asArray\n     * @return mixed\n     */\n    obj.getHeaders = function (asArray) {\n        var title = [];\n\n        for (var i = 0; i < obj.headers.length; i++) {\n            title.push(obj.getHeader(i));\n        }\n\n        return asArray ? title : title.join(obj.options.csvDelimiter);\n    }\n\n    /**\n     * Get meta information from cell(s)\n     * \n     * @return integer\n     */\n    obj.getMeta = function(cell, key) {\n        if (! cell) {\n            return obj.options.meta;\n        } else {\n            if (key) {\n                return obj.options.meta[cell] && obj.options.meta[cell][key] ? obj.options.meta[cell][key] : null;\n            } else {\n                return obj.options.meta[cell] ? obj.options.meta[cell] : null;\n            }\n        }\n    }\n\n    /**\n     * Set meta information to cell(s)\n     * \n     * @return integer\n     */\n    obj.setMeta = function(o, k, v) {\n        if (! obj.options.meta) {\n            obj.options.meta = {}\n        }\n\n        if (k && v) {\n            // Set data value\n            if (! obj.options.meta[o]) {\n                obj.options.meta[o] = {};\n            }\n            obj.options.meta[o][k] = v;\n        } else {\n            // Apply that for all cells\n            var keys = Object.keys(o);\n            for (var i = 0; i < keys.length; i++) {\n                if (! obj.options.meta[keys[i]]) {\n                    obj.options.meta[keys[i]] = {};\n                }\n\n                var prop = Object.keys(o[keys[i]]);\n                for (var j = 0; j < prop.length; j++) {\n                    obj.options.meta[keys[i]][prop[j]] = o[keys[i]][prop[j]];\n                }\n            }\n        }\n\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onchangemeta) == 'function') {\n                obj.options.onchangemeta(el, o, k, v);\n            }\n        }\n    }\n\n    /**\n     * Update meta information\n     * \n     * @return integer\n     */\n    obj.updateMeta = function(affectedCells) {\n        if (obj.options.meta) {\n            var newMeta = {};\n            var keys = Object.keys(obj.options.meta);\n            for (var i = 0; i < keys.length; i++) {\n                if (affectedCells[keys[i]]) {\n                    newMeta[affectedCells[keys[i]]] = obj.options.meta[keys[i]];\n                } else {\n                    newMeta[keys[i]] = obj.options.meta[keys[i]];\n                }\n            }\n            // Update meta information\n            obj.options.meta = newMeta;\n        }\n    }\n\n    /**\n     * Get style information from cell(s)\n     * \n     * @return integer\n     */\n    obj.getStyle = function(cell, key) {\n        // Cell\n        if (! cell) {\n            // Control vars\n            var data = {};\n\n            // Column and row length\n            var x = obj.options.data[0].length;\n            var y = obj.options.data.length;\n\n            // Go through the columns to get the data\n            for (var j = 0; j < y; j++) {\n                for (var i = 0; i < x; i++) {\n                    // Value\n                    var v = key ? obj.records[j][i].style[key] : obj.records[j][i].getAttribute('style');\n\n                    // Any meta data for this column?\n                    if (v) {\n                        // Column name\n                        var k = jexcel.getColumnNameFromId([i, j]);\n                        // Value\n                        data[k] = v;\n                    }\n                }\n            }\n\n           return data;\n        } else {\n            cell = jexcel.getIdFromColumnName(cell, true);\n\n            return key ? obj.records[cell[1]][cell[0]].style[key] : obj.records[cell[1]][cell[0]].getAttribute('style');\n        }\n    },\n\n    obj.resetStyle = function(o, ignoreHistoryAndEvents) {\n        var keys = Object.keys(o);\n        for (var i = 0; i < keys.length; i++) {\n            // Position\n            var cell = jexcel.getIdFromColumnName(keys[i], true);\n            if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n                obj.records[cell[1]][cell[0]].setAttribute('style', '');\n            }\n        }\n        obj.setStyle(o, null, null, null, ignoreHistoryAndEvents);\n    }\n\n    /**\n     * Set meta information to cell(s)\n     * \n     * @return integer\n     */\n    obj.setStyle = function(o, k, v, force, ignoreHistoryAndEvents) {\n        var newValue = {};\n        var oldValue = {};\n\n        // Apply style\n        var applyStyle = function(cellId, key, value) {\n            // Position\n            var cell = jexcel.getIdFromColumnName(cellId, true);\n\n            if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n                // Current value\n                var currentValue = obj.records[cell[1]][cell[0]].style[key];\n\n                // Change layout\n                if (currentValue == value && ! force) {\n                    value = '';\n                    obj.records[cell[1]][cell[0]].style[key] = '';\n                } else {\n                    obj.records[cell[1]][cell[0]].style[key] = value;\n                }\n\n                // History\n                if (! oldValue[cellId]) {\n                    oldValue[cellId] = [];\n                }\n                if (! newValue[cellId]) {\n                    newValue[cellId] = [];\n                }\n\n                oldValue[cellId].push([key + ':' + currentValue]);\n                newValue[cellId].push([key + ':' + value]);\n            }\n        }\n\n        if (k && v) {\n            // Get object from string\n            if (typeof(o) == 'string') {\n                applyStyle(o, k, v);\n            } else {\n                // Avoid duplications\n                var oneApplication = [];\n                // Apply that for all cells\n                for (var i = 0; i < o.length; i++) {\n                    var x = o[i].getAttribute('data-x');\n                    var y = o[i].getAttribute('data-y');\n                    var cellName = jexcel.getColumnNameFromId([x, y]);\n                    // This happens when is a merged cell\n                    if (! oneApplication[cellName]) {\n                        applyStyle(cellName, k, v);\n                        oneApplication[cellName] = true;\n                    }\n                }\n            }\n        } else {\n            var keys = Object.keys(o);\n            for (var i = 0; i < keys.length; i++) {\n                var style = o[keys[i]];\n                if (typeof(style) == 'string') {\n                    style = style.split(';');\n                }\n                for (var j = 0; j < style.length; j++) {\n                    if (typeof(style[j]) == 'string') {\n                        style[j] = style[j].split(':');\n                    }\n                    // Apply value\n                    if (style[j][0].trim()) {\n                        applyStyle(keys[i], style[j][0].trim(), style[j][1]);\n                    }\n                }\n            }\n        }\n\n        var keys = Object.keys(oldValue);\n        for (var i = 0; i < keys.length; i++) {\n            oldValue[keys[i]] = oldValue[keys[i]].join(';');\n        }\n        var keys = Object.keys(newValue);\n        for (var i = 0; i < keys.length; i++) {\n            newValue[keys[i]] = newValue[keys[i]].join(';');\n        }\n\n        if (! ignoreHistoryAndEvents) {\n            // Keeping history of changes\n            obj.setHistory({\n                action: 'setStyle',\n                oldValue: oldValue,\n                newValue: newValue,\n            });\n        }\n\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onchangestyle) == 'function') {\n                obj.options.onchangestyle(el, o, k, v);\n            }\n        }\n    }\n\n    /**\n     * Get cell comments, null cell for all\n     */\n    obj.getComments = function(cell, withAuthor) {\n        if (cell) {\r\n            if (typeof(cell) == 'string') {\r\n              var cell = jexcel.getIdFromColumnName(cell, true);\r\n            }\r\n\r\n            if (withAuthor) {\r\n                return [obj.records[cell[1]][cell[0]].getAttribute('title'), obj.records[cell[1]][cell[0]].getAttribute('author')];\r\n            } else {\r\n                return obj.records[cell[1]][cell[0]].getAttribute('title') || '';\r\n            }\r\n        } else {\r\n            var data = {};\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                for (var i = 0; i < obj.options.columns.length; i++) {\r\n                    var comments = obj.records[j][i].getAttribute('title');\r\n                    if (comments) {\r\n                        var cell = jexcel.getColumnNameFromId([i, j]);\r\n                        data[cell] = comments;\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        }\n    }\n\n    /**\n     * Set cell comments\n     */\n    obj.setComments = function(cellId, comments, author) {\n        if (typeof(cellId) == 'string') {\n            var cell = jexcel.getIdFromColumnName(cellId, true);\n        } else {\n            var cell = cellId;\n        }\n\n        // Keep old value\n        var title = obj.records[cell[1]][cell[0]].getAttribute('title');\n        var author = obj.records[cell[1]][cell[0]].getAttribute('data-author');\n        var oldValue = [ title, author ];\n\n        // Set new values\n        obj.records[cell[1]][cell[0]].setAttribute('title', comments ? comments : '');\n        obj.records[cell[1]][cell[0]].setAttribute('data-author', author ? author : '');\n\n        // Remove class if there is no comment\n        if (comments) {\n            obj.records[cell[1]][cell[0]].classList.add('jexcel_comments');\n        } else {\n            obj.records[cell[1]][cell[0]].classList.remove('jexcel_comments');\n        }\n\n        // Save history\n        obj.setHistory({\n            action:'setComments',\n            column: cellId,\n            newValue: [ comments, author ],\n            oldValue: oldValue,\n        });\n    }\n\n    /**\n     * Get table config information\n     */\n    obj.getConfig = function() {\n        var options = obj.options;\n        options.style = obj.getStyle();\n        options.mergeCells = obj.getMerge();\r\n        options.comments = obj.getComments();\n\n        return options;\n    }\n\n    /**\n     * Sort data and reload table\n     */\n    obj.orderBy = function(column, order) {\n        if (column >= 0) {\n            // Merged cells\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n                if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                    return false;\n                } else {\n                    // Remove merged cells\n                    obj.destroyMerged();\n                }\n            }\n\n            // Direction\n            if (order == null) {\n                order = obj.headers[column].classList.contains('arrow-down') ? 1 : 0;\n            } else {\n                order = order ? 1 : 0;\n            }\n\n            // Filter\n            Array.prototype.orderBy = function(p, o) {\n                return this.slice(0).sort(function(a, b) {\n                    var valueA = a[p] == '' ? '' : Number(a[p]) == a[p] ? Number(a[p]) : a[p].toLowerCase();\n                    var valueB = b[p] == '' ? '' : Number(b[p]) == b[p] ? Number(b[p]) : b[p].toLowerCase();\n\n                    if (! o) {\n                        return (valueA == '' && valueB != '') ? 1 : (valueA != '' && valueB == '') ? -1 : (valueA > valueB) ? 1 : (valueA < valueB) ? -1 :  0;\n                    } else {\n                        return (valueA == '' && valueB != '') ? 1 : (valueA != '' && valueB == '') ? -1 : (valueA > valueB) ? -1 : (valueA < valueB) ? 1 :  0;\n                    }\n                });\n            }\n\n            // Test order\n            var temp = [];\n            if (obj.options.columns[column].type == 'calendar' ||\n                obj.options.columns[column].type == 'checkbox' ||\n                obj.options.columns[column].type == 'radio') {\n                for (var j = 0; j < obj.options.data.length; j++) {\n                    temp[j] = [ j, obj.options.data[j][column] ];\n                }\n            } else {\n                for (var j = 0; j < obj.options.data.length; j++) {\n                    temp[j] = [ j, obj.records[j][column].innerHTML ];\n                }\n            }\n            temp = temp.orderBy(1, order);\n\n            // Save history\n            var newValue = [];\n            for (var j = 0; j < temp.length; j++) {\n                newValue[j] = temp[j][0];\n            }\n\n            // Save history\n            obj.setHistory({\n                action: 'orderBy',\n                rows: newValue,\n                column: column,\n                order: order,\n            });\n\n            // Update order\n            obj.updateOrderArrow(column, order);\n            obj.updateOrder(newValue);\n\n            // On sort event\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.onsort) == 'function') {\n                    obj.options.onsort(el, column, order);\n                }\n            }\n\n            return true;\n        }\n    }\n\n    /**\n     * Update order arrow\n     */\n    obj.updateOrderArrow = function(column, order) {\n        // Remove order\n        for (var i = 0; i < obj.headers.length; i++) {\n            obj.headers[i].classList.remove('arrow-up');\n            obj.headers[i].classList.remove('arrow-down');\n        }\n\n        // No order specified then toggle order\n        if (order) {\n            obj.headers[column].classList.add('arrow-up');\n        } else {\n            obj.headers[column].classList.add('arrow-down');\n        }\n    }\n\n    /**\n     * Update rows position\n     */\n    obj.updateOrder = function(rows) {\n        // History\n        var data = []\n        for (var j = 0; j < rows.length; j++) {\n            data[j] = obj.options.data[rows[j]];\n        }\n        obj.options.data = data;\n\n        var data = []\n        for (var j = 0; j < rows.length; j++) {\n            data[j] = obj.records[rows[j]];\n        }\n        obj.records = data;\n\n        var data = []\n        for (var j = 0; j < rows.length; j++) {\n            data[j] = obj.rows[rows[j]];\n        }\n        obj.rows = data;\n\n        // Update references\n        obj.updateTableReferences();\n\n        // Redo search\n        if (obj.searchInput.value) {\n            obj.search(obj.searchInput.value);\n        } else {\n            // Create page\n            obj.results = null;\n            obj.pageNumber = 0;\n\n            if (obj.options.pagination > 0) {\n                obj.page(0);\n            } else if (obj.options.lazyLoading == true) {\n                obj.loadPage(0);\n            } else {\n                for (var j = 0; j < obj.rows.length; j++) {\n                    obj.tbody.appendChild(obj.rows[j]);\n                }\n            }\n        }\n    }\n\n    /**\n     * Move row\n     * \n     * @return void\n     */\n    obj.moveRow = function(o, d, ignoreDom) {\n        if (Object.keys(obj.options.mergeCells).length > 0) {\n           if (o > d) {\r\n               var insertBefore = 1;\r\n           } else {\r\n               var insertBefore = 0;\r\n           }\r\n\r\n           if (obj.isRowMerged(o).length || obj.isRowMerged(d, insertBefore).length) {\n                if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                    return false;\n                } else {\n                    obj.destroyMerged();\n                }\n            }\n        }\n\n        if (obj.options.search == true) {\n            if (obj.results && obj.results.length != obj.rows.length) {\n                if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                    obj.resetSearch();\n                } else {\n                    return false;\n                }\n            }\n\n            obj.results = null;\n        }\n\n        if (! ignoreDom) {\n            if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[d]) >= 0) {\n                if (o > d) {\n                    obj.tbody.insertBefore(obj.rows[o], obj.rows[d]);\n                } else {\n                    obj.tbody.insertBefore(obj.rows[o], obj.rows[d].nextSibling);\n                }\n            } else {\n                obj.tbody.removeChild(obj.rows[o]);\n            }\n        }\n\n        // Place references in the correct position\n        obj.rows.splice(d, 0, obj.rows.splice(o, 1)[0]);\n        obj.records.splice(d, 0, obj.records.splice(o, 1)[0]);\n        obj.options.data.splice(d, 0, obj.options.data.splice(o, 1)[0]);\n\n        // Respect pagination\n        if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n            obj.page(obj.pageNumber);\n        }\n\n        // Keeping history of changes\n        obj.setHistory({\n            action:'moveRow',\n            oldValue: o,\n            newValue: d,\n        });\n\n        // Update table references\n        obj.updateTableReferences();\n\n        // Events\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onmoverow) == 'function') {\n                obj.options.onmoverow(el, o, d);\n            }\n        }\n    }\n\n    /**\n     * Insert a new row\n     * \n     * @param mixed - number of blank lines to be insert or a single array with the data of the new row\n     * @param rowNumber\n     * @param insertBefore\n     * @return void\n     */\n    obj.insertRow = function(mixed, rowNumber, insertBefore) {\n        // Configuration\n        if (obj.options.allowInsertRow == true) {\n            // Records\n            var records = [];\n\n            // Data to be insert\n            var data = [];\n\n            // The insert could be lead by number of rows or the array of data\n            if (mixed > 0) {\n                var numOfRows = mixed;\n            } else {\n                var numOfRows = 1;\n\n                if (mixed) {\n                    data = mixed;\n                }\n            }\n\n            // Direction\n            var insertBefore = insertBefore ? true : false;\n\n            // Current column number\n            var lastRow = obj.options.data.length - 1;\n\n            if (rowNumber == undefined || rowNumber >= parseInt(lastRow) || rowNumber < 0) {\n                rowNumber = lastRow;\n            }\n\n            // Onbeforeinsertrow\n            if (typeof(obj.options.onbeforeinsertrow) == 'function') {\n                if (! obj.options.onbeforeinsertrow(el, rowNumber, numOfRows, insertBefore)) {\n                    console.log('onbeforeinsertrow returned false');\n\n                    return false;\n                }\n            }\n\n            // Merged cells\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n                if (obj.isRowMerged(rowNumber, insertBefore).length) {\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                        return false;\n                    } else {\n                        obj.destroyMerged();\n                    }\n                }\n            }\n\n            // Clear any search\n            if (obj.options.search == true) {\n                if (obj.results && obj.results.length != obj.rows.length) {\n                    if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                        obj.resetSearch();\n                    } else {\n                        return false;\n                    }\n                }\n\n                obj.results = null;\n            }\n\n            // Insertbefore\n            var rowIndex = (! insertBefore) ? rowNumber + 1 : rowNumber;\n\n            // Keep the current data\n            var currentRecords = obj.records.splice(rowIndex);\n            var currentData = obj.options.data.splice(rowIndex);\n            var currentRows = obj.rows.splice(rowIndex);\n\n            // Adding lines\n            var rowRecords = [];\n            var rowData = [];\n            var rowNode = [];\n\n            for (var row = rowIndex; row < (numOfRows + rowIndex); row++) {\n                // Push data to the data container\n                obj.options.data[row] = [];\n                for (var col = 0; col < obj.options.columns.length; col++) {\n                    obj.options.data[row][col]  = data[col] ? data[col] : '';\n                }\n                // Create row\n                var tr = obj.createRow(row, obj.options.data[row]);\n                // Append node\n                if (currentRows[0]) {\r\n                    if (Array.prototype.indexOf.call(obj.tbody.children, currentRows[0]) >= 0) {\r\n                        obj.tbody.insertBefore(tr, currentRows[0]);\n                    }\n                } else {\r\n                    if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[rowNumber]) >= 0) {\r\n                        obj.tbody.appendChild(tr);\r\n                    }\r\n                }\n                // Record History\n                rowRecords.push(obj.records[row]);\n                rowData.push(obj.options.data[row]);\n                rowNode.push(tr);\n            }\n\n            // Copy the data back to the main data\n            Array.prototype.push.apply(obj.records, currentRecords);\n            Array.prototype.push.apply(obj.options.data, currentData);\n            Array.prototype.push.apply(obj.rows, currentRows);\n\n            // Respect pagination\n            if (obj.options.pagination > 0) {\n                obj.page(obj.pageNumber);\n            }\n\n            // Keep history\n            obj.setHistory({\n                action: 'insertRow',\n                rowNumber: rowNumber,\n                numOfRows: numOfRows,\n                insertBefore: insertBefore,\n                rowRecords: rowRecords,\n                rowData: rowData,\n                rowNode: rowNode,\n            });\n\n            // Remove table references\n            obj.updateTableReferences();\n\n            // Events\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.oninsertrow) == 'function') {\n                    obj.options.oninsertrow(el, rowNumber, numOfRows, rowRecords, insertBefore);\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete a row by number\n     * \n     * @param integer rowNumber - row number to be excluded\n     * @param integer numOfRows - number of lines\n     * @return void\n     */\n    obj.deleteRow = function(rowNumber, numOfRows) {\n        // Global Configuration\n        if (obj.options.allowDeleteRow == true) {\n            if (obj.options.allowDeletingAllRows == true || obj.options.data.length > 1) {\n                // Delete row definitions\n                if (rowNumber == undefined) {\n                    var number = obj.getSelectedRows();\n\n                    if (! number[0]) {\n                        rowNumber = obj.options.data.length - 1;\n                        numOfRows = 1;\n                    } else {\n                        rowNumber = parseInt(number[0].getAttribute('data-y'));\n                        numOfRows = number.length;\n                    }\n                }\n\n                // Last column\n                var lastRow = obj.options.data.length - 1;\n\n                if (rowNumber == undefined || rowNumber > lastRow || rowNumber < 0) {\n                    rowNumber = lastRow;\n                }\n\n                if (! numOfRows) {\n                    numOfRows = 1;\n                }\n\n                // Do not delete more than the number of recoreds\n                if (rowNumber + numOfRows >= obj.options.data.length) {\n                    numOfRows = obj.options.data.length - rowNumber;\n                }\n\n                // Onbeforedeleterow\n                if (typeof(obj.options.onbeforedeleterow) == 'function') {\n                    if (! obj.options.onbeforedeleterow(el, rowNumber, numOfRows)) {\n                        console.log('onbeforedeleterow returned false');\n                        return false;\n                    }\n                }\n\n                if (parseInt(rowNumber) > -1) {\n                    // Merged cells\n                    var mergeExists = false;\n                    if (Object.keys(obj.options.mergeCells).length > 0) {\n                        for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n                            if (obj.isRowMerged(row, false).length) {\n                                mergeExists = true;\n                            }\n                        }\n                    }\n                    if (mergeExists) {\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                            return false;\n                        } else {\n                            obj.destroyMerged();\n                        }\n                    }\n\n                    // Clear any search\n                    if (obj.options.search == true) {\n                        if (obj.results && obj.results.length != obj.rows.length) {\n                            if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                                obj.resetSearch();\n                            } else {\n                                return false;\n                            }\n                        }\n\n                        obj.results = null;\n                    }\n\n                    // Remove node\n                    for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n                        if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[row]) >= 0) {\n                            obj.rows[row].className = '';\n                            obj.rows[row].parentNode.removeChild(obj.rows[row]);\n                        }\n                    }\n\n                    // Remove data\n                    var rowRecords = obj.records.splice(rowNumber, numOfRows);\n                    var rowData = obj.options.data.splice(rowNumber, numOfRows);\n                    var rowNode = obj.rows.splice(rowNumber, numOfRows);\n\n                    // Respect pagination\n                    if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n                        obj.page(obj.pageNumber);\n                    }\n\n                    // Remove selection\n                    obj.conditionalSelectionUpdate(1, rowNumber, (rowNumber + numOfRows) - 1);\n\n                    // Keep history\n                    obj.setHistory({\n                        action: 'deleteRow',\n                        rowNumber: rowNumber,\n                        numOfRows: numOfRows,\n                        insertBefore: 1,\n                        rowRecords: rowRecords,\n                        rowData: rowData,\n                        rowNode: rowNode\n                    });\n\n                    // Remove table references\n                    obj.updateTableReferences();\n\n                    // Events\n                    if (obj.ignoreEvents != true) {\n                        if (typeof(obj.options.ondeleterow) == 'function') {\n                            obj.options.ondeleterow(el, rowNumber, numOfRows, rowRecords);\n                        }\n                    }\n                }\n            } else {\n                console.error('JEXCEL. It is not possible to delete the last row');\n            }\n        }\n    }\n\n\n    /**\n     * Move column\n     * \n     * @return void\n     */\n    obj.moveColumn = function(o, d) {\n        if (Object.keys(obj.options.mergeCells).length > 0) {\n            if (o > d) {\r\n                var insertBefore = 1;\r\n            } else {\r\n                var insertBefore = 0;\r\n            }\r\n\r\n            if (obj.isColMerged(o).length || obj.isColMerged(d, insertBefore).length) {\r\n                if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                    return false;\n                } else {\n                    obj.destroyMerged();\n                }\n            }\n        }\n\n        var o = parseInt(o);\n        var d = parseInt(d);\n\n        if (o > d) {\n            obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d]);\n            obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d]);\n\n            for (var j = 0; j < obj.rows.length; j++) {\n                obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d]);\n            }\n        } else {\n            obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d].nextSibling);\n            obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d].nextSibling);\n\n            for (var j = 0; j < obj.rows.length; j++) {\n                obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d].nextSibling);\n            }\n        }\n\n        obj.options.columns.splice(d, 0, obj.options.columns.splice(o, 1)[0]);\n        obj.headers.splice(d, 0, obj.headers.splice(o, 1)[0]);\n        obj.colgroup.splice(d, 0, obj.colgroup.splice(o, 1)[0]);\n\n        for (var j = 0; j < obj.rows.length; j++) {\n            obj.options.data[j].splice(d, 0, obj.options.data[j].splice(o, 1)[0]);\n            obj.records[j].splice(d, 0, obj.records[j].splice(o, 1)[0]);\n        }\n\n        // Keeping history of changes\n        obj.setHistory({\n            action:'moveColumn',\n            oldValue: o,\n            newValue: d,\n        });\n\n        // Update table references\n        obj.updateTableReferences();\n\n        // Events\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onmovecolumn) == 'function') {\n                obj.options.onmovecolumn(el, o, d);\n            }\n        }\n    }\n\n\n    /**\n     * Insert a new column\n     * \n     * @param mixed - num of columns to be added or data to be added in one single column\n     * @param int columnNumber - number of columns to be created\n     * @param bool insertBefore\n     * @param object properties - column properties\n     * @return void\n     */\n    obj.insertColumn = function(mixed, columnNumber, insertBefore, properties) {\n        // Configuration\n        if (obj.options.allowInsertColumn == true) {\n            // Records\n            var records = [];\n\n            // Data to be insert\n            var data = [];\n\n            // The insert could be lead by number of rows or the array of data\n            if (mixed > 0) {\n                var numOfColumns = mixed;\n            } else {\n                var numOfColumns = 1;\n\n                if (mixed) {\n                    data = mixed;\n                }\n            }\n\n            // Direction\n            var insertBefore = insertBefore ? true : false;\n\n            // Current column number\n            var lastColumn = obj.options.columns.length - 1;\n\n            // Confirm position\n            if (columnNumber == undefined || columnNumber >= parseInt(lastColumn) || columnNumber < 0) {\n                columnNumber = lastColumn;\n            }\n\n            // Onbeforeinsertcolumn\n            if (typeof(obj.options.onbeforeinsertcolumn) == 'function') {\n                if (! obj.options.onbeforeinsertcolumn(el, columnNumber, numOfColumns, insertBefore)) {\n                    console.log('onbeforeinsertcolumn returned false');\n\n                    return false;\n                }\n            }\n\n            // Merged cells\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n                if (obj.isColMerged(columnNumber, insertBefore).length) {\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                        return false;\n                    } else {\n                        obj.destroyMerged();\n                    }\n                }\n            }\n\n            // Create default properties\n            if (! properties) {\n                properties = [];\n            }\n\n            for (var i = 0; i < numOfColumns; i++) {\n                if (! properties[i]) {\n                    properties[i] = { type:'text', source:[], options:[], width:obj.options.defaultColWidth, align:obj.options.defaultColAlign };\n                }\n            }\n\n            // Insert before\n            var columnIndex = (! insertBefore) ? columnNumber + 1 : columnNumber;\n            obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, properties);\n\n            // Open space in the containers\n            var currentHeaders = obj.headers.splice(columnIndex);\n            var currentColgroup = obj.colgroup.splice(columnIndex);\n\n            // History\n            var historyHeaders = [];\n            var historyColgroup = [];\n            var historyRecords = [];\n            var historyData = [];\n\n            // Add new headers\n            for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\n                obj.createCellHeader(col);\n                obj.headerContainer.insertBefore(obj.headers[col], obj.headerContainer.children[col+1]);\n                obj.colgroupContainer.insertBefore(obj.colgroup[col], obj.colgroupContainer.children[col+1]);\n\n                historyHeaders.push(obj.headers[col]);\n                historyColgroup.push(obj.colgroup[col]);\n            }\n\n            // Adding visual columns\n            for (var row = 0; row < obj.options.data.length; row++) {\n                // Keep the current data\n                var currentData = obj.options.data[row].splice(columnIndex);\n                var currentRecord = obj.records[row].splice(columnIndex);\n\n                // History\n                historyData[row] = [];\n                historyRecords[row] = [];\n\n                for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\n                    // New value\n                    var value = data[row] ? data[row] : '';\n                    obj.options.data[row][col] = value;\n                    // New cell\n                    var td = obj.createCell(col, row, obj.options.data[row][col]);\n                    obj.records[row][col] = td;\n                    // Add cell to the row\n                    if (obj.rows[row]) {\n                        obj.rows[row].insertBefore(td, obj.rows[row].children[col+1]);\n                    }\n\n                    // Record History\n                    historyData[row].push(value);\n                    historyRecords[row].push(td);\n                }\n\n                // Copy the data back to the main data\n                Array.prototype.push.apply(obj.options.data[row], currentData);\n                Array.prototype.push.apply(obj.records[row], currentRecord);\n            }\n\n            Array.prototype.push.apply(obj.headers, currentHeaders);\n            Array.prototype.push.apply(obj.colgroup, currentColgroup);\n\n            // Adjust nested headers\n            if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                // Flexible way to handle nestedheaders\n                if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                    for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                        var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + numOfColumns;\n                        obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                        obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                    }\n                } else {\n                    var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + numOfColumns;\n                    obj.options.nestedHeaders[0].colspan = colspan;\n                    obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n                }\n            }\n\n            // Keep history\n            obj.setHistory({\n                action: 'insertColumn',\n                columnNumber:columnNumber,\n                numOfColumns:numOfColumns,\n                insertBefore:insertBefore,\n                columns:properties,\n                headers:historyHeaders,\n                colgroup:historyColgroup,\n                records:historyRecords,\n                data:historyData,\n            });\n\n            // Remove table references\n            obj.updateTableReferences();\n\n            // Events\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.oninsertcolumn) == 'function') {\n                    obj.options.oninsertcolumn(el, columnNumber, numOfColumns, historyRecords, insertBefore);\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete a column by number\n     * \n     * @param integer columnNumber - reference column to be excluded\n     * @param integer numOfColumns - number of columns to be excluded from the reference column\n     * @return void\n     */\n    obj.deleteColumn = function(columnNumber, numOfColumns) {\n        // Global Configuration\n        if (obj.options.allowDeleteColumn == true) {\n            if (obj.headers.length > 1) {\n                // Delete column definitions\n                if (columnNumber == undefined) {\n                    var number = obj.getSelectedColumns(true);\n\n                    if (! number.length) {\n                        // Remove last column\n                        columnNumber = obj.headers.length - 1;\n                        numOfColumns = 1;\n                    } else {\n                        // Remove selected\n                        columnNumber = parseInt(number[0]);\n                        numOfColumns = parseInt(number.length);\n                    }\n                }\n\n                // Lasat column\n                var lastColumn = obj.options.data[0].length - 1;\n\n                if (columnNumber == undefined || columnNumber > lastColumn || columnNumber < 0) {\n                    columnNumber = lastColumn;\n                }\n\n                // Minimum of columns to be delete is 1\n                if (! numOfColumns) {\n                    numOfColumns = 1;\n                }\n\n\n\n                // Can't delete more than the limit of the table\n                if (numOfColumns > obj.options.data[0].length - columnNumber) {\n                    numOfColumns = obj.options.data[0].length - columnNumber;\n                }\n\n                // onbeforedeletecolumn\n                if (typeof(obj.options.onbeforedeletecolumn) == 'function') {\n                   if (! obj.options.onbeforedeletecolumn(el, columnNumber, numOfColumns)) {\n                      console.log('onbeforedeletecolumn returned false');\n                      return false;\n                   }\n                }\n\n                // Can't remove the last column\n                if (parseInt(columnNumber) > -1) {\n                    // Merged cells\n                    var mergeExists = false;\n                    if (Object.keys(obj.options.mergeCells).length > 0) {\n                        for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                            if (obj.isColMerged(col, false).length) {\n                                mergeExists = true;\n                            }\n                        }\n                    }\n                    if (mergeExists) {\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                            return false;\n                        } else {\n                            obj.destroyMerged();\n                        }\n                    }\n\n                    // Delete the column properties\n                    var columns = obj.options.columns.splice(columnNumber, numOfColumns);\n\n                    for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                        obj.colgroup[col].className = '';\n                        obj.headers[col].className = '';\n                        obj.colgroup[col].parentNode.removeChild(obj.colgroup[col]);\n                        obj.headers[col].parentNode.removeChild(obj.headers[col]);\n                    }\n\n                    var historyHeaders = obj.headers.splice(columnNumber, numOfColumns);\n                    var historyColgroup = obj.colgroup.splice(columnNumber, numOfColumns);\n                    var historyRecords = [];\n                    var historyData = [];\n\n                    for (var row = 0; row < obj.options.data.length; row++) {\n                        for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                            obj.records[row][col].className = '';\n                            obj.records[row][col].parentNode.removeChild(obj.records[row][col]);\n                        }\n                    }\n\n                    // Delete headers\n                    for (var row = 0; row < obj.options.data.length; row++) {\n                        // History\n                        historyData[row] = obj.options.data[row].splice(columnNumber, numOfColumns);\n                        historyRecords[row] = obj.records[row].splice(columnNumber, numOfColumns);\n                    }\n\n                    // Remove selection\n                    obj.conditionalSelectionUpdate(0, columnNumber, (columnNumber + numOfColumns) - 1);\n\n                    // Adjust nested headers\n                    if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                        // Flexible way to handle nestedheaders\n                        if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                            for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                                var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - numOfColumns;\n                                obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                                obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                            }\n                        } else {\n                            var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - numOfColumns;\n                            obj.options.nestedHeaders[0].colspan = colspan;\n                            obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n                        }\n                    }\n\n                    // Keeping history of changes\n                    obj.setHistory({\n                        action:'deleteColumn',\n                        columnNumber:columnNumber,\n                        numOfColumns:numOfColumns,\n                        insertBefore: 1,\n                        columns:columns,\n                        headers:historyHeaders,\n                        colgroup:historyColgroup,\n                        records:historyRecords,\n                        data:historyData,\n                    });\n\n                    // Update table references\n                    obj.updateTableReferences();\n\n                    // Delete\n                    if (obj.ignoreEvents != true) {\n                        if (typeof(obj.options.ondeletecolumn) == 'function') {\n                            obj.options.ondeletecolumn(el, columnNumber, numOfColumns, historyRecords);\n                        }\n                    }\n                }\n            } else {\n                console.error('JEXCEL. It is not possible to delete the last column');\n            }\n        }\n    }\n\n    /**\n     * Get seleted rows numbers\n     * \n     * @return array\n     */\n    obj.getSelectedRows = function(asIds) {\n        var rows = [];\n        // Get all selected rows\n        for (var j = 0; j < obj.rows.length; j++) {\n            if (obj.rows[j].classList.contains('selected')) {\n                if (asIds) {\n                    rows.push(j);\n                } else {\n                    rows.push(obj.rows[j]);\n                }\n            }\n        }\n\n        return rows;\n    },\n\n    /**\n     * Get seleted column numbers\n     * \n     * @return array\n     */\n    obj.getSelectedColumns = function() {\n        var cols = [];\n        // Get all selected cols\n        for (var i = 0; i < obj.headers.length; i++) {\n            if (obj.headers[i].classList.contains('selected')) {\n                cols.push(i);\n            }\n        }\n\n        return cols;\n    }\n\n    /**\n     * Get highlighted\n     * \n     * @return array\n     */\n    obj.getHighlighted = function() {\n        return obj.highlighted;\n    }\n\n    /**\n     * Update cell references\n     * \n     * @return void\n     */\n    obj.updateTableReferences = function() {\n        // Update headers\n        for (var i = 0; i < obj.headers.length; i++) {\n            var x = obj.headers[i].getAttribute('data-x');\n\n            if (x != i) {\n                // Update coords\n                obj.headers[i].setAttribute('data-x', i);\n                // Title\n                if (! obj.headers[i].getAttribute('title')) {\n                    obj.headers[i].innerHTML = jexcel.getColumnName(i);\n                }\n            }\n        }\n\n        // Update all rows\n        for (var j = 0; j < obj.rows.length; j++) {\n            if (obj.rows[j]) {\n                var y = obj.rows[j].getAttribute('data-y');\n\n                if (y != j) {\n                    // Update coords\n                    obj.rows[j].setAttribute('data-y', j);\n                    obj.rows[j].children[0].setAttribute('data-y', j);\n                    // Row number\n                    obj.rows[j].children[0].innerHTML = j + 1;\n                }\n            }\n        }\n\n        // Regular cells affected by this change\n        var affectedTokens = [];\n        var mergeCellUpdates = [];\n\n        // Update cell\n        var updatePosition = function(x,y,i,j) {\n            if (x != i) {\n                obj.records[j][i].setAttribute('data-x', i);\n            }\n            if (y != j) {\n                obj.records[j][i].setAttribute('data-y', j);\n            }\n\n            // Other updates\n            if (x != i || y != j) {\n                var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\n                var columnIdTo = jexcel.getColumnNameFromId([i, j]);\n                affectedTokens[columnIdFrom] = columnIdTo;\n            }\n        }\n\n        for (var j = 0; j < obj.records.length; j++) {\n            for (var i = 0; i < obj.records[0].length; i++) {\n                if (obj.records[j][i]) {\n                    // Current values\n                    var x = obj.records[j][i].getAttribute('data-x');\n                    var y = obj.records[j][i].getAttribute('data-y');\n\n                    // Update column\n                    if (obj.records[j][i].getAttribute('data-merged')) {\n                        var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\n                        var columnIdTo = jexcel.getColumnNameFromId([i, j]);\n                        if (mergeCellUpdates[columnIdFrom] == null) {\n                            if (columnIdFrom == columnIdTo) {\n                                mergeCellUpdates[columnIdFrom] = false;\n                            } else {\n                                var totalX = parseInt(i - x);\n                                var totalY = parseInt(j - y);\n                                mergeCellUpdates[columnIdFrom] = [ columnIdTo, totalX, totalY ];\n                            }\n                        }\n                    } else {\n                        updatePosition(x,y,i,j);\n                    }\n                }\n            }\n        }\n\n        // Update merged if applicable\n        var keys = Object.keys(mergeCellUpdates);\n        if (keys.length) {\n            for (var i = 0; i < keys.length; i++) {\n                if (mergeCellUpdates[keys[i]]) {\n                    var info = jexcel.getIdFromColumnName(keys[i], true)\n                    var x = info[0];\n                    var y = info[1];\n                    updatePosition(x,y,x + mergeCellUpdates[keys[i]][1],y + mergeCellUpdates[keys[i]][2]);\n\n                    var columnIdFrom = keys[i];\n                    var columnIdTo = mergeCellUpdates[keys[i]][0];\n                    for (var j = 0; j < obj.options.mergeCells[columnIdFrom][2].length; j++) {\n                        var x = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-x'));\n                        var y = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-y'));\n                        obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-x', x + mergeCellUpdates[keys[i]][1]);\n                        obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-y', y + mergeCellUpdates[keys[i]][2]);\n                    }\n\n                    obj.options.mergeCells[columnIdTo] = obj.options.mergeCells[columnIdFrom];\n                    delete(obj.options.mergeCells[columnIdFrom]);\n                }\n            }\n        }\n\n        // Update formulas\n        obj.updateFormulas(affectedTokens);\n\n        // Update meta data\n        obj.updateMeta(affectedTokens);\n\n        // Refresh selection\n        obj.refreshSelection();\n\n        // Update table with custom configuration if applicable\n        obj.updateTable();\n    }\n\n    /**\n     * Custom settings for the cells\n     */\n    obj.updateTable = function() {\n        // Check for spare\n        if (obj.options.minSpareRows > 0) {\n            var numBlankRows = 0;\n            for (var j = obj.rows.length - 1; j >= 0; j--) {\n                var test = false;\n                for (var i = 0; i < obj.headers.length; i++) {\n                    if (obj.options.data[j][i]) {\n                        test = true;\n                    }\n                }\n                if (test) {\n                    break;\n                } else {\n                    numBlankRows++;\n                }\n            }\n\n            if (obj.options.minSpareRows - numBlankRows > 0) {\n                obj.insertRow(obj.options.minSpareRows - numBlankRows)\n            }\n        }\n\n        if (obj.options.minSpareCols > 0) {\n            var numBlankCols = 0;\n            for (var i = obj.headers.length - 1; i >= 0 ; i--) {\n                var test = false;\n                for (var j = 0; j < obj.rows.length; j++) {\n                    if (obj.options.data[j][i]) {\n                        test = true;\n                    }\n                }\n                if (test) {\n                    break;\n                } else {\n                    numBlankCols++;\n                }\n            }\n\n            if (obj.options.minSpareCols - numBlankCols > 0) {\n                obj.insertColumn(obj.options.minSpareCols - numBlankCols)\n            }\n        }\n\n        // Customizations by the developer\n        if (typeof(obj.options.updateTable) == 'function') {\n            if (obj.options.detachForUpdates) {\r\n                el.removeChild(obj.content);\r\n            }\r\n\n            for (var j = 0; j < obj.rows.length; j++) {\n                for (var i = 0; i < obj.headers.length; i++) {\n                    obj.options.updateTable(el, obj.records[j][i], i, j, obj.options.data[j][i], obj.records[j][i].innerText, jexcel.getColumnNameFromId([i, j]));\n                }\n            }\n\r\n            if (obj.options.detachForUpdates) {\r\n                el.insertBefore(obj.content, obj.pagination);\r\n            }\n        }\n\n        // Update corner position\n        setTimeout(function() {\n            obj.updateCornerPosition();\n        },0);\n    }\n\r\n    /**\r\n     * Show column\r\n     */\r\n    obj.showColumn = function(colNumber) {\r\n        obj.headers[colNumber].style.display = '';\r\n        obj.colgroup[colNumber].style.display = '';\r\n        for (var j = 0; j < obj.options.data.length; j++) {\r\n            obj.records[j][colNumber].style.display = '';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Hide column\r\n     */\r\n    obj.hideColumn = function(colNumber) {\r\n        obj.headers[colNumber].style.display = 'none';\r\n        obj.colgroup[colNumber].style.display = 'none';\r\n        for (var j = 0; j < obj.options.data.length; j++) {\r\n            obj.records[j][colNumber].style.display = 'none';\r\n        }\r\n    }\r\n\n    /**\n     * Show index column\n     */\n    obj.showIndex = function() {\n        obj.table.classList.remove('jexcel_hidden_index');\n    }\n\n    /**\n     * Hide index column\n     */\n    obj.hideIndex = function() {\n        obj.table.classList.add('jexcel_hidden_index');\n    }\n\n    /**\n     * Update all related cells in the chain\n     */\n    var chainLoopProtection = [];\n\n    obj.updateFormulaChain = function(x, y, records) {\n        var cellId = jexcel.getColumnNameFromId([x, y]);\n        if (obj.formula[cellId] && obj.formula[cellId].length > 0) {\n            if (chainLoopProtection[cellId]) {\n                obj.records[y][x].innerHTML = '#ERROR';\n                obj.formula[cellId] = '';\n            } else {\n                // Protection\n                chainLoopProtection[cellId] = true;\n\n                for (var i = 0; i < obj.formula[cellId].length; i++) {\n                    var cell = jexcel.getIdFromColumnName(obj.formula[cellId][i], true);\n                    // Update cell\n                    var value = ''+obj.options.data[cell[1]][cell[0]];\n                    if (value.substr(0,1) == '=') {\n                        records.push(obj.updateCell(cell[0], cell[1], value, true));\n                    } else {\n                        // No longer a formula, remove from the chain\n                        Object.keys(obj.formula)[i] = null;\n                    }\n                    obj.updateFormulaChain(cell[0], cell[1], records);\n                }\n            }\n        }\n\n        chainLoopProtection = [];\n    }\n\n    /**\n     * Update formulas\n     */\n    obj.updateFormulas = function(referencesToUpdate) {\n        // Update formulas\n        for (var j = 0; j < obj.options.data.length; j++) {\n            for (var i = 0; i < obj.options.data[0].length; i++) {\n                var value = '' + obj.options.data[j][i];\n                // Is formula\n                if (value.substr(0,1) == '=') {\n                    // Replace tokens\n                    var newFormula = obj.updateFormula(value, referencesToUpdate);\n                    if (newFormula != value) {\n                        obj.options.data[j][i] = newFormula;\n                    }\n                }\n            }\n        }\n\n        // Update formula chain\n        var formula = [];\n        var keys = Object.keys(obj.formula);\n        for (var j = 0; j < keys.length; j++) {\n            // Current key and values\n            var key = keys[j];\n            var value = obj.formula[key];\n            // Update key\n            if (referencesToUpdate[key]) {\n                key = referencesToUpdate[key];\n            }\n            // Update values\n            formula[key] = [];\n            for (var i = 0; i < value.length; i++) {\n                var letter = value[i];\n                if (referencesToUpdate[letter]) {\n                    letter = referencesToUpdate[letter];\n                }\n                formula[key].push(letter);\n            }\n        }\n        obj.formula = formula;\n    }\n\n    /**\n     * Update formula\n     */\n    obj.updateFormula = function(formula, referencesToUpdate) {\n        var testLetter = /[A-Z]/;\n        var testNumber = /[0-9]/;\n\n        var newFormula = '';\n        var letter = null;\n        var number = null;\n        var token = '';\n\n        for (var index = 0; index < formula.length; index++) {\n            if (testLetter.exec(formula[index])) {\n                letter = 1;\n                number = 0;\n                token += formula[index];\n            } else if (testNumber.exec(formula[index])) {\n                number = letter ? 1 : 0;\n                token += formula[index];\n            } else {\n                if (letter && number) {\n                    token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n                }\n                newFormula += token;\n                newFormula += formula[index];\n                letter = 0;\n                number = 0;\n                token = '';\n            }\n        }\n\n        if (token) {\n            if (letter && number) {\n                token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n            }\n            newFormula += token;\n        }\n\n        return newFormula;\n    }\n\n    /**\n     * Parse formulas\n     */\n    obj.executeFormula = function(expression, x, y) {\n\n        var formulaResults = [];\n        var formulaLoopProtection = [];\n\n        // Execute formula with loop protection\n        var execute = function(expression, x, y) {\n         // Parent column identification\n            var parentId = jexcel.getColumnNameFromId([x, y]);\n\n            // Code protection\n            if (formulaLoopProtection[parentId]) {\n                console.error('Reference loop detected');\n                return '#ERROR';\n            }\n\n            formulaLoopProtection[parentId] = true;\n\n            // Convert range tokens\n            var tokensUpdate = function(tokens) {\n                for (var index = 0; index < tokens.length; index++) {\n                    var f = [];\n                    var token = tokens[index].split(':');\n                    var e1 = jexcel.getIdFromColumnName(token[0], true);\n                    var e2 = jexcel.getIdFromColumnName(token[1], true);\n\n                    if (e1[0] <= e2[0]) {\n                        var x1 = e1[0];\n                        var x2 = e2[0];\n                    } else {\n                        var x1 = e2[0];\n                        var x2 = e1[0];\n                    }\n\n                    if (e1[1] <= e2[1]) {\n                        var y1 = e1[1];\n                        var y2 = e2[1];\n                    } else {\n                        var y1 = e2[1];\n                        var y2 = e1[1];\n                    }\n\n                    for (var j = y1; j <= y2; j++) {\n                        for (var i = x1; i <= x2; i++) {\n                            f.push(jexcel.getColumnNameFromId([i, j]));\n                        }\n                    }\n\n                    expression = expression.replace(tokens[index], f.join(','));\n                }\n            }\n\n            var tokens = expression.match(/([A-Z]+[0-9]+)\\:([A-Z]+[0-9]+)/g);\n            if (tokens && tokens.length) {\n                tokensUpdate(tokens);\n            }\n\n            // String\n            var evalstring = '';\n\n            // Get tokens\n            var tokens = expression.match(/([A-Z]+[0-9]+)/g);\n\n            // Direct self-reference protection\n            if (tokens && tokens.indexOf(parentId) > -1) {\n                console.error('Self Reference detected');\n                return '#ERROR';\n            } else {\n                if (tokens) {\n                    for (var i = 0; i < tokens.length; i++) {\n                        // Keep chain\n                        if (! obj.formula[tokens[i]]) {\n                            obj.formula[tokens[i]] = [];\n                        }\n                        // Is already in the register\n                        if (obj.formula[tokens[i]].indexOf(parentId) < 0) {\n                            obj.formula[tokens[i]].push(parentId);\n                        }\n\n                        // Do not calculate again\n                        if (eval('typeof(' + tokens[i] + ') == \"undefined\"')) {\n                            // Coords\n                            var position = jexcel.getIdFromColumnName(tokens[i], 1);\n                            // Get value\n                            if (typeof(obj.options.data[position[1]]) != 'undefined' && typeof(obj.options.data[position[1]][position[0]]) != 'undefined') {\n                                var value = obj.options.data[position[1]][position[0]];\n                            } else {\n                                var value = '';\n                            }\n                            // Get column data\n                            if ((''+value).substr(0,1) == '=') {\n                                if (formulaResults[tokens[i]]) {\n                                    value = formulaResults[tokens[i]];\n                                } else {\n                                    value = execute(value, position[0], position[1]);\n                                    formulaResults[tokens[i]] = value;\n                                }\n                            }\n                            // Type!\n                            if ((''+value).trim() == '') {\n                                // Null\n                                evalstring += \"var \" + tokens[i] + \" = null;\";\n                            } else {\n                                if (value == Number(value) && obj.options.autoCasting == true) {\n                                    // Number\n                                    evalstring += \"var \" + tokens[i] + \" = \" + Number(value) + \";\";\n                                } else {\n                                    // Trying any formatted number\n                                    var number = obj.parseNumber(value, position[0])\n                                    if (obj.options.autoCasting == true && number) {\n                                        // Render as number\n                                        evalstring += \"var \" + tokens[i] + \" = \" + number + \";\";\n                                    } else {\n                                        // Render as string\n                                        evalstring += \"var \" + tokens[i] + \" = '\" + value + \"';\";\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n\n                // Convert formula to javascript\n                try {\n                    evalstring += \"function COLUMN() { return parseInt(x) + 1; }; function ROW() { return parseInt(y) + 1; }; function CELL() { return parentId; };\";\n\n                    var res = eval(evalstring + expression.substr(1));\n                } catch (e) {\n                    var res = '#ERROR';\n                }\n\n                return res;\n            }\n        }\n\n        return execute(expression, x, y);\n    }\n\n    /**\n     * Trying to extract a number from a string\n     */\n    obj.parseNumber = function(value, columnNumber) {\n        // Decimal point\n        var decimal = columnNumber && obj.options.columns[columnNumber].decimal ? obj.options.columns[columnNumber].decimal : '.';\n\n        // Parse both parts of the number\n        var number = ('' + value);\n        number = number.split(decimal);\n        number[0] = number[0].match(/[+-]?[0-9]/g);\n        if (number[0]) {\n            number[0] = number[0].join('');\n        }\n        if (number[1]) {\n            number[1] = number[1].match(/[0-9]*/g).join('');\n        }\n\n        // Is a valid number\n        if (number[0] && Number(number[0]) >= 0) {\n            if (! number[1]) {\n                var value = Number(number[0] + '.00');\n            } else {\n                var value = Number(number[0] + '.' + number[1]);\n            }\n        } else {\n            var value = null;\n        }\n\n        return value;\n    }\n\n    /**\n     * Get row number\n     */\n    obj.row = function(cell) {\n    }\n\n    /**\n     * Get col number\n     */\n    obj.col = function(cell) {\n    }\n\n    obj.up = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[3] > 0) {\n                obj.up.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[1] > 0) {\n                obj.up.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        // Update selection\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n\n        // Change page\n        if (obj.options.lazyLoading == true) {\n            if (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0) {\n                obj.loadPage(0);\n                obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            } else {\n                if (obj.loadValidation()) {\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                } else {\n                    var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n                    if (obj.selectedCell[1] - item < 30) {\n                        obj.loadUp();\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                    }\n                }\n            }\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateScroll(1);\n    }\n\n    obj.up.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var j = 0; j < y; j++) {\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                    y = j;\n                    break;\n                }\n            }\n        } else {\n            y = obj.up.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.up.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n        for (var j = (y - 1); j >= 0; j--) {\n            if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                if (obj.records[j][x].getAttribute('data-merged')) {\n                    if (obj.records[j][x] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                y = j;\n                break;\n            }\n        }\n\n        return y;\n    }\n\n    obj.down = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[3] < obj.records.length - 1) {\n                obj.down.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[1] < obj.records.length - 1) {\n                obj.down.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n\n        // Change page\n        if (obj.options.lazyLoading == true) {\n            if ((obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\n                obj.loadPage(-1);\n                obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            } else {\n                if (obj.loadValidation()) {\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                } else {\n                    var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n                    if (item - obj.selectedCell[3] < 30) {\n                        obj.loadDown();\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                    }\n                }\n            }\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateScroll(3);\n    }\n\n    obj.down.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var j = obj.rows.length - 1; j > y; j--) {\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                    y = j;\n                    break;\n                }\n            }\n        } else {\n            y = obj.down.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.down.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n        for (var j = (y + 1); j < obj.rows.length; j++) {\n            if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                if (obj.records[j][x].getAttribute('data-merged')) {\n                    if (obj.records[j][x] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                y = j;\n                break;\n            }\n        }\n\n        return y;\n    }\n\n    obj.right = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[2] < obj.headers.length - 1) {\n                obj.right.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[0] < obj.headers.length - 1) {\n                obj.right.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(2);\n    }\n\n    obj.right.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var i = obj.headers.length - 1; i > x; i--) {\n                if (obj.records[y][i].style.display != 'none') {\n                    x = i;\n                    break;\n                }\n            }\n        } else {\n            x = obj.right.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.right.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n\n        for (var i = (x + 1); i < obj.headers.length; i++) {\n            if (obj.records[y][i].style.display != 'none') {\n                if (obj.records[y][i].getAttribute('data-merged')) {\n                    if (obj.records[y][i] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                x = i;\n                break;\n            }\n        }\n\n        return x;\n    }\n\n    obj.left = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[2] > 0) {\n                obj.left.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[0] > 0) {\n                obj.left.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(0);\n    }\n\n    obj.left.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var i = 0; i < x; i++) {\n                if (obj.records[y][i].style.display != 'none') {\n                    x = i;\n                    break;\n                }\n            }\n        } else {\n            x = obj.left.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.left.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n        for (var i = (x - 1); i >= 0; i--) {\n            if (obj.records[y][i].style.display != 'none') {\n                if (obj.records[y][i].getAttribute('data-merged')) {\n                    if (obj.records[y][i] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                x = i;\n                break;\n            }\n        }\n\n        return x;\n    }\n\n    obj.first = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (ctrlKey) {\n                obj.selectedCell[3] = 0;\n            } else {\n                obj.left.visible(1, 0);\n            }\n        } else {\n            if (ctrlKey) {\n                obj.selectedCell[1] = 0;\n            } else {\n                obj.left.visible(0, 0);\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        // Change page\n        if (obj.options.lazyLoading == true && (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0)) {\n            obj.loadPage(0);\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(1);\n    }\n\n    obj.last = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (ctrlKey) {\n                obj.selectedCell[3] = obj.records.length - 1;\n            } else {\n                obj.right.visible(1, 0);\n            }\n        } else {\n            if (ctrlKey) {\n                obj.selectedCell[1] = obj.records.length - 1;\n            } else {\n                obj.right.visible(0, 0);\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        // Change page\n        if (obj.options.lazyLoading == true && (obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\n            obj.loadPage(-1);\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(3);\n    }\n\n    obj.selectAll = function() {\n        if (! obj.selectedCell) {\n            obj.selectedCell = [];\n        }\n\n        obj.selectedCell[0] = 0;\n        obj.selectedCell[1] = 0;\n        obj.selectedCell[2] = obj.headers.length - 1;\n        obj.selectedCell[3] = obj.records.length - 1;\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n    }\n\n    /**\n     * Go to a page in a lazyLoading\n     */\n    obj.loadPage = function(pageNumber) {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n\n        // Per page\n        var quantityPerPage = 100;\n\n        // pageNumber\n        if (pageNumber == null || pageNumber == -1) {\n            // Last page\n            pageNumber = Math.ceil(results.length / quantityPerPage); \n        }\n\n        var startRow = (pageNumber * quantityPerPage);\n        var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\n        if (finalRow > results.length) {\n            finalRow = results.length;\n        }\n        startRow = finalRow - 100;\n        if (startRow < 0) {\n            startRow = 0;\n        }\n\n        // Appeding items\n        for (var j = startRow; j < finalRow; j++) {\n            if (obj.options.search == true && obj.results) {\n                obj.tbody.appendChild(obj.rows[results[j]]);\n            } else {\n                obj.tbody.appendChild(obj.rows[j]);\n            }\n\n            if (obj.tbody.children.length > quantityPerPage) {\n                obj.tbody.removeChild(obj.tbody.firstChild);\n            }\n        }\n    }\n\n    obj.loadUp = function() {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n        var test = 0;\n        if (results.length > 100) {\n            // Get the first element in the page\n            var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n            if (obj.options.search == true && obj.results) {\n                item = results.indexOf(item);\n            }\n            if (item > 0) {\n                for (var j = 0; j < 30; j++) {\n                    item = item - 1;\n                    if (item > -1) {\n                        if (obj.options.search == true && obj.results) {\n                            obj.tbody.insertBefore(obj.rows[results[item]], obj.tbody.firstChild);\n                        } else {\n                            obj.tbody.insertBefore(obj.rows[item], obj.tbody.firstChild);\n                        }\n                        if (obj.tbody.children.length > 100) {\n                            obj.tbody.removeChild(obj.tbody.lastChild);\n                            test = 1;\n                        }\n                    }\n                }\n            }\n        }\n        return test;\n    }\n\n    obj.loadDown = function() {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n        var test = 0;\n        if (results.length > 100) {\n            // Get the last element in the page\n            var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n            if (obj.options.search == true && obj.results) {\n                item = results.indexOf(item);\n            }\n            if (item < obj.rows.length - 1) {\n                for (var j = 0; j <= 30; j++) {\n                    if (item < results.length) {\n                        if (obj.options.search == true && obj.results) {\n                            obj.tbody.appendChild(obj.rows[results[item]]);\n                        } else {\n                            obj.tbody.appendChild(obj.rows[item]);\n                        }\n                        if (obj.tbody.children.length > 100) {\n                            obj.tbody.removeChild(obj.tbody.firstChild);\n                            test = 1;\n                        }\n                    }\n                    item = item + 1;\n                }\n            }\n        }\n\n        return test;\n    }\n\n    obj.loadValidation = function() {\n        if (obj.selectedCell) {\n            var currentPage = parseInt(obj.tbody.firstChild.getAttribute('data-y')) / 100;\n            var selectedPage = parseInt(obj.selectedCell[3] / 100);\n            var totalPages = parseInt(obj.rows.length / 100);\n\n            if (currentPage != selectedPage && selectedPage <= totalPages) {\n                if (! Array.prototype.indexOf.call(obj.tbody.children, obj.rows[obj.selectedCell[3]])) {\n                    obj.loadPage(selectedPage);\n                    return true;\n                }\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * Reset search\n     */\n    obj.resetSearch = function() {\n        obj.searchInput.value = '';\n        obj.search('');\n        obj.results = null;\n    }\n\n    /**\n     * Search\n     */\n    obj.search = function(query) {\n        // Query\n        if (query) {\n            var query = query.toLowerCase();\n        }\n\n        // Reset selection\n        obj.resetSelection();\n\n        // Total of results\n        obj.pageNumber = 0;\n        obj.results = [];\n\n        if (query) {\n            // Search filter\n            var search = function(item, query, index) {\n                for (var i = 0; i < item.length; i++) {\n                    if ((''+item[i]).toLowerCase().search(query) >= 0 ||\n                        (''+obj.records[index][i].innerHTML).toLowerCase().search(query) >= 0) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n\n            // Result\n            var addToResult = function(k) {\n                if (obj.results.indexOf(k) == -1) {\n                    obj.results.push(k);\n                }\n            }\n\n            // Filter\n            var data = obj.options.data.filter(function(v, k) {\n                if (search(v, query, k)) {\n                    // Merged rows found\n                    var rows = obj.isRowMerged(k);\n                    if (rows.length) {\n                        for (var i = 0; i < rows.length; i++) {\n                            var row = jexcel.getIdFromColumnName(rows[i], true);\n                            for (var j = 0; j < obj.options.mergeCells[rows[i]][1]; j++) {\n                                addToResult(row[1]+j);\n                            }\n                        }\n                    } else {\n                        // Normal row found\n                        addToResult(k);\n                    }\n                    return true;\n                } else {\n                    return false;\n                }\n            });\n        } else {\n            obj.results = null;\n        }\n\n        var total = 0;\n        var index = 0;\n\n        // Page 1\n        if (obj.options.lazyLoading == true) {\n            total = 100;\n        } else if (obj.options.pagination > 0) {\n            total = obj.options.pagination;\n        } else {\n            if (obj.results) {\n                total = obj.results.length;\n            } else {\n                total = obj.rows.length;\n            }\n        }\n\n        // Reset current nodes\n        while (obj.tbody.firstChild) {\n            obj.tbody.removeChild(obj.tbody.firstChild);\n        }\n\n        // Hide all records from the table\n        for (var j = 0; j < obj.rows.length; j++) {\n            if (! obj.results || obj.results.indexOf(j) > -1) {\n                if (index < total) {\n                    obj.tbody.appendChild(obj.rows[j]);\n                    index++;\n                }\n                obj.rows[j].style.display = '';\n            } else {\n                obj.rows[j].style.display = 'none';\n            }\n        }\n\n        // Update pagination\n        if (obj.options.pagination > 0) {\n            obj.updatePagination();\n        }\n\n        return total;\n    }\n\n    /**\n     * Which page the cell is\n     */\n    obj.whichPage = function(cell) {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            cell = obj.results.indexOf(cell);\n        }\n\n        return (Math.ceil((parseInt(cell) + 1) / parseInt(obj.options.pagination))) - 1;\n    }\n\n    /**\n     * Go to page\n     */\n    obj.page = function(pageNumber) {\n        var oldPage = obj.pageNumber;\r\n\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n\n        // Per page\n        var quantityPerPage = parseInt(obj.options.pagination);\n\n        // pageNumber\n        if (pageNumber == null || pageNumber == -1) {\n            // Last page\n            pageNumber = Math.ceil(results.length / quantityPerPage); \n        }\n\n        // Page number\n        obj.pageNumber = pageNumber;\n\n        var startRow = (pageNumber * quantityPerPage);\n        var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\n        if (finalRow > results.length) {\n            finalRow = results.length;\n        }\n        if (startRow < 0) {\n            startRow = 0;\n        }\n\n        // Reset container\n        while (obj.tbody.firstChild) {\n            obj.tbody.removeChild(obj.tbody.firstChild);\n        }\n\n        // Appeding items\n        for (var j = startRow; j < finalRow; j++) {\n            if (obj.options.search == true && obj.results) {\n                obj.tbody.appendChild(obj.rows[results[j]]);\n            } else {\n                obj.tbody.appendChild(obj.rows[j]);\n            }\n        }\n\n        if (obj.options.pagination > 0) {\n            obj.updatePagination();\n        }\n\n        // Update corner position\n        obj.updateCornerPosition();\n\r\n        if (typeof(obj.options.onchangepage) == 'function') {\r\n            obj.options.onchangepage(el, pageNumber, oldPage);\r\n        }\n    }\n\n    /**\n     * Update the pagination\n     */\n    obj.updatePagination = function() {\n        // Reset container\n        obj.pagination.children[0].innerHTML = '';\n        obj.pagination.children[1].innerHTML = '';\n\n        // Start pagination\n        if (obj.options.pagination) {\n            // Searchable\n            if (obj.options.search == true && obj.results) {\n                var results = obj.results.length;\n            } else {\n                var results = obj.rows.length;\n            }\n\n            if (! results) {\n                // No records found\n                obj.pagination.children[0].innerHTML = obj.options.text.noRecordsFound;\n            } else {\n                // Pagination container\n                var quantyOfPages = Math.ceil(results / obj.options.pagination);\n\n                if (obj.pageNumber < 6) {\n                    var startNumber = 1;\n                    var finalNumber = quantyOfPages < 10 ? quantyOfPages : 10;\n                } else if (quantyOfPages - obj.pageNumber < 5) {\n                    var startNumber = quantyOfPages - 9;\n                    var finalNumber = quantyOfPages;\n                    if (startNumber < 1) {\n                        startNumber = 1;\n                    }\n                } else {\n                    var startNumber = obj.pageNumber - 4;\n                    var finalNumber = obj.pageNumber + 5;\n                }\n\n                // First\n                if (startNumber > 1) {\n                    var paginationItem = document.createElement('div');\n                    paginationItem.className = 'jexcel_page';\n                    paginationItem.innerHTML = '<';\n                    paginationItem.title = 1;\n                    obj.pagination.children[1].appendChild(paginationItem);\n                }\n\n                // Get page links\n                for (var i = startNumber; i <= finalNumber; i++) {\n                    var paginationItem = document.createElement('div');\n                    paginationItem.className = 'jexcel_page';\n                    paginationItem.innerHTML = i;\n                    obj.pagination.children[1].appendChild(paginationItem);\n\n                    if (obj.pageNumber == (i-1)) {\n                        paginationItem.classList.add('jexcel_page_selected');\n                    }\n                }\n\n                // Last\n                if (finalNumber < quantyOfPages) {\n                    var paginationItem = document.createElement('div');\n                    paginationItem.className = 'jexcel_page';\n                    paginationItem.innerHTML = '>';\n                    paginationItem.title = quantyOfPages;\n                    obj.pagination.children[1].appendChild(paginationItem);\n                }\n\n                // Text\n                var format = function(format) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    return format.replace(/{(\\d+)}/g, function(match, number) {\n                      return typeof args[number] != 'undefined'\n                        ? args[number]\n                        : match\n                      ;\n                    });\n                };\n\n                obj.pagination.children[0].innerHTML = format(obj.options.text.showingPage, obj.pageNumber + 1, quantyOfPages)\n            }\n        }\n    }\n\n    /**\n     * Download CSV table\n     * \n     * @return null\n     */\n    obj.download = function(includeHeaders) {\n        if (obj.options.allowExport == false) {\n            console.error('Export not allowed');\n        } else {\n            // Data\n            var data = '';\n            if (includeHeaders == true || obj.options.includeHeadersOnDownload == true) {\n                data += obj.getHeaders();\n                data += \"\\r\\n\";\n            }\n\r\n            // Get data\n            data += obj.copy(false, obj.options.csvDelimiter, true);\r\n\n            // Download element\n            var blob = new Blob([\"\\uFEFF\"+data], {type: 'text/csv;charset=utf-8;'});\n\r\n            // IE Compatibility\r\n            if (window.navigator && window.navigator.msSaveOrOpenBlob) {\r\n                window.navigator.msSaveOrOpenBlob(blob, options.csvFileName + '.csv');\r\n            } else {\n                // Download element\n                var pom = document.createElement('a');\n                var url = URL.createObjectURL(blob);\n                pom.href = url;\n                pom.setAttribute('download', obj.options.csvFileName + '.csv');\n                document.body.appendChild(pom);\n                pom.click();\n                pom.parentNode.removeChild(pom);\n            }\n        }\n    }\n\n    /**\n     * Initializes a new history record for undo/redo\n     * \n     * @return null\n     */\n    obj.setHistory = function(changes) {\n        if (obj.ignoreHistory != true) {\n            // Increment and get the current history index\n            var index = ++obj.historyIndex;\n\n            // Slice the array to discard undone changes\n            obj.history = (obj.history = obj.history.slice(0, index + 1));\n\n            // Keep history\n            obj.history[index] = changes;\n        }\n    }\n\n    /**\n     * Copy method\n     * \n     * @param bool highlighted - Get only highlighted cells\n     * @param delimiter - \\t default to keep compatibility with excel\n     * @return string value\n     */\n    obj.copy = function(highlighted, delimiter, returnData) {\n        if (! delimiter) {\n            delimiter = \"\\t\";\n        }\n\n        // Controls\n        var col = [];\n        var colLabel = [];\n        var row = [];\n        var rowLabel = [];\n        var x = obj.options.data[0].length\n        var y = obj.options.data.length\n        var tmp = '';\n\n        // Reset container\n        obj.style = [];\n\n        // Go through the columns to get the data\n        for (var j = 0; j < y; j++) {\n            col = [];\n            colLabel = [];\n\n            for (var i = 0; i < x; i++) {\n                // If cell is highlighted\n                if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                    // Values\n                    var value = obj.options.data[j][i];\n                    if (value.match && (value.match(/,/g) || value.match(/\\n/) || value.match(/\\\"/))) {\n                        value = value.replace(new RegExp('\"', 'g'), '\"\"');\n                        value = '\"' + value + '\"';\n                    }\n                    col.push(value);\n\n                    // Labels\n                    if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\r\n                        var label = value;\n                    } else {\r\n                        var label = obj.records[j][i].innerHTML;\n                        if (label.match && (label.match(/,/g) || label.match(/\\n/) || label.match(/\\\"/))) {\n                            // Scape double quotes\n                            label = label.replace(new RegExp('\"', 'g'), '\"\"');\n                            label = '\"' + label + '\"';\n                        }\r\n                    }\n                    colLabel.push(label);\n\n                    // Get style\n                    tmp = obj.records[j][i].getAttribute('style');\n                    obj.style.push(tmp ? tmp : '');\n                }\n            }\n\n            if (col.length) {\n                row.push(col.join(delimiter));\n            }\n            if (colLabel.length) {\n                rowLabel.push(colLabel.join(delimiter));\n            }\n        }\n\n        // Final string\n        var str = row.join(\"\\r\\n\");\n        var strLabel = rowLabel.join(\"\\r\\n\");\n\n        // Create a hidden textarea to copy the values\n        if (! returnData) {\n            if (obj.options.copyCompatibility == true) {\n                obj.textarea.value = strLabel;\n            } else {\n                obj.textarea.value = str;\n            }\n            obj.textarea.select();\n            document.execCommand(\"copy\");\n        }\n\n        // Keep data\n        if (obj.options.copyCompatibility == true) {\n            obj.data = strLabel;\n        } else {\n        obj.data = str;\n        }\n        // Keep non visible information\n        obj.hashString = obj.hash(obj.data);\n\n        return obj.data;\n    }\n\n    /**\n     * jExcel paste method\n     * \n     * @param integer row number\n     * @return string value\n     */\n    obj.paste = function(x, y, data) {\n        // Paste filter\n        if (typeof(obj.options.onbeforepaste) == 'function') {\n            var data = obj.options.onbeforepaste(el, data);\n        }\n\n        // Controls\n        var hash = obj.hash(data);\n        var style = (hash == obj.hashString) ? obj.style : null;\n\n        // Depending on the behavior\n        if (obj.options.copyCompatibility == true && hash == obj.hashString) {\n            var data = obj.data;\n        }\n\n        // Split new line\n        var data = obj.parseCSV(data, \"\\t\");\n\n        if (x != null && y != null && data) {\n            // Records\n            var i = 0;\n            var j = 0;\n            var records = [];\n            var newStyle = {};\n            var oldStyle = {};\n            var styleIndex = 0;\n\n            // Index\n            var colIndex = parseInt(x);\n            var rowIndex = parseInt(y);\n            var row = null;\n\n            // Go through the columns to get the data\n            while (row = data[j]) {\n                i = 0;\n                colIndex = parseInt(x);\n\n                while (row[i] != null) {\n                    // Update and keep history\n                    var record = obj.updateCell(colIndex, rowIndex, row[i]);\n                    // Keep history\n                    records.push(record);\n                    // Update all formulas in the chain\n                    obj.updateFormulaChain(colIndex, rowIndex, records);\n                    // Style\n                    if (style && style[styleIndex]) {\n                        var columnName = jexcel.getColumnNameFromId([colIndex, rowIndex]);\n                        newStyle[columnName] = style[styleIndex];\n                        oldStyle[columnName] = obj.getStyle(columnName);\n                        obj.records[rowIndex][colIndex].setAttribute('style', style[styleIndex]);\n                        styleIndex++\n                    }\n                    i++;\n                    if (row[i] != null) {\n                        if (colIndex >= obj.headers.length - 1) {\n                            obj.insertColumn();\n                        }\n                        colIndex = obj.right.get(colIndex, rowIndex);\n                    }\n                }\n\n                j++;\n                if (data[j]) {\n                    if (rowIndex >= obj.rows.length-1) {\n                        obj.insertRow();\n                    }\n                    rowIndex = obj.down.get(x, rowIndex);\n                }\n            }\n\n            // Select the new cells\n            obj.updateSelectionFromCoords(x, y, colIndex, rowIndex);\n\n            // Update history\n            obj.setHistory({\n                action:'setValue',\n                records:records,\n                selection:obj.selectedCell,\n                newStyle:newStyle,\n                oldStyle:oldStyle,\n            });\n\n            // Update table\n            obj.updateTable();\n\n            // Paste event\n            if (typeof(obj.options.onpaste) == 'function') {\n                obj.options.onpaste(el, records);\n            }\n\n            // On after changes\n            obj.onafterchanges(el, records);\n        }\n    }\n\n    /**\n     * Process row\n     */\n    obj.historyProcessRow = function(type, historyRecord) {\n        var rowIndex = (! historyRecord.insertBefore) ? historyRecord.rowNumber + 1 : historyRecord.rowNumber;\n\n        if (obj.options.search == true) {\n            if (obj.results && obj.results.length != obj.rows.length) {\n                obj.resetSearch();\n            }\n        }\n\n        // Remove row\n        if (type == 1) {\n            var numOfRows = historyRecord.numOfRows;\n            // Remove nodes\n            for (var j = rowIndex; j < (numOfRows + rowIndex); j++) {\n                obj.rows[j].parentNode.removeChild(obj.rows[j]);\n            }\n            // Remove references\n            obj.records.splice(rowIndex, numOfRows);\n            obj.options.data.splice(rowIndex, numOfRows);\n            obj.rows.splice(rowIndex, numOfRows);\n\n            obj.conditionalSelectionUpdate(1, rowIndex, (numOfRows + rowIndex) - 1);\n        } else {\n            // Insert data\n            obj.records = jexcel.injectArray(obj.records, rowIndex, historyRecord.rowRecords);\n            obj.options.data = jexcel.injectArray(obj.options.data, rowIndex, historyRecord.rowData);\n            obj.rows = jexcel.injectArray(obj.rows, rowIndex, historyRecord.rowNode);\n            // Insert nodes\n            var index = 0\n            for (var j = rowIndex; j < (historyRecord.numOfRows + rowIndex); j++) {\n                obj.tbody.insertBefore(historyRecord.rowNode[index], obj.tbody.children[j]);\n                index++;\n            }\n        }\n\n        // Respect pagination\n        if (obj.options.pagination > 0) {\n            obj.page(obj.pageNumber);\n        }\n\n        obj.updateTableReferences();\n    }\n\n    /**\n     * Process column\n     */\n    obj.historyProcessColumn = function(type, historyRecord) {\n        var columnIndex = (! historyRecord.insertBefore) ? historyRecord.columnNumber + 1 : historyRecord.columnNumber;\n\n        // Remove column\n        if (type == 1) {\n            var numOfColumns = historyRecord.numOfColumns;\n\n            obj.options.columns.splice(columnIndex, numOfColumns);\n            for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\n                obj.headers[i].parentNode.removeChild(obj.headers[i]);\n                obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]);\n            }\n            obj.headers.splice(columnIndex, numOfColumns);\n            obj.colgroup.splice(columnIndex, numOfColumns);\n            for (var j = 0; j < historyRecord.data.length; j++) {\n                for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\n                    obj.records[j][i].parentNode.removeChild(obj.records[j][i]);\n                }\n                obj.records[j].splice(columnIndex, numOfColumns);\n                obj.options.data[j].splice(columnIndex, numOfColumns);\n            }\n\n            obj.conditionalSelectionUpdate(0, columnIndex, (numOfColumns + columnIndex) - 1);\n        } else {\n            // Insert data\n            obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, historyRecord.columns);\n            obj.headers = jexcel.injectArray(obj.headers, columnIndex, historyRecord.headers);\n            obj.colgroup = jexcel.injectArray(obj.colgroup, columnIndex, historyRecord.colgroup);\n\n            var index = 0\n            for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\n                obj.headerContainer.insertBefore(historyRecord.headers[index], obj.headerContainer.children[i+1]);\n                obj.colgroupContainer.insertBefore(historyRecord.colgroup[index], obj.colgroupContainer.children[i+1]);\n                index++;\n            }\n\n            for (var j = 0; j < historyRecord.data.length; j++) {\n                obj.options.data[j] = jexcel.injectArray(obj.options.data[j], columnIndex, historyRecord.data[j]);\n                obj.records[j] = jexcel.injectArray(obj.records[j], columnIndex, historyRecord.records[j]);\n                var index = 0\n                for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\n                    obj.rows[j].insertBefore(historyRecord.records[j][index], obj.rows[j].children[i+1]);\n                    index++;\n                }\n            }\n        }\n\n        // Adjust nested headers\n        if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n            // Flexible way to handle nestedheaders\n            if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                    if (type == 1) {\n                        var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - historyRecord.numOfColumns;\n                    } else {\n                        var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + historyRecord.numOfColumns;\n                    }\n                    obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                    obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                }\n            } else {\n                if (type == 1) {\n                    var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - historyRecord.numOfColumns;\n                } else {\n                    var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + historyRecord.numOfColumns;\n                }\n                obj.options.nestedHeaders[0].colspan = colspan;\n                obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n            }\n        }\n\n        obj.updateTableReferences();\n    }\n\n    /**\n     * Undo last action\n     */\n    obj.undo = function() {\n        // Ignore events and history\n        var ignoreEvents = obj.ignoreEvents ? true : false;\n        var ignoreHistory = obj.ignoreHistory ? true : false;\n\n        obj.ignoreEvents = true;\n        obj.ignoreHistory = true;\n\n        // Records\n        var records = [];\n\n        // Update cells\n        if (obj.historyIndex >= 0) {\n            // History\n            var historyRecord = obj.history[obj.historyIndex--];\n\n            if (historyRecord.action == 'insertRow') {\n                obj.historyProcessRow(1, historyRecord);\n            } else if (historyRecord.action == 'deleteRow') {\n                obj.historyProcessRow(0, historyRecord);\n            } else if (historyRecord.action == 'insertColumn') {\n                obj.historyProcessColumn(1, historyRecord);\n            } else if (historyRecord.action == 'deleteColumn') {\n                obj.historyProcessColumn(0, historyRecord);\n            } else if (historyRecord.action == 'moveRow') {\n                obj.moveRow(historyRecord.newValue, historyRecord.oldValue);\n            } else if (historyRecord.action == 'moveColumn') {\n                obj.moveColumn(historyRecord.newValue, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setMerge') {\n                obj.removeMerge(historyRecord.column, historyRecord.data);\n            } else if (historyRecord.action == 'setStyle') {\n                obj.setStyle(historyRecord.oldValue, null, null, 1);\n            } else if (historyRecord.action == 'setWidth') {\n                obj.setWidth(historyRecord.column, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setHeight') {\n                obj.setHeight(historyRecord.row, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setHeader') {\n                obj.setHeader(historyRecord.column, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setComments') {\n                obj.setComments(historyRecord.column, historyRecord.oldValue[0], historyRecord.oldValue[1]);\n            } else if (historyRecord.action == 'orderBy') {\n                var rows = [];\n                for (var j = 0; j < historyRecord.rows.length; j++) {\n                    rows[historyRecord.rows[j]] = j;\n                }\n                obj.updateOrderArrow(historyRecord.column, historyRecord.order ? 0 : 1);\n                obj.updateOrder(rows);\n            } else if (historyRecord.action == 'setValue') {\n                // Redo for changes in cells\n                for (var i = 0; i < historyRecord.records.length; i++) {\n                    obj.updateCell(historyRecord.records[i].col, historyRecord.records[i].row, historyRecord.records[i].oldValue);\n                    obj.updateFormulaChain(historyRecord.records[i].col, historyRecord.records[i].row, records);\n                    if (historyRecord.oldStyle) {\n                        obj.resetStyle(historyRecord.oldStyle, true);\n                    }\n                }\n                // Update selection\n                if (! historyRecord.selection) {\n                    historyRecord.selection = [historyRecord.records[0].col, historyRecord.records[0].row];\n                }\n                obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\n                // Update table\n                obj.updateTable();\n            }\n        }\n        obj.ignoreEvents = ignoreEvents;\n        obj.ignoreHistory = ignoreHistory;\n\n        if (typeof(obj.options.onundo) == 'function') {\n            obj.options.onundo(el, historyRecord);\n        }\n    }\n\n    /**\n     * Redo previously undone action\n     */\n    obj.redo = function() {\n        // Ignore events and history\n        var ignoreEvents = obj.ignoreEvents ? true : false;\n        var ignoreHistory = obj.ignoreHistory ? true : false;\n\n        obj.ignoreEvents = true;\n        obj.ignoreHistory = true;\n\n        // Records\n        var records = [];\n\n        // Update cells\n        if (obj.historyIndex < obj.history.length - 1) {\n            // History\n            var historyRecord = obj.history[++obj.historyIndex];\n\n            if (historyRecord.action == 'insertRow') {\n                obj.historyProcessRow(0, historyRecord);\n            } else if (historyRecord.action == 'deleteRow') {\n                obj.historyProcessRow(1, historyRecord);\n            } else if (historyRecord.action == 'insertColumn') {\n                obj.historyProcessColumn(0, historyRecord);\n            } else if (historyRecord.action == 'deleteColumn') {\n                obj.historyProcessColumn(1, historyRecord);\n            } else if (historyRecord.action == 'moveRow') {\n                obj.moveRow(historyRecord.oldValue, historyRecord.newValue);\n            } else if (historyRecord.action == 'moveColumn') {\n                obj.moveColumn(historyRecord.oldValue, historyRecord.newValue);\n            } else if (historyRecord.action == 'setMerge') {\n                obj.setMerge(historyRecord.column, historyRecord.colspan, historyRecord.rowspan, 1);\n            } else if (historyRecord.action == 'setStyle') {\n                obj.setStyle(historyRecord.newValue, null, null, 1);\n            } else if (historyRecord.action == 'setWidth') {\n                obj.setWidth(historyRecord.column, historyRecord.newValue);\n            } else if (historyRecord.action == 'setHeight') {\n                obj.setHeight(historyRecord.row, historyRecord.newValue);\n            } else if (historyRecord.action == 'setHeader') {\n                obj.setHeader(historyRecord.column, historyRecord.newValue);\n            } else if (historyRecord.action == 'setComments') {\n                obj.setComments(historyRecord.column, historyRecord.newValue[0], historyRecord.newValue[1]);\n            } else if (historyRecord.action == 'orderBy') {\n                obj.updateOrderArrow(historyRecord.column, historyRecord.order);\n                obj.updateOrder(historyRecord.rows);\n            } else if (historyRecord.action == 'setValue') {\n                // Redo for changes in cells\n                for (var i = 0; i < historyRecord.records.length; i++) {\n                    obj.updateCell(historyRecord.records[i].col, historyRecord.records[i].row, historyRecord.records[i].newValue);\n                    obj.updateFormulaChain(historyRecord.records[i].col, historyRecord.records[i].row, records);\n                    if (historyRecord.newStyle) {\n                        obj.resetStyle(historyRecord.newStyle, true);\n                    }\n                }\n\n                // Update selection\n                if (! historyRecord.selection) {\n                    historyRecord.selection = [historyRecord.records[0].col, historyRecord.records[0].row];\n                }\n                obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\n                // Update table\n                obj.updateTable();\n            }\n        }\n        obj.ignoreEvents = ignoreEvents;\n        obj.ignoreHistory = ignoreHistory;\n\n        if (typeof(obj.options.onredo) == 'function') {\n            obj.options.onredo(el, historyRecord);\n        }\n    }\n\n    /**\n     * Get dropdown value from key\n     */\n    obj.getDropDownValue = function(column, key) {\n        var value = [];\n\n        if (obj.options.columns[column] && obj.options.columns[column].source) {\n            // Create array from source\n            var combo = [];\n            var source = obj.options.columns[column].source;\n\n            for (var i = 0; i < source.length; i++) {\n                if (typeof(source[i]) == 'object') {\n                    combo[source[i].id] = source[i].name;\n                } else {\n                    combo[source[i]] = source[i];\n                }\n            }\n\n            // Garante single multiple compatibily\n            var keys = ('' + key).split(';')\n\n            for (var i = 0; i < keys.length; i++) {\n                if (combo[keys[i]]) {\n                    value.push(combo[keys[i]]);\n                }\n            }\n        } else {\n            console.error('Invalid column');\n        }\n\n        return (value.length > 0) ? value.join('; ') : '';\n    }\n\n    /**\n     * From starckoverflow contributions\n     */\n    obj.parseCSV = function(str, delimiter) {\n        // Remove last line break\n        str = str.replace(/\\r?\\n$|\\r$|\\n$/g, \"\");\n        // Last caracter is the delimiter\n        if (str.charCodeAt(str.length-1) == 9) {\n            str += \"\\0\";\n        }\n        // user-supplied delimeter or default comma\n        delimiter = (delimiter || \",\");\n\n        var arr = [];\n        var quote = false;  // true means we're inside a quoted field\n        // iterate over each character, keep track of current row and column (of the returned array)\n        for (var row = 0, col = 0, c = 0; c < str.length; c++) {\n            var cc = str[c], nc = str[c+1];\n            arr[row] = arr[row] || [];\n            arr[row][col] = arr[row][col] || '';\n\n            // If the current character is a quotation mark, and we're inside a quoted field, and the next character is also a quotation mark, add a quotation mark to the current column and skip the next character\n            if (cc == '\"' && quote && nc == '\"') { arr[row][col] += cc; ++c; continue; }  \n\n            // If it's just one quotation mark, begin/end quoted field\n            if (cc == '\"') { quote = !quote; continue; }\n\n            // If it's a comma and we're not in a quoted field, move on to the next column\n            if (cc == delimiter && !quote) { ++col; continue; }\n\n            // If it's a newline (CRLF) and we're not in a quoted field, skip the next character and move on to the next row and move to column 0 of that new row\n            if (cc == '\\r' && nc == '\\n' && !quote) { ++row; col = 0; ++c; continue; }\n\n            // If it's a newline (LF or CR) and we're not in a quoted field, move on to the next row and move to column 0 of that new row\n            if (cc == '\\n' && !quote) { ++row; col = 0; continue; }\n            if (cc == '\\r' && !quote) { ++row; col = 0; continue; }\n\n            // Otherwise, append the current character to the current column\n            arr[row][col] += cc;\n        }\n        return arr;\n    }\n\n    obj.hash = function(str) {\n        var hash = 0, i, chr;\n\n        if (str.length === 0) {\n            return hash;\n        } else {\n            for (i = 0; i < str.length; i++) {\n              chr = str.charCodeAt(i);\n              hash = ((hash << 5) - hash) + chr;\n              hash |= 0;\n            }\n        }\n        return hash;\n    }\n\n    obj.onafterchanges = function(el, records) {\n        if (! obj.ignoreEvents) {\n            // On after changes\n            if (typeof(obj.options.onafterchanges) == 'function') {\n                obj.options.onafterchanges(el, records);\n            }\n        }\n    }\r\n\n    obj.destroy = function() {\r\n        jexcel.destroy(el);\r\n    }\r\n\n    /**\n     * Initialization method\n     */\n    obj.init = function() {\n        jexcel.current = obj;\n\n        // Build handlers\n        if (typeof(jexcel.build) == 'function') {\n            jexcel.build();\n            jexcel.build = null;\n        }\n\n        // Load the table data based on an CSV file\n        if (obj.options.csv) {\n            // Loading\n            if (obj.options.loadingSpin == true) {\n                jSuites.loading.show();\n            }\n\n            // Load CSV file\n            jSuites.ajax({\n                url: obj.options.csv,\n                method: 'GET',\n                dataType: 'text',\n                success: function(result) {\n                    // Convert data\n                    var newData = obj.parseCSV(result, obj.options.csvDelimiter)\n\n                    // Headers\n                    if (obj.options.csvHeaders == true && newData.length > 0) {\n                        var headers = newData.shift();\n                        for(var i = 0; i < headers.length; i++) {\n                            if (! obj.options.columns[i]) {\n                                obj.options.columns[i] = { type:'text', align:obj.options.defaultColAlign, width:obj.options.defaultColWidth };\n                            }\n                            // Precedence over pre-configurated titles\n                            if (typeof obj.options.columns[i].title === 'undefined') {\n                              obj.options.columns[i].title = headers[i];\n                            }\n                        }\n                    }\n                    // Data\n                    obj.options.data = newData;\n                    // Prepare table\n                    obj.prepareTable();\n                    // Hide spin\n                    if (obj.options.loadingSpin == true) {\n                        jSuites.loading.hide();\n                    }\n                }\n            });\n        } else if (obj.options.url) {\n            // Loading\n            if (obj.options.loadingSpin == true) {\n                jSuites.loading.show();\n            }\n\n            jSuites.ajax({\n                url: obj.options.url,\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    // Data\n                    obj.options.data = (result.data) ? result.data : result;\n                    // Prepare table\n                    obj.prepareTable();\n                    // Hide spin\n                    if (obj.options.loadingSpin == true) {\n                        jSuites.loading.hide();\n                    }\n                }\n            });\n        } else {\n            // Prepare table\n            obj.prepareTable();\n        }\n    }\n\n    // Context menu\n    if (options && options.contextMenu != null) {\n        obj.options.contextMenu = options.contextMenu;\n    } else {\n        obj.options.contextMenu = function(el, x, y, e) {\n            var items = [];\n\n            if (y == null) {\n                // Insert a new column\n                if (obj.options.allowInsertColumn == true) {\n                    items.push({\n                        title:obj.options.text.insertANewColumnBefore,\n                        onclick:function() {\n                            obj.insertColumn(1, parseInt(x), 1);\n                        }\n                    });\n                }\n\n                if (obj.options.allowInsertColumn == true) {\n                    items.push({\n                        title:obj.options.text.insertANewColumnAfter,\n                        onclick:function() {\n                            obj.insertColumn(1, parseInt(x), 0);\n                        }\n                    });\n                }\n\n                // Delete a column\n                if (obj.options.allowDeleteColumn == true) {\n                    items.push({\n                        title:obj.options.text.deleteSelectedColumns,\n                        onclick:function() {\n                            obj.deleteColumn(obj.getSelectedColumns().length ? undefined : parseInt(x));\n                        }\n                    });\n                }\n\n                // Rename column\n                if (obj.options.allowRenameColumn == true) {\n                    items.push({\n                        title:obj.options.text.renameThisColumn,\n                        onclick:function() {\n                            obj.setHeader(x);\n                        }\n                    });\n                }\n\n                // Sorting\n                if (obj.options.columnSorting == true) {\n                    // Line\n                    items.push({ type:'line' });\n\n                    items.push({\n                        title:obj.options.text.orderAscending,\n                        onclick:function() {\n                            obj.orderBy(x, 0);\n                        }\n                    });\n                    items.push({\n                        title:obj.options.text.orderDescending,\n                        onclick:function() {\n                            obj.orderBy(x, 1);\n                        }\n                    });\n                }\n            } else {\n                // Insert new row\n                if (obj.options.allowInsertRow == true) {\n                    items.push({\n                        title:obj.options.text.insertANewRowBefore,\n                        onclick:function() {\n                            obj.insertRow(1, parseInt(y), 1);\n                        }\n                    });\n\n                    items.push({\n                        title:obj.options.text.insertANewRowAfter,\n                        onclick:function() {\n                            obj.insertRow(1, parseInt(y));\n                        }\n                    });\n                }\n\n                if (obj.options.allowDeleteRow == true) {\n                    items.push({\n                        title:obj.options.text.deleteSelectedRows,\n                        onclick:function() {\n                            obj.deleteRow(obj.getSelectedRows().length ? undefined : parseInt(y));\n                        }\n                    });\n                }\n\n                if (x) {\n                    if (obj.options.allowComments == true) {\n                        items.push({ type:'line' });\n\n                        var title = obj.records[y][x].getAttribute('title') || '';\n\n                        items.push({\n                            title: title ? obj.options.text.editComments : obj.options.text.addComments,\n                            onclick:function() {\n                                var comment = prompt(obj.options.text.comments, title);\r\n                                if (comment) {\r\n                                    obj.setComments([ x, y ], comment);\r\n                                }\n                            }\n                        });\n\n                        if (title) {\n                            items.push({\n                                title:obj.options.text.clearComments,\n                                onclick:function() {\n                                    obj.setComments([ x, y ], '');\n                                }\n                            });\n                        }\n                    }\n                }\n            }\n\n            // Line\n            items.push({ type:'line' });\n\n            // Copy\n            items.push({\n                title:obj.options.text.copy,\n                shortcut:'Ctrl + C',\n                onclick:function() {\n                    obj.copy(true);\n                }\n            });\n\n            // Paste\n            if (navigator && navigator.clipboard) {\n                items.push({\n                    title:obj.options.text.paste,\n                    shortcut:'Ctrl + V',\n                    onclick:function() {\n                        if (obj.selectedCell) {\n                            navigator.clipboard.readText().then(function(text) {\n                                if (text) {\n                                    jexcel.current.paste(obj.selectedCell[0], obj.selectedCell[1], text);\n                                }\n                            });\n                        }\n                    }\n                });\n            }\n\n            // Save\n            if (obj.options.allowExport) {\n                items.push({\n                    title: obj.options.text.saveAs,\n                    shortcut: 'Ctrl + S',\n                    onclick: function () {\n                        obj.download();\n                    }\n                });\n            }\n\n            // About\n            if (obj.options.about) {\n                items.push({\n                    title:obj.options.text.about,\n                    onclick:function() {\n                        alert(obj.options.about);\n                    }\n                });\n            }\n\n            return items;\n        }\n    }\n\n    obj.scrollControls = function(e) {\n        if (obj.options.lazyLoading == true) {\n            if (jexcel.timeControlLoading == null) {\n                jexcel.timeControlLoading = setTimeout(function() {\n                    if (obj.content.scrollTop + obj.content.clientHeight >= obj.content.scrollHeight) {\n                        if (obj.loadDown()) {\n                            if (obj.content.scrollTop + obj.content.clientHeight > obj.content.scrollHeight - 10) {\n                                obj.content.scrollTop = obj.content.scrollTop - obj.content.clientHeight;\n                            }\n                            obj.updateCornerPosition();\n                        }\n                    } else if (obj.content.scrollTop <= obj.content.clientHeight) {\n                        if (obj.loadUp()) {\n                            if (obj.content.scrollTop < 10) {\n                                obj.content.scrollTop = obj.content.scrollTop + obj.content.clientHeight;\n                            }\n                            obj.updateCornerPosition();\n                        }\n                    }\n\n                    jexcel.timeControlLoading = null;\n                }, 100);\n            }\n        }\n\n        // Close editor\n        if (obj.options.lazyLoading == true || obj.options.tableOverflow == true) {\n            if (obj.edition && e.target.className.substr(0,9) != 'jdropdown') {\n                obj.closeEditor(obj.edition[0], true);\n            }\n        }\n    }\n\n    el.addEventListener(\"DOMMouseScroll\", obj.scrollControls);\n    el.addEventListener(\"mousewheel\", obj.scrollControls);\n\n    el.jexcel = obj;\n\n    obj.init();\n\n    return obj;\n});\n\njexcel.current = null;\njexcel.timeControl = null;\njexcel.timeControlLoading = null;\n\njexcel.destroy = function(element, destroyEventHandlers) {\n    if (element.jexcel) {\n        element.removeEventListener(\"DOMMouseScroll\", element.jexcel.scrollControls);\n        element.removeEventListener(\"mousewheel\", element.jexcel.scrollControls);\n        element.jexcel = null;\n        element.innerHTML = '';\n\n        if (destroyEventHandlers) {\n            document.removeEventListener(\"keydown\", jexcel.keyDownControls);\n            document.removeEventListener(\"mouseup\", jexcel.mouseUpControls);\n            document.removeEventListener(\"mousedown\", jexcel.mouseDownControls);\n            document.removeEventListener(\"mousemove\", jexcel.mouseMoveControls);\n            document.removeEventListener(\"mouseover\", jexcel.mouseOverControls);\n            document.removeEventListener(\"dblclick\", jexcel.doubleClickControls);\n            document.removeEventListener(\"paste\", jexcel.pasteControls);\n            document.removeEventListener(\"contextmenu\", jexcel.contextMenuControls);\n            document.removeEventListener(\"touchstart\", jexcel.touchStartControls);\n            document.removeEventListener(\"touchend\", jexcel.touchEndControls);\n            document.removeEventListener(\"touchcancel\", jexcel.touchEndControls);\n            jexcel = null;\n        }\n    }\n}\n\njexcel.build = function() {\n    document.addEventListener(\"keydown\", jexcel.keyDownControls);\n    document.addEventListener(\"mouseup\", jexcel.mouseUpControls);\n    document.addEventListener(\"mousedown\", jexcel.mouseDownControls);\n    document.addEventListener(\"mousemove\", jexcel.mouseMoveControls);\n    document.addEventListener(\"mouseover\", jexcel.mouseOverControls);\n    document.addEventListener(\"dblclick\", jexcel.doubleClickControls);\n    document.addEventListener(\"paste\", jexcel.pasteControls);\n    document.addEventListener(\"contextmenu\", jexcel.contextMenuControls);\n    document.addEventListener(\"touchstart\", jexcel.touchStartControls);\n    document.addEventListener(\"touchend\", jexcel.touchEndControls);\n    document.addEventListener(\"touchcancel\", jexcel.touchEndControls);\n    document.addEventListener(\"touchmove\", jexcel.touchEndControls);\n}\n\n/**\n * Events\n */\njexcel.keyDownControls = function(e) {\n    if (jexcel.current) {\n        if (jexcel.current.edition) {\n            if (e.which == 27) {\n                // Escape\n                if (jexcel.current.edition) {\n                    // Exit without saving\n                    jexcel.current.closeEditor(jexcel.current.edition[0], false);\n                }\n                e.preventDefault();\n            } else if (e.which == 13) {\n                // Enter\n                if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\n                    jexcel.current.editor[0].children[0].calendar.close(1);\n                } else if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'dropdown' ||\n                           jexcel.current.options.columns[jexcel.current.edition[2]].type == 'autocomplete') {\n                    // Do nothing\n                } else {\n                    // Alt enter -> do not close editor\n                    if ((jexcel.current.options.wordWrap == true ||\n                         jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap == true ||\n                         jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length > 200) && e.altKey) {\n                        // Add new line to the editor\n                        var editorTextarea = jexcel.current.edition[0].children[0];\n                        var editorValue = jexcel.current.edition[0].children[0].value;\n                        var editorIndexOf = editorTextarea.selectionStart;\n                        editorValue = editorValue.slice(0, editorIndexOf) + \"\\n\" + editorValue.slice(editorIndexOf);\n                        editorTextarea.value = editorValue;\n                        editorTextarea.focus();\n                        editorTextarea.selectionStart = editorIndexOf + 1;\n                        editorTextarea.selectionEnd = editorIndexOf + 1;\n                    } else {\n                        jexcel.current.edition[0].children[0].blur();\n                    }\n                }\n            } else if (e.which == 9) {\n                // Tab\n                if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\n                    jexcel.current.edition[0].children[0].calendar.close(1);\n                } else {\n                    jexcel.current.edition[0].children[0].blur();\n                }\n            }\n        }\n\n        if (! jexcel.current.edition && jexcel.current.selectedCell) {\n            // Which key\n            if (e.which == 37) {\n                jexcel.current.left(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 39) {\n                jexcel.current.right(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 38) {\n                jexcel.current.up(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 40) {\n                jexcel.current.down(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 36) {\n                jexcel.current.first(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 35) {\n                jexcel.current.last(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 32) {\n                if (jexcel.current.options.editable == true) {\n                    jexcel.current.setCheckRadioValue();\n                }\n                e.preventDefault();\n            } else if (e.which == 46) {\n                // Delete\n                if (jexcel.current.options.editable == true) {\n                    if (jexcel.current.selectedRow) {\n                        if (jexcel.current.options.allowDeleteRow == true) {\n                            if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)) {\n                                jexcel.current.deleteRow();\n                            }\n                        }\n                    } else if (jexcel.current.selectedHeader) {\n                        if (jexcel.current.options.allowDeleteColumn == true) {\n                            if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)) {\n                                jexcel.current.deleteColumn();\n                            }\n                        }\n                    } else {\n                        // Change value\n                        jexcel.current.setValue(jexcel.current.highlighted, '');\n                    }\n                }\n            } else if (e.which == 13) {\n                // Move cursor\n                if (e.shiftKey) {\n                    jexcel.current.up();\n                } else {\n                    if (jexcel.current.options.allowInsertRow == true) {\n                        if (jexcel.current.options.allowManualInsertRow == true) {\n                            if (jexcel.current.selectedCell[1] == jexcel.current.options.data.length - 1) {\n                                // New record in case selectedCell in the last row\n                                jexcel.current.insertRow();\n                            }\n                        }\n                    }\n\n                    jexcel.current.down();\n                }\n                e.preventDefault();\n            } else if (e.which == 9) {\n                // Tab\n                if (e.shiftKey) {\n                    jexcel.current.left();\n                } else {\n                    if (jexcel.current.options.allowInsertColumn == true) {\n                        if (jexcel.current.options.allowManualInsertColumn == true) {\n                            if (jexcel.current.selectedCell[0] == jexcel.current.options.data[0].length - 1) {\n                                // New record in case selectedCell in the last column\n                                jexcel.current.insertColumn();\n                            }\n                        }\n                    }\n\n                    jexcel.current.right();\n                }\n                e.preventDefault();\n            } else {\n                if ((e.ctrlKey || e.metaKey) && ! e.shiftKey) {\n                    if (e.which == 65) {\n                        // Ctrl + A\n                        jexcel.current.selectAll();\n                        e.preventDefault();\n                    } else if (e.which == 83) {\n                        // Ctrl + S\n                        jexcel.current.download();\n                        e.preventDefault();\n                    } else if (e.which == 89) {\n                        // Ctrl + Y\n                        jexcel.current.redo();\n                        e.preventDefault();\n                    } else if (e.which == 90) {\n                        // Ctrl + Z\n                        jexcel.current.undo();\n                        e.preventDefault();\n                    } else if (e.which == 67) {\n                        // Ctrl + C\n                        jexcel.current.copy(true);\n                        e.preventDefault();\n                    } else if (e.which == 67) {\n                        // Ctrl + C\n                        jexcel.current.copy(true);\n                        e.preventDefault();\n                    } else if (e.which == 88) {\n                        // Ctrl + X\n                        if (jexcel.current.options.editable == true) {\n                            jexcel.cutControls();\n                        } else {\n                            jexcel.copyControls();\n                        }\n                        e.preventDefault();\n                    } else if (e.which == 86) {\n                        // Ctrl + V\n                        jexcel.pasteControls();\n                    }\n                } else {\n                    if (jexcel.current.selectedCell) {\n                        if (jexcel.current.options.editable == true) {\n                            var rowId = jexcel.current.selectedCell[1];\n                            var columnId = jexcel.current.selectedCell[0];\n\n                            // If is not readonly\n                            if (jexcel.current.options.columns[columnId].type != 'readonly') {\n                                // Characters able to start a edition\n                                if (e.keyCode == 32) {\n                                    // Space\n                                    if (jexcel.current.options.columns[columnId].type == 'checkbox' ||\n                                        jexcel.current.options.columns[columnId].type == 'radio') {\n                                        e.preventDefault();\n                                    } else {\n                                        // Start edition\n                                        jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\n                                    }\n                                } else if (e.keyCode == 113) {\n                                    // Start edition with current content F2\n                                    jexcel.current.openEditor(jexcel.current.records[rowId][columnId], false);\n                                } else if ((e.keyCode == 8) ||\n                                           (e.keyCode >= 48 && e.keyCode <= 57) ||\n                                           (e.keyCode >= 96 && e.keyCode <= 111) ||\n                                           (e.keyCode == 187) ||\n                                           (e.keyCode == 189) ||\n                                           ((String.fromCharCode(e.keyCode) == e.key || String.fromCharCode(e.keyCode).toLowerCase() == e.key.toLowerCase()) && jexcel.validLetter(String.fromCharCode(e.keyCode)))) {\n                                    // Start edition\n                                    jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\n                                    // Prevent entries in the calendar\n                                    if (jexcel.current.options.columns[columnId].type == 'calendar') {\n                                        e.preventDefault();\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        } else {\n            if (e.target.classList.contains('jexcel_search')) {\n                if (jexcel.timeControl) {\n                    clearTimeout(jexcel.timeControl);\n                }\n\n                jexcel.timeControl = setTimeout(function() {\n                    jexcel.current.search(e.target.value);\n                }, 200);\n            }\n        }\n    }\n}\n\njexcel.isMouseAction = false;\n\njexcel.mouseDownControls = function(e) {\n    e = e || window.event;\n    if (e.buttons) {\n        var mouseButton = e.buttons;\n    } else if (e.button) {\n        var mouseButton = e.button;\n    } else {\n        var mouseButton = e.which;\n    }\n\n    // Get elements\n    var jexcelTable = jexcel.getElement(e.target);\n\n    if (jexcelTable[0]) {\n        if (jexcel.current != jexcelTable[0].jexcel) {\n            if (jexcel.current) {\n                jexcel.current.resetSelection();\n            }\n            jexcel.current = jexcelTable[0].jexcel;\n        }\n    } else {\n        if (jexcel.current) {\n            jexcel.current.resetSelection(true);\n            jexcel.current = null;\n        }\n    }\n\n    if (jexcel.current && mouseButton == 1) {\n        if (e.target.classList.contains('jexcel_selectall')) {\n            if (jexcel.current) {\n                jexcel.current.selectAll();\n            }\n        } else if (e.target.classList.contains('jexcel_corner')) {\n            if (jexcel.current.options.editable == true) {\n                jexcel.current.selectedCorner = true;\n            }\n        } else {\n            // Header found\n            if (jexcelTable[1] == 1) {\n                var columnId = e.target.getAttribute('data-x');\n                if (columnId) {\n                    // Update cursor\n                    var info = e.target.getBoundingClientRect();\n                    if (jexcel.current.options.columnResize == true && info.width - e.offsetX < 6) {\n                        // Resize helper\n                        jexcel.current.resizing = {\n                            mousePosition: e.pageX,\n                            column: columnId,\n                            width: info.width,\n                        };\n\n                        // Border indication\n                        jexcel.current.headers[columnId].classList.add('resizing');\n                        for (var j = 0; j < jexcel.current.records.length; j++) {\n                            if (jexcel.current.records[j][columnId]) {\n                                jexcel.current.records[j][columnId].classList.add('resizing');\n                            }\n                        }\n                    } else if (jexcel.current.options.columnDrag == true && info.height - e.offsetY < 6) {\n                        if (jexcel.current.isColMerged(columnId).length) {\n                            console.error('JEXCEL: This column is part of a merged cell.');\n                        } else {\n                            // Reset selection\n                            jexcel.current.resetSelection();\n                            // Drag helper\n                            jexcel.current.dragging = {\n                                element: e.target,\n                                column:columnId,\n                                destination:columnId,\n                            };\n                            // Border indication\n                            jexcel.current.headers[columnId].classList.add('dragging');\n                            for (var j = 0; j < jexcel.current.records.length; j++) {\n                                if (jexcel.current.records[j][columnId]) {\n                                    jexcel.current.records[j][columnId].classList.add('dragging');\n                                }\n                            }\n                        }\n                    } else {\n                        if (jexcel.current.selectedHeader && (e.shiftKey || e.ctrlKey)) {\n                            var o = jexcel.current.selectedHeader;\n                            var d = columnId;\n                        } else {\n                            // Press to rename\n                            if (jexcel.current.selectedHeader == columnId && jexcel.current.options.allowRenameColumn == true) {\n                                jexcel.timeControl = setTimeout(function() {\n                                    jexcel.current.setHeader(columnId);\n                                }, 800);\n                            }\n\n                            // Keep track of which header was selected first\n                            jexcel.current.selectedHeader = columnId;\n\n                            // Update selection single column\n                            var o = columnId;\n                            var d = columnId;\n                        }\n\n                        // Update selection\n                        jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\n                    }\n                } else {\n                    if (e.target.parentNode.classList.contains('jexcel_nested')) {\n                        if (e.target.getAttribute('data-column')) {\n                            var column = e.target.getAttribute('data-column').split(',');\n                            var c1 = parseInt(column[0]);\n                            var c2 = parseInt(column[column.length-1]);\n                        } else {\r\n                            var c1 = 0;\r\n                            var c2 = jexcel.current.options.columns.length - 1;\r\n                        }\n                        jexcel.current.updateSelectionFromCoords(c1, 0, c2, jexcel.current.options.data.length - 1);\n                    }\n                }\n            } else {\n                jexcel.current.selectedHeader = false;\n            }\n\n            // Body found\n            if (jexcelTable[1] == 2) {\n                var rowId = e.target.getAttribute('data-y');\n\n                if (e.target.classList.contains('jexcel_row')) {\n                    var info = e.target.getBoundingClientRect();\n                    if (jexcel.current.options.rowResize == true && info.height - e.offsetY < 6) {\n                        // Resize helper\n                        jexcel.current.resizing = {\n                            element: e.target.parentNode,\n                            mousePosition: e.pageY,\n                            row: rowId,\n                            height: info.height,\n                        };\n                        // Border indication\n                        e.target.parentNode.classList.add('resizing');\n                    } else if (jexcel.current.options.rowDrag == true && info.width - e.offsetX < 6) {\n                        if (jexcel.current.isRowMerged(rowId).length) {\n                            console.error('JEXCEL: This row is part of a merged cell');\n                        } else if (jexcel.current.options.search == true && jexcel.current.results) {\n                            console.error('JEXCEL: Please clear your search before perform this action');\n                        } else {\n                            // Reset selection\n                            jexcel.current.resetSelection();\n                            // Drag helper\n                            jexcel.current.dragging = {\n                                element: e.target.parentNode,\n                                row:rowId,\n                                destination:rowId,\n                            };\n                            // Border indication\n                            e.target.parentNode.classList.add('dragging');\n                        }\n                    } else {\n                        if (jexcel.current.selectedRow && (e.shiftKey || e.ctrlKey)) {\n                            var o = jexcel.current.selectedRow;\n                            var d = rowId;\n                        } else {\n                            // Keep track of which header was selected first\n                            jexcel.current.selectedRow = rowId;\n\n                            // Update selection single column\n                            var o = rowId;\n                            var d = rowId;\n                        }\n\n                        // Update selection\n                        jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\n                    }\n                } else {\n                    // Jclose\n                    if (e.target.classList.contains('jclose') && e.target.clientWidth - e.offsetX < 50 && e.offsetY < 50) {\n                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                    } else {\n                        var getCellCoords = function(element) {\n                            var x = element.getAttribute('data-x');\n                            var y = element.getAttribute('data-y');\n                            if (x && y) {\n                                return [x, y];\n                            } else {\n                                if (element.parentNode) {\n                                    return getCellCoords(element.parentNode);\n                                }\n                            }\n                        };\n\n                        var position = getCellCoords(e.target);\n                        if (position) {\n                            var columnId = position[0];\n                            var rowId = position[1];\n                            // Close edition\n                            if (jexcel.current.edition) {\n                                if (jexcel.current.edition[2] != columnId || jexcel.current.edition[3] != rowId) {\n                                    jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                                }\n                            }\n\n                            if (! jexcel.current.edition) {\n                                // Update cell selection\n                                if (e.shiftKey) {\n                                    jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\n                                } else {\n                                    jexcel.current.updateSelectionFromCoords(columnId, rowId);\n                                }\n                            }\n\n                            // No full row selected\n                            jexcel.current.selectedHeader = null;\n                            jexcel.current.selectedRow = null;\n                        }\n                    }\n                }\n            } else {\n                jexcel.current.selectedRow = false;\n            }\n\n            // Pagination\n            if (e.target.classList.contains('jexcel_page')) {\n                if (e.target.innerText == '<') {\n                    jexcel.current.page(0);\n                } else if (e.target.innerText == '>') {\n                    jexcel.current.page(e.target.getAttribute('title') - 1);\n                } else {\n                    jexcel.current.page(e.target.innerText - 1);\n                }\n            }\n        }\n\n        if (jexcel.current.edition) {\n            jexcel.isMouseAction = false;\n        } else {\n            jexcel.isMouseAction = true;\n        }\n    } else {\n        jexcel.isMouseAction = false;\n    }\n}\n\njexcel.mouseUpControls = function(e) {\n    if (jexcel.current) {\n        // Update cell size\n        if (jexcel.current.resizing) {\n            // Columns to be updated\n            if (jexcel.current.resizing.column) {\n                // Remove Class\n                jexcel.current.headers[jexcel.current.resizing.column].classList.remove('resizing');\n                var newWidth = jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute('width');\n                jexcel.current.setWidth(jexcel.current.resizing.column, newWidth, jexcel.current.resizing.width);\n                // Remove border\n                jexcel.current.headers[jexcel.current.resizing.column].classList.remove('resizing');\n                for (var j = 0; j < jexcel.current.records.length; j++) {\n                    if (jexcel.current.records[j][jexcel.current.resizing.column]){\n                        jexcel.current.records[j][jexcel.current.resizing.column].classList.remove('resizing');\n                    }\n                }\n            } else {\n                // Remove Class\n                jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove('resizing');\n                var newHeight = jexcel.current.rows[jexcel.current.resizing.row].getAttribute('height');\n                jexcel.current.setHeight(jexcel.current.resizing.row, newHeight, jexcel.current.resizing.height);\n                // Remove border\n                jexcel.current.resizing.element.classList.remove('resizing');\n            }\n            // Reset resizing helper\n            jexcel.current.resizing = null;\n        } else if (jexcel.current.dragging) {\n            // Reset dragging helper\n            if (jexcel.current.dragging) {\n                if (jexcel.current.dragging.column) {\n                    // Target\n                    var columnId = e.target.getAttribute('data-x');\n                    // Remove move style\n                    jexcel.current.headers[jexcel.current.dragging.column].classList.remove('dragging');\n                    for (var j = 0; j < jexcel.current.rows.length; j++) {\n                        if (jexcel.current.records[j][jexcel.current.dragging.column]) {\n                            jexcel.current.records[j][jexcel.current.dragging.column].classList.remove('dragging');\n                        }\n                    }\n                    for (var i = 0; i < jexcel.current.headers.length; i++) {\n                        jexcel.current.headers[i].classList.remove('dragging-left');\n                        jexcel.current.headers[i].classList.remove('dragging-right');\n                    }\n                    // Update position\n                    if (columnId) {\n                        if (jexcel.current.dragging.column != jexcel.current.dragging.destination) {\n                            jexcel.current.moveColumn(jexcel.current.dragging.column, jexcel.current.dragging.destination);\n                        }\n                    }\n                } else {\n                    var position = Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children, jexcel.current.dragging.element);\n                    if (jexcel.current.dragging.row != position) {\n                        jexcel.current.moveRow(jexcel.current.dragging.row, position, true);\n                    }\n                    jexcel.current.dragging.element.classList.remove('dragging');\n                }\n                jexcel.current.dragging = null;\n            }\n        } else {\n            // Close any corner selection\n            if (jexcel.current.selectedCorner) {\n                jexcel.current.selectedCorner = false;\n\n                // Data to be copied\n                if (jexcel.current.selection.length > 0) {\n                    // Copy data\n                    jexcel.current.copyData(jexcel.current.selection[0], jexcel.current.selection[jexcel.current.selection.length - 1]);\n\n                    // Remove selection\n                    jexcel.current.removeCopySelection();\n                }\n            }\n        }\n    }\n\n    // Clear any time control\n    if (jexcel.timeControl) {\n        clearTimeout(jexcel.timeControl);\n        jexcel.timeControl = null;\n    }\n\n    // Mouse up\n    jexcel.isMouseAction = false;\n}\n\n// Mouse move controls\njexcel.mouseMoveControls = function(e) {\n    e = e || window.event;\n    if (e.buttons) {\n        var mouseButton = e.buttons;\n    } else if (e.button) {\n        var mouseButton = e.button;\n    } else {\n        var mouseButton = e.which;\n    }\n\n    if (! mouseButton) {\n        jexcel.isMouseAction = false;\n    }\n\n    if (jexcel.current) {\n        if (jexcel.isMouseAction == true) {\n            // Resizing is ongoing\n            if (jexcel.current.resizing) {\n                if (jexcel.current.resizing.column) {\n                    var width = e.pageX - jexcel.current.resizing.mousePosition;\n\n                    if (jexcel.current.resizing.width + width > 0) {\n                        var tempWidth = jexcel.current.resizing.width + width;\n                        jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute('width', tempWidth);\n\n                        jexcel.current.updateCornerPosition();\n                    }\n                } else {\n                    var height = e.pageY - jexcel.current.resizing.mousePosition;\n\n                    if (jexcel.current.resizing.height + height > 0) {\n                        var tempHeight = jexcel.current.resizing.height + height;\n                        jexcel.current.rows[jexcel.current.resizing.row].setAttribute('height', tempHeight);\n\n                        jexcel.current.updateCornerPosition();\n                    }\n                }\n            }\n        } else {\n            var x = e.target.getAttribute('data-x');\n            var y = e.target.getAttribute('data-y');\n            var rect = e.target.getBoundingClientRect();\n\n            if (jexcel.current.cursor) {\n                jexcel.current.cursor.style.cursor = '';\n                jexcel.current.cursor = null;\n            }\n\n            if (e.target.parentNode.parentNode && e.target.parentNode.parentNode.className) {\n                if (e.target.parentNode.parentNode.classList.contains('resizable')) {\n                    if (e.target && x && ! y && (rect.width - (e.clientX - rect.left) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'col-resize';\n                    } else if (e.target && ! x && y && (rect.height - (e.clientY - rect.top) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'row-resize';\n                    }\n                }\n\n                if (e.target.parentNode.parentNode.classList.contains('draggable')) {\n                    if (e.target && ! x && y && (rect.width - (e.clientX - rect.left) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'move';\n                    } else if (e.target && x && ! y && (rect.height - (e.clientY - rect.top) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'move';\n                    }\n                }\n            }\n        }\n    }\n}\n\njexcel.mouseOverControls = function(e) {\n    e = e || window.event;\n    if (e.buttons) {\n        var mouseButton = e.buttons;\n    } else if (e.button) {\n        var mouseButton = e.button;\n    } else {\n        var mouseButton = e.which;\n    }\n\n    if (! mouseButton) {\n        jexcel.isMouseAction = false;\n    }\n\n    if (jexcel.current && jexcel.isMouseAction == true) {\n        // Get elements\n        var jexcelTable = jexcel.getElement(e.target);\n\n        if (jexcelTable[0]) {\n            // Avoid cross reference\n            if (jexcel.current != jexcelTable[0].jexcel) {\n                if (jexcel.current) {\n                    return false;\n                }\n            }\n\n            var columnId = e.target.getAttribute('data-x');\n            var rowId = e.target.getAttribute('data-y');\n\n            if (jexcel.current.dragging) {\n                if (jexcel.current.dragging.column) {\n                    if (columnId) {\n                        if (jexcel.current.isColMerged(columnId).length) {\n                            console.error('JEXCEL: This column is part of a merged cell.');\n                        } else {\n                            for (var i = 0; i < jexcel.current.headers.length; i++) {\n                                jexcel.current.headers[i].classList.remove('dragging-left');\n                                jexcel.current.headers[i].classList.remove('dragging-right');\n                            }\n\n                            if (jexcel.current.dragging.column == columnId) {\n                                jexcel.current.dragging.destination = parseInt(columnId);\n                            } else {\n                                if (e.target.clientWidth / 2 > e.offsetX) {\n                                    if (jexcel.current.dragging.column < columnId) {\n                                        jexcel.current.dragging.destination = parseInt(columnId) - 1;\n                                    } else {\n                                        jexcel.current.dragging.destination = parseInt(columnId);\n                                    }\n                                    jexcel.current.headers[columnId].classList.add('dragging-left');\n                                } else {\n                                    if (jexcel.current.dragging.column < columnId) {\n                                        jexcel.current.dragging.destination = parseInt(columnId);\n                                    } else {\n                                        jexcel.current.dragging.destination = parseInt(columnId) + 1;\n                                    }\n                                    jexcel.current.headers[columnId].classList.add('dragging-right');\n                                }\n                            }\n                        }\n                    }\n                } else {\n                    if (rowId) {\n                        if (jexcel.current.isRowMerged(rowId).length) {\n                            console.error('JEXCEL: This row is part of a merged cell.');\n                        } else {\n                            var target = (e.target.clientHeight / 2 > e.offsetY) ? e.target.parentNode.nextSibling : e.target.parentNode;\n                            e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element, target);\n                        }\n                    }\n                }\n            } else if (jexcel.current.resizing) {\n            } else {\n                // Header found\n                if (jexcelTable[1] == 1) {\n                    if (jexcel.current.selectedHeader) {\n                        var columnId = e.target.getAttribute('data-x');\n                        var o = jexcel.current.selectedHeader;\n                        var d = columnId;\n                        // Update selection\n                        jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\n                    }\n                }\n\n                // Body found\n                if (jexcelTable[1] == 2) {\n                    if (e.target.classList.contains('jexcel_row')) {\n                        if (jexcel.current.selectedRow) {\n                            var o = jexcel.current.selectedRow;\n                            var d = rowId;\n                            // Update selection\n                            jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\n                        }\n                    } else {\n                        // Do not select edtion is in progress\n                        if (! jexcel.current.edition) {\n                            if (columnId && rowId) {\n                                if (jexcel.current.selectedCorner) {\n                                    jexcel.current.updateCopySelection(columnId, rowId);\n                                } else {\n                                    if (jexcel.current.selectedCell) {\n                                        jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    // Clear any time control\n    if (jexcel.timeControl) {\n        clearTimeout(jexcel.timeControl);\n        jexcel.timeControl = null;\n    }\n}\n\n/**\n * Double click event handler: controls the double click in the corner, cell edition or column re-ordering.\n */\njexcel.doubleClickControls = function(e) {\n    // Jexcel is selected\n    if (jexcel.current) {\n        // Corner action\n        if (e.target.classList.contains('jexcel_corner')) {\n            // Any selected cells\n            if (jexcel.current.highlighted.length > 0) {\n                // Copy from this\n                var x1 = jexcel.current.highlighted[0].getAttribute('data-x');\n                var y1 = parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-y')) + 1;\n                // Until this\n                var x2 = jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-x');\n                var y2 = jexcel.current.records.length - 1\n                // Execute copy\n                jexcel.current.copyData(jexcel.current.records[y1][x1], jexcel.current.records[y2][x2]);\n            }\n        } else {\n            // Get table\n            var jexcelTable = jexcel.getElement(e.target);\n\n            // Double click over header\n            if (jexcelTable[1] == 1 && jexcel.current.options.columnSorting == true) {\n                // Check valid column header coords\n                var columnId = e.target.getAttribute('data-x');\n                if (columnId) {\n                    jexcel.current.orderBy(columnId);\n                }\n            }\n\n            // Double click over body\n            if (jexcelTable[1] == 2 && jexcel.current.options.editable == true) {\n                if (! jexcel.current.edition) {\n                    var getCellCoords = function(element) {\n                        if (element.parentNode) {\n                            var x = element.getAttribute('data-x');\n                            var y = element.getAttribute('data-y');\n                            if (x && y) {\n                                return element;\n                            } else {\n                                return getCellCoords(element.parentNode);\n                            }\n                        }\n                    }\n                    var cell = getCellCoords(e.target);\n                    if (cell && cell.classList.contains('highlight')) {\n                        jexcel.current.openEditor(cell);\n                    }\n                }\n            }\n        }\n    }\n}\n\njexcel.copyControls = function(e) {\n    if (jexcel.current && jexcel.copyControls.enabled) {\n        if (! jexcel.current.edition) {\n            jexcel.current.copy(true);\n        }\n    }\n}\n\njexcel.cutControls = function(e) {\n    if (jexcel.current) {\n        if (! jexcel.current.edition) {\n            jexcel.current.copy(true);\n            if (jexcel.current.options.editable == true) {\n                jexcel.current.setValue(jexcel.current.highlighted, '');\n            }\n        }\n    }\n}\n\njexcel.pasteControls = function(e) {\n    if (jexcel.current && jexcel.current.selectedCell) {\n        if (! jexcel.current.edition) {\n            if (jexcel.current.options.editable == true) {\n                if (e && e.clipboardData) {\n                    jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], e.clipboardData.getData('text'));\n                    e.preventDefault();\n                } else if (window.clipboardData) {\n                    jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], window.clipboardData.getData('text'));\n                }\n            }\n        }\n    }\n}\n\njexcel.contextMenuControls = function(e) {\n    e = e || window.event;\n    if (\"buttons\" in e) {\n        var mouseButton = e.buttons;\n    } else {\n        var mouseButton = e.which || e.button;\n    }\n\n    if (jexcel.current) {\n        if (jexcel.current.edition) {\n            e.preventDefault();\n        } else if (jexcel.current.options.contextMenu) {\n            jexcel.current.contextMenu.contextmenu.close();\n\n            if (jexcel.current) {\n                var x = e.target.getAttribute('data-x');\n                var y = e.target.getAttribute('data-y');\n\n                if (x || y) {\n                    // Table found\n                    var items = jexcel.current.options.contextMenu(jexcel.current, x, y, e);\n                    // The id is depending on header and body\n                    jexcel.current.contextMenu.contextmenu.open(e, items);\n                    // Avoid the real one\n                    e.preventDefault();\n                }\n            }\n        }\n    }\n}\n\njexcel.touchStartControls = function(e) {\n    var jexcelTable = jexcel.getElement(e.target);\n\n    if (jexcelTable[0]) {\n        if (jexcel.current != jexcelTable[0].jexcel) {\n            if (jexcel.current) {\n                jexcel.current.resetSelection();\n            }\n            jexcel.current = jexcelTable[0].jexcel;\n        }\n    } else {\n        if (jexcel.current) {\n            jexcel.current.resetSelection();\n            jexcel.current = null;\n        }\n    }\n\n    if (jexcel.current) {\n        if (! jexcel.current.edition) {\n            var columnId = e.target.getAttribute('data-x');\n            var rowId = e.target.getAttribute('data-y');\n\n            if (columnId && rowId) {\n                jexcel.current.updateSelectionFromCoords(columnId, rowId);\n\n                jexcel.timeControl = setTimeout(function() {\n                    // Keep temporary reference to the element\r\n                    if (jexcel.current.options.columns[columnId].type == 'color') {\r\n                        jexcel.tmpElement = null;\r\n                    } else {\r\n                        jexcel.tmpElement = e.target;\r\n                    }\r\n                    jexcel.current.openEditor(e.target, false, e);\n                }, 500);\n            }\n        }\n    }\n}\n\njexcel.touchEndControls = function(e) {\n    // Clear any time control\n    if (jexcel.timeControl) {\n        clearTimeout(jexcel.timeControl);\n        jexcel.timeControl = null;\n        // Element\r\n        if (jexcel.tmpElement && jexcel.tmpElement.children[0].tagName == 'INPUT') {\r\n            jexcel.tmpElement.children[0].focus();\r\n        }\n        jexcel.tmpElement = null;\n    }\r\n}\r\n\r\n/**\r\n * Jexcel extensions\r\n */\r\n\r\njexcel.createTabs = function(tabs, result) {\r\n    // Create tab container\r\n    tabs.innerHTML = '';\r\n    tabs.classList.add('jexcel_tabs');\r\n    var spreadsheet = []\r\n    var link = [];\r\n    for (var i = 0; i < result.length; i++) {\r\n        // Spreadsheet container\r\n        spreadsheet[i] = document.createElement('div');\r\n        spreadsheet[i].classList.add('jexcel_tab');\r\n        // Tab link\r\n        link[i] = document.createElement('div');\r\n        link[i].classList.add('jexcel_tab_link');\r\n        link[i].setAttribute('data-spreadsheet', i);\r\n        link[i].innerHTML = result[i].sheetName;\r\n        link[i].onclick = function() {\r\n            for (var j = 0; j < spreadsheet.length; j++) {\r\n                spreadsheet[j].style.display = 'none';\r\n                link[j].classList.remove('selected');\r\n            }\r\n            var i = this.getAttribute('data-spreadsheet');\r\n            spreadsheet[i].style.display = 'block';\r\n            link[i].classList.add('selected')\r\n        }\r\n        tabs.appendChild(link[i]);\r\n    }\r\n\r\n    // Append spreadsheet\r\n    for (var i = 0; i < spreadsheet.length - 1; i++) {\r\n        tabs.appendChild(spreadsheet[i]);\r\n        jexcel(spreadsheet[i], result[i]);\r\n    }\r\n\r\n    // First tab\r\n    spreadsheet[0].style.display = 'block';\r\n    link[0].classList.add('selected')\r\n}\r\n\r\njexcel.fromSpreadsheet = function(file, __callback) {\r\n    var convert = function(workbook) {\r\n        var spreadsheets = [];\r\n        workbook.SheetNames.forEach(function(sheetName) {\r\n            var spreadsheet = {};\r\n            spreadsheet.rows = [];\r\n            spreadsheet.columns = [];\r\n            spreadsheet.data = [];\r\n            spreadsheet.style = {};\r\n            spreadsheet.sheetName = sheetName;\r\n\r\n            // Column widths\r\n            var temp = workbook.Sheets[sheetName]['!cols'];\r\n            if (temp && temp.length) {\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    spreadsheet.columns[i] = {};\r\n                    if (temp[i] && temp[i].wpx) {\r\n                        spreadsheet.columns[i].width = temp[i].wpx + 'px';\r\n                    }\r\n                }\r\n            }\r\n            // Rows heights\r\n            var temp = workbook.Sheets[sheetName]['!rows'];\r\n            if (temp && temp.length) {\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    if (temp[i] && temp[i].hpx) {\r\n                        spreadsheet.rows[i] = {};\r\n                        spreadsheet.rows[i].height = temp[i].hpx + 'px';\r\n                    }\r\n                }\r\n            }\r\n            // Merge cells\r\n            var temp = workbook.Sheets[sheetName]['!merges'];\r\n            if (temp && temp.length > 0) {\r\n                spreadsheet.mergeCells = [];\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    var x1 = temp[i].s.c;\r\n                    var y1 = temp[i].s.r;\r\n                    var x2 = temp[i].e.c;\r\n                    var y2 = temp[i].e.r;\r\n                    var key = jexcel.getColumnNameFromId([x1,y1]);\r\n                    spreadsheet.mergeCells[key] = [ x2-x1+1, y2-y1+1 ];\r\n                }\r\n            }\r\n            // Data container\r\n            var max_x = 0;\r\n            var max_y = 0;\r\n            var temp = Object.keys(workbook.Sheets[sheetName]);\r\n            for (var i = 0; i < temp.length; i++) {\r\n                if (temp[i].substr(0,1) != '!') {\r\n                    var cell = workbook.Sheets[sheetName][temp[i]];\r\n                    var info = jexcel.getIdFromColumnName(temp[i], true);\r\n                    if (! spreadsheet.data[info[1]]) {\r\n                        spreadsheet.data[info[1]] = [];\r\n                    }\r\n                    spreadsheet.data[info[1]][info[0]] = cell.f ? '=' + cell.f : cell.w;\r\n                    if (max_x < info[0]) {\r\n                        max_x = info[0];\r\n                    }\r\n                    if (max_y < info[1]) {\r\n                        max_y = info[1];\r\n                    }\r\n                    // Style\r\n                    if (cell.style && Object.keys(cell.style).length > 0) {\r\n                        spreadsheet.style[temp[i]] = cell.style;\r\n                    }\r\n                    if (cell.s && cell.s.fgColor) {\r\n                        if (spreadsheet.style[temp[i]]) {\r\n                            spreadsheet.style[temp[i]] += ';';\r\n                        }\r\n                        spreadsheet.style[temp[i]] += 'background-color:#' + cell.s.fgColor.rgb;\r\n                    }\r\n                }\r\n            }\r\n            var numColumns = spreadsheet.columns;\r\n            for (var j = 0; j <= max_y; j++) {\r\n                for (var i = 0; i <= max_x; i++) {\r\n                    if (! spreadsheet.data[j]) {\r\n                        spreadsheet.data[j] = [];\r\n                    }\r\n                    if (! spreadsheet.data[j][i]) {\r\n                        if (numColumns < i) {\r\n                            spreadsheet.data[j][i] = '';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            spreadsheets.push(spreadsheet);\r\n        });\r\n\r\n        return spreadsheets;\r\n    }\r\n\r\n    var oReq;\r\n    oReq = new XMLHttpRequest();\r\n    oReq.open(\"GET\", file, true);\r\n\r\n    if(typeof Uint8Array !== 'undefined') {\r\n        oReq.responseType = \"arraybuffer\";\r\n        oReq.onload = function(e) {\r\n            var arraybuffer = oReq.response;\r\n            var data = new Uint8Array(arraybuffer);\r\n            var wb = XLSX.read(data, {type:\"array\", cellFormula:true, cellStyles:true });\r\n            __callback(convert(wb))\r\n        };\r\n    } else {\r\n        oReq.setRequestHeader(\"Accept-Charset\", \"x-user-defined\");  \r\n        oReq.onreadystatechange = function() { if(oReq.readyState == 4 && oReq.status == 200) {\r\n            var ff = convertResponseBodyToText(oReq.responseBody);\r\n            var wb = XLSX.read(ff, {type:\"binary\", cellFormula:true, cellStyles:true });\r\n            __callback(convert(wb))\r\n        }};\r\n    }\r\n\r\n    oReq.send();\r\n}\r\n\r\n/**\r\n * Valid international letter\r\n */\r\n\r\njexcel.validLetter = function (text) {\r\n    var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC-\\u0400-\\u04FF']+)/g;\r\n    return text.match(regex) ? 1 : 0;\r\n}\r\n\r\n/**\r\n * Helper injectArray\r\n */\r\njexcel.injectArray = function(o, idx, arr) {\r\n    return o.slice(0, idx).concat(arr).concat(o.slice(idx));\r\n}\r\n\r\n/**\r\n * Get letter based on a number\r\n * \r\n * @param integer i\r\n * @return string letter\r\n */\r\njexcel.getColumnName = function(i) {\r\n    var letter = '';\r\n    if (i > 701) {\r\n        letter += String.fromCharCode(64 + parseInt(i / 676));\r\n        letter += String.fromCharCode(64 + parseInt((i % 676) / 26));\r\n    } else if (i > 25) {\r\n        letter += String.fromCharCode(64 + parseInt(i / 26));\r\n    }\r\n    letter += String.fromCharCode(65 + (i % 26));\r\n\r\n    return letter;\r\n}\r\n\r\n/**\r\n * Convert excel like column to jexcel id\r\n * \r\n * @param string id\r\n * @return string id\r\n */\r\njexcel.getIdFromColumnName = function (id, arr) {\r\n    // Get the letters\r\n    var t = /^[a-zA-Z]+/.exec(id);\r\n\r\n    if (t) {\r\n        // Base 26 calculation\r\n        var code = 0;\r\n        for (var i = 0; i < t[0].length; i++) {\r\n            code += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, (t[0].length - 1 - i));\r\n        }\r\n        code--;\r\n        // Make sure jexcel starts on zero\r\n        if (code < 0) {\r\n            code = 0;\r\n        }\r\n\r\n        // Number\r\n        var number = parseInt(/[0-9]+$/.exec(id));\r\n        if (number > 0) {\r\n            number--;\r\n        }\r\n\r\n        if (arr == true) {\r\n            id = [ code, number ];\r\n        } else {\r\n            id = code + '-' + number;\r\n        }\r\n    }\r\n\r\n    return id;\r\n}\r\n\r\n/**\r\n * Convert jexcel id to excel like column name\r\n * \r\n * @param string id\r\n * @return string id\r\n */\r\njexcel.getColumnNameFromId = function (cellId) {\r\n    if (! Array.isArray(cellId)) {\r\n        cellId = cellId.split('-');\r\n    }\r\n\r\n    return jexcel.getColumnName(parseInt(cellId[0])) + (parseInt(cellId[1]) + 1);\r\n}\r\n\r\n/**\r\n * Verify element inside jexcel table\r\n * \r\n * @param string id\r\n * @return string id\r\n */\r\njexcel.getElement = function(element) {\r\n    var jexcelSection = 0;\r\n    var jexcelElement = 0;\r\n\r\n    function path (element) {\r\n        if (element.className) {\r\n            if (element.classList.contains('jexcel_container')) {\r\n                jexcelElement = element;\r\n            }\r\n        }\r\n\r\n        if (element.tagName == 'THEAD') {\r\n            jexcelSection = 1;\r\n        } else if (element.tagName == 'TBODY') {\r\n            jexcelSection = 2;\r\n        }\r\n\r\n        if (element.parentNode) {\r\n            path(element.parentNode);\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return [ jexcelElement, jexcelSection ];\r\n}\r\n\r\njexcel.doubleDigitFormat = function(v) {\r\n    v = ''+v;\r\n    if (v.length == 1) {\r\n        v = '0'+v;\r\n    }\r\n    return v;\r\n}\r\n\r\n/**\r\n * Jquery Support\r\n */\r\nif (typeof(jQuery) != 'undefined') {\r\n    (function($){\r\n        $.fn.jexcel = function(method) {\r\n            var spreadsheetContainer = $(this).get(0);\r\n            if (! spreadsheetContainer.jexcel) {\r\n                return jexcel($(this).get(0), arguments[0]);\r\n            } else {\r\n                return spreadsheetContainer.jexcel[method].apply(this, Array.prototype.slice.call( arguments, 1 ));\r\n            }\r\n        };\r\n\r\n    })(jQuery);\r\n}\r\n\r\n\r\n// Based on sutoiku work (https://github.com/sutoiku)\r\n\r\nvar error = (function() {\r\n    var exports = {};\r\n\r\n    exports.nil = new Error('#NULL!');\r\n    exports.div0 = new Error('#DIV/0!');\r\n    exports.value = new Error('#VALUE!');\r\n    exports.ref = new Error('#REF!');\r\n    exports.name = new Error('#NAME?');\r\n    exports.num = new Error('#NUM!');\r\n    exports.na = new Error('#N/A');\r\n    exports.error = new Error('#ERROR!');\r\n    exports.data = new Error('#GETTING_DATA');\r\n\r\n    return exports;\r\n})();\r\n\r\nvar utils = (function() {\r\n    var exports = {};\r\n\r\n    exports.flattenShallow = function(array) {\r\n        if (!array || !array.reduce) {\r\n            return array;\r\n        }\r\n\r\n        return array.reduce(function(a, b) {\r\n            var aIsArray = Array.isArray(a);\r\n            var bIsArray = Array.isArray(b);\r\n\r\n            if (aIsArray && bIsArray) {\r\n                return a.concat(b);\r\n            }\r\n            if (aIsArray) {\r\n                a.push(b);\r\n\r\n                return a;\r\n            }\r\n            if (bIsArray) {\r\n                return [ a ].concat(b);\r\n            }\r\n\r\n            return [ a, b ];\r\n        });\r\n    };\r\n\r\n    exports.isFlat = function(array) {\r\n        if (!array) {\r\n            return false;\r\n        }\r\n\r\n        for (var i = 0; i < array.length; ++i) {\r\n            if (Array.isArray(array[i])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    exports.flatten = function() {\r\n        var result = exports.argsToArray.apply(null, arguments);\r\n\r\n        while (!exports.isFlat(result)) {\r\n            result = exports.flattenShallow(result);\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.argsToArray = function(args) {\r\n        var result = [];\r\n\r\n        exports.arrayEach(args, function(value) {\r\n            result.push(value);\r\n        });\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.numbers = function() {\r\n        var possibleNumbers = this.flatten.apply(null, arguments);\r\n        return possibleNumbers.filter(function(el) {\r\n            return typeof el === 'number';\r\n        });\r\n    };\r\n\r\n    exports.cleanFloat = function(number) {\r\n        var power = 1e14;\r\n        return Math.round(number * power) / power;\r\n    };\r\n\r\n    exports.parseBool = function(bool) {\r\n        if (typeof bool === 'boolean') {\r\n            return bool;\r\n        }\r\n\r\n        if (bool instanceof Error) {\r\n            return bool;\r\n        }\r\n\r\n        if (typeof bool === 'number') {\r\n            return bool !== 0;\r\n        }\r\n\r\n        if (typeof bool === 'string') {\r\n            var up = bool.toUpperCase();\r\n            if (up === 'TRUE') {\r\n                return true;\r\n            }\r\n\r\n            if (up === 'FALSE') {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (bool instanceof Date && !isNaN(bool)) {\r\n            return true;\r\n        }\r\n\r\n        return error.value;\r\n    };\r\n\r\n    exports.parseNumber = function(string) {\r\n        if (string === undefined || string === '') {\r\n            return error.value;\r\n        }\r\n        if (!isNaN(string)) {\r\n            return parseFloat(string);\r\n        }\r\n\r\n        return error.value;\r\n    };\r\n\r\n    exports.parseNumberArray = function(arr) {\r\n        var len;\r\n\r\n        if (!arr || (len = arr.length) === 0) {\r\n            return error.value;\r\n        }\r\n\r\n        var parsed;\r\n\r\n        while (len--) {\r\n            parsed = exports.parseNumber(arr[len]);\r\n            if (parsed === error.value) {\r\n                return parsed;\r\n            }\r\n            arr[len] = parsed;\r\n        }\r\n\r\n        return arr;\r\n    };\r\n\r\n    exports.parseMatrix = function(matrix) {\r\n        var n;\r\n\r\n        if (!matrix || (n = matrix.length) === 0) {\r\n            return error.value;\r\n        }\r\n        var pnarr;\r\n\r\n        for (var i = 0; i < matrix.length; i++) {\r\n            pnarr = exports.parseNumberArray(matrix[i]);\r\n            matrix[i] = pnarr;\r\n\r\n            if (pnarr instanceof Error) {\r\n                return pnarr;\r\n            }\r\n        }\r\n\r\n        return matrix;\r\n    };\r\n\r\n    var d1900 = new Date(Date.UTC(1900, 0, 1));\r\n    exports.parseDate = function(date) {\r\n        if (!isNaN(date)) {\r\n            if (date instanceof Date) {\r\n                return new Date(date);\r\n            }\r\n            var d = parseInt(date, 10);\r\n            if (d < 0) {\r\n                return error.num;\r\n            }\r\n            if (d <= 60) {\r\n                return new Date(d1900.getTime() + (d - 1) * 86400000);\r\n            }\r\n            return new Date(d1900.getTime() + (d - 2) * 86400000);\r\n        }\r\n        if (typeof date === 'string') {\r\n            date = new Date(date);\r\n            if (!isNaN(date)) {\r\n                return date;\r\n            }\r\n        }\r\n        return error.value;\r\n    };\r\n\r\n    exports.parseDateArray = function(arr) {\r\n        var len = arr.length;\r\n        var parsed;\r\n        while (len--) {\r\n            parsed = this.parseDate(arr[len]);\r\n            if (parsed === error.value) {\r\n                return parsed;\r\n            }\r\n            arr[len] = parsed;\r\n        }\r\n        return arr;\r\n    };\r\n\r\n    exports.anyIsError = function() {\r\n        var n = arguments.length;\r\n        while (n--) {\r\n            if (arguments[n] instanceof Error) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    exports.arrayValuesToNumbers = function(arr) {\r\n        var n = arr.length;\r\n        var el;\r\n        while (n--) {\r\n            el = arr[n];\r\n            if (typeof el === 'number') {\r\n                continue;\r\n            }\r\n            if (el === true) {\r\n                arr[n] = 1;\r\n                continue;\r\n            }\r\n            if (el === false) {\r\n                arr[n] = 0;\r\n                continue;\r\n            }\r\n            if (typeof el === 'string') {\r\n                var number = this.parseNumber(el);\r\n                if (number instanceof Error) {\r\n                    arr[n] = 0;\r\n                } else {\r\n                    arr[n] = number;\r\n                }\r\n            }\r\n        }\r\n        return arr;\r\n    };\r\n\r\n    exports.rest = function(array, idx) {\r\n        idx = idx || 1;\r\n        if (!array || typeof array.slice !== 'function') {\r\n            return array;\r\n        }\r\n        return array.slice(idx);\r\n    };\r\n\r\n    exports.initial = function(array, idx) {\r\n        idx = idx || 1;\r\n        if (!array || typeof array.slice !== 'function') {\r\n            return array;\r\n        }\r\n        return array.slice(0, array.length - idx);\r\n    };\r\n\r\n    exports.arrayEach = function(array, iteratee) {\r\n        var index = -1, length = array.length;\r\n\r\n        while (++index < length) {\r\n            if (iteratee(array[index], index, array) === false) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        return array;\r\n    };\r\n\r\n    exports.transpose = function(matrix) {\r\n        if (!matrix) {\r\n            return error.value;\r\n        }\r\n\r\n        return matrix[0].map(function(col, i) {\r\n            return matrix.map(function(row) {\r\n                return row[i];\r\n            });\r\n        });\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods = {};\r\n\r\njexcel.methods.datetime = (function() {\r\n    var exports = {};\r\n\r\n    var d1900 = new Date(1900, 0, 1);\r\n    var WEEK_STARTS = [\r\n        undefined,\r\n        0,\r\n        1,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        1,\r\n        2,\r\n        3,\r\n        4,\r\n        5,\r\n        6,\r\n        0\r\n    ];\r\n    var WEEK_TYPES = [\r\n        [],\r\n        [1, 2, 3, 4, 5, 6, 7],\r\n        [7, 1, 2, 3, 4, 5, 6],\r\n        [6, 0, 1, 2, 3, 4, 5],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [7, 1, 2, 3, 4, 5, 6],\r\n        [6, 7, 1, 2, 3, 4, 5],\r\n        [5, 6, 7, 1, 2, 3, 4],\r\n        [4, 5, 6, 7, 1, 2, 3],\r\n        [3, 4, 5, 6, 7, 1, 2],\r\n        [2, 3, 4, 5, 6, 7, 1],\r\n        [1, 2, 3, 4, 5, 6, 7]\r\n    ];\r\n    var WEEKEND_TYPES = [\r\n        [],\r\n        [6, 0],\r\n        [0, 1],\r\n        [1, 2],\r\n        [2, 3],\r\n        [3, 4],\r\n        [4, 5],\r\n        [5, 6],\r\n        undefined,\r\n        undefined,\r\n        undefined, [0, 0],\r\n        [1, 1],\r\n        [2, 2],\r\n        [3, 3],\r\n        [4, 4],\r\n        [5, 5],\r\n        [6, 6]\r\n    ];\r\n\r\n    exports.DATE = function(year, month, day) {\r\n        year = utils.parseNumber(year);\r\n        month = utils.parseNumber(month);\r\n        day = utils.parseNumber(day);\r\n        if (utils.anyIsError(year, month, day)) {\r\n            return error.value;\r\n        }\r\n        if (year < 0 || month < 0 || day < 0) {\r\n            return error.num;\r\n        }\r\n        var date = new Date(year, month - 1, day);\r\n        return date;\r\n    };\r\n\r\n    exports.DATEVALUE = function(date_text) {\r\n        if (typeof date_text !== 'string') {\r\n            return error.value;\r\n        }\r\n        var date = Date.parse(date_text);\r\n        if (isNaN(date)) {\r\n            return error.value;\r\n        }\r\n        if (date <= -2203891200000) {\r\n            return (date - d1900) / 86400000 + 1;\r\n        }\r\n        return (date - d1900) / 86400000 + 2;\r\n    };\r\n\r\n    exports.DAY = function(serial_number) {\r\n        var date = utils.parseDate(serial_number);\r\n        if (date instanceof Error) {\r\n            return date;\r\n        }\r\n        return date.getDate();\r\n    };\r\n\r\n    exports.DAYS = function(end_date, start_date) {\r\n        end_date = utils.parseDate(end_date);\r\n        start_date = utils.parseDate(start_date);\r\n        if (end_date instanceof Error) {\r\n            return end_date;\r\n        }\r\n        if (start_date instanceof Error) {\r\n            return start_date;\r\n        }\r\n        return serial(end_date) - serial(start_date);\r\n    };\r\n\r\n    exports.DAYS360 = function(start_date, end_date, method) {\r\n    };\r\n\r\n    exports.EDATE = function(start_date, months) {\r\n        start_date = utils.parseDate(start_date);\r\n        if (start_date instanceof Error) {\r\n            return start_date;\r\n        }\r\n        if (isNaN(months)) {\r\n            return error.value;\r\n        }\r\n        months = parseInt(months, 10);\r\n        start_date.setMonth(start_date.getMonth() + months);\r\n        return serial(start_date);\r\n    };\r\n\r\n    exports.EOMONTH = function(start_date, months) {\r\n        start_date = utils.parseDate(start_date);\r\n        if (start_date instanceof Error) {\r\n            return start_date;\r\n        }\r\n        if (isNaN(months)) {\r\n            return error.value;\r\n        }\r\n        months = parseInt(months, 10);\r\n        return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\r\n    };\r\n\r\n    exports.HOUR = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getHours();\r\n    };\r\n\r\n    exports.INTERVAL = function(second) {\r\n        if (typeof second !== 'number' && typeof second !== 'string') {\r\n            return error.value;\r\n        } else {\r\n            second = parseInt(second, 10);\r\n        }\r\n\r\n        var year  = Math.floor(second/946080000);\r\n        second    = second%946080000;\r\n        var month = Math.floor(second/2592000);\r\n        second    = second%2592000;\r\n        var day   = Math.floor(second/86400);\r\n        second    = second%86400;\r\n\r\n        var hour  = Math.floor(second/3600);\r\n        second    = second%3600;\r\n        var min   = Math.floor(second/60);\r\n        second    = second%60;\r\n        var sec   = second;\r\n\r\n        year  = (year  > 0) ? year  + 'Y' : '';\r\n        month = (month > 0) ? month + 'M' : '';\r\n        day   = (day   > 0) ? day   + 'D' : '';\r\n        hour  = (hour  > 0) ? hour  + 'H' : '';\r\n        min   = (min   > 0) ? min   + 'M' : '';\r\n        sec   = (sec   > 0) ? sec   + 'S' : '';\r\n\r\n        return 'P' + year + month + day + 'T' + hour + min + sec;\r\n    };\r\n\r\n    exports.ISOWEEKNUM = function(date) {\r\n        date = utils.parseDate(date);\r\n        if (date instanceof Error) {\r\n            return date;\r\n        }\r\n\r\n        date.setHours(0, 0, 0);\r\n        date.setDate(date.getDate() + 4 - (date.getDay() || 7));\r\n        var yearStart = new Date(date.getFullYear(), 0, 1);\r\n        return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\r\n    };\r\n\r\n    exports.MINUTE = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getMinutes();\r\n    };\r\n\r\n    exports.MONTH = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getMonth() + 1;\r\n    };\r\n\r\n    exports.NETWORKDAYS = function(start_date, end_date, holidays) {\r\n    };\r\n\r\n    exports.NETWORKDAYS.INTL = function(start_date, end_date, weekend, holidays) {\r\n    };\r\n\r\n    exports.NOW = function() {\r\n        return new Date();\r\n    };\r\n\r\n    exports.SECOND = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getSeconds();\r\n    };\r\n\r\n    exports.TIME = function(hour, minute, second) {\r\n        hour = utils.parseNumber(hour);\r\n        minute = utils.parseNumber(minute);\r\n        second = utils.parseNumber(second);\r\n        if (utils.anyIsError(hour, minute, second)) {\r\n            return error.value;\r\n        }\r\n        if (hour < 0 || minute < 0 || second < 0) {\r\n            return error.num;\r\n        }\r\n        return (3600 * hour + 60 * minute + second) / 86400;\r\n    };\r\n\r\n    exports.TIMEVALUE = function(time_text) {\r\n        time_text = utils.parseDate(time_text);\r\n        if (time_text instanceof Error) {\r\n            return time_text;\r\n        }\r\n        return (3600 * time_text.getHours() + 60 * time_text.getMinutes() + time_text.getSeconds()) / 86400;\r\n    };\r\n\r\n    exports.TODAY = function() {\r\n        return new Date();\r\n    };\r\n\r\n    exports.WEEKDAY = function(serial_number, return_type) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        if (return_type === undefined) {\r\n            return_type = 1;\r\n        }\r\n        var day = serial_number.getDay();\r\n        return WEEK_TYPES[return_type][day];\r\n    };\r\n\r\n    exports.WEEKNUM = function(serial_number, return_type) {\r\n    };\r\n\r\n    exports.WORKDAY = function(start_date, days, holidays) {\r\n    };\r\n\r\n    exports.WORKDAY.INTL = function(start_date, days, weekend, holidays) {\r\n    };\r\n\r\n    exports.YEAR = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getFullYear();\r\n    };\r\n\r\n    function isLeapYear(year) {\r\n        return new Date(year, 1, 29).getMonth() === 1;\r\n    }\r\n\r\n    exports.YEARFRAC = function(start_date, end_date, basis) {\r\n    };\r\n\r\n    function serial(date) {\r\n        var addOn = (date > -2203891200000)?2:1;\r\n        return (date - d1900) / 86400000 + addOn;\r\n    }\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.database = (function() {\r\n    var exports = {};\r\n\r\n    function compact(array) {\r\n        if (!array) {\r\n            return array;\r\n        }\r\n        var result = [];\r\n        for (var i = 0; i < array.length; ++i) {\r\n            if (!array[i]) {\r\n                continue;\r\n            }\r\n            result.push(array[i]);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    exports.FINDFIELD = function(database, title) {\r\n        var index = null;\r\n        for (var i = 0; i < database.length; i++) {\r\n            if (database[i][0] === title) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Return error if the input field title is incorrect\r\n        if (index == null) {\r\n            return error.value;\r\n        }\r\n        return index;\r\n    };\r\n\r\n    function findResultIndex(database, criterias) {\r\n        var matches = {};\r\n        for (var i = 1; i < database[0].length; ++i) {\r\n            matches[i] = true;\r\n        }\r\n        var maxCriteriaLength = criterias[0].length;\r\n        for (i = 1; i < criterias.length; ++i) {\r\n            if (criterias[i].length > maxCriteriaLength) {\r\n                maxCriteriaLength = criterias[i].length;\r\n            }\r\n        }\r\n\r\n        for (var k = 1; k < database.length; ++k) {\r\n            for (var l = 1; l < database[k].length; ++l) {\r\n                var currentCriteriaResult = false;\r\n                var hasMatchingCriteria = false;\r\n                for (var j = 0; j < criterias.length; ++j) {\r\n                    var criteria = criterias[j];\r\n                    if (criteria.length < maxCriteriaLength) {\r\n                        continue;\r\n                    }\r\n\r\n                    var criteriaField = criteria[0];\r\n                    if (database[k][0] !== criteriaField) {\r\n                        continue;\r\n                    }\r\n                    hasMatchingCriteria = true;\r\n                    for (var p = 1; p < criteria.length; ++p) {\r\n                        currentCriteriaResult = currentCriteriaResult\r\n                                || eval(database[k][l] + criteria[p]); // jshint\r\n                                                                        // ignore:line\r\n                    }\r\n                }\r\n                if (hasMatchingCriteria) {\r\n                    matches[l] = matches[l] && currentCriteriaResult;\r\n                }\r\n            }\r\n        }\r\n\r\n        var result = [];\r\n        for (var n = 0; n < database[0].length; ++n) {\r\n            if (matches[n]) {\r\n                result.push(n - 1);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Database functions\r\n    exports.DAVERAGE = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var sum = 0;\r\n        for (var i = 0; i < resultIndexes.length; i++) {\r\n            sum += targetFields[resultIndexes[i]];\r\n        }\r\n        return resultIndexes.length === 0 ? error.div0 : sum / resultIndexes.length;\r\n    };\r\n\r\n    exports.DCOUNT = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DCOUNTA = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DGET = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        // Return error if no record meets the criteria\r\n        if (resultIndexes.length === 0) {\r\n            return error.value;\r\n        }\r\n        // Returns the #NUM! error value because more than one record meets the\r\n        // criteria\r\n        if (resultIndexes.length > 1) {\r\n            return error.num;\r\n        }\r\n\r\n        return targetFields[resultIndexes[0]];\r\n    };\r\n\r\n    exports.DMAX = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var maxValue = targetFields[resultIndexes[0]];\r\n        for (var i = 1; i < resultIndexes.length; i++) {\r\n            if (maxValue < targetFields[resultIndexes[i]]) {\r\n                maxValue = targetFields[resultIndexes[i]];\r\n            }\r\n        }\r\n        return maxValue;\r\n    };\r\n\r\n    exports.DMIN = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var minValue = targetFields[resultIndexes[0]];\r\n        for (var i = 1; i < resultIndexes.length; i++) {\r\n            if (minValue > targetFields[resultIndexes[i]]) {\r\n                minValue = targetFields[resultIndexes[i]];\r\n            }\r\n        }\r\n        return minValue;\r\n    };\r\n\r\n    exports.DPRODUCT = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var targetValues = [];\r\n        for (var i = 0; i < resultIndexes.length; i++) {\r\n            targetValues[i] = targetFields[resultIndexes[i]];\r\n        }\r\n        targetValues = compact(targetValues);\r\n        var result = 1;\r\n        for (i = 0; i < targetValues.length; i++) {\r\n            result *= targetValues[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.DSTDEV = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DSTDEVP = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DSUM = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DVAR = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DVARP = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.MATCH = function(lookupValue, lookupArray, matchType) {\r\n        if (!lookupValue && !lookupArray) {\r\n            return error.na;\r\n        }\r\n        if (arguments.length === 2) {\r\n            matchType = 1;\r\n        }\r\n        if (!(lookupArray instanceof Array)) {\r\n            return error.na;\r\n        }\r\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\r\n            return error.na;\r\n        }\r\n\r\n        var index;\r\n        var indexValue;\r\n\r\n        for (var idx = 0; idx < lookupArray.length; idx++) {\r\n            if (matchType === 1) {\r\n                if (lookupArray[idx] === lookupValue) {\r\n                    return idx + 1;\r\n                } else if (lookupArray[idx] < lookupValue) {\r\n                    if (!indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    } else if (lookupArray[idx] > indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    }\r\n                }\r\n            } else if (matchType === 0) {\r\n                if (typeof lookupValue === 'string') {\r\n                    lookupValue = lookupValue.replace(/\\?/g, '.');\r\n                    if (lookupArray[idx].toLowerCase().match(lookupValue.toLowerCase())) {\r\n                        return idx + 1;\r\n                    }\r\n                } else {\r\n                    if (lookupArray[idx] === lookupValue) {\r\n                        return idx + 1;\r\n                    }\r\n                }\r\n            } else if (matchType === -1) {\r\n                if (lookupArray[idx] === lookupValue) {\r\n                    return idx + 1;\r\n                } else if (lookupArray[idx] > lookupValue) {\r\n                    if (!indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    } else if (lookupArray[idx] < indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return index ? index : error.na;\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.engineering = (function() {\r\n    var exports = {};\r\n\r\n    function isValidBinaryNumber(number) {\r\n        return (/^[01]{1,10}$/).test(number);\r\n    }\r\n\r\n    exports.BESSELI = function(x, n) {\r\n    };\r\n\r\n    exports.BESSELJ = function(x, n) {\r\n    };\r\n\r\n    exports.BESSELK = function(x, n) {\r\n    };\r\n\r\n    exports.BESSELY = function(x, n) {\r\n    };\r\n\r\n    exports.BIN2DEC = function(number) {\r\n        // Return error if number is not binary or contains more than 10\r\n        // characters (10 digits)\r\n        if (!isValidBinaryNumber(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert binary number to decimal\r\n        var result = parseInt(number, 2);\r\n\r\n        // Handle negative numbers\r\n        var stringified = number.toString();\r\n        if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n            return parseInt(stringified.substring(1), 2) - 512;\r\n        } else {\r\n            return result;\r\n        }\r\n    };\r\n\r\n    exports.BIN2HEX = function(number, places) {\r\n        // Return error if number is not binary or contains more than 10\r\n        // characters (10 digits)\r\n        if (!isValidBinaryNumber(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character hexadecimal number if number\r\n        // is negative\r\n        var stringified = number.toString();\r\n        if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n            return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\r\n        }\r\n\r\n        // Convert binary number to hexadecimal\r\n        var result = parseInt(number, 2).toString(16);\r\n\r\n        // Return hexadecimal number using the minimum number of characters\r\n        // necessary if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.BIN2OCT = function(number, places) {\r\n        // Return error if number is not binary or contains more than 10\r\n        // characters (10 digits)\r\n        if (!isValidBinaryNumber(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        var stringified = number.toString();\r\n        if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n            return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\r\n        }\r\n\r\n        // Convert binary number to octal\r\n        var result = parseInt(number, 2).toString(8);\r\n\r\n        // Return octal number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.BITAND = function(number1, number2) {\r\n        // Return error if either number is a non-numeric value\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either number is less than 0\r\n        if (number1 < 0 || number2 < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is a non-integer\r\n        if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is greater than (2^48)-1\r\n        if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bitwise AND of two numbers\r\n        return number1 & number2;\r\n    };\r\n\r\n    exports.BITLSHIFT = function(number, shift) {\r\n        number = utils.parseNumber(number);\r\n        shift = utils.parseNumber(shift);\r\n        if (utils.anyIsError(number, shift)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if number is less than 0\r\n        if (number < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is a non-integer\r\n        if (Math.floor(number) !== number) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is greater than (2^48)-1\r\n        if (number > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if the absolute value of shift is greater than 53\r\n        if (Math.abs(shift) > 53) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return number shifted by shift bits to the left or to the right if\r\n        // shift is negative\r\n        return (shift >= 0) ? number << shift : number >> -shift;\r\n    };\r\n\r\n    exports.BITOR = function(number1, number2) {\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either number is less than 0\r\n        if (number1 < 0 || number2 < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is a non-integer\r\n        if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is greater than (2^48)-1\r\n        if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bitwise OR of two numbers\r\n        return number1 | number2;\r\n    };\r\n\r\n    exports.BITRSHIFT = function(number, shift) {\r\n        number = utils.parseNumber(number);\r\n        shift = utils.parseNumber(shift);\r\n        if (utils.anyIsError(number, shift)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if number is less than 0\r\n        if (number < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is a non-integer\r\n        if (Math.floor(number) !== number) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is greater than (2^48)-1\r\n        if (number > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if the absolute value of shift is greater than 53\r\n        if (Math.abs(shift) > 53) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return number shifted by shift bits to the right or to the left if\r\n        // shift is negative\r\n        return (shift >= 0) ? number >> shift : number << -shift;\r\n    };\r\n\r\n    exports.BITXOR = function(number1, number2) {\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either number is less than 0\r\n        if (number1 < 0 || number2 < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is a non-integer\r\n        if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is greater than (2^48)-1\r\n        if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bitwise XOR of two numbers\r\n        return number1 ^ number2;\r\n    };\r\n\r\n    exports.COMPLEX = function(real, imaginary, suffix) {\r\n        real = utils.parseNumber(real);\r\n        imaginary = utils.parseNumber(imaginary);\r\n        if (utils.anyIsError(real, imaginary)) {\r\n            return real;\r\n        }\r\n\r\n        // Set suffix\r\n        suffix = (suffix === undefined) ? 'i' : suffix;\r\n\r\n        // Return error if suffix is neither \"i\" nor \"j\"\r\n        if (suffix !== 'i' && suffix !== 'j') {\r\n            return error.value;\r\n        }\r\n\r\n        // Return complex number\r\n        if (real === 0 && imaginary === 0) {\r\n            return 0;\r\n        } else if (real === 0) {\r\n            return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\r\n        } else if (imaginary === 0) {\r\n            return real.toString();\r\n        } else {\r\n            var sign = (imaginary > 0) ? '+' : '';\r\n            return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\r\n        }\r\n    };\r\n\r\n    exports.CONVERT = function(number, from_unit, to_unit) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // List of units supported by CONVERT and units defined by the\r\n        // International System of Units\r\n        // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion\r\n        // ratio]\r\n        var units = [\r\n            [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n            [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\r\n            [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\r\n            [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\r\n            [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n            [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\r\n            [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\r\n            [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\r\n            [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\r\n            [\"ngstrm\", \"\", [\"ang\"], \"length\", false, true, 1e-10],\r\n            [\"are\", \"ar\", null, \"area\", false, true, 100],\r\n            [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\r\n            [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\r\n            [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\r\n            [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\r\n            [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\r\n            [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\r\n            [\"byte\", \"byte\", null, \"information\", false, true, 8],\r\n            [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\r\n            [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\r\n            [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\r\n            [\"cubic ngstrm\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\r\n            [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\r\n            [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\r\n            [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\r\n            [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\r\n            [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\r\n            [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\r\n            [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\r\n            [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\r\n            [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\r\n            [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\r\n            [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\r\n            [\"degree\", \"\", null, \"angle\", false, false, 0.0174532925199433],\r\n            [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\r\n            [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\r\n            [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\r\n            [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\r\n            [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\r\n            [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\r\n            [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\r\n            [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\r\n            [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\r\n            [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\r\n            [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\r\n            [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\r\n            [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\r\n            [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\r\n            [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\r\n            [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\r\n            [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\r\n            [\"henry\", \"H\", null, \"inductance\", true, false, 1],\r\n            [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\r\n            [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\r\n            [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\r\n            [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\r\n            [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\r\n            [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\r\n            [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\r\n            [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\r\n            [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\r\n            [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\r\n            [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\r\n            [\"joule\", \"J\", null, \"energy\", true, true, 1],\r\n            [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\r\n            [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\r\n            [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\r\n            [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\r\n            [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\r\n            [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\r\n            [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\r\n            [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\r\n            [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\r\n            [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\r\n            [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\r\n            [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\r\n            [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\r\n            [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\r\n            [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\r\n            [\"metre\", \"m\", null, \"length\", true, true, 1],\r\n            [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\r\n            [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\r\n            [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\r\n            [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\r\n            [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\r\n            [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\r\n            [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\r\n            [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n            [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n            [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\r\n            [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\r\n            [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1852],\r\n            [\"newton\", \"N\", null, \"force\", true, true, 1],\r\n            [\"rsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\r\n            [\"ohm\", \"\", null, \"electric_resistance\", true, false, 1],\r\n            [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\r\n            [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\r\n            [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\r\n            [\"pferdestrke\", \"PS\", null, \"power\", false, true, 735.49875],\r\n            [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\r\n            [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\r\n            [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\r\n            [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\r\n            [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\r\n            [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\r\n            [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\r\n            [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\r\n            [\"radian\", \"rad\", null, \"angle\", true, false, 1],\r\n            [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\r\n            [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\r\n            [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\r\n            [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\r\n            [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\r\n            [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\r\n            [\"square ngstrm\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\r\n            [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\r\n            [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\r\n            [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\r\n            [\"square meter\", \"m?\", null, \"area\", true, true, 1],\r\n            [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\r\n            [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\r\n            [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\r\n            [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\r\n            [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\r\n            [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\r\n            [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\r\n            [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\r\n            [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\r\n            [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\r\n            [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\r\n            [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\r\n            [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\r\n            [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\r\n            [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\r\n            [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\r\n            [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\r\n            [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\r\n            [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\r\n            [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\r\n            [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\r\n            [\"volt\", \"V\", null, \"voltage\", true, false, 1],\r\n            [\"watt\", \"W\", null, \"power\", true, true, 1],\r\n            [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\r\n            [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\r\n            [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\r\n            [\"year\", \"yr\", null, \"time\", false, true, 31557600]\r\n        ];\r\n\r\n        // Binary prefixes\r\n        // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived\r\n        // from]\r\n        var binary_prefixes = {\r\n            Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\r\n            Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\r\n            Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\r\n            Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\r\n            Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\r\n            Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\r\n            Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\r\n            ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\r\n        };\r\n\r\n        // Unit prefixes\r\n        // [Name, Multiplier, Abbreviation]\r\n        var unit_prefixes = {\r\n            Y: [\"yotta\", 1e+24, \"Y\"],\r\n            Z: [\"zetta\", 1e+21, \"Z\"],\r\n            E: [\"exa\", 1e+18, \"E\"],\r\n            P: [\"peta\", 1e+15, \"P\"],\r\n            T: [\"tera\", 1e+12, \"T\"],\r\n            G: [\"giga\", 1e+09, \"G\"],\r\n            M: [\"mega\", 1e+06, \"M\"],\r\n            k: [\"kilo\", 1e+03, \"k\"],\r\n            h: [\"hecto\", 1e+02, \"h\"],\r\n            e: [\"dekao\", 1e+01, \"e\"],\r\n            d: [\"deci\", 1e-01, \"d\"],\r\n            c: [\"centi\", 1e-02, \"c\"],\r\n            m: [\"milli\", 1e-03, \"m\"],\r\n            u: [\"micro\", 1e-06, \"u\"],\r\n            n: [\"nano\", 1e-09, \"n\"],\r\n            p: [\"pico\", 1e-12, \"p\"],\r\n            f: [\"femto\", 1e-15, \"f\"],\r\n            a: [\"atto\", 1e-18, \"a\"],\r\n            z: [\"zepto\", 1e-21, \"z\"],\r\n            y: [\"yocto\", 1e-24, \"y\"]\r\n        };\r\n\r\n        // Initialize units and multipliers\r\n        var from = null;\r\n        var to = null;\r\n        var base_from_unit = from_unit;\r\n        var base_to_unit = to_unit;\r\n        var from_multiplier = 1;\r\n        var to_multiplier = 1;\r\n        var alt;\r\n\r\n        // Lookup from and to units\r\n        for (var i = 0; i < units.length; i++) {\r\n            alt = (units[i][2] === null) ? [] : units[i][2];\r\n            if (units[i][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n              from = units[i];\r\n            }\r\n            if (units[i][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n              to = units[i];\r\n            }\r\n        }\r\n\r\n        // Lookup from prefix\r\n        if (from === null) {\r\n            var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\r\n            var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\r\n\r\n            // Handle dekao unit prefix (only unit prefix with two characters)\r\n            if (from_unit.substring(0, 2) === 'da') {\r\n              from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n            }\r\n\r\n            // Handle binary prefixes first (so that 'Yi' is processed before\r\n            // 'Y')\r\n            if (from_binary_prefix) {\r\n              from_multiplier = from_binary_prefix[2];\r\n              base_from_unit = from_unit.substring(2);\r\n            } else if (from_unit_prefix) {\r\n              from_multiplier = from_unit_prefix[1];\r\n              base_from_unit = from_unit.substring(from_unit_prefix[2].length);\r\n            }\r\n\r\n            // Lookup from unit\r\n            for (var j = 0; j < units.length; j++) {\r\n              alt = (units[j][2] === null) ? [] : units[j][2];\r\n              if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n                  from = units[j];\r\n              }\r\n            }\r\n        }\r\n\r\n        // Lookup to prefix\r\n        if (to === null) {\r\n            var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\r\n            var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\r\n\r\n            // Handle dekao unit prefix (only unit prefix with two characters)\r\n            if (to_unit.substring(0, 2) === 'da') {\r\n              to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n            }\r\n\r\n            // Handle binary prefixes first (so that 'Yi' is processed before\r\n            // 'Y')\r\n            if (to_binary_prefix) {\r\n              to_multiplier = to_binary_prefix[2];\r\n              base_to_unit = to_unit.substring(2);\r\n            } else if (to_unit_prefix) {\r\n              to_multiplier = to_unit_prefix[1];\r\n              base_to_unit = to_unit.substring(to_unit_prefix[2].length);\r\n            }\r\n\r\n            // Lookup to unit\r\n            for (var k = 0; k < units.length; k++) {\r\n              alt = (units[k][2] === null) ? [] : units[k][2];\r\n              if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n                  to = units[k];\r\n              }\r\n            }\r\n        }\r\n\r\n        // Return error if a unit does not exist\r\n        if (from === null || to === null) {\r\n            return error.na;\r\n        }\r\n\r\n        // Return error if units represent different quantities\r\n        if (from[3] !== to[3]) {\r\n            return error.na;\r\n        }\r\n\r\n        // Return converted number\r\n        return number * from[6] * from_multiplier / (to[6] * to_multiplier);\r\n    };\r\n\r\n    exports.DEC2BIN = function(number, places) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // Return error if number is not decimal, is lower than -512, or is\r\n        // greater than 511\r\n        if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character binary number if number is\r\n        // negative\r\n        if (number < 0) {\r\n            return '1' + REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\r\n        }\r\n\r\n        // Convert decimal number to binary\r\n        var result = parseInt(number, 10).toString(2);\r\n\r\n        // Return binary number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.DEC2HEX = function(number, places) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // Return error if number is not decimal, is lower than -549755813888,\r\n        // or is greater than 549755813887\r\n        if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character hexadecimal number if number\r\n        // is negative\r\n        if (number < 0) {\r\n            return (1099511627776 + number).toString(16);\r\n        }\r\n\r\n        // Convert decimal number to hexadecimal\r\n        var result = parseInt(number, 10).toString(16);\r\n\r\n        // Return hexadecimal number using the minimum number of characters\r\n        // necessary if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.DEC2OCT = function(number, places) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // Return error if number is not decimal, is lower than -549755813888,\r\n        // or is greater than 549755813887\r\n        if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        if (number < 0) {\r\n            return (1073741824 + number).toString(8);\r\n        }\r\n\r\n        // Convert decimal number to octal\r\n        var result = parseInt(number, 10).toString(8);\r\n\r\n        // Return octal number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.DELTA = function(number1, number2) {\r\n        // Set number2 to zero if undefined\r\n        number2 = (number2 === undefined) ? 0 : number2;\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return delta\r\n        return (number1 === number2) ? 1 : 0;\r\n    };\r\n\r\n    exports.ERF = function(lower_bound, upper_bound) {\r\n    };\r\n\r\n    exports.ERF.PRECISE = function() {\r\n    };\r\n\r\n    exports.ERFC = function(x) {\r\n    };\r\n\r\n    exports.ERFC.PRECISE = function() {\r\n    };\r\n\r\n    exports.GESTEP = function(number, step) {\r\n        step = step || 0;\r\n        number = utils.parseNumber(number);\r\n        if (utils.anyIsError(step, number)) {\r\n            return number;\r\n        }\r\n\r\n        // Return delta\r\n        return (number >= step) ? 1 : 0;\r\n    };\r\n\r\n    exports.HEX2BIN = function(number, places) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Check if number is negative\r\n        var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\r\n\r\n        // Convert hexadecimal number to decimal\r\n        var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\r\n\r\n        // Return error if number is lower than -512 or greater than 511\r\n        if (decimal < -512 || decimal > 511) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character binary number if number is\r\n        // negative\r\n        if (negative) {\r\n            return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n        }\r\n\r\n        // Convert decimal number to binary\r\n        var result = decimal.toString(2);\r\n\r\n        // Return binary number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.HEX2DEC = function(number) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert hexadecimal number to decimal\r\n        var decimal = parseInt(number, 16);\r\n\r\n        // Return decimal number\r\n        return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\r\n    };\r\n\r\n    exports.HEX2OCT = function(number, places) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert hexadecimal number to decimal\r\n        var decimal = parseInt(number, 16);\r\n\r\n        // Return error if number is positive and greater than 0x1fffffff\r\n        // (536870911)\r\n        if (decimal > 536870911 && decimal < 1098974756864) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        if (decimal >= 1098974756864) {\r\n            return (decimal - 1098437885952).toString(8);\r\n        }\r\n\r\n        // Convert decimal number to octal\r\n        var result = decimal.toString(8);\r\n\r\n        // Return octal number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.IMABS = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return absolute value of complex number\r\n        return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\r\n    };\r\n\r\n    exports.IMAGINARY = function(inumber) {\r\n        if (inumber === undefined || inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return 0 if inumber is equal to 0\r\n        if (inumber === 0 || inumber === '0') {\r\n            return 0;\r\n        }\r\n\r\n        // Handle special cases\r\n        if (['i', 'j'].indexOf(inumber) >= 0) {\r\n            return 1;\r\n        }\r\n\r\n        // Normalize imaginary coefficient\r\n        inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\r\n\r\n        // Lookup sign\r\n        var plus = inumber.indexOf('+');\r\n        var minus = inumber.indexOf('-');\r\n        if (plus === 0) {\r\n            plus = inumber.indexOf('+', 1);\r\n        }\r\n\r\n        if (minus === 0) {\r\n            minus = inumber.indexOf('-', 1);\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var last = inumber.substring(inumber.length - 1, inumber.length);\r\n        var unit = (last === 'i' || last === 'j');\r\n\r\n        if (plus >= 0 || minus >= 0) {\r\n            // Return error if imaginary unit is neither i nor j\r\n            if (!unit) {\r\n              return error.num;\r\n            }\r\n\r\n            // Return imaginary coefficient of complex number\r\n            if (plus >= 0) {\r\n              return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  Number(inumber.substring(plus + 1, inumber.length - 1));\r\n            } else {\r\n              return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  -Number(inumber.substring(minus + 1, inumber.length - 1));\r\n            }\r\n        } else {\r\n            if (unit) {\r\n              return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\r\n            } else {\r\n              return (isNaN(inumber)) ? error.num : 0;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.IMARGUMENT = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if inumber is equal to zero\r\n        if (x === 0 && y === 0) {\r\n            return error.div0;\r\n        }\r\n\r\n        // Return PI/2 if x is equal to zero and y is positive\r\n        if (x === 0 && y > 0) {\r\n            return Math.PI / 2;\r\n        }\r\n\r\n        // Return -PI/2 if x is equal to zero and y is negative\r\n        if (x === 0 && y < 0) {\r\n            return -Math.PI / 2;\r\n        }\r\n\r\n        // Return zero if x is negative and y is equal to zero\r\n        if (y === 0 && x > 0) {\r\n            return 0;\r\n        }\r\n\r\n        // Return zero if x is negative and y is equal to zero\r\n        if (y === 0 && x < 0) {\r\n            return -Math.PI;\r\n        }\r\n\r\n        // Return argument of complex number\r\n        if (x > 0) {\r\n            return Math.atan(y / x);\r\n        } else if (x < 0 && y >= 0) {\r\n            return Math.atan(y / x) + Math.PI;\r\n        } else {\r\n            return Math.atan(y / x) - Math.PI;\r\n        }\r\n    };\r\n\r\n    exports.IMCONJUGATE = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return conjugate of complex number\r\n        return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\r\n    };\r\n\r\n    exports.IMCOS = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return cosine of complex number\r\n        return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n    };\r\n\r\n    exports.IMCOSH = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return hyperbolic cosine of complex number\r\n        return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\r\n    };\r\n\r\n    exports.IMCOT = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return cotangent of complex number\r\n        return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\r\n    };\r\n\r\n    exports.IMDIV = function(inumber1, inumber2) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var a = exports.IMREAL(inumber1);\r\n        var b = exports.IMAGINARY(inumber1);\r\n        var c = exports.IMREAL(inumber2);\r\n        var d = exports.IMAGINARY(inumber2);\r\n\r\n        if (utils.anyIsError(a, b, c, d)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit1 = inumber1.substring(inumber1.length - 1);\r\n        var unit2 = inumber2.substring(inumber2.length - 1);\r\n        var unit = 'i';\r\n        if (unit1 === 'j') {\r\n            unit = 'j';\r\n        } else if (unit2 === 'j') {\r\n            unit = 'j';\r\n        }\r\n\r\n        // Return error if inumber2 is null\r\n        if (c === 0 && d === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return exponential of complex number\r\n        var den = c * c + d * d;\r\n        return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\r\n    };\r\n\r\n    exports.IMEXP = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        var e = Math.exp(x);\r\n        return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\r\n    };\r\n\r\n    exports.IMLN = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\r\n    };\r\n\r\n    exports.IMLOG10 = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\r\n    };\r\n\r\n    exports.IMLOG2 = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\r\n    };\r\n\r\n    exports.IMPOWER = function(inumber, number) {\r\n        number = utils.parseNumber(number);\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n        if (utils.anyIsError(number, x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Calculate power of modulus\r\n        var p = Math.pow(exports.IMABS(inumber), number);\r\n\r\n        // Calculate argument\r\n        var t = exports.IMARGUMENT(inumber);\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\r\n    };\r\n\r\n    exports.IMPRODUCT = function() {\r\n        // Initialize result\r\n        var result = arguments[0];\r\n\r\n        // Loop on all numbers\r\n        for (var i = 1; i < arguments.length; i++) {\r\n            // Lookup coefficients of two complex numbers\r\n            var a = exports.IMREAL(result);\r\n            var b = exports.IMAGINARY(result);\r\n            var c = exports.IMREAL(arguments[i]);\r\n            var d = exports.IMAGINARY(arguments[i]);\r\n\r\n            if (utils.anyIsError(a, b, c, d)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Complute product of two complex numbers\r\n            result = exports.COMPLEX(a * c - b * d, a * d + b * c);\r\n        }\r\n\r\n        // Return product of complex numbers\r\n        return result;\r\n    };\r\n\r\n    exports.IMREAL = function(inumber) {\r\n        if (inumber === undefined || inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return 0 if inumber is equal to 0\r\n        if (inumber === 0 || inumber === '0') {\r\n            return 0;\r\n        }\r\n\r\n        // Handle special cases\r\n        if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\r\n            return 0;\r\n        }\r\n\r\n        // Lookup sign\r\n        var plus = inumber.indexOf('+');\r\n        var minus = inumber.indexOf('-');\r\n        if (plus === 0) {\r\n            plus = inumber.indexOf('+', 1);\r\n        }\r\n        if (minus === 0) {\r\n            minus = inumber.indexOf('-', 1);\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var last = inumber.substring(inumber.length - 1, inumber.length);\r\n        var unit = (last === 'i' || last === 'j');\r\n\r\n        if (plus >= 0 || minus >= 0) {\r\n            // Return error if imaginary unit is neither i nor j\r\n            if (!unit) {\r\n              return error.num;\r\n            }\r\n\r\n            // Return real coefficient of complex number\r\n            if (plus >= 0) {\r\n              return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  Number(inumber.substring(0, plus));\r\n            } else {\r\n              return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  Number(inumber.substring(0, minus));\r\n            }\r\n        } else {\r\n            if (unit) {\r\n              return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\r\n            } else {\r\n              return (isNaN(inumber)) ? error.num : inumber;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.IMSEC = function(inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return secant of complex number\r\n        return exports.IMDIV('1', exports.IMCOS(inumber));\r\n    };\r\n\r\n    exports.IMSECH = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return hyperbolic secant of complex number\r\n        return exports.IMDIV('1', exports.IMCOSH(inumber));\r\n    };\r\n\r\n    exports.IMSIN = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return sine of complex number\r\n        return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n    };\r\n\r\n    exports.IMSINH = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return hyperbolic sine of complex number\r\n        return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\r\n    };\r\n\r\n    exports.IMSQRT = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Calculate power of modulus\r\n        var s = Math.sqrt(exports.IMABS(inumber));\r\n\r\n        // Calculate argument\r\n        var t = exports.IMARGUMENT(inumber);\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\r\n    };\r\n\r\n    exports.IMCSC = function (inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return cosecant of complex number\r\n        return exports.IMDIV('1', exports.IMSIN(inumber));\r\n    };\r\n\r\n    exports.IMCSCH = function (inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return hyperbolic cosecant of complex number\r\n        return exports.IMDIV('1', exports.IMSINH(inumber));\r\n    };\r\n\r\n    exports.IMSUB = function(inumber1, inumber2) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var a = this.IMREAL(inumber1);\r\n        var b = this.IMAGINARY(inumber1);\r\n        var c = this.IMREAL(inumber2);\r\n        var d = this.IMAGINARY(inumber2);\r\n\r\n        if (utils.anyIsError(a, b, c, d)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit1 = inumber1.substring(inumber1.length - 1);\r\n        var unit2 = inumber2.substring(inumber2.length - 1);\r\n        var unit = 'i';\r\n        if (unit1 === 'j') {\r\n            unit = 'j';\r\n        } else if (unit2 === 'j') {\r\n            unit = 'j';\r\n        }\r\n\r\n        // Return _ of two complex numbers\r\n        return this.COMPLEX(a - c, b - d, unit);\r\n    };\r\n\r\n    exports.IMSUM = function() {\r\n        var args = utils.flatten(arguments);\r\n\r\n        // Initialize result\r\n        var result = args[0];\r\n\r\n        // Loop on all numbers\r\n        for (var i = 1; i < args.length; i++) {\r\n            // Lookup coefficients of two complex numbers\r\n            var a = this.IMREAL(result);\r\n            var b = this.IMAGINARY(result);\r\n            var c = this.IMREAL(args[i]);\r\n            var d = this.IMAGINARY(args[i]);\r\n\r\n            if (utils.anyIsError(a, b, c, d)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Complute product of two complex numbers\r\n            result = this.COMPLEX(a + c, b + d);\r\n        }\r\n\r\n        // Return sum of complex numbers\r\n        return result;\r\n    };\r\n\r\n    exports.IMTAN = function(inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return tangent of complex number\r\n        return this.IMDIV(this.IMSIN(inumber), this.IMCOS(inumber));\r\n    };\r\n\r\n    exports.OCT2BIN = function(number, places) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-7]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Check if number is negative\r\n        var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\r\n\r\n        // Convert octal number to decimal\r\n        var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\r\n\r\n        // Return error if number is lower than -512 or greater than 511\r\n        if (decimal < -512 || decimal > 511) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character binary number if number is\r\n        // negative\r\n        if (negative) {\r\n            return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n        }\r\n\r\n        // Convert decimal number to binary\r\n        var result = decimal.toString(2);\r\n\r\n        // Return binary number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.OCT2DEC = function(number) {\r\n        // Return error if number is not octal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-7]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert octal number to decimal\r\n        var decimal = parseInt(number, 8);\r\n\r\n        // Return decimal number\r\n        return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\r\n    };\r\n\r\n    exports.OCT2HEX = function(number, places) {\r\n        // Return error if number is not octal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-7]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert octal number to decimal\r\n        var decimal = parseInt(number, 8);\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        if (decimal >= 536870912) {\r\n            return 'ff' + (decimal + 3221225472).toString(16);\r\n        }\r\n\r\n        // Convert decimal number to hexadecimal\r\n        var result = decimal.toString(16);\r\n\r\n        // Return hexadecimal number using the minimum number of characters\r\n        // necessary if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.financial = (function() {\r\n    var exports = {};\r\n\r\n    function validDate(d) {\r\n        return d && d.getTime && !isNaN(d.getTime());\r\n    }\r\n\r\n    function ensureDate(d) {\r\n        return (d instanceof Date)?d:new Date(d);\r\n    }\r\n\r\n    exports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\r\n        // Return error if either date is invalid\r\n        issue        = ensureDate(issue);\r\n        first        = ensureDate(first);\r\n        settlement = ensureDate(settlement);\r\n        if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\r\n            return '#VALUE!';\r\n        }\r\n\r\n        // Return error if either rate or par are lower than or equal to zero\r\n        if (rate <= 0 || par <= 0) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Return error if frequency is neither 1, 2, or 4\r\n        if ([1, 2, 4].indexOf(frequency) === -1) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Return error if basis is neither 0, 1, 2, 3, or 4\r\n        if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Return error if settlement is before or equal to issue\r\n        if (settlement <= issue) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Set default values\r\n        par   = par   || 0;\r\n        basis = basis || 0;\r\n\r\n        // Compute accrued interest\r\n        return par * rate * YEARFRAC(issue, settlement, basis);\r\n    };\r\n\r\n    exports.ACCRINTM = null;\r\n\r\n    exports.AMORDEGRC = null;\r\n\r\n    exports.AMORLINC = null;\r\n\r\n    exports.COUPDAYBS = null;\r\n\r\n    exports.COUPDAYS = null;\r\n\r\n    exports.COUPDAYSNC = null;\r\n\r\n    exports.COUPNCD = null;\r\n\r\n    exports.COUPNUM = null;\r\n\r\n    exports.COUPPCD = null;\r\n\r\n    exports.CUMIPMT = function(rate, periods, value, start, end, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n        // Credits: Hannes Stiebitzhofer for the translations of function and\r\n            // variable names\r\n        // Requires exports.FV() and exports.PMT() from exports.js\r\n            // [http://stoic.com/exports/]\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        value = utils.parseNumber(value);\r\n        if (utils.anyIsError(rate, periods, value)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either rate, periods, or value are lower than or\r\n            // equal to zero\r\n        if (rate <= 0 || periods <= 0 || value <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if start < 1, end < 1, or start > end\r\n        if (start < 1 || end < 1 || start > end) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if type is neither 0 nor 1\r\n        if (type !== 0 && type !== 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Compute cumulative interest\r\n        var payment = exports.PMT(rate, periods, value, 0, type);\r\n        var interest = 0;\r\n\r\n        if (start === 1) {\r\n            if (type === 0) {\r\n                interest = -value;\r\n                start++;\r\n            }\r\n        }\r\n\r\n        for (var i = start; i <= end; i++) {\r\n            if (type === 1) {\r\n                interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\r\n            } else {\r\n                interest += exports.FV(rate, i - 1, payment, value, 0);\r\n            }\r\n        }\r\n        interest *= rate;\r\n\r\n        // Return cumulative interest\r\n        return interest;\r\n    };\r\n\r\n    exports.CUMPRINC = function(rate, periods, value, start, end, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n        // Credits: Hannes Stiebitzhofer for the translations of function and\r\n            // variable names\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        value = utils.parseNumber(value);\r\n        if (utils.anyIsError(rate, periods, value)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either rate, periods, or value are lower than or\r\n            // equal to zero\r\n        if (rate <= 0 || periods <= 0 || value <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if start < 1, end < 1, or start > end\r\n        if (start < 1 || end < 1 || start > end) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if type is neither 0 nor 1\r\n        if (type !== 0 && type !== 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Compute cumulative principal\r\n        var payment = exports.PMT(rate, periods, value, 0, type);\r\n        var principal = 0;\r\n        if (start === 1) {\r\n            if (type === 0) {\r\n                principal = payment + value * rate;\r\n            } else {\r\n                principal = payment;\r\n            }\r\n            start++;\r\n        }\r\n        for (var i = start; i <= end; i++) {\r\n            if (type > 0) {\r\n                principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\r\n            } else {\r\n                principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\r\n            }\r\n        }\r\n\r\n        // Return cumulative principal\r\n        return principal;\r\n    };\r\n\r\n    exports.DB = function(cost, salvage, life, period, month) {\r\n        // Initialize month\r\n        month = (month === undefined) ? 12 : month;\r\n\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        period = utils.parseNumber(period);\r\n        month = utils.parseNumber(month);\r\n        if (utils.anyIsError(cost, salvage, life, period, month)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if any of the parameters is negative\r\n        if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if month is not an integer between 1 and 12\r\n        if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if period is greater than life\r\n        if (period > life) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return 0 (zero) if salvage is greater than or equal to cost\r\n        if (salvage >= cost) {\r\n            return 0;\r\n        }\r\n\r\n        // Rate is rounded to three decimals places\r\n        var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\r\n\r\n        // Compute initial depreciation\r\n        var initial = cost * rate * month / 12;\r\n\r\n        // Compute total depreciation\r\n        var total = initial;\r\n        var current = 0;\r\n        var ceiling = (period === life) ? life - 1 : period;\r\n        for (var i = 2; i <= ceiling; i++) {\r\n            current = (cost - total) * rate;\r\n            total += current;\r\n        }\r\n\r\n        // Depreciation for the first and last periods are special cases\r\n        if (period === 1) {\r\n            // First period\r\n            return initial;\r\n        } else if (period === life) {\r\n            // Last period\r\n            return (cost - total) * rate;\r\n        } else {\r\n            return current;\r\n        }\r\n    };\r\n\r\n    exports.DDB = function(cost, salvage, life, period, factor) {\r\n        // Initialize factor\r\n        factor = (factor === undefined) ? 2 : factor;\r\n\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        period = utils.parseNumber(period);\r\n        factor = utils.parseNumber(factor);\r\n        if (utils.anyIsError(cost, salvage, life, period, factor)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if any of the parameters is negative or if factor is\r\n            // null\r\n        if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if period is greater than life\r\n        if (period > life) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return 0 (zero) if salvage is greater than or equal to cost\r\n        if (salvage >= cost) {\r\n            return 0;\r\n        }\r\n\r\n        // Compute depreciation\r\n        var total = 0;\r\n        var current = 0;\r\n        for (var i = 1; i <= period; i++) {\r\n            current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\r\n            total += current;\r\n        }\r\n\r\n        // Return depreciation\r\n        return current;\r\n    };\r\n\r\n    exports.DISC = null;\r\n\r\n    exports.DOLLARDE = function(dollar, fraction) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        dollar = utils.parseNumber(dollar);\r\n        fraction = utils.parseNumber(fraction);\r\n        if (utils.anyIsError(dollar, fraction)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if fraction is negative\r\n        if (fraction < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if fraction is greater than or equal to 0 and less than\r\n            // 1\r\n        if (fraction >= 0 && fraction < 1) {\r\n            return error.div0;\r\n        }\r\n\r\n        // Truncate fraction if it is not an integer\r\n        fraction = parseInt(fraction, 10);\r\n\r\n        // Compute integer part\r\n        var result = parseInt(dollar, 10);\r\n\r\n        // Add decimal part\r\n        result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\r\n\r\n        // Round result\r\n        var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\r\n        result = Math.round(result * power) / power;\r\n\r\n        // Return converted dollar price\r\n        return result;\r\n    };\r\n\r\n    exports.DOLLARFR = function(dollar, fraction) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        dollar = utils.parseNumber(dollar);\r\n        fraction = utils.parseNumber(fraction);\r\n        if (utils.anyIsError(dollar, fraction)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if fraction is negative\r\n        if (fraction < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if fraction is greater than or equal to 0 and less than\r\n            // 1\r\n        if (fraction >= 0 && fraction < 1) {\r\n            return error.div0;\r\n        }\r\n\r\n        // Truncate fraction if it is not an integer\r\n        fraction = parseInt(fraction, 10);\r\n\r\n        // Compute integer part\r\n        var result = parseInt(dollar, 10);\r\n\r\n        // Add decimal part\r\n        result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\r\n\r\n        // Return converted dollar price\r\n        return result;\r\n    };\r\n\r\n    exports.DURATION = null;\r\n\r\n    exports.EFFECT = function(rate, periods) {\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        if (utils.anyIsError(rate, periods)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if rate <=0 or periods < 1\r\n        if (rate <= 0 || periods < 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Truncate periods if it is not an integer\r\n        periods = parseInt(periods, 10);\r\n\r\n        // Return effective annual interest rate\r\n        return Math.pow(1 + rate / periods, periods) - 1;\r\n    };\r\n\r\n    exports.FV = function(rate, periods, payment, value, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        value = value || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        payment = utils.parseNumber(payment);\r\n        value = utils.parseNumber(value);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, payment, value, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return future value\r\n        var result;\r\n        if (rate === 0) {\r\n            result = value + payment * periods;\r\n        } else {\r\n            var term = Math.pow(1 + rate, periods);\r\n            if (type === 1) {\r\n                result = value * term + payment * (1 + rate) * (term - 1) / rate;\r\n            } else {\r\n                result = value * term + payment * (term - 1) / rate;\r\n            }\r\n        }\r\n        return -result;\r\n    };\r\n\r\n    exports.FVSCHEDULE = function(principal, schedule) {\r\n        principal = utils.parseNumber(principal);\r\n        schedule = utils.parseNumberArray(utils.flatten(schedule));\r\n        if (utils.anyIsError(principal, schedule)) {\r\n            return error.value;\r\n        }\r\n\r\n        var n = schedule.length;\r\n        var future = principal;\r\n\r\n        // Apply all interests in schedule\r\n        for (var i = 0; i < n; i++) {\r\n            // Apply scheduled interest\r\n            future *= 1 + schedule[i];\r\n        }\r\n\r\n        // Return future value\r\n        return future;\r\n    };\r\n\r\n    exports.INTRATE = null;\r\n\r\n    exports.IPMT = function(rate, period, periods, present, future, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        period = utils.parseNumber(period);\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, period, periods, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Compute payment\r\n        var payment = exports.PMT(rate, periods, present, future, type);\r\n\r\n        // Compute interest\r\n        var interest;\r\n        if (period === 1) {\r\n            if (type === 1) {\r\n                interest = 0;\r\n            } else {\r\n                interest = -present;\r\n            }\r\n        } else {\r\n            if (type === 1) {\r\n                interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\r\n            } else {\r\n                interest = exports.FV(rate, period - 1, payment, present, 0);\r\n            }\r\n        }\r\n\r\n        // Return interest\r\n        return interest * rate;\r\n    };\r\n\r\n    exports.IRR = function(values, guess) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        guess = guess || 0;\r\n\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        guess = utils.parseNumber(guess);\r\n        if (utils.anyIsError(values, guess)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Calculates the resulting amount\r\n        var irrResult = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = values[0];\r\n            for (var i = 1; i < values.length; i++) {\r\n                result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Calculates the first derivation\r\n        var irrResultDeriv = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = 0;\r\n            for (var i = 1; i < values.length; i++) {\r\n                var frac = (dates[i] - dates[0]) / 365;\r\n                result -= frac * values[i] / Math.pow(r, frac + 1);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Initialize dates and check that values contains at least one positive\r\n            // value and one negative value\r\n        var dates = [];\r\n        var positive = false;\r\n        var negative = false;\r\n        for (var i = 0; i < values.length; i++) {\r\n            dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\r\n            if (values[i] > 0) {\r\n                positive = true;\r\n            }\r\n            if (values[i] < 0) {\r\n                negative = true;\r\n            }\r\n        }\r\n\r\n        // Return error if values does not contain at least one positive value\r\n            // and one negative value\r\n        if (!positive || !negative) {\r\n            return error.num;\r\n        }\r\n\r\n        // Initialize guess and resultRate\r\n        guess = (guess === undefined) ? 0.1 : guess;\r\n        var resultRate = guess;\r\n\r\n        // Set maximum epsilon for end of iteration\r\n        var epsMax = 1e-10;\r\n\r\n        // Implement Newton's method\r\n        var newRate, epsRate, resultValue;\r\n        var contLoop = true;\r\n        do {\r\n            resultValue = irrResult(values, dates, resultRate);\r\n            newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n            epsRate = Math.abs(newRate - resultRate);\r\n            resultRate = newRate;\r\n            contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n        } while (contLoop);\r\n\r\n        // Return internal rate of return\r\n        return resultRate;\r\n    };\r\n\r\n    exports.ISPMT = function(rate, period, periods, value) {\r\n        rate = utils.parseNumber(rate);\r\n        period = utils.parseNumber(period);\r\n        periods = utils.parseNumber(periods);\r\n        value = utils.parseNumber(value);\r\n        if (utils.anyIsError(rate, period, periods, value)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return interest\r\n        return value * rate * (period / periods - 1);\r\n    };\r\n\r\n    exports.MDURATION = null;\r\n\r\n    exports.MIRR = function(values, finance_rate, reinvest_rate) {\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        finance_rate = utils.parseNumber(finance_rate);\r\n        reinvest_rate = utils.parseNumber(reinvest_rate);\r\n        if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Initialize number of values\r\n        var n = values.length;\r\n\r\n        // Lookup payments (negative values) and incomes (positive values)\r\n        var payments = [];\r\n        var incomes = [];\r\n        for (var i = 0; i < n; i++) {\r\n            if (values[i] < 0) {\r\n                payments.push(values[i]);\r\n            } else {\r\n                incomes.push(values[i]);\r\n            }\r\n        }\r\n\r\n        // Return modified internal rate of return\r\n        var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\r\n        var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\r\n        return Math.pow(num / den, 1 / (n - 1)) - 1;\r\n    };\r\n\r\n    exports.NOMINAL = function(rate, periods) {\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        if (utils.anyIsError(rate, periods)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if rate <=0 or periods < 1\r\n        if (rate <= 0 || periods < 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Truncate periods if it is not an integer\r\n        periods = parseInt(periods, 10);\r\n\r\n        // Return nominal annual interest rate\r\n        return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\r\n    };\r\n\r\n    exports.NPER = function(rate, payment, present, future, type) {\r\n        type = (type === undefined) ? 0 : type;\r\n        future = (future === undefined) ? 0 : future;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        payment = utils.parseNumber(payment);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, payment, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return number of periods\r\n        var num = payment * (1 + rate * type) - future * rate;\r\n        var den = (present * rate + payment * (1 + rate * type));\r\n        return Math.log(num / den) / Math.log(1 + rate);\r\n    };\r\n\r\n    exports.NPV = function() {\r\n        var args = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (args instanceof Error) {\r\n            return args;\r\n        }\r\n\r\n        // Lookup rate\r\n        var rate = args[0];\r\n\r\n        // Initialize net present value\r\n        var value = 0;\r\n\r\n        // Loop on all values\r\n        for (var j = 1; j < args.length; j++) {\r\n            value += args[j] / Math.pow(1 + rate, j);\r\n        }\r\n\r\n        // Return net present value\r\n        return value;\r\n    };\r\n\r\n    exports.ODDFPRICE = null;\r\n\r\n    exports.ODDFYIELD = null;\r\n\r\n    exports.ODDLPRICE = null;\r\n\r\n    exports.ODDLYIELD = null;\r\n\r\n    exports.PDURATION = function(rate, present, future) {\r\n        rate = utils.parseNumber(rate);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        if (utils.anyIsError(rate, present, future)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if rate <=0\r\n        if (rate <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return number of periods\r\n        return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\r\n    };\r\n\r\n    exports.PMT = function(rate, periods, present, future, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return payment\r\n        var result;\r\n        if (rate === 0) {\r\n            result = (present + future) / periods;\r\n        } else {\r\n            var term = Math.pow(1 + rate, periods);\r\n            if (type === 1) {\r\n                result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\r\n            } else {\r\n                result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\r\n            }\r\n        }\r\n        return -result;\r\n    };\r\n\r\n    exports.PPMT = function(rate, period, periods, present, future, type) {\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\r\n    };\r\n\r\n    exports.PRICE = null;\r\n\r\n    exports.PRICEDISC = null;\r\n\r\n    exports.PRICEMAT = null;\r\n\r\n    exports.PV = function(rate, periods, payment, future, type) {\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        payment = utils.parseNumber(payment);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, payment, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return present value\r\n        if (rate === 0) {\r\n            return -payment * periods - future;\r\n        } else {\r\n            return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\r\n        }\r\n    };\r\n\r\n    exports.RATE = function(periods, payment, present, future, type, guess) {\r\n        // Credits: rabugento\r\n\r\n        guess = (guess === undefined) ? 0.01 : guess;\r\n        future = (future === undefined) ? 0 : future;\r\n        type = (type === undefined) ? 0 : type;\r\n\r\n        periods = utils.parseNumber(periods);\r\n        payment = utils.parseNumber(payment);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        guess = utils.parseNumber(guess);\r\n        if (utils.anyIsError(periods, payment, present, future, type, guess)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Set maximum epsilon for end of iteration\r\n        var epsMax = 1e-6;\r\n\r\n        // Set maximum number of iterations\r\n        var iterMax = 100;\r\n        var iter = 0;\r\n        var close = false;\r\n        var rate = guess;\r\n\r\n        while (iter < iterMax && !close) {\r\n            var t1 = Math.pow(rate + 1, periods);\r\n            var t2 = Math.pow(rate + 1, periods - 1);\r\n\r\n            var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\r\n            var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\r\n            var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\r\n\r\n            var newRate = rate - f1 / (f2 + f3);\r\n\r\n            if (Math.abs(newRate - rate) < epsMax) close = true;\r\n            iter++\r\n            rate = newRate;\r\n        }\r\n\r\n        if (!close) return Number.NaN + rate;\r\n        return rate;\r\n    };\r\n\r\n    // TODO\r\n    exports.RECEIVED = null;\r\n\r\n    exports.RRI = function(periods, present, future) {\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        if (utils.anyIsError(periods, present, future)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if periods or present is equal to 0 (zero)\r\n        if (periods === 0 || present === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return equivalent interest rate\r\n        return Math.pow(future / present, 1 / periods) - 1;\r\n    };\r\n\r\n    exports.SLN = function(cost, salvage, life) {\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        if (utils.anyIsError(cost, salvage, life)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if life equal to 0 (zero)\r\n        if (life === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return straight-line depreciation\r\n        return (cost - salvage) / life;\r\n    };\r\n\r\n    exports.SYD = function(cost, salvage, life, period) {\r\n        // Return error if any of the parameters is not a number\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        period = utils.parseNumber(period);\r\n        if (utils.anyIsError(cost, salvage, life, period)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if life equal to 0 (zero)\r\n        if (life === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if period is lower than 1 or greater than life\r\n        if (period < 1 || period > life) {\r\n            return error.num;\r\n        }\r\n\r\n        // Truncate period if it is not an integer\r\n        period = parseInt(period, 10);\r\n\r\n        // Return straight-line depreciation\r\n        return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\r\n    };\r\n\r\n    exports.TBILLEQ = function(settlement, maturity, discount) {\r\n        settlement = utils.parseDate(settlement);\r\n        maturity = utils.parseDate(maturity);\r\n        discount = utils.parseNumber(discount);\r\n        if (utils.anyIsError(settlement, maturity, discount)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if discount is lower than or equal to zero\r\n        if (discount <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if settlement is greater than maturity\r\n        if (settlement > maturity) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if maturity is more than one year after settlement\r\n        if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bond-equivalent yield\r\n        return (365 * discount) / (360 - discount * DAYS360(settlement, maturity, false));\r\n    };\r\n\r\n    exports.TBILLPRICE = function(settlement, maturity, discount) {\r\n        settlement = utils.parseDate(settlement);\r\n        maturity = utils.parseDate(maturity);\r\n        discount = utils.parseNumber(discount);\r\n        if (utils.anyIsError(settlement, maturity, discount)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if discount is lower than or equal to zero\r\n        if (discount <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if settlement is greater than maturity\r\n        if (settlement > maturity) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if maturity is more than one year after settlement\r\n        if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bond-equivalent yield\r\n        return 100 * (1 - discount * DAYS360(settlement, maturity, false) / 360);\r\n    };\r\n\r\n    exports.TBILLYIELD = function(settlement, maturity, price) {\r\n        settlement = utils.parseDate(settlement);\r\n        maturity = utils.parseDate(maturity);\r\n        price = utils.parseNumber(price);\r\n        if (utils.anyIsError(settlement, maturity, price)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if price is lower than or equal to zero\r\n        if (price <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if settlement is greater than maturity\r\n        if (settlement > maturity) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if maturity is more than one year after settlement\r\n        if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bond-equivalent yield\r\n        return (100 - price) * 360 / (price * DAYS360(settlement, maturity, false));\r\n    };\r\n\r\n    exports.VDB = null;\r\n\r\n    exports.XIRR = function(values, dates, guess) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        dates = utils.parseDateArray(utils.flatten(dates));\r\n        guess = utils.parseNumber(guess);\r\n        if (utils.anyIsError(values, dates, guess)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Calculates the resulting amount\r\n        var irrResult = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = values[0];\r\n            for (var i = 1; i < values.length; i++) {\r\n                result += values[i] / Math.pow(r, DAYS(dates[i], dates[0]) / 365);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Calculates the first derivation\r\n        var irrResultDeriv = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = 0;\r\n            for (var i = 1; i < values.length; i++) {\r\n                var frac = DAYS(dates[i], dates[0]) / 365;\r\n                result -= frac * values[i] / Math.pow(r, frac + 1);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Check that values contains at least one positive value and one\r\n            // negative value\r\n        var positive = false;\r\n        var negative = false;\r\n        for (var i = 0; i < values.length; i++) {\r\n            if (values[i] > 0) {\r\n                positive = true;\r\n            }\r\n            if (values[i] < 0) {\r\n                negative = true;\r\n            }\r\n        }\r\n\r\n        // Return error if values does not contain at least one positive value\r\n            // and one negative value\r\n        if (!positive || !negative) {\r\n            return error.num;\r\n        }\r\n\r\n        // Initialize guess and resultRate\r\n        guess = guess || 0.1;\r\n        var resultRate = guess;\r\n\r\n        // Set maximum epsilon for end of iteration\r\n        var epsMax = 1e-10;\r\n\r\n        // Implement Newton's method\r\n        var newRate, epsRate, resultValue;\r\n        var contLoop = true;\r\n        do {\r\n            resultValue = irrResult(values, dates, resultRate);\r\n            newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n            epsRate = Math.abs(newRate - resultRate);\r\n            resultRate = newRate;\r\n            contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n        } while (contLoop);\r\n\r\n        // Return internal rate of return\r\n        return resultRate;\r\n    };\r\n\r\n    exports.XNPV = function(rate, values, dates) {\r\n        rate = utils.parseNumber(rate);\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        dates = utils.parseDateArray(utils.flatten(dates));\r\n        if (utils.anyIsError(rate, values, dates)) {\r\n            return error.value;\r\n        }\r\n\r\n        var result = 0;\r\n        for (var i = 0; i < values.length; i++) {\r\n            result += values[i] / Math.pow(1 + rate, DAYS(dates[i], dates[0]) / 365);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.YIELD = null;\r\n\r\n    exports.YIELDDISC = null;\r\n\r\n    exports.YIELDMAT = null;\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.information = (function() {\r\n    var exports = {};\r\n    exports.CELL = null;\r\n\r\n    exports.ERROR = {};\r\n    exports.ERROR.TYPE = function(error_val) {\r\n        switch (error_val) {\r\n            case error.nil: return 1;\r\n            case error.div0: return 2;\r\n            case error.value: return 3;\r\n            case error.ref: return 4;\r\n            case error.name: return 5;\r\n            case error.num: return 6;\r\n            case error.na: return 7;\r\n            case error.data: return 8;\r\n        }\r\n        return error.na;\r\n    };\r\n\r\n    exports.INFO = null;\r\n\r\n    exports.ISBLANK = function(value) {\r\n        return value === null;\r\n    };\r\n\r\n    exports.ISBINARY = function (number) {\r\n        return (/^[01]{1,10}$/).test(number);\r\n    };\r\n\r\n    exports.ISERR = function(value) {\r\n        return ([error.value, error.ref, error.div0, error.num, error.name, error.nil]).indexOf(value) >= 0 ||\r\n            (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\r\n    };\r\n\r\n    exports.ISERROR = function(value) {\r\n        return exports.ISERR(value) || value === error.na;\r\n    };\r\n\r\n    exports.ISEVEN = function(number) {\r\n        return (Math.floor(Math.abs(number)) & 1) ? false : true;\r\n    };\r\n\r\n    // TODO\r\n    exports.ISFORMULA = null;\r\n\r\n    exports.ISLOGICAL = function(value) {\r\n        return value === true || value === false;\r\n    };\r\n\r\n    exports.ISNA = function(value) {\r\n        return value === error.na;\r\n    };\r\n\r\n    exports.ISNONTEXT = function(value) {\r\n        return typeof(value) !== 'string';\r\n    };\r\n\r\n    exports.ISNUMBER = function(value) {\r\n        return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\r\n    };\r\n\r\n    exports.ISODD = function(number) {\r\n        return (Math.floor(Math.abs(number)) & 1) ? true : false;\r\n    };\r\n\r\n    exports.ISREF = null;\r\n\r\n    exports.ISTEXT = function(value) {\r\n        return typeof(value) === 'string';\r\n    };\r\n\r\n    exports.N = function(value) {\r\n        if (this.ISNUMBER(value)) {\r\n            return value;\r\n        }\r\n        if (value instanceof Date) {\r\n            return value.getTime();\r\n        }\r\n        if (value === true) {\r\n            return 1;\r\n        }\r\n        if (value === false) {\r\n            return 0;\r\n        }\r\n        if (this.ISERROR(value)) {\r\n            return value;\r\n        }\r\n        return 0;\r\n    };\r\n\r\n    exports.NA = function() {\r\n        return error.na;\r\n    };\r\n\r\n    exports.SHEET = null;\r\n\r\n    exports.SHEETS = null;\r\n\r\n    exports.TYPE = function(value) {\r\n        if (this.ISNUMBER(value)) {\r\n            return 1;\r\n        }\r\n        if (this.ISTEXT(value)) {\r\n            return 2;\r\n        }\r\n        if (this.ISLOGICAL(value)) {\r\n            return 4;\r\n        }\r\n        if (this.ISERROR(value)) {\r\n            return 16;\r\n        }\r\n        if (Array.isArray(value)) {\r\n            return 64;\r\n        }\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.logical = (function() {\r\n    var exports = {};\r\n\r\n    exports.AND = function() {\r\n        var args = utils.flatten(arguments);\r\n        var result = true;\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (!args[i]) {\r\n                result = false;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.CHOOSE = function() {\r\n        if (arguments.length < 2) {\r\n            return error.na;\r\n        }\r\n\r\n        var index = arguments[0];\r\n        if (index < 1 || index > 254) {\r\n            return error.value;\r\n        }\r\n\r\n        if (arguments.length < index + 1) {\r\n            return error.value;\r\n        }\r\n\r\n        return arguments[index];\r\n    };\r\n\r\n    exports.FALSE = function() {\r\n        return false;\r\n    };\r\n\r\n    exports.IF = function(test, then_value, otherwise_value) {\r\n        return test ? then_value : otherwise_value;\r\n    };\r\n\r\n    exports.IFERROR = function(value, valueIfError) {\r\n        if (ISERROR(value)) {\r\n            return valueIfError;\r\n        }\r\n        return value;\r\n    };\r\n\r\n    exports.IFNA = function(value, value_if_na) {\r\n        return value === error.na ? value_if_na : value;\r\n    };\r\n\r\n    exports.NOT = function(logical) {\r\n        return !logical;\r\n    };\r\n\r\n    exports.OR = function() {\r\n        var args = utils.flatten(arguments);\r\n        var result = false;\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (args[i]) {\r\n                result = true;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.TRUE = function() {\r\n        return true;\r\n    };\r\n\r\n    exports.XOR = function() {\r\n        var args = utils.flatten(arguments);\r\n        var result = 0;\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (args[i]) {\r\n                result++;\r\n            }\r\n        }\r\n        return (Math.floor(Math.abs(result)) & 1) ? true : false;\r\n    };\r\n\r\n    exports.SWITCH = function() {\r\n        var result;\r\n        if (arguments.length > 0)  {\r\n            var targetValue = arguments[0];\r\n            var argc = arguments.length - 1;\r\n            var switchCount = Math.floor(argc / 2);\r\n            var switchSatisfied = false;\r\n            var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\r\n\r\n            if (switchCount) {\r\n                for (var index = 0; index < switchCount; index++) {\r\n                    if (targetValue === arguments[index * 2 + 1]) {\r\n                      result = arguments[index * 2 + 2];\r\n                      switchSatisfied = true;\r\n                      break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!switchSatisfied && defaultClause) {\r\n                result = defaultClause;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.math = (function() {\r\n    var exports = {};\r\n\r\n    exports.ABS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.abs(utils.parseNumber(number));\r\n    };\r\n\r\n    exports.ACOS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.acos(number);\r\n    };\r\n\r\n    exports.ACOSH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number + Math.sqrt(number * number - 1));\r\n    };\r\n\r\n    exports.ACOT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.atan(1 / number);\r\n    };\r\n\r\n    exports.ACOTH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 0.5 * Math.log((number + 1) / (number - 1));\r\n    };\r\n\r\n    exports.AGGREGATE = null\r\n\r\n    exports.ARABIC = function(text) {\r\n        // Credits: Rafa? Kukawski\r\n        if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\r\n            return error.value;\r\n        }\r\n        var r = 0;\r\n        text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function(i) {\r\n            r += {\r\n                M: 1000,\r\n                CM: 900,\r\n                D: 500,\r\n                CD: 400,\r\n                C: 100,\r\n                XC: 90,\r\n                L: 50,\r\n                XL: 40,\r\n                X: 10,\r\n                IX: 9,\r\n                V: 5,\r\n                IV: 4,\r\n                I: 1\r\n            }[i];\r\n        });\r\n        return r;\r\n    };\r\n\r\n    exports.ASIN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.asin(number);\r\n    };\r\n\r\n    exports.ASINH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number + Math.sqrt(number * number + 1));\r\n    };\r\n\r\n    exports.ATAN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.atan(number);\r\n    };\r\n\r\n    exports.ATAN2 = function(number_x, number_y) {\r\n        number_x = utils.parseNumber(number_x);\r\n        number_y = utils.parseNumber(number_y);\r\n        if (utils.anyIsError(number_x, number_y)) {\r\n            return error.value;\r\n        }\r\n        return Math.atan2(number_x, number_y);\r\n    };\r\n\r\n    exports.ATANH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log((1 + number) / (1 - number)) / 2;\r\n    };\r\n\r\n    exports.BASE = function(number, radix, min_length) {\r\n        min_length = min_length || 0;\r\n\r\n        number = utils.parseNumber(number);\r\n        radix = utils.parseNumber(radix);\r\n        min_length = utils.parseNumber(min_length);\r\n        if (utils.anyIsError(number, radix, min_length)) {\r\n            return error.value;\r\n        }\r\n        min_length = (min_length === undefined) ? 0 : min_length;\r\n        var result = number.toString(radix);\r\n        return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\r\n    };\r\n\r\n    exports.CEILING = function(number, significance, mode) {\r\n        significance = (significance === undefined) ? 1 : significance;\r\n        mode = (mode === undefined) ? 0 : mode;\r\n\r\n        number = utils.parseNumber(number);\r\n        significance = utils.parseNumber(significance);\r\n        mode = utils.parseNumber(mode);\r\n        if (utils.anyIsError(number, significance, mode)) {\r\n            return error.value;\r\n        }\r\n        if (significance === 0) {\r\n            return 0;\r\n        }\r\n\r\n        significance = Math.abs(significance);\r\n        if (number >= 0) {\r\n            return Math.ceil(number / significance) * significance;\r\n        } else {\r\n            if (mode === 0) {\r\n                return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n            } else {\r\n                return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.CEILING.MATH = exports.CEILING;\r\n\r\n    exports.CEILING.PRECISE = exports.CEILING;\r\n\r\n    exports.COMBIN = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\r\n    };\r\n\r\n    exports.COMBINA = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\r\n    };\r\n\r\n    exports.COS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.cos(number);\r\n    };\r\n\r\n    exports.COSH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return (Math.exp(number) + Math.exp(-number)) / 2;\r\n    };\r\n\r\n    exports.COT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 1 / Math.tan(number);\r\n    };\r\n\r\n    exports.COTH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var e2 = Math.exp(2 * number);\r\n        return (e2 + 1) / (e2 - 1);\r\n    };\r\n\r\n    exports.CSC = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 1 / Math.sin(number);\r\n    };\r\n\r\n    exports.CSCH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 2 / (Math.exp(number) - Math.exp(-number));\r\n    };\r\n\r\n    exports.DECIMAL = function(number, radix) {\r\n        if (arguments.length < 1) {\r\n            return error.value;\r\n        }\r\n\r\n\r\n        return parseInt(number, radix);\r\n    };\r\n\r\n    exports.DEGREES = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return number * 180 / Math.PI;\r\n    };\r\n\r\n    exports.EVEN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return exports.CEILING(number, -2, -1);\r\n    };\r\n\r\n    exports.EXP = Math.exp;\r\n\r\n    var MEMOIZED_FACT = [];\r\n    exports.FACT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var n = Math.floor(number);\r\n        if (n === 0 || n === 1) {\r\n            return 1;\r\n        } else if (MEMOIZED_FACT[n] > 0) {\r\n            return MEMOIZED_FACT[n];\r\n        } else {\r\n            MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\r\n            return MEMOIZED_FACT[n];\r\n        }\r\n    };\r\n\r\n    exports.FACTDOUBLE = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var n = Math.floor(number);\r\n        if (n <= 0) {\r\n            return 1;\r\n        } else {\r\n            return n * exports.FACTDOUBLE(n - 2);\r\n        }\r\n    };\r\n\r\n    exports.FLOOR = function(number, significance, mode) {\r\n        significance = (significance === undefined) ? 1 : significance;\r\n        mode = (mode === undefined) ? 0 : mode;\r\n\r\n        number = utils.parseNumber(number);\r\n        significance = utils.parseNumber(significance);\r\n        mode = utils.parseNumber(mode);\r\n        if (utils.anyIsError(number, significance, mode)) {\r\n            return error.value;\r\n        }\r\n        if (significance === 0) {\r\n            return 0;\r\n        }\r\n\r\n        significance = Math.abs(significance);\r\n        if (number >= 0) {\r\n            return Math.floor(number / significance) * significance;\r\n        } else {\r\n            if (mode === 0) {\r\n                return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n            } else {\r\n                return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.FLOOR.MATH = exports.FLOOR;\r\n\r\n    exports.GCD = null;\r\n\r\n    exports.INT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.floor(number);\r\n    };\r\n\r\n    exports.LCM = function() {\r\n        // Credits: Jonas Raoni Soares Silva\r\n        var o = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (o instanceof Error) {\r\n            return o;\r\n        }\r\n        for (var i, j, n, d, r = 1;\r\n            (n = o.pop()) !== undefined;) {\r\n            while (n > 1) {\r\n                if (n % 2) {\r\n                    for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\r\n                      //empty\r\n                    }\r\n                    d = (i <= j) ? i : n;\r\n                } else {\r\n                    d = 2;\r\n                }\r\n                for (n /= d, r *= d, i = o.length; i;\r\n                    (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\r\n                    //empty\r\n                }\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n\r\n    exports.LN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number);\r\n    };\r\n\r\n    exports.LOG = function(number, base) {\r\n        number = utils.parseNumber(number);\r\n        base = (base === undefined) ? 10 : utils.parseNumber(base);\r\n\r\n        if (utils.anyIsError(number, base)) {\r\n            return error.value;\r\n        }\r\n\r\n        return Math.log(number) / Math.log(base);\r\n    };\r\n\r\n    exports.LOG10 = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number) / Math.log(10);\r\n    };\r\n\r\n    exports.MDETERM = null;\r\n\r\n    exports.MINVERSE = null;\r\n\r\n    exports.MMULT = null;\r\n\r\n    exports.MOD = function(dividend, divisor) {\r\n        dividend = utils.parseNumber(dividend);\r\n        divisor = utils.parseNumber(divisor);\r\n        if (utils.anyIsError(dividend, divisor)) {\r\n            return error.value;\r\n        }\r\n        if (divisor === 0) {\r\n            return error.div0;\r\n        }\r\n        var modulus = Math.abs(dividend % divisor);\r\n        return (divisor > 0) ? modulus : -modulus;\r\n    };\r\n\r\n    exports.MROUND = function(number, multiple) {\r\n        number = utils.parseNumber(number);\r\n        multiple = utils.parseNumber(multiple);\r\n        if (utils.anyIsError(number, multiple)) {\r\n            return error.value;\r\n        }\r\n        if (number * multiple < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        return Math.round(number / multiple) * multiple;\r\n    };\r\n\r\n    exports.MULTINOMIAL = function() {\r\n        var args = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (args instanceof Error) {\r\n            return args;\r\n        }\r\n        var sum = 0;\r\n        var divisor = 1;\r\n        for (var i = 0; i < args.length; i++) {\r\n            sum += args[i];\r\n            divisor *= exports.FACT(args[i]);\r\n        }\r\n        return exports.FACT(sum) / divisor;\r\n    };\r\n\r\n    exports.MUNIT = null;\r\n\r\n    exports.ODD = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var temp = Math.ceil(Math.abs(number));\r\n        temp = (temp & 1) ? temp : temp + 1;\r\n        return (number > 0) ? temp : -temp;\r\n    };\r\n\r\n    exports.PI = function() {\r\n        return Math.PI;\r\n    };\r\n\r\n    exports.POWER = function(number, power) {\r\n        number = utils.parseNumber(number);\r\n        power = utils.parseNumber(power);\r\n        if (utils.anyIsError(number, power)) {\r\n            return error.value;\r\n        }\r\n        var result = Math.pow(number, power);\r\n        if (isNaN(result)) {\r\n            return error.num;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.PRODUCT = function() {\r\n        var args = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (args instanceof Error) {\r\n            return args;\r\n        }\r\n        var result = 1;\r\n        for (var i = 0; i < args.length; i++) {\r\n            result *= args[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.QUOTIENT = function(numerator, denominator) {\r\n        numerator = utils.parseNumber(numerator);\r\n        denominator = utils.parseNumber(denominator);\r\n        if (utils.anyIsError(numerator, denominator)) {\r\n            return error.value;\r\n        }\r\n        return parseInt(numerator / denominator, 10);\r\n    };\r\n\r\n    exports.RADIANS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return number * Math.PI / 180;\r\n    };\r\n\r\n    exports.RAND = function() {\r\n        return Math.random();\r\n    };\r\n\r\n    exports.RANDBETWEEN = function(bottom, top) {\r\n        bottom = utils.parseNumber(bottom);\r\n        top = utils.parseNumber(top);\r\n        if (utils.anyIsError(bottom, top)) {\r\n            return error.value;\r\n        }\r\n        // Creative Commons Attribution 3.0 License\r\n        // Copyright (c) 2012 eqcode\r\n        return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\r\n    };\r\n\r\n    exports.ROMAN = null;\r\n\r\n    exports.ROUND = function(number, digits) {\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\r\n    };\r\n\r\n    exports.ROUNDDOWN = function(number, digits) {\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        var sign = (number > 0) ? 1 : -1;\r\n        return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n    };\r\n\r\n    exports.ROUNDUP = function(number, digits) {\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        var sign = (number > 0) ? 1 : -1;\r\n        return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n    };\r\n\r\n    exports.SEC = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 1 / Math.cos(number);\r\n    };\r\n\r\n    exports.SECH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 2 / (Math.exp(number) + Math.exp(-number));\r\n    };\r\n\r\n    exports.SERIESSUM = function(x, n, m, coefficients) {\r\n        x = utils.parseNumber(x);\r\n        n = utils.parseNumber(n);\r\n        m = utils.parseNumber(m);\r\n        coefficients = utils.parseNumberArray(coefficients);\r\n        if (utils.anyIsError(x, n, m, coefficients)) {\r\n            return error.value;\r\n        }\r\n        var result = coefficients[0] * Math.pow(x, n);\r\n        for (var i = 1; i < coefficients.length; i++) {\r\n            result += coefficients[i] * Math.pow(x, n + i * m);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SIGN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        if (number < 0) {\r\n            return -1;\r\n        } else if (number === 0) {\r\n            return 0;\r\n        } else {\r\n            return 1;\r\n        }\r\n    };\r\n\r\n    exports.SIN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.sin(number);\r\n    };\r\n\r\n    exports.SINH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return (Math.exp(number) - Math.exp(-number)) / 2;\r\n    };\r\n\r\n    exports.SQRT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        if (number < 0) {\r\n            return error.num;\r\n        }\r\n        return Math.sqrt(number);\r\n    };\r\n\r\n    exports.SQRTPI = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.sqrt(number * Math.PI);\r\n    };\r\n\r\n    exports.SUBTOTAL = null;\r\n\r\n    exports.ADD = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.value;\r\n        }\r\n\r\n        return num1 + num2;\r\n    };\r\n\r\n    exports.MINUS = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.value;\r\n        }\r\n\r\n        return num1 - num2;\r\n    };\r\n\r\n    exports.DIVIDE = function (dividend, divisor) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        dividend = utils.parseNumber(dividend);\r\n        divisor = utils.parseNumber(divisor);\r\n        if (utils.anyIsError(dividend, divisor)) {\r\n            return error.value;\r\n        }\r\n\r\n        if (divisor === 0) {\r\n            return error.div0;\r\n        }\r\n\r\n        return dividend / divisor;\r\n    };\r\n\r\n    exports.MULTIPLY = function (factor1, factor2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        factor1 = utils.parseNumber(factor1);\r\n        factor2 = utils.parseNumber(factor2);\r\n        if (utils.anyIsError(factor1, factor2)) {\r\n            return error.value;\r\n        }\r\n\r\n        return factor1 * factor2;\r\n    };\r\n\r\n    exports.GTE = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.error;\r\n        }\r\n\r\n        return num1 >= num2;\r\n    };\r\n\r\n    exports.LT = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.error;\r\n        }\r\n\r\n        return num1 < num2;\r\n    };\r\n\r\n    exports.LTE = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.error;\r\n        }\r\n\r\n        return num1 <= num2;\r\n    };\r\n\r\n    exports.EQ = function (value1, value2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        return value1 === value2;\r\n    };\r\n\r\n    exports.NE = function (value1, value2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        return value1 !== value2;\r\n    };\r\n\r\n    exports.POW = function (base, exponent) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        base = utils.parseNumber(base);\r\n        exponent = utils.parseNumber(exponent);\r\n        if (utils.anyIsError(base, exponent)) {\r\n            return error.error;\r\n        }\r\n\r\n        return exports.POWER(base, exponent);\r\n    };\r\n\r\n    exports.SUM = function() {\r\n        var result = 0;\r\n        var argsKeys = Object.keys(arguments);\r\n        for (var i = 0; i < argsKeys.length; ++i) {\r\n            var elt = arguments[argsKeys[i]];\r\n            if (typeof elt === 'number') {\r\n                result += elt;\r\n            } else if (typeof elt === 'string') {\r\n                var parsed = parseFloat(elt);\r\n                !isNaN(parsed) && (result += parsed);\r\n            } else if (Array.isArray(elt)) {\r\n                result += exports.SUM.apply(null, elt);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMIF = function(range, criteria) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        var result = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMIFS = function() {\r\n        var args = utils.argsToArray(arguments);\r\n        var range = utils.parseNumberArray(utils.flatten(args.shift()));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        var criteria = args;\r\n\r\n        var n_range_elements = range.length;\r\n        var n_criterias = criteria.length;\r\n\r\n        var result = 0;\r\n        for (var i = 0; i < n_range_elements; i++) {\r\n            var el = range[i];\r\n            var condition = '';\r\n            for (var c = 0; c < n_criterias; c++) {\r\n                condition += el + criteria[c];\r\n                if (c !== n_criterias - 1) {\r\n                    condition += '&&';\r\n                }\r\n            }\r\n            if (eval(condition)) { // jshint ignore:line\r\n                result += el;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMPRODUCT = null;\r\n\r\n    exports.SUMSQ = function() {\r\n        var numbers = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (numbers instanceof Error) {\r\n            return numbers;\r\n        }\r\n        var result = 0;\r\n        var length = numbers.length;\r\n        for (var i = 0; i < length; i++) {\r\n            result += (ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMX2MY2 = function(array_x, array_y) {\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        if (utils.anyIsError(array_x, array_y)) {\r\n            return error.value;\r\n        }\r\n        var result = 0;\r\n        for (var i = 0; i < array_x.length; i++) {\r\n            result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMX2PY2 = function(array_x, array_y) {\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        if (utils.anyIsError(array_x, array_y)) {\r\n            return error.value;\r\n        }\r\n        var result = 0;\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        for (var i = 0; i < array_x.length; i++) {\r\n            result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMXMY2 = function(array_x, array_y) {\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        if (utils.anyIsError(array_x, array_y)) {\r\n            return error.value;\r\n        }\r\n        var result = 0;\r\n        array_x = utils.flatten(array_x);\r\n        array_y = utils.flatten(array_y);\r\n        for (var i = 0; i < array_x.length; i++) {\r\n            result += Math.pow(array_x[i] - array_y[i], 2);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.TAN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.tan(number);\r\n    };\r\n\r\n    exports.TANH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var e2 = Math.exp(2 * number);\r\n        return (e2 - 1) / (e2 + 1);\r\n    };\r\n\r\n    exports.TRUNC = function(number, digits) {\r\n        digits = (digits === undefined) ? 0 : digits;\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        var sign = (number > 0) ? 1 : -1;\r\n        return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.misc = (function() {\r\n    var exports = {};\r\n\r\n    exports.UNIQUE = function () {\r\n        var result = [];\r\n        for (var i = 0; i < arguments.length; ++i) {\r\n            var hasElement = false;\r\n            var element = arguments[i];\r\n\r\n            // Check if we've already seen this element.\r\n            for (var j = 0; j < result.length; ++j) {\r\n                hasElement = result[j] === element;\r\n                if (hasElement) { break; }\r\n            }\r\n\r\n            // If we did not find it, add it to the result.\r\n            if (!hasElement) {\r\n                result.push(element);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.FLATTEN = utils.flatten;\r\n\r\n    exports.ARGS2ARRAY = function () {\r\n        return Array.prototype.slice.call(arguments, 0);\r\n    };\r\n\r\n    exports.REFERENCE = function (context, reference) {\r\n        try {\r\n            var path = reference.split('.');\r\n            var result = context;\r\n            for (var i = 0; i < path.length; ++i) {\r\n                var step = path[i];\r\n                if (step[step.length - 1] === ']') {\r\n                    var opening = step.indexOf('[');\r\n                    var index = step.substring(opening + 1, step.length - 1);\r\n                    result = result[step.substring(0, opening)][index];\r\n                } else {\r\n                    result = result[step];\r\n                }\r\n            }\r\n            return result;\r\n        } catch (error) {}\r\n    };\r\n\r\n    exports.JOIN = function (array, separator) {\r\n        return array.join(separator);\r\n    };\r\n\r\n    exports.NUMBERS = function () {\r\n        var possibleNumbers = utils.flatten(arguments);\r\n        return possibleNumbers.filter(function (el) {\r\n            return typeof el === 'number';\r\n        });\r\n    };\r\n\r\n    exports.NUMERAL = null;\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.text = (function() {\r\n    var exports = {};\r\n\r\n    exports.ASC = null;\r\n\r\n    exports.BAHTTEXT = null;\r\n\r\n    exports.CHAR = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return String.fromCharCode(number);\r\n    };\r\n\r\n    exports.CLEAN = function(text) {\r\n        text = text || '';\r\n        var re = /[\\0-\\x1F]/g;\r\n        return text.replace(re, \"\");\r\n    };\r\n\r\n    exports.CODE = function(text) {\r\n        text = text || '';\r\n        return text.charCodeAt(0);\r\n    };\r\n\r\n    exports.CONCATENATE = function() {\r\n        var args = utils.flatten(arguments);\r\n\r\n        var trueFound = 0;\r\n        while ((trueFound = args.indexOf(true)) > -1) {\r\n            args[trueFound] = 'TRUE';\r\n        }\r\n\r\n        var falseFound = 0;\r\n        while ((falseFound = args.indexOf(false)) > -1) {\r\n            args[falseFound] = 'FALSE';\r\n        }\r\n\r\n        return args.join('');\r\n    };\r\n\r\n    exports.DBCS = null;\r\n\r\n    exports.DOLLAR = null;\r\n\r\n    exports.EXACT = function(text1, text2) {\r\n        return text1 === text2;\r\n    };\r\n\r\n    exports.FIND = function(find_text, within_text, position) {\r\n        position = (position === undefined) ? 0 : position;\r\n        return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\r\n    };\r\n\r\n    exports.FIXED = null;\r\n\r\n    exports.HTML2TEXT = function (value) {\r\n        var result = '';\r\n\r\n        if (value) {\r\n            if (value instanceof Array) {\r\n                value.forEach(function (line) {\r\n                    if (result !== '') {\r\n                      result += '\\n';\r\n                    }\r\n                    result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\r\n                });\r\n            } else {\r\n                result = value.replace(/<(?:.|\\n)*?>/gm, '');\r\n            }\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.LEFT = function(text, number) {\r\n        number = (number === undefined) ? 1 : number;\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error || typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text ? text.substring(0, number) : null;\r\n    };\r\n\r\n    exports.LEN = function(text) {\r\n        if (arguments.length === 0) {\r\n            return error.error;\r\n        }\r\n\r\n        if (typeof text === 'string') {\r\n            return text ? text.length : 0;\r\n        }\r\n\r\n        if (text.length) {\r\n            return text.length;\r\n        }\r\n\r\n        return error.value;\r\n    };\r\n\r\n    exports.LOWER = function(text) {\r\n        if (typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text ? text.toLowerCase() : text;\r\n    };\r\n\r\n    exports.MID = function(text, start, number) {\r\n        start = utils.parseNumber(start);\r\n        number = utils.parseNumber(number);\r\n        if (utils.anyIsError(start, number) || typeof text !== 'string') {\r\n            return number;\r\n        }\r\n\r\n        var begin = start - 1;\r\n        var end = begin + number;\r\n\r\n        return text.substring(begin, end);\r\n    };\r\n\r\n    exports.NUMBERVALUE = null;\r\n\r\n    exports.PRONETIC = null;\r\n\r\n    exports.PROPER = function(text) {\r\n        if (text === undefined || text.length === 0) {\r\n            return error.value;\r\n        }\r\n        if (text === true) {\r\n            text = 'TRUE';\r\n        }\r\n        if (text === false) {\r\n            text = 'FALSE';\r\n        }\r\n        if (isNaN(text) && typeof text === 'number') {\r\n            return error.value;\r\n        }\r\n        if (typeof text === 'number') {\r\n            text = '' + text;\r\n        }\r\n\r\n        return text.replace(/\\w\\S*/g, function(txt) {\r\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\r\n        });\r\n    };\r\n\r\n    exports.REGEXEXTRACT = function (text, regular_expression) {\r\n        var match = text.match(new RegExp(regular_expression));\r\n        return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\r\n    };\r\n\r\n    exports.REGEXMATCH = function (text, regular_expression, full) {\r\n        var match = text.match(new RegExp(regular_expression));\r\n        return full ? match : !!match;\r\n    };\r\n\r\n    exports.REGEXREPLACE = function (text, regular_expression, replacement) {\r\n        return text.replace(new RegExp(regular_expression), replacement);\r\n    };\r\n\r\n    exports.REPLACE = function(text, position, length, new_text) {\r\n        position = utils.parseNumber(position);\r\n        length = utils.parseNumber(length);\r\n        if (utils.anyIsError(position, length) ||\r\n            typeof text !== 'string' ||\r\n            typeof new_text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\r\n    };\r\n\r\n    exports.REPT = function(text, number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return new Array(number + 1).join(text);\r\n    };\r\n\r\n    exports.RIGHT = function(text, number) {\r\n        number = (number === undefined) ? 1 : number;\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return text ? text.substring(text.length - number) : null;\r\n    };\r\n\r\n    exports.SEARCH = function(find_text, within_text, position) {\r\n        var foundAt;\r\n        if (typeof find_text !== 'string' || typeof within_text !== 'string') {\r\n            return error.value;\r\n        }\r\n        position = (position === undefined) ? 0 : position;\r\n        foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\r\n        return (foundAt === 0)?error.value:foundAt;\r\n    };\r\n\r\n    exports.SPLIT = function (text, separator) {\r\n        return text.split(separator);\r\n    };\r\n\r\n    exports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\r\n        if (!text || !old_text || !new_text) {\r\n            return text;\r\n        } else if (occurrence === undefined) {\r\n            return text.replace(new RegExp(old_text, 'g'), new_text);\r\n        } else {\r\n            var index = 0;\r\n            var i = 0;\r\n            while (text.indexOf(old_text, index) > 0) {\r\n                index = text.indexOf(old_text, index + 1);\r\n                i++;\r\n                if (i === occurrence) {\r\n                    return text.substring(0, index) + new_text + text.substring(index + old_text.length);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.T = function(value) {\r\n        return (typeof value === \"string\") ? value : '';\r\n    };\r\n\r\n    exports.TEXT = null;\r\n\r\n    exports.TRIM = function(text) {\r\n        if (typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text.replace(/ +/g, ' ').trim();\r\n    };\r\n\r\n    exports.UNICHAR = exports.CHAR;\r\n\r\n    exports.UNICODE = exports.CODE;\r\n\r\n    exports.UPPER = function(text) {\r\n        if (typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text.toUpperCase();\r\n    };\r\n\r\n    exports.VALUE = null;\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.stats = (function() {\r\n    var exports = {};\r\n\r\n    var SQRT2PI = 2.5066282746310002;\r\n\r\n    exports.AVEDEV = null;\r\n\r\n    exports.AVERAGE = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        var n = range.length;\r\n        var sum = 0;\r\n        var count = 0;\r\n        for (var i = 0; i < n; i++) {\r\n            sum += range[i];\r\n            count += 1;\r\n        }\r\n        return sum / count;\r\n    };\r\n\r\n    exports.AVERAGEA = function() {\r\n        var range = utils.flatten(arguments);\r\n        var n = range.length;\r\n        var sum = 0;\r\n        var count = 0;\r\n        for (var i = 0; i < n; i++) {\r\n            var el = range[i];\r\n            if (typeof el === 'number') {\r\n                sum += el;\r\n            }\r\n            if (el === true) {\r\n                sum++;\r\n            }\r\n            if (el !== null) {\r\n                count++;\r\n            }\r\n        }\r\n        return sum / count;\r\n    };\r\n\r\n    exports.AVERAGEIF = function(range, criteria, average_range) {\r\n        average_range = average_range || range;\r\n        range = utils.flatten(range);\r\n        average_range = utils.parseNumberArray(utils.flatten(average_range));\r\n        if (average_range instanceof Error) {\r\n            return average_range;\r\n        }\r\n        var average_count = 0;\r\n        var result = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                result += average_range[i];\r\n                average_count++;\r\n            }\r\n        }\r\n        return result / average_count;\r\n    };\r\n\r\n    exports.AVERAGEIFS = null;\r\n\r\n    exports.COUNT = function() {\r\n        return utils.numbers(utils.flatten(arguments)).length;\r\n    };\r\n\r\n    exports.COUNTA = function() {\r\n        var range = utils.flatten(arguments);\r\n        return range.length - exports.COUNTBLANK(range);\r\n    };\r\n\r\n    exports.COUNTIN = function (range, value) {\r\n        var result = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            if (range[i] === value) {\r\n                result++;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.COUNTBLANK = function() {\r\n        var range = utils.flatten(arguments);\r\n        var blanks = 0;\r\n        var element;\r\n        for (var i = 0; i < range.length; i++) {\r\n            element = range[i];\r\n            if (element === null || element === '') {\r\n                blanks++;\r\n            }\r\n        }\r\n        return blanks;\r\n    };\r\n\r\n    exports.COUNTIF = function(range, criteria) {\r\n        range = utils.flatten(range);\r\n        if (!/[<>=!]/.test(criteria)) {\r\n            criteria = '==\"' + criteria + '\"';\r\n        }\r\n        var matches = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            if (typeof range[i] !== 'string') {\r\n                if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                    matches++;\r\n                }\r\n            } else {\r\n                if (eval('\"' + range[i] + '\"' + criteria)) { // jshint ignore:line\r\n                    matches++;\r\n                }\r\n            }\r\n        }\r\n        return matches;\r\n    };\r\n\r\n    exports.COUNTIFS = function() {\r\n        var args = utils.argsToArray(arguments);\r\n        var results = new Array(utils.flatten(args[0]).length);\r\n        for (var i = 0; i < results.length; i++) {\r\n            results[i] = true;\r\n        }\r\n        for (i = 0; i < args.length; i += 2) {\r\n            var range = utils.flatten(args[i]);\r\n            var criteria = args[i + 1];\r\n            if (!/[<>=!]/.test(criteria)) {\r\n                criteria = '==\"' + criteria + '\"';\r\n            }\r\n            for (var j = 0; j < range.length; j++) {\r\n                if (typeof range[j] !== 'string') {\r\n                    results[j] = results[j] && eval(range[j] + criteria); // jshint ignore:line\r\n                } else {\r\n                    results[j] = results[j] && eval('\"' + range[j] + '\"' + criteria); // jshint ignore:line\r\n                }\r\n            }\r\n        }\r\n        var result = 0;\r\n        for (i = 0; i < results.length; i++) {\r\n            if (results[i]) {\r\n                result++;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.COUNTUNIQUE = function () {\r\n        return UNIQUE.apply(null, utils.flatten(arguments)).length;\r\n    };\r\n\r\n    exports.FISHER = function(x) {\r\n        x = utils.parseNumber(x);\r\n        if (x instanceof Error) {\r\n            return x;\r\n        }\r\n        return Math.log((1 + x) / (1 - x)) / 2;\r\n    };\r\n\r\n    exports.FISHERINV = function(y) {\r\n        y = utils.parseNumber(y);\r\n        if (y instanceof Error) {\r\n            return y;\r\n        }\r\n        var e2y = Math.exp(2 * y);\r\n        return (e2y - 1) / (e2y + 1);\r\n    };\r\n\r\n    exports.FREQUENCY = function(data, bins) {\r\n        data = utils.parseNumberArray(utils.flatten(data));\r\n        bins = utils.parseNumberArray(utils.flatten(bins));\r\n        if (utils.anyIsError(data, bins)) {\r\n            return error.value;\r\n        }\r\n        var n = data.length;\r\n        var b = bins.length;\r\n        var r = [];\r\n        for (var i = 0; i <= b; i++) {\r\n            r[i] = 0;\r\n            for (var j = 0; j < n; j++) {\r\n                if (i === 0) {\r\n                    if (data[j] <= bins[0]) {\r\n                        r[0] += 1;\r\n                    }\r\n                } else if (i < b) {\r\n                    if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\r\n                        r[i] += 1;\r\n                    }\r\n                } else if (i === b) {\r\n                    if (data[j] > bins[b - 1]) {\r\n                        r[b] += 1;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n\r\n    exports.LARGE = function(range, k) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(range, k)) {\r\n            return range;\r\n        }\r\n        return range.sort(function(a, b) {\r\n            return b - a;\r\n        })[k - 1];\r\n    };\r\n\r\n    exports.MAX = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n    };\r\n\r\n    exports.MAXA = function() {\r\n        var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n    };\r\n\r\n    exports.MIN = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n    };\r\n\r\n    exports.MINA = function() {\r\n        var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n    };\r\n\r\n    exports.MODE = {};\r\n\r\n    exports.MODE.MULT = function() {\r\n        // Credits: Ronan\r\n        var range = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        var n = range.length;\r\n        var count = {};\r\n        var maxItems = [];\r\n        var max = 0;\r\n        var currentItem;\r\n\r\n        for (var i = 0; i < n; i++) {\r\n            currentItem = range[i];\r\n            count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\r\n            if (count[currentItem] > max) {\r\n                max = count[currentItem];\r\n                maxItems = [];\r\n            }\r\n            if (count[currentItem] === max) {\r\n                maxItems[maxItems.length] = currentItem;\r\n            }\r\n        }\r\n        return maxItems;\r\n    };\r\n\r\n    exports.MODE.SNGL = function() {\r\n        var range = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        return exports.MODE.MULT(range).sort(function(a, b) {\r\n            return a - b;\r\n        })[0];\r\n    };\r\n\r\n    exports.PERCENTILE = {};\r\n\r\n    exports.PERCENTILE.EXC = function(array, k) {\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(array, k)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            {\r\n                return a - b;\r\n            }\r\n        });\r\n        var n = array.length;\r\n        if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\r\n            return error.num;\r\n        }\r\n        var l = k * (n + 1) - 1;\r\n        var fl = Math.floor(l);\r\n        return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n    };\r\n\r\n    exports.PERCENTILE.INC = function(array, k) {\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(array, k)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var n = array.length;\r\n        var l = k * (n - 1);\r\n        var fl = Math.floor(l);\r\n        return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n    };\r\n\r\n    exports.PERCENTRANK = {};\r\n\r\n    exports.PERCENTRANK.EXC = function(array, x, significance) {\r\n        significance = (significance === undefined) ? 3 : significance;\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        x = utils.parseNumber(x);\r\n        significance = utils.parseNumber(significance);\r\n        if (utils.anyIsError(array, x, significance)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var uniques = UNIQUE.apply(null, array);\r\n        var n = array.length;\r\n        var m = uniques.length;\r\n        var power = Math.pow(10, significance);\r\n        var result = 0;\r\n        var match = false;\r\n        var i = 0;\r\n        while (!match && i < m) {\r\n            if (x === uniques[i]) {\r\n                result = (array.indexOf(uniques[i]) + 1) / (n + 1);\r\n                match = true;\r\n            } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\r\n                match = true;\r\n            }\r\n            i++;\r\n        }\r\n        return Math.floor(result * power) / power;\r\n    };\r\n\r\n    exports.PERCENTRANK.INC = function(array, x, significance) {\r\n        significance = (significance === undefined) ? 3 : significance;\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        x = utils.parseNumber(x);\r\n        significance = utils.parseNumber(significance);\r\n        if (utils.anyIsError(array, x, significance)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var uniques = UNIQUE.apply(null, array);\r\n        var n = array.length;\r\n        var m = uniques.length;\r\n        var power = Math.pow(10, significance);\r\n        var result = 0;\r\n        var match = false;\r\n        var i = 0;\r\n        while (!match && i < m) {\r\n            if (x === uniques[i]) {\r\n                result = array.indexOf(uniques[i]) / (n - 1);\r\n                match = true;\r\n            } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\r\n                match = true;\r\n            }\r\n            i++;\r\n        }\r\n        return Math.floor(result * power) / power;\r\n    };\r\n\r\n    exports.PERMUT = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return FACT(number) / FACT(number - number_chosen);\r\n    };\r\n\r\n    exports.PERMUTATIONA = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return Math.pow(number, number_chosen);\r\n    };\r\n\r\n    exports.PHI = function(x) {\r\n        x = utils.parseNumber(x);\r\n        if (x instanceof Error) {\r\n            return error.value;\r\n        }\r\n        return Math.exp(-0.5 * x * x) / SQRT2PI;\r\n    };\r\n\r\n    exports.PROB = function(range, probability, lower, upper) {\r\n        if (lower === undefined) {\r\n            return 0;\r\n        }\r\n        upper = (upper === undefined) ? lower : upper;\r\n\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        probability = utils.parseNumberArray(utils.flatten(probability));\r\n        lower = utils.parseNumber(lower);\r\n        upper = utils.parseNumber(upper);\r\n        if (utils.anyIsError(range, probability, lower, upper)) {\r\n            return error.value;\r\n        }\r\n\r\n        if (lower === upper) {\r\n            return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\r\n        }\r\n\r\n        var sorted = range.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var n = sorted.length;\r\n        var result = 0;\r\n        for (var i = 0; i < n; i++) {\r\n            if (sorted[i] >= lower && sorted[i] <= upper) {\r\n                result += probability[range.indexOf(sorted[i])];\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.QUARTILE = {};\r\n\r\n    exports.QUARTILE.EXC = function(range, quart) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        quart = utils.parseNumber(quart);\r\n        if (utils.anyIsError(range, quart)) {\r\n            return error.value;\r\n        }\r\n        switch (quart) {\r\n            case 1:\r\n                return exports.PERCENTILE.EXC(range, 0.25);\r\n            case 2:\r\n                return exports.PERCENTILE.EXC(range, 0.5);\r\n            case 3:\r\n                return exports.PERCENTILE.EXC(range, 0.75);\r\n            default:\r\n                return error.num;\r\n        }\r\n    };\r\n\r\n    exports.QUARTILE.INC = function(range, quart) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        quart = utils.parseNumber(quart);\r\n        if (utils.anyIsError(range, quart)) {\r\n            return error.value;\r\n        }\r\n        switch (quart) {\r\n            case 1:\r\n                return exports.PERCENTILE.INC(range, 0.25);\r\n            case 2:\r\n                return exports.PERCENTILE.INC(range, 0.5);\r\n            case 3:\r\n                return exports.PERCENTILE.INC(range, 0.75);\r\n            default:\r\n                return error.num;\r\n        }\r\n    };\r\n\r\n    exports.RANK = {};\r\n\r\n    exports.RANK.AVG = function(number, range, order) {\r\n        number = utils.parseNumber(number);\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        if (utils.anyIsError(number, range)) {\r\n            return error.value;\r\n        }\r\n        range = utils.flatten(range);\r\n        order = order || false;\r\n        var sort = (order) ? function(a, b) {\r\n            return a - b;\r\n        } : function(a, b) {\r\n            return b - a;\r\n        };\r\n        range = range.sort(sort);\r\n\r\n        var length = range.length;\r\n        var count = 0;\r\n        for (var i = 0; i < length; i++) {\r\n            if (range[i] === number) {\r\n                count++;\r\n            }\r\n        }\r\n\r\n        return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\r\n    };\r\n\r\n    exports.RANK.EQ = function(number, range, order) {\r\n        number = utils.parseNumber(number);\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        if (utils.anyIsError(number, range)) {\r\n            return error.value;\r\n        }\r\n        order = order || false;\r\n        var sort = (order) ? function(a, b) {\r\n            return a - b;\r\n        } : function(a, b) {\r\n            return b - a;\r\n        };\r\n        range = range.sort(sort);\r\n        return range.indexOf(number) + 1;\r\n    };\r\n\r\n    exports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\r\n        data_x = utils.parseNumberArray(utils.flatten(data_x));\r\n        data_y = utils.parseNumberArray(utils.flatten(data_y));\r\n        if (utils.anyIsError(data_x, data_y)) {\r\n            return error.value;\r\n        }\r\n        return Math.pow(exports.PEARSON(data_x, data_y), 2);\r\n    };\r\n\r\n    exports.SMALL = function(range, k) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(range, k)) {\r\n            return range;\r\n        }\r\n        return range.sort(function(a, b) {\r\n            return a - b;\r\n        })[k - 1];\r\n    };\r\n\r\n    exports.STANDARDIZE = function(x, mean, sd) {\r\n        x = utils.parseNumber(x);\r\n        mean = utils.parseNumber(mean);\r\n        sd = utils.parseNumber(sd);\r\n        if (utils.anyIsError(x, mean, sd)) {\r\n            return error.value;\r\n        }\r\n        return (x - mean) / sd;\r\n    };\r\n\r\n    exports.STDEV = {};\r\n\r\n    exports.STDEV.P = function() {\r\n        var v = exports.VAR.P.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.STDEV.S = function() {\r\n        var v = exports.VAR.S.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.STDEVA = function() {\r\n        var v = exports.VARA.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.STDEVPA = function() {\r\n        var v = exports.VARPA.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.VAR = {};\r\n\r\n    exports.VAR.P = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var mean = exports.AVERAGE(range);\r\n        for (var i = 0; i < n; i++) {\r\n            sigma += Math.pow(range[i] - mean, 2);\r\n        }\r\n        return sigma / n;\r\n    };\r\n\r\n    exports.VAR.S = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var mean = exports.AVERAGE(range);\r\n        for (var i = 0; i < n; i++) {\r\n            sigma += Math.pow(range[i] - mean, 2);\r\n        }\r\n        return sigma / (n - 1);\r\n    };\r\n\r\n    exports.VARA = function() {\r\n        var range = utils.flatten(arguments);\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var count = 0;\r\n        var mean = exports.AVERAGEA(range);\r\n        for (var i = 0; i < n; i++) {\r\n            var el = range[i];\r\n            if (typeof el === 'number') {\r\n                sigma += Math.pow(el - mean, 2);\r\n            } else if (el === true) {\r\n                sigma += Math.pow(1 - mean, 2);\r\n            } else {\r\n                sigma += Math.pow(0 - mean, 2);\r\n            }\r\n\r\n            if (el !== null) {\r\n                count++;\r\n            }\r\n        }\r\n        return sigma / (count - 1);\r\n    };\r\n\r\n    exports.VARPA = function() {\r\n        var range = utils.flatten(arguments);\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var count = 0;\r\n        var mean = exports.AVERAGEA(range);\r\n        for (var i = 0; i < n; i++) {\r\n            var el = range[i];\r\n            if (typeof el === 'number') {\r\n                sigma += Math.pow(el - mean, 2);\r\n            } else if (el === true) {\r\n                sigma += Math.pow(1 - mean, 2);\r\n            } else {\r\n                sigma += Math.pow(0 - mean, 2);\r\n            }\r\n\r\n            if (el !== null) {\r\n                count++;\r\n            }\r\n        }\r\n        return sigma / count;\r\n    };\r\n\r\n    exports.WEIBULL = {};\r\n\r\n    exports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\r\n        x = utils.parseNumber(x);\r\n        alpha = utils.parseNumber(alpha);\r\n        beta = utils.parseNumber(beta);\r\n        if (utils.anyIsError(x, alpha, beta)) {\r\n            return error.value;\r\n        }\r\n        return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\r\n    };\r\n\r\n    exports.Z = {};\r\n\r\n    exports.Z.TEST = function(range, x, sd) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        x = utils.parseNumber(x);\r\n        if (utils.anyIsError(range, x)) {\r\n            return error.value;\r\n        }\r\n\r\n        sd = sd || exports.STDEV.S(range);\r\n        var n = range.length;\r\n        return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\nfor (var i = 0; i < Object.keys(jexcel.methods).length; i++) {\r\n    var methods = jexcel.methods[Object.keys(jexcel.methods)[i]];\r\n    for (var j = 0; j < Object.keys(methods).length; j++) {\r\n        if (typeof(methods[Object.keys(methods)[j]]) == 'function') {\r\n            window[Object.keys(methods)[j]] = methods[Object.keys(methods)[j]];\r\n        } else {\r\n            window[Object.keys(methods)[j]] = function() {\r\n                return Object.keys(methods)[j] + 'Not implemented';\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n    return jexcel;\r\n\r\n})));"]},"metadata":{},"sourceType":"script"}