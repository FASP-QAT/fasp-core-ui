{"ast":null,"code":"'use strict';\n\nvar immediate = require('immediate');\n/* istanbul ignore next */\n\n\nfunction INTERNAL() {}\n\nvar handlers = {};\nvar REJECTED = ['REJECTED'];\nvar FULFILLED = ['FULFILLED'];\nvar PENDING = ['PENDING'];\nmodule.exports = Promise;\n\nfunction Promise(resolver) {\n  if (typeof resolver !== 'function') {\n    throw new TypeError('resolver must be a function');\n  }\n\n  this.state = PENDING;\n  this.queue = [];\n  this.outcome = void 0;\n\n  if (resolver !== INTERNAL) {\n    safelyResolveThenable(this, resolver);\n  }\n}\n\nPromise.prototype[\"finally\"] = function (callback) {\n  if (typeof callback !== 'function') {\n    return this;\n  }\n\n  var p = this.constructor;\n  return this.then(resolve, reject);\n\n  function resolve(value) {\n    function yes() {\n      return value;\n    }\n\n    return p.resolve(callback()).then(yes);\n  }\n\n  function reject(reason) {\n    function no() {\n      throw reason;\n    }\n\n    return p.resolve(callback()).then(no);\n  }\n};\n\nPromise.prototype[\"catch\"] = function (onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function (onFulfilled, onRejected) {\n  if (typeof onFulfilled !== 'function' && this.state === FULFILLED || typeof onRejected !== 'function' && this.state === REJECTED) {\n    return this;\n  }\n\n  var promise = new this.constructor(INTERNAL);\n\n  if (this.state !== PENDING) {\n    var resolver = this.state === FULFILLED ? onFulfilled : onRejected;\n    unwrap(promise, resolver, this.outcome);\n  } else {\n    this.queue.push(new QueueItem(promise, onFulfilled, onRejected));\n  }\n\n  return promise;\n};\n\nfunction QueueItem(promise, onFulfilled, onRejected) {\n  this.promise = promise;\n\n  if (typeof onFulfilled === 'function') {\n    this.onFulfilled = onFulfilled;\n    this.callFulfilled = this.otherCallFulfilled;\n  }\n\n  if (typeof onRejected === 'function') {\n    this.onRejected = onRejected;\n    this.callRejected = this.otherCallRejected;\n  }\n}\n\nQueueItem.prototype.callFulfilled = function (value) {\n  handlers.resolve(this.promise, value);\n};\n\nQueueItem.prototype.otherCallFulfilled = function (value) {\n  unwrap(this.promise, this.onFulfilled, value);\n};\n\nQueueItem.prototype.callRejected = function (value) {\n  handlers.reject(this.promise, value);\n};\n\nQueueItem.prototype.otherCallRejected = function (value) {\n  unwrap(this.promise, this.onRejected, value);\n};\n\nfunction unwrap(promise, func, value) {\n  immediate(function () {\n    var returnValue;\n\n    try {\n      returnValue = func(value);\n    } catch (e) {\n      return handlers.reject(promise, e);\n    }\n\n    if (returnValue === promise) {\n      handlers.reject(promise, new TypeError('Cannot resolve promise with itself'));\n    } else {\n      handlers.resolve(promise, returnValue);\n    }\n  });\n}\n\nhandlers.resolve = function (self, value) {\n  var result = tryCatch(getThen, value);\n\n  if (result.status === 'error') {\n    return handlers.reject(self, result.value);\n  }\n\n  var thenable = result.value;\n\n  if (thenable) {\n    safelyResolveThenable(self, thenable);\n  } else {\n    self.state = FULFILLED;\n    self.outcome = value;\n    var i = -1;\n    var len = self.queue.length;\n\n    while (++i < len) {\n      self.queue[i].callFulfilled(value);\n    }\n  }\n\n  return self;\n};\n\nhandlers.reject = function (self, error) {\n  self.state = REJECTED;\n  self.outcome = error;\n  var i = -1;\n  var len = self.queue.length;\n\n  while (++i < len) {\n    self.queue[i].callRejected(error);\n  }\n\n  return self;\n};\n\nfunction getThen(obj) {\n  // Make sure we only access the accessor once as required by the spec\n  var then = obj && obj.then;\n\n  if (obj && (typeof obj === 'object' || typeof obj === 'function') && typeof then === 'function') {\n    return function appyThen() {\n      then.apply(obj, arguments);\n    };\n  }\n}\n\nfunction safelyResolveThenable(self, thenable) {\n  // Either fulfill, reject or reject with error\n  var called = false;\n\n  function onError(value) {\n    if (called) {\n      return;\n    }\n\n    called = true;\n    handlers.reject(self, value);\n  }\n\n  function onSuccess(value) {\n    if (called) {\n      return;\n    }\n\n    called = true;\n    handlers.resolve(self, value);\n  }\n\n  function tryToUnwrap() {\n    thenable(onSuccess, onError);\n  }\n\n  var result = tryCatch(tryToUnwrap);\n\n  if (result.status === 'error') {\n    onError(result.value);\n  }\n}\n\nfunction tryCatch(func, value) {\n  var out = {};\n\n  try {\n    out.value = func(value);\n    out.status = 'success';\n  } catch (e) {\n    out.status = 'error';\n    out.value = e;\n  }\n\n  return out;\n}\n\nPromise.resolve = resolve;\n\nfunction resolve(value) {\n  if (value instanceof this) {\n    return value;\n  }\n\n  return handlers.resolve(new this(INTERNAL), value);\n}\n\nPromise.reject = reject;\n\nfunction reject(reason) {\n  var promise = new this(INTERNAL);\n  return handlers.reject(promise, reason);\n}\n\nPromise.all = all;\n\nfunction all(iterable) {\n  var self = this;\n\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var values = new Array(len);\n  var resolved = 0;\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    allResolver(iterable[i], i);\n  }\n\n  return promise;\n\n  function allResolver(value, i) {\n    self.resolve(value).then(resolveFromAll, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n\n    function resolveFromAll(outValue) {\n      values[i] = outValue;\n\n      if (++resolved === len && !called) {\n        called = true;\n        handlers.resolve(promise, values);\n      }\n    }\n  }\n}\n\nPromise.race = race;\n\nfunction race(iterable) {\n  var self = this;\n\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    resolver(iterable[i]);\n  }\n\n  return promise;\n\n  function resolver(value) {\n    self.resolve(value).then(function (response) {\n      if (!called) {\n        called = true;\n        handlers.resolve(promise, response);\n      }\n    }, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n  }\n}","map":{"version":3,"sources":["/home/altius/NodeJs/gitHubRepos/fasp-core-ui/node_modules/lie/lib/browser.js"],"names":["immediate","require","INTERNAL","handlers","REJECTED","FULFILLED","PENDING","module","exports","Promise","resolver","TypeError","state","queue","outcome","safelyResolveThenable","prototype","callback","p","constructor","then","resolve","reject","value","yes","reason","no","onRejected","onFulfilled","promise","unwrap","push","QueueItem","callFulfilled","otherCallFulfilled","callRejected","otherCallRejected","func","returnValue","e","self","result","tryCatch","getThen","status","thenable","i","len","length","error","obj","appyThen","apply","arguments","called","onError","onSuccess","tryToUnwrap","out","all","iterable","Object","toString","call","values","Array","resolved","allResolver","resolveFromAll","outValue","race","response"],"mappings":"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","sourcesContent":["'use strict';\nvar immediate = require('immediate');\n\n/* istanbul ignore next */\nfunction INTERNAL() {}\n\nvar handlers = {};\n\nvar REJECTED = ['REJECTED'];\nvar FULFILLED = ['FULFILLED'];\nvar PENDING = ['PENDING'];\n\nmodule.exports = Promise;\n\nfunction Promise(resolver) {\n  if (typeof resolver !== 'function') {\n    throw new TypeError('resolver must be a function');\n  }\n  this.state = PENDING;\n  this.queue = [];\n  this.outcome = void 0;\n  if (resolver !== INTERNAL) {\n    safelyResolveThenable(this, resolver);\n  }\n}\n\nPromise.prototype[\"finally\"] = function (callback) {\n  if (typeof callback !== 'function') {\n    return this;\n  }\n  var p = this.constructor;\n  return this.then(resolve, reject);\n\n  function resolve(value) {\n    function yes () {\n      return value;\n    }\n    return p.resolve(callback()).then(yes);\n  }\n  function reject(reason) {\n    function no () {\n      throw reason;\n    }\n    return p.resolve(callback()).then(no);\n  }\n};\nPromise.prototype[\"catch\"] = function (onRejected) {\n  return this.then(null, onRejected);\n};\nPromise.prototype.then = function (onFulfilled, onRejected) {\n  if (typeof onFulfilled !== 'function' && this.state === FULFILLED ||\n    typeof onRejected !== 'function' && this.state === REJECTED) {\n    return this;\n  }\n  var promise = new this.constructor(INTERNAL);\n  if (this.state !== PENDING) {\n    var resolver = this.state === FULFILLED ? onFulfilled : onRejected;\n    unwrap(promise, resolver, this.outcome);\n  } else {\n    this.queue.push(new QueueItem(promise, onFulfilled, onRejected));\n  }\n\n  return promise;\n};\nfunction QueueItem(promise, onFulfilled, onRejected) {\n  this.promise = promise;\n  if (typeof onFulfilled === 'function') {\n    this.onFulfilled = onFulfilled;\n    this.callFulfilled = this.otherCallFulfilled;\n  }\n  if (typeof onRejected === 'function') {\n    this.onRejected = onRejected;\n    this.callRejected = this.otherCallRejected;\n  }\n}\nQueueItem.prototype.callFulfilled = function (value) {\n  handlers.resolve(this.promise, value);\n};\nQueueItem.prototype.otherCallFulfilled = function (value) {\n  unwrap(this.promise, this.onFulfilled, value);\n};\nQueueItem.prototype.callRejected = function (value) {\n  handlers.reject(this.promise, value);\n};\nQueueItem.prototype.otherCallRejected = function (value) {\n  unwrap(this.promise, this.onRejected, value);\n};\n\nfunction unwrap(promise, func, value) {\n  immediate(function () {\n    var returnValue;\n    try {\n      returnValue = func(value);\n    } catch (e) {\n      return handlers.reject(promise, e);\n    }\n    if (returnValue === promise) {\n      handlers.reject(promise, new TypeError('Cannot resolve promise with itself'));\n    } else {\n      handlers.resolve(promise, returnValue);\n    }\n  });\n}\n\nhandlers.resolve = function (self, value) {\n  var result = tryCatch(getThen, value);\n  if (result.status === 'error') {\n    return handlers.reject(self, result.value);\n  }\n  var thenable = result.value;\n\n  if (thenable) {\n    safelyResolveThenable(self, thenable);\n  } else {\n    self.state = FULFILLED;\n    self.outcome = value;\n    var i = -1;\n    var len = self.queue.length;\n    while (++i < len) {\n      self.queue[i].callFulfilled(value);\n    }\n  }\n  return self;\n};\nhandlers.reject = function (self, error) {\n  self.state = REJECTED;\n  self.outcome = error;\n  var i = -1;\n  var len = self.queue.length;\n  while (++i < len) {\n    self.queue[i].callRejected(error);\n  }\n  return self;\n};\n\nfunction getThen(obj) {\n  // Make sure we only access the accessor once as required by the spec\n  var then = obj && obj.then;\n  if (obj && (typeof obj === 'object' || typeof obj === 'function') && typeof then === 'function') {\n    return function appyThen() {\n      then.apply(obj, arguments);\n    };\n  }\n}\n\nfunction safelyResolveThenable(self, thenable) {\n  // Either fulfill, reject or reject with error\n  var called = false;\n  function onError(value) {\n    if (called) {\n      return;\n    }\n    called = true;\n    handlers.reject(self, value);\n  }\n\n  function onSuccess(value) {\n    if (called) {\n      return;\n    }\n    called = true;\n    handlers.resolve(self, value);\n  }\n\n  function tryToUnwrap() {\n    thenable(onSuccess, onError);\n  }\n\n  var result = tryCatch(tryToUnwrap);\n  if (result.status === 'error') {\n    onError(result.value);\n  }\n}\n\nfunction tryCatch(func, value) {\n  var out = {};\n  try {\n    out.value = func(value);\n    out.status = 'success';\n  } catch (e) {\n    out.status = 'error';\n    out.value = e;\n  }\n  return out;\n}\n\nPromise.resolve = resolve;\nfunction resolve(value) {\n  if (value instanceof this) {\n    return value;\n  }\n  return handlers.resolve(new this(INTERNAL), value);\n}\n\nPromise.reject = reject;\nfunction reject(reason) {\n  var promise = new this(INTERNAL);\n  return handlers.reject(promise, reason);\n}\n\nPromise.all = all;\nfunction all(iterable) {\n  var self = this;\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var values = new Array(len);\n  var resolved = 0;\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    allResolver(iterable[i], i);\n  }\n  return promise;\n  function allResolver(value, i) {\n    self.resolve(value).then(resolveFromAll, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n    function resolveFromAll(outValue) {\n      values[i] = outValue;\n      if (++resolved === len && !called) {\n        called = true;\n        handlers.resolve(promise, values);\n      }\n    }\n  }\n}\n\nPromise.race = race;\nfunction race(iterable) {\n  var self = this;\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    resolver(iterable[i]);\n  }\n  return promise;\n  function resolver(value) {\n    self.resolve(value).then(function (response) {\n      if (!called) {\n        called = true;\n        handlers.resolve(promise, response);\n      }\n    }, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n  }\n}\n"]},"metadata":{},"sourceType":"script"}